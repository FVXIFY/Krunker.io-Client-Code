!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=74)}([function(t,e,i){var n=e.global=i(41),r=e.hasBuffer=n&&!!n.isBuffer,a=e.hasArrayBuffer="undefined"!=typeof ArrayBuffer,o=e.isArray=i(4);e.isArrayBuffer=a?function(t){return t instanceof ArrayBuffer||f(t)}:g;var s=e.isBuffer=r?n.isBuffer:g,c=e.isView=a?ArrayBuffer.isView||v("ArrayBuffer","buffer"):g;e.alloc=p,e.concat=function(t,i){i||(i=0,Array.prototype.forEach.call(t,function(t){i+=t.length}));var n=this!==e&&this||t[0],r=p.call(n,i),a=0;return Array.prototype.forEach.call(t,function(t){a+=d.copy.call(t,r,a)}),r},e.from=function(t){return"string"==typeof t?function(t){var e=3*t.length,i=p.call(this,e),n=d.write.call(i,t);return e!==n&&(i=d.slice.call(i,0,n)),i}.call(this,t):m(this).from(t)};var h=e.Array=i(39),l=e.Buffer=i(38),u=e.Uint8Array=i(37),d=e.prototype=i(7);function p(t){return m(this).alloc(t)}var f=v("ArrayBuffer");function m(t){return s(t)?l:c(t)?u:o(t)?h:r?l:a?u:h}function g(){return!1}function v(t,e){return t="[object "+t+"]",function(i){return null!=i&&{}.toString.call(e?i[e]:i)===t}}},function(t,e,i){(function(e){t.exports.isProd=void 0!==e&&!!e.env.IS_PROD||"undefined"!=typeof location&&"127.0.0.1"!==location.hostname&&!location.hostname.startsWith("192.168."),t.exports.enableHttps=t.exports.isProd,t.exports.serverTickRate=1e3/30,t.exports.serverSendRate=100,t.exports.clientSendRate=1e3/30,t.exports.maxDelta=1e3/30,t.exports.maxPlayers=8,t.exports.playerSpread=1,t.exports.gamesPerServer=6,t.exports.kickTimer=45e3,t.exports.prefabIDS=["CUBE","CRATE","BARREL","LADDER","PLANE","SPAWN_POINT","CAMERA_POSITION","VEHICLE","STACK","RAMP"],t.exports.gravity=15e-5,t.exports.deathY=-300,t.exports.skyScale=18e3,t.exports.shadowDst=600,t.exports.shadowRes=512,t.exports.shadowOff=.004,t.exports.lightDistance=300,t.exports.cornerPad=1,t.exports.cornerScl=2.5,t.exports.cornerH=7,t.exports.wallH=5,t.exports.wallW=.8,t.exports.crateScale=6,t.exports.stackScale=6,t.exports.barrelScale=4,t.exports.vehicleScale=20,t.exports.barrelMlt=1.5,t.exports.ladderWidth=3.2,t.exports.ladderScale=.5,t.exports.terrainGrid=8,t.exports.otherSoundMlt=.55,t.exports.gameTime=24e4,t.exports.endTimer=2e4,t.exports.endAnim=5e3,t.exports.maxParticles=100,t.exports.chatMaxLength=70,t.exports.chatInterval=800,t.exports.movDirs=[];for(var i=0;i<8;++i)t.exports.movDirs.push(-Math.PI+(i+1)*Math.PI/4);t.exports.interpolation=1.1,t.exports.stateHistory=1e3,t.exports.syncFreq=500,t.exports.pingCount=10,t.exports.mouseSens=.0024,t.exports.camChaseTrn=.0022,t.exports.camChaseSpd=.0012,t.exports.camChaseSen=.2,t.exports.camChaseDst=30,t.exports.menuCamDist=200,t.exports.menuCamAngle=-.5,t.exports.menuCamSpeed=.1,t.exports.animMult=1.2,t.exports.leanPull=.99,t.exports.leanSens=.035,t.exports.leanMax=.16,t.exports.bobAnimZMax=.3,t.exports.leanPullZ=.99,t.exports.leanMltZ=.028,t.exports.bobMltY=.028,t.exports.bobMltZ=.08,t.exports.bobPullY=.985,t.exports.bobPullZ=.99,t.exports.aimAnimMlt=.18,t.exports.aimSlow=.55,t.exports.aimJumpSlow=.75,t.exports.stepAnim=.065,t.exports.stepMlt=.25,t.exports.stepPull=.995,t.exports.maxHealth=100,t.exports.passiveInc=500,t.exports.cameraHeight=1.5,t.exports.playerSpeed=42e-5,t.exports.ladderSpeed=.035,t.exports.ladderDecel=.97,t.exports.groundDecel=.99,t.exports.airSpeed=45e-6,t.exports.airDecel=.9995,t.exports.jumpVel=.072,t.exports.jumpPush=.1,t.exports.decelMin=1e-4,t.exports.climbHeight=1.5,t.exports.wpnSpin=.018,t.exports.materialDens={flesh:.2,floor_0:.5},t.exports.nameOffset=2,t.exports.maxNameLength=14,t.exports.maxPassLength=16,t.exports.playerHeight=11,t.exports.chestWidth=2.6,t.exports.chestScale=1.3,t.exports.armScale=1.3,t.exports.legScale=1.3,t.exports.uArmLength=2.7,t.exports.armInset=-.1,t.exports.lArmLength=2.7,t.exports.headScale=2,t.exports.armOff=-.8,t.exports.legHeight=4.2,t.exports.playerScale=(2*t.exports.armScale+t.exports.chestWidth+t.exports.armInset)/2,t.exports.hitBoxPad=1,t.exports.tracerMinDst=60,t.exports.tracerMaxDst=400,t.exports.tracerSpeed=1.7,t.exports.tracerChance=1,t.exports.crouchLean=-.1*Math.PI,t.exports.crouchDst=2.5,t.exports.crouchSlow=.3,t.exports.crouchSpeed=.007,t.exports.crouchJump=.25,t.exports.crouchSpread=.4,t.exports.crouchAnim=7e-4,t.exports.crouchAnimMlt=.5,t.exports.spreadMove=30,t.exports.spreadFall=35,t.exports.spreadRecover=.985,t.exports.spreadAdj=63e-5,t.exports.spreadMlt=400,t.exports.recoilMlt=.3,t.exports.maxLevel=60,t.exports.medalAnim=1e3,t.exports.medalDelay=900,t.exports.scoreStreak=2e3,t.exports.feedTimer=1500,t.exports.spinTimer=1800,t.exports.endStats=["sid","name","score","kills","deaths","highest"],t.exports.hitLife=1e3,t.exports.regenDelay=5e3,t.exports.regenVal=10,t.exports.sprayTimer=1e3,t.exports.sprayRange=25,t.exports.sprayScale=15,t.exports.deathDelay=2800,t.exports.deathFollowD=100,t.exports.fov=70,t.exports.viewDist=2e3,t.exports.nameVisRate=200,t.exports.worldUV=60,t.exports.ambientVal=.3,t.exports.ambD=2,t.exports.ambMlt=15,t.exports.ambS=3,t.exports.ambScale=6,t.exports.ambBleed=0,t.exports.rankVar=.03,t.exports.newDataInterval=6e4,t.exports.socials=["leaders","profile","feed"],t.exports.leaderQueries=["score","kills","wins","timeplayed"],t.exports.leaderCal={player_score:function(e){return"<span class='lName'>lvl </span>"+Math.max(1,Math.floor(t.exports.rankVar*Math.sqrt(e)))},player_kills:function(t){return t+"<span class='lName'> kills</span>"},player_wins:function(t){return t+"<span class='lName'> wins</span>"},player_timeplayed:function(t){var e=t/1e3/60,i=parseInt(e%60);e/=60;var n=parseInt(e%24);e/=24;var r=parseInt(e);return(r?r+"d ":"")+(n?n+"h ":"")+(i||0)+"m "}}}).call(this,i(24))},function(t,e,i){"use strict";function n(){}i.r(e),i.d(e,"WebGLRenderTargetCube",function(){return je}),i.d(e,"WebGLRenderTarget",function(){return Ve}),i.d(e,"WebGLRenderer",function(){return Zn}),i.d(e,"ShaderLib",function(){return Bi}),i.d(e,"UniformsLib",function(){return Fi}),i.d(e,"UniformsUtils",function(){return Ui}),i.d(e,"ShaderChunk",function(){return Ni}),i.d(e,"FogExp2",function(){return Jn}),i.d(e,"Fog",function(){return Kn}),i.d(e,"Scene",function(){return Qn}),i.d(e,"Sprite",function(){return tr}),i.d(e,"LOD",function(){return er}),i.d(e,"SkinnedMesh",function(){return rr}),i.d(e,"Skeleton",function(){return ir}),i.d(e,"Bone",function(){return nr}),i.d(e,"Mesh",function(){return Tn}),i.d(e,"LineSegments",function(){return sr}),i.d(e,"LineLoop",function(){return cr}),i.d(e,"Line",function(){return or}),i.d(e,"Points",function(){return lr}),i.d(e,"Group",function(){return ur}),i.d(e,"VideoTexture",function(){return dr}),i.d(e,"DataTexture",function(){return Ye}),i.d(e,"CompressedTexture",function(){return pr}),i.d(e,"CubeTexture",function(){return Xe}),i.d(e,"CanvasTexture",function(){return Wi}),i.d(e,"DepthTexture",function(){return fr}),i.d(e,"Texture",function(){return He}),i.d(e,"CompressedTextureLoader",function(){return za}),i.d(e,"DataTextureLoader",function(){return ka}),i.d(e,"CubeTextureLoader",function(){return Ga}),i.d(e,"TextureLoader",function(){return Va}),i.d(e,"ObjectLoader",function(){return jo}),i.d(e,"MaterialLoader",function(){return Wo}),i.d(e,"BufferGeometryLoader",function(){return zo}),i.d(e,"DefaultLoadingManager",function(){return Na}),i.d(e,"LoadingManager",function(){return Ua}),i.d(e,"JSONLoader",function(){return Vo}),i.d(e,"ImageLoader",function(){return Ha}),i.d(e,"ImageBitmapLoader",function(){return Jo}),i.d(e,"FontLoader",function(){return ts}),i.d(e,"FileLoader",function(){return Wa}),i.d(e,"Loader",function(){return Ho}),i.d(e,"LoaderUtils",function(){return Go}),i.d(e,"Cache",function(){return Fa}),i.d(e,"AudioLoader",function(){return rs}),i.d(e,"SpotLightShadow",function(){return yo}),i.d(e,"SpotLight",function(){return xo}),i.d(e,"PointLight",function(){return wo}),i.d(e,"RectAreaLight",function(){return _o}),i.d(e,"HemisphereLight",function(){return go}),i.d(e,"DirectionalLightShadow",function(){return bo}),i.d(e,"DirectionalLight",function(){return Lo}),i.d(e,"AmbientLight",function(){return Mo}),i.d(e,"LightShadow",function(){return vo}),i.d(e,"Light",function(){return mo}),i.d(e,"StereoCamera",function(){return as}),i.d(e,"PerspectiveCamera",function(){return Gn}),i.d(e,"OrthographicCamera",function(){return tn}),i.d(e,"CubeCamera",function(){return os}),i.d(e,"ArrayCamera",function(){return Vn}),i.d(e,"Camera",function(){return $i}),i.d(e,"AudioListener",function(){return ss}),i.d(e,"PositionalAudio",function(){return hs}),i.d(e,"AudioContext",function(){return ns}),i.d(e,"AudioAnalyser",function(){return ls}),i.d(e,"Audio",function(){return cs}),i.d(e,"VectorKeyframeTrack",function(){return No}),i.d(e,"StringKeyframeTrack",function(){return Ao}),i.d(e,"QuaternionKeyframeTrack",function(){return Ro}),i.d(e,"NumberKeyframeTrack",function(){return Po}),i.d(e,"ColorKeyframeTrack",function(){return Oo}),i.d(e,"BooleanKeyframeTrack",function(){return Eo}),i.d(e,"PropertyMixer",function(){return us}),i.d(e,"PropertyBinding",function(){return ps}),i.d(e,"KeyframeTrack",function(){return Uo}),i.d(e,"AnimationUtils",function(){return Fo}),i.d(e,"AnimationObjectGroup",function(){return fs}),i.d(e,"AnimationMixer",function(){return gs}),i.d(e,"AnimationClip",function(){return Bo}),i.d(e,"Uniform",function(){return vs}),i.d(e,"InstancedBufferGeometry",function(){return ys}),i.d(e,"BufferGeometry",function(){return yn}),i.d(e,"Geometry",function(){return rn}),i.d(e,"InterleavedBufferAttribute",function(){return xs}),i.d(e,"InstancedInterleavedBuffer",function(){return bs}),i.d(e,"InterleavedBuffer",function(){return ws}),i.d(e,"InstancedBufferAttribute",function(){return Ls}),i.d(e,"Face3",function(){return en}),i.d(e,"Object3D",function(){return Qi}),i.d(e,"Raycaster",function(){return Ms}),i.d(e,"Layers",function(){return Ji}),i.d(e,"EventDispatcher",function(){return n}),i.d(e,"Clock",function(){return Es}),i.d(e,"QuaternionLinearInterpolant",function(){return To}),i.d(e,"LinearInterpolant",function(){return Io}),i.d(e,"DiscreteInterpolant",function(){return Do}),i.d(e,"CubicInterpolant",function(){return Co}),i.d(e,"Interpolant",function(){return So}),i.d(e,"Triangle",function(){return Sn}),i.d(e,"Math",function(){return Fe}),i.d(e,"Spherical",function(){return Ss}),i.d(e,"Cylindrical",function(){return Ts}),i.d(e,"Plane",function(){return Yi}),i.d(e,"Frustum",function(){return Xi}),i.d(e,"Sphere",function(){return ji}),i.d(e,"Ray",function(){return An}),i.d(e,"Matrix4",function(){return Ne}),i.d(e,"Matrix3",function(){return ze}),i.d(e,"Box3",function(){return Vi}),i.d(e,"Box2",function(){return Rs}),i.d(e,"Line3",function(){return En}),i.d(e,"Euler",function(){return Zi}),i.d(e,"Vector4",function(){return Ge}),i.d(e,"Vector3",function(){return We}),i.d(e,"Vector2",function(){return Ue}),i.d(e,"Quaternion",function(){return Be}),i.d(e,"Color",function(){return Di}),i.d(e,"ImmediateRenderObject",function(){return Os}),i.d(e,"VertexNormalsHelper",function(){return Ps}),i.d(e,"SpotLightHelper",function(){return Cs}),i.d(e,"SkeletonHelper",function(){return Is}),i.d(e,"PointLightHelper",function(){return Ds}),i.d(e,"RectAreaLightHelper",function(){return Fs}),i.d(e,"HemisphereLightHelper",function(){return Us}),i.d(e,"GridHelper",function(){return Ns}),i.d(e,"PolarGridHelper",function(){return Bs}),i.d(e,"FaceNormalsHelper",function(){return Ws}),i.d(e,"DirectionalLightHelper",function(){return zs}),i.d(e,"CameraHelper",function(){return ks}),i.d(e,"BoxHelper",function(){return Hs}),i.d(e,"Box3Helper",function(){return Gs}),i.d(e,"PlaneHelper",function(){return Vs}),i.d(e,"ArrowHelper",function(){return js}),i.d(e,"AxesHelper",function(){return Ys}),i.d(e,"Shape",function(){return fo}),i.d(e,"Path",function(){return po}),i.d(e,"ShapePath",function(){return Ko}),i.d(e,"Font",function(){return Qo}),i.d(e,"CurvePath",function(){return uo}),i.d(e,"Curve",function(){return ja}),i.d(e,"ShapeUtils",function(){return ea}),i.d(e,"WebGLUtils",function(){return Yn}),i.d(e,"WireframeGeometry",function(){return mr}),i.d(e,"ParametricGeometry",function(){return gr}),i.d(e,"ParametricBufferGeometry",function(){return vr}),i.d(e,"TetrahedronGeometry",function(){return wr}),i.d(e,"TetrahedronBufferGeometry",function(){return br}),i.d(e,"OctahedronGeometry",function(){return Lr}),i.d(e,"OctahedronBufferGeometry",function(){return Mr}),i.d(e,"IcosahedronGeometry",function(){return _r}),i.d(e,"IcosahedronBufferGeometry",function(){return Ar}),i.d(e,"DodecahedronGeometry",function(){return Er}),i.d(e,"DodecahedronBufferGeometry",function(){return Sr}),i.d(e,"PolyhedronGeometry",function(){return yr}),i.d(e,"PolyhedronBufferGeometry",function(){return xr}),i.d(e,"TubeGeometry",function(){return Tr}),i.d(e,"TubeBufferGeometry",function(){return Rr}),i.d(e,"TorusKnotGeometry",function(){return Or}),i.d(e,"TorusKnotBufferGeometry",function(){return Pr}),i.d(e,"TorusGeometry",function(){return Cr}),i.d(e,"TorusBufferGeometry",function(){return Ir}),i.d(e,"TextGeometry",function(){return oa}),i.d(e,"TextBufferGeometry",function(){return sa}),i.d(e,"SphereGeometry",function(){return ca}),i.d(e,"SphereBufferGeometry",function(){return ha}),i.d(e,"RingGeometry",function(){return la}),i.d(e,"RingBufferGeometry",function(){return ua}),i.d(e,"PlaneGeometry",function(){return bn}),i.d(e,"PlaneBufferGeometry",function(){return Ln}),i.d(e,"LatheGeometry",function(){return da}),i.d(e,"LatheBufferGeometry",function(){return pa}),i.d(e,"ShapeGeometry",function(){return fa}),i.d(e,"ShapeBufferGeometry",function(){return ma}),i.d(e,"ExtrudeGeometry",function(){return ra}),i.d(e,"ExtrudeBufferGeometry",function(){return aa}),i.d(e,"EdgesGeometry",function(){return va}),i.d(e,"ConeGeometry",function(){return wa}),i.d(e,"ConeBufferGeometry",function(){return ba}),i.d(e,"CylinderGeometry",function(){return ya}),i.d(e,"CylinderBufferGeometry",function(){return xa}),i.d(e,"CircleGeometry",function(){return La}),i.d(e,"CircleBufferGeometry",function(){return Ma}),i.d(e,"BoxGeometry",function(){return xn}),i.d(e,"BoxBufferGeometry",function(){return wn}),i.d(e,"ShadowMaterial",function(){return Aa}),i.d(e,"SpriteMaterial",function(){return $n}),i.d(e,"RawShaderMaterial",function(){return Ea}),i.d(e,"ShaderMaterial",function(){return _n}),i.d(e,"PointsMaterial",function(){return hr}),i.d(e,"MeshPhysicalMaterial",function(){return Ta}),i.d(e,"MeshStandardMaterial",function(){return Sa}),i.d(e,"MeshPhongMaterial",function(){return Ra}),i.d(e,"MeshToonMaterial",function(){return Oa}),i.d(e,"MeshNormalMaterial",function(){return Pa}),i.d(e,"MeshLambertMaterial",function(){return Ca}),i.d(e,"MeshDepthMaterial",function(){return Hi}),i.d(e,"MeshDistanceMaterial",function(){return Gi}),i.d(e,"MeshBasicMaterial",function(){return Mn}),i.d(e,"LineDashedMaterial",function(){return Ia}),i.d(e,"LineBasicMaterial",function(){return ar}),i.d(e,"Material",function(){return ki}),i.d(e,"Float64BufferAttribute",function(){return fn}),i.d(e,"Float32BufferAttribute",function(){return pn}),i.d(e,"Uint32BufferAttribute",function(){return dn}),i.d(e,"Int32BufferAttribute",function(){return un}),i.d(e,"Uint16BufferAttribute",function(){return ln}),i.d(e,"Int16BufferAttribute",function(){return hn}),i.d(e,"Uint8ClampedBufferAttribute",function(){return cn}),i.d(e,"Uint8BufferAttribute",function(){return sn}),i.d(e,"Int8BufferAttribute",function(){return on}),i.d(e,"BufferAttribute",function(){return an}),i.d(e,"ArcCurve",function(){return Xa}),i.d(e,"CatmullRomCurve3",function(){return $a}),i.d(e,"CubicBezierCurve",function(){return no}),i.d(e,"CubicBezierCurve3",function(){return ro}),i.d(e,"EllipseCurve",function(){return Ya}),i.d(e,"LineCurve",function(){return ao}),i.d(e,"LineCurve3",function(){return oo}),i.d(e,"QuadraticBezierCurve",function(){return so}),i.d(e,"QuadraticBezierCurve3",function(){return co}),i.d(e,"SplineCurve",function(){return ho}),i.d(e,"REVISION",function(){return r}),i.d(e,"MOUSE",function(){return a}),i.d(e,"CullFaceNone",function(){return o}),i.d(e,"CullFaceBack",function(){return s}),i.d(e,"CullFaceFront",function(){return c}),i.d(e,"CullFaceFrontBack",function(){return h}),i.d(e,"FrontFaceDirectionCW",function(){return l}),i.d(e,"FrontFaceDirectionCCW",function(){return u}),i.d(e,"BasicShadowMap",function(){return d}),i.d(e,"PCFShadowMap",function(){return p}),i.d(e,"PCFSoftShadowMap",function(){return f}),i.d(e,"FrontSide",function(){return m}),i.d(e,"BackSide",function(){return g}),i.d(e,"DoubleSide",function(){return v}),i.d(e,"FlatShading",function(){return y}),i.d(e,"SmoothShading",function(){return x}),i.d(e,"NoColors",function(){return w}),i.d(e,"FaceColors",function(){return b}),i.d(e,"VertexColors",function(){return L}),i.d(e,"NoBlending",function(){return M}),i.d(e,"NormalBlending",function(){return _}),i.d(e,"AdditiveBlending",function(){return A}),i.d(e,"SubtractiveBlending",function(){return E}),i.d(e,"MultiplyBlending",function(){return S}),i.d(e,"CustomBlending",function(){return T}),i.d(e,"AddEquation",function(){return R}),i.d(e,"SubtractEquation",function(){return O}),i.d(e,"ReverseSubtractEquation",function(){return P}),i.d(e,"MinEquation",function(){return C}),i.d(e,"MaxEquation",function(){return I}),i.d(e,"ZeroFactor",function(){return D}),i.d(e,"OneFactor",function(){return F}),i.d(e,"SrcColorFactor",function(){return U}),i.d(e,"OneMinusSrcColorFactor",function(){return N}),i.d(e,"SrcAlphaFactor",function(){return B}),i.d(e,"OneMinusSrcAlphaFactor",function(){return W}),i.d(e,"DstAlphaFactor",function(){return z}),i.d(e,"OneMinusDstAlphaFactor",function(){return k}),i.d(e,"DstColorFactor",function(){return H}),i.d(e,"OneMinusDstColorFactor",function(){return G}),i.d(e,"SrcAlphaSaturateFactor",function(){return V}),i.d(e,"NeverDepth",function(){return j}),i.d(e,"AlwaysDepth",function(){return Y}),i.d(e,"LessDepth",function(){return X}),i.d(e,"LessEqualDepth",function(){return q}),i.d(e,"EqualDepth",function(){return Z}),i.d(e,"GreaterEqualDepth",function(){return J}),i.d(e,"GreaterDepth",function(){return K}),i.d(e,"NotEqualDepth",function(){return Q}),i.d(e,"MultiplyOperation",function(){return $}),i.d(e,"MixOperation",function(){return tt}),i.d(e,"AddOperation",function(){return et}),i.d(e,"NoToneMapping",function(){return it}),i.d(e,"LinearToneMapping",function(){return nt}),i.d(e,"ReinhardToneMapping",function(){return rt}),i.d(e,"Uncharted2ToneMapping",function(){return at}),i.d(e,"CineonToneMapping",function(){return ot}),i.d(e,"UVMapping",function(){return st}),i.d(e,"CubeReflectionMapping",function(){return ct}),i.d(e,"CubeRefractionMapping",function(){return ht}),i.d(e,"EquirectangularReflectionMapping",function(){return lt}),i.d(e,"EquirectangularRefractionMapping",function(){return ut}),i.d(e,"SphericalReflectionMapping",function(){return dt}),i.d(e,"CubeUVReflectionMapping",function(){return pt}),i.d(e,"CubeUVRefractionMapping",function(){return ft}),i.d(e,"RepeatWrapping",function(){return mt}),i.d(e,"ClampToEdgeWrapping",function(){return gt}),i.d(e,"MirroredRepeatWrapping",function(){return vt}),i.d(e,"NearestFilter",function(){return yt}),i.d(e,"NearestMipMapNearestFilter",function(){return xt}),i.d(e,"NearestMipMapLinearFilter",function(){return wt}),i.d(e,"LinearFilter",function(){return bt}),i.d(e,"LinearMipMapNearestFilter",function(){return Lt}),i.d(e,"LinearMipMapLinearFilter",function(){return Mt}),i.d(e,"UnsignedByteType",function(){return _t}),i.d(e,"ByteType",function(){return At}),i.d(e,"ShortType",function(){return Et}),i.d(e,"UnsignedShortType",function(){return St}),i.d(e,"IntType",function(){return Tt}),i.d(e,"UnsignedIntType",function(){return Rt}),i.d(e,"FloatType",function(){return Ot}),i.d(e,"HalfFloatType",function(){return Pt}),i.d(e,"UnsignedShort4444Type",function(){return Ct}),i.d(e,"UnsignedShort5551Type",function(){return It}),i.d(e,"UnsignedShort565Type",function(){return Dt}),i.d(e,"UnsignedInt248Type",function(){return Ft}),i.d(e,"AlphaFormat",function(){return Ut}),i.d(e,"RGBFormat",function(){return Nt}),i.d(e,"RGBAFormat",function(){return Bt}),i.d(e,"LuminanceFormat",function(){return Wt}),i.d(e,"LuminanceAlphaFormat",function(){return zt}),i.d(e,"RGBEFormat",function(){return kt}),i.d(e,"DepthFormat",function(){return Ht}),i.d(e,"DepthStencilFormat",function(){return Gt}),i.d(e,"RGB_S3TC_DXT1_Format",function(){return Vt}),i.d(e,"RGBA_S3TC_DXT1_Format",function(){return jt}),i.d(e,"RGBA_S3TC_DXT3_Format",function(){return Yt}),i.d(e,"RGBA_S3TC_DXT5_Format",function(){return Xt}),i.d(e,"RGB_PVRTC_4BPPV1_Format",function(){return qt}),i.d(e,"RGB_PVRTC_2BPPV1_Format",function(){return Zt}),i.d(e,"RGBA_PVRTC_4BPPV1_Format",function(){return Jt}),i.d(e,"RGBA_PVRTC_2BPPV1_Format",function(){return Kt}),i.d(e,"RGB_ETC1_Format",function(){return Qt}),i.d(e,"RGBA_ASTC_4x4_Format",function(){return $t}),i.d(e,"RGBA_ASTC_5x4_Format",function(){return te}),i.d(e,"RGBA_ASTC_5x5_Format",function(){return ee}),i.d(e,"RGBA_ASTC_6x5_Format",function(){return ie}),i.d(e,"RGBA_ASTC_6x6_Format",function(){return ne}),i.d(e,"RGBA_ASTC_8x5_Format",function(){return re}),i.d(e,"RGBA_ASTC_8x6_Format",function(){return ae}),i.d(e,"RGBA_ASTC_8x8_Format",function(){return oe}),i.d(e,"RGBA_ASTC_10x5_Format",function(){return se}),i.d(e,"RGBA_ASTC_10x6_Format",function(){return ce}),i.d(e,"RGBA_ASTC_10x8_Format",function(){return he}),i.d(e,"RGBA_ASTC_10x10_Format",function(){return le}),i.d(e,"RGBA_ASTC_12x10_Format",function(){return ue}),i.d(e,"RGBA_ASTC_12x12_Format",function(){return de}),i.d(e,"LoopOnce",function(){return pe}),i.d(e,"LoopRepeat",function(){return fe}),i.d(e,"LoopPingPong",function(){return me}),i.d(e,"InterpolateDiscrete",function(){return ge}),i.d(e,"InterpolateLinear",function(){return ve}),i.d(e,"InterpolateSmooth",function(){return ye}),i.d(e,"ZeroCurvatureEnding",function(){return xe}),i.d(e,"ZeroSlopeEnding",function(){return we}),i.d(e,"WrapAroundEnding",function(){return be}),i.d(e,"TrianglesDrawMode",function(){return Le}),i.d(e,"TriangleStripDrawMode",function(){return Me}),i.d(e,"TriangleFanDrawMode",function(){return _e}),i.d(e,"LinearEncoding",function(){return Ae}),i.d(e,"sRGBEncoding",function(){return Ee}),i.d(e,"GammaEncoding",function(){return Se}),i.d(e,"RGBEEncoding",function(){return Te}),i.d(e,"LogLuvEncoding",function(){return Re}),i.d(e,"RGBM7Encoding",function(){return Oe}),i.d(e,"RGBM16Encoding",function(){return Pe}),i.d(e,"RGBDEncoding",function(){return Ce}),i.d(e,"BasicDepthPacking",function(){return Ie}),i.d(e,"RGBADepthPacking",function(){return De}),i.d(e,"CubeGeometry",function(){return xn}),i.d(e,"Face4",function(){return Xs}),i.d(e,"LineStrip",function(){return qs}),i.d(e,"LinePieces",function(){return Zs}),i.d(e,"MeshFaceMaterial",function(){return Js}),i.d(e,"MultiMaterial",function(){return Ks}),i.d(e,"PointCloud",function(){return Qs}),i.d(e,"Particle",function(){return $s}),i.d(e,"ParticleSystem",function(){return tc}),i.d(e,"PointCloudMaterial",function(){return ec}),i.d(e,"ParticleBasicMaterial",function(){return ic}),i.d(e,"ParticleSystemMaterial",function(){return nc}),i.d(e,"Vertex",function(){return rc}),i.d(e,"DynamicBufferAttribute",function(){return ac}),i.d(e,"Int8Attribute",function(){return oc}),i.d(e,"Uint8Attribute",function(){return sc}),i.d(e,"Uint8ClampedAttribute",function(){return cc}),i.d(e,"Int16Attribute",function(){return hc}),i.d(e,"Uint16Attribute",function(){return lc}),i.d(e,"Int32Attribute",function(){return uc}),i.d(e,"Uint32Attribute",function(){return dc}),i.d(e,"Float32Attribute",function(){return pc}),i.d(e,"Float64Attribute",function(){return fc}),i.d(e,"ClosedSplineCurve3",function(){return mc}),i.d(e,"SplineCurve3",function(){return gc}),i.d(e,"Spline",function(){return vc}),i.d(e,"AxisHelper",function(){return yc}),i.d(e,"BoundingBoxHelper",function(){return xc}),i.d(e,"EdgesHelper",function(){return wc}),i.d(e,"WireframeHelper",function(){return bc}),i.d(e,"XHRLoader",function(){return Lc}),i.d(e,"BinaryTextureLoader",function(){return Mc}),i.d(e,"GeometryUtils",function(){return _c}),i.d(e,"ImageUtils",function(){return Ac}),i.d(e,"Projector",function(){return Ec}),i.d(e,"CanvasRenderer",function(){return Sc}),i.d(e,"SceneUtils",function(){return Tc}),i.d(e,"LensFlare",function(){return Rc}),void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype==0&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&(Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(void 0!==n&&null!==n)for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}),Object.assign(n.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var i=this._listeners;void 0===i[t]&&(i[t]=[]),-1===i[t].indexOf(e)&&i[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var i=this._listeners;return void 0!==i[t]&&-1!==i[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var i=this._listeners[t];if(void 0!==i){var n=i.indexOf(e);-1!==n&&i.splice(n,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners[t.type];if(void 0!==e){t.target=this;for(var i=e.slice(0),n=0,r=i.length;n<r;n++)i[n].call(this,t)}}}});var r="90",a={LEFT:0,MIDDLE:1,RIGHT:2},o=0,s=1,c=2,h=3,l=0,u=1,d=0,p=1,f=2,m=0,g=1,v=2,y=1,x=2,w=0,b=1,L=2,M=0,_=1,A=2,E=3,S=4,T=5,R=100,O=101,P=102,C=103,I=104,D=200,F=201,U=202,N=203,B=204,W=205,z=206,k=207,H=208,G=209,V=210,j=0,Y=1,X=2,q=3,Z=4,J=5,K=6,Q=7,$=0,tt=1,et=2,it=0,nt=1,rt=2,at=3,ot=4,st=300,ct=301,ht=302,lt=303,ut=304,dt=305,pt=306,ft=307,mt=1e3,gt=1001,vt=1002,yt=1003,xt=1004,wt=1005,bt=1006,Lt=1007,Mt=1008,_t=1009,At=1010,Et=1011,St=1012,Tt=1013,Rt=1014,Ot=1015,Pt=1016,Ct=1017,It=1018,Dt=1019,Ft=1020,Ut=1021,Nt=1022,Bt=1023,Wt=1024,zt=1025,kt=Bt,Ht=1026,Gt=1027,Vt=33776,jt=33777,Yt=33778,Xt=33779,qt=35840,Zt=35841,Jt=35842,Kt=35843,Qt=36196,$t=37808,te=37809,ee=37810,ie=37811,ne=37812,re=37813,ae=37814,oe=37815,se=37816,ce=37817,he=37818,le=37819,ue=37820,de=37821,pe=2200,fe=2201,me=2202,ge=2300,ve=2301,ye=2302,xe=2400,we=2401,be=2402,Le=0,Me=1,_e=2,Ae=3e3,Ee=3001,Se=3007,Te=3002,Re=3003,Oe=3004,Pe=3005,Ce=3006,Ie=3200,De=3201,Fe={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16).toUpperCase();return function(){var e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&n|128]+t[n>>8&255]+"-"+t[n>>16&255]+t[n>>24&255]+t[255&r]+t[r>>8&255]+t[r>>16&255]+t[r>>24&255]}}(),clamp:function(t,e,i){return Math.max(e,Math.min(i,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,i,n,r){return n+(t-e)*(r-n)/(i-e)},lerp:function(t,e,i){return(1-i)*t+i*e},smoothstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*(3-2*t)},smootherstep:function(t,e,i){return t<=e?0:t>=i?1:(t=(t-e)/(i-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Fe.DEG2RAD},radToDeg:function(t){return t*Fe.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};function Ue(t,e){this.x=t||0,this.y=e||0}function Ne(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function Be(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._w=void 0!==n?n:1}function We(t,e,i){this.x=t||0,this.y=e||0,this.z=i||0}function ze(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}Object.defineProperties(Ue.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(Ue.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,i=this.y,n=t.elements;return this.x=n[0]*e+n[3]*i+n[6],this.y=n[1]*e+n[4]*i+n[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new Ue,e=new Ue;return function(i,n){return t.set(i,i),e.set(n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y;return e*e+i*i},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=this.x-t.x,a=this.y-t.y;return this.x=r*i-a*n+t.x,this.y=r*n+a*i+t.y,this}}),Object.assign(Ne.prototype,{isMatrix4:!0,set:function(t,e,i,n,r,a,o,s,c,h,l,u,d,p,f,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=i,g[12]=n,g[1]=r,g[5]=a,g[9]=o,g[13]=s,g[2]=c,g[6]=h,g[10]=l,g[14]=u,g[3]=d,g[7]=p,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new Ne).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],e[9]=i[9],e[10]=i[10],e[11]=i[11],e[12]=i[12],e[13]=i[13],e[14]=i[14],e[15]=i[15],this},copyPosition:function(t){var e=this.elements,i=t.elements;return e[12]=i[12],e[13]=i[13],e[14]=i[14],this},extractBasis:function(t,e,i){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,i){return this.set(t.x,e.x,i.x,0,t.y,e.y,i.y,0,t.z,e.z,i.z,0,0,0,0,1),this},extractRotation:function(){var t=new We;return function(e){var i=this.elements,n=e.elements,r=1/t.setFromMatrixColumn(e,0).length(),a=1/t.setFromMatrixColumn(e,1).length(),o=1/t.setFromMatrixColumn(e,2).length();return i[0]=n[0]*r,i[1]=n[1]*r,i[2]=n[2]*r,i[4]=n[4]*a,i[5]=n[5]*a,i[6]=n[6]*a,i[8]=n[8]*o,i[9]=n[9]*o,i[10]=n[10]*o,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,i=t.x,n=t.y,r=t.z,a=Math.cos(i),o=Math.sin(i),s=Math.cos(n),c=Math.sin(n),h=Math.cos(r),l=Math.sin(r);if("XYZ"===t.order){var u=a*h,d=a*l,p=o*h,f=o*l;e[0]=s*h,e[4]=-s*l,e[8]=c,e[1]=d+p*c,e[5]=u-f*c,e[9]=-o*s,e[2]=f-u*c,e[6]=p+d*c,e[10]=a*s}else if("YXZ"===t.order){var m=s*h,g=s*l,v=c*h,y=c*l;e[0]=m+y*o,e[4]=v*o-g,e[8]=a*c,e[1]=a*l,e[5]=a*h,e[9]=-o,e[2]=g*o-v,e[6]=y+m*o,e[10]=a*s}else if("ZXY"===t.order)m=s*h,g=s*l,v=c*h,y=c*l,e[0]=m-y*o,e[4]=-a*l,e[8]=v+g*o,e[1]=g+v*o,e[5]=a*h,e[9]=y-m*o,e[2]=-a*c,e[6]=o,e[10]=a*s;else if("ZYX"===t.order)u=a*h,d=a*l,p=o*h,f=o*l,e[0]=s*h,e[4]=p*c-d,e[8]=u*c+f,e[1]=s*l,e[5]=f*c+u,e[9]=d*c-p,e[2]=-c,e[6]=o*s,e[10]=a*s;else if("YZX"===t.order){var x=a*s,w=a*c,b=o*s,L=o*c;e[0]=s*h,e[4]=L-x*l,e[8]=b*l+w,e[1]=l,e[5]=a*h,e[9]=-o*h,e[2]=-c*h,e[6]=w*l+b,e[10]=x-L*l}else"XZY"===t.order&&(x=a*s,w=a*c,b=o*s,L=o*c,e[0]=s*h,e[4]=-l,e[8]=c*h,e[1]=x*l+L,e[5]=a*h,e[9]=w*l-b,e[2]=b*l-w,e[6]=o*h,e[10]=L*l+x);return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,i=t._x,n=t._y,r=t._z,a=t._w,o=i+i,s=n+n,c=r+r,h=i*o,l=i*s,u=i*c,d=n*s,p=n*c,f=r*c,m=a*o,g=a*s,v=a*c;return e[0]=1-(d+f),e[4]=l-v,e[8]=u+g,e[1]=l+v,e[5]=1-(h+f),e[9]=p-m,e[2]=u-g,e[6]=p+m,e[10]=1-(h+d),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new We,e=new We,i=new We;return function(n,r,a){var o=this.elements;return i.subVectors(n,r),0===i.lengthSq()&&(i.z=1),i.normalize(),t.crossVectors(a,i),0===t.lengthSq()&&(1===Math.abs(a.z)?i.x+=1e-4:i.z+=1e-4,i.normalize(),t.crossVectors(a,i)),t.normalize(),e.crossVectors(i,t),o[0]=t.x,o[4]=e.x,o[8]=i.x,o[1]=t.y,o[5]=e.y,o[9]=i.y,o[2]=t.z,o[6]=e.z,o[10]=i.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[4],s=i[8],c=i[12],h=i[1],l=i[5],u=i[9],d=i[13],p=i[2],f=i[6],m=i[10],g=i[14],v=i[3],y=i[7],x=i[11],w=i[15],b=n[0],L=n[4],M=n[8],_=n[12],A=n[1],E=n[5],S=n[9],T=n[13],R=n[2],O=n[6],P=n[10],C=n[14],I=n[3],D=n[7],F=n[11],U=n[15];return r[0]=a*b+o*A+s*R+c*I,r[4]=a*L+o*E+s*O+c*D,r[8]=a*M+o*S+s*P+c*F,r[12]=a*_+o*T+s*C+c*U,r[1]=h*b+l*A+u*R+d*I,r[5]=h*L+l*E+u*O+d*D,r[9]=h*M+l*S+u*P+d*F,r[13]=h*_+l*T+u*C+d*U,r[2]=p*b+f*A+m*R+g*I,r[6]=p*L+f*E+m*O+g*D,r[10]=p*M+f*S+m*P+g*F,r[14]=p*_+f*T+m*C+g*U,r[3]=v*b+y*A+x*R+w*I,r[7]=v*L+y*E+x*O+w*D,r[11]=v*M+y*S+x*P+w*F,r[15]=v*_+y*T+x*C+w*U,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new We;return function(e){for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix4(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],i=t[4],n=t[8],r=t[12],a=t[1],o=t[5],s=t[9],c=t[13],h=t[2],l=t[6],u=t[10],d=t[14];return t[3]*(+r*s*l-n*c*l-r*o*u+i*c*u+n*o*d-i*s*d)+t[7]*(+e*s*d-e*c*u+r*a*u-n*a*d+n*c*h-r*s*h)+t[11]*(+e*c*l-e*o*d-r*a*l+i*a*d+r*o*h-i*c*h)+t[15]*(-n*o*h-e*s*l+e*o*u+n*a*l-i*a*u+i*s*h)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var i=this.elements,n=t.elements,r=n[0],a=n[1],o=n[2],s=n[3],c=n[4],h=n[5],l=n[6],u=n[7],d=n[8],p=n[9],f=n[10],m=n[11],g=n[12],v=n[13],y=n[14],x=n[15],w=p*y*u-v*f*u+v*l*m-h*y*m-p*l*x+h*f*x,b=g*f*u-d*y*u-g*l*m+c*y*m+d*l*x-c*f*x,L=d*v*u-g*p*u+g*h*m-c*v*m-d*h*x+c*p*x,M=g*p*l-d*v*l-g*h*f+c*v*f+d*h*y-c*p*y,_=r*w+a*b+o*L+s*M;if(0===_){var A="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(A);return console.warn(A),this.identity()}var E=1/_;return i[0]=w*E,i[1]=(v*f*s-p*y*s-v*o*m+a*y*m+p*o*x-a*f*x)*E,i[2]=(h*y*s-v*l*s+v*o*u-a*y*u-h*o*x+a*l*x)*E,i[3]=(p*l*s-h*f*s-p*o*u+a*f*u+h*o*m-a*l*m)*E,i[4]=b*E,i[5]=(d*y*s-g*f*s+g*o*m-r*y*m-d*o*x+r*f*x)*E,i[6]=(g*l*s-c*y*s-g*o*u+r*y*u+c*o*x-r*l*x)*E,i[7]=(c*f*s-d*l*s+d*o*u-r*f*u-c*o*m+r*l*m)*E,i[8]=L*E,i[9]=(g*p*s-d*v*s-g*a*m+r*v*m+d*a*x-r*p*x)*E,i[10]=(c*v*s-g*h*s+g*a*u-r*v*u-c*a*x+r*h*x)*E,i[11]=(d*h*s-c*p*s-d*a*u+r*p*u+c*a*m-r*h*m)*E,i[12]=M*E,i[13]=(d*v*o-g*p*o+g*a*f-r*v*f-d*a*y+r*p*y)*E,i[14]=(g*h*o-c*v*o-g*a*l+r*v*l+c*a*y-r*h*y)*E,i[15]=(c*p*o-d*h*o+d*a*l-r*p*l-c*a*f+r*h*f)*E,this},scale:function(t){var e=this.elements,i=t.x,n=t.y,r=t.z;return e[0]*=i,e[4]*=n,e[8]*=r,e[1]*=i,e[5]*=n,e[9]*=r,e[2]*=i,e[6]*=n,e[10]*=r,e[3]*=i,e[7]*=n,e[11]*=r,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],n=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,i,n))},makeTranslation:function(t,e,i){return this.set(1,0,0,t,0,1,0,e,0,0,1,i,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,e,-i,0,0,i,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,0,i,0,0,1,0,0,-i,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),i=Math.sin(t);return this.set(e,-i,0,0,i,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var i=Math.cos(e),n=Math.sin(e),r=1-i,a=t.x,o=t.y,s=t.z,c=r*a,h=r*o;return this.set(c*a+i,c*o-n*s,c*s+n*o,0,c*o+n*s,h*o+i,h*s-n*a,0,c*s-n*o,h*s+n*a,r*s*s+i,0,0,0,0,1),this},makeScale:function(t,e,i){return this.set(t,0,0,0,0,e,0,0,0,0,i,0,0,0,0,1),this},makeShear:function(t,e,i){return this.set(1,e,i,0,t,1,i,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,i){return this.makeRotationFromQuaternion(e),this.scale(i),this.setPosition(t),this},decompose:function(){var t=new We,e=new Ne;return function(i,n,r){var a=this.elements,o=t.set(a[0],a[1],a[2]).length(),s=t.set(a[4],a[5],a[6]).length(),c=t.set(a[8],a[9],a[10]).length();this.determinant()<0&&(o=-o),i.x=a[12],i.y=a[13],i.z=a[14],e.copy(this);var h=1/o,l=1/s,u=1/c;return e.elements[0]*=h,e.elements[1]*=h,e.elements[2]*=h,e.elements[4]*=l,e.elements[5]*=l,e.elements[6]*=l,e.elements[8]*=u,e.elements[9]*=u,e.elements[10]*=u,n.setFromRotationMatrix(e),r.x=o,r.y=s,r.z=c,this}}(),makePerspective:function(t,e,i,n,r,a){void 0===a&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var o=this.elements,s=2*r/(e-t),c=2*r/(i-n),h=(e+t)/(e-t),l=(i+n)/(i-n),u=-(a+r)/(a-r),d=-2*a*r/(a-r);return o[0]=s,o[4]=0,o[8]=h,o[12]=0,o[1]=0,o[5]=c,o[9]=l,o[13]=0,o[2]=0,o[6]=0,o[10]=u,o[14]=d,o[3]=0,o[7]=0,o[11]=-1,o[15]=0,this},makeOrthographic:function(t,e,i,n,r,a){var o=this.elements,s=1/(e-t),c=1/(i-n),h=1/(a-r),l=(e+t)*s,u=(i+n)*c,d=(a+r)*h;return o[0]=2*s,o[4]=0,o[8]=0,o[12]=-l,o[1]=0,o[5]=2*c,o[9]=0,o[13]=-u,o[2]=0,o[6]=0,o[10]=-2*h,o[14]=-d,o[3]=0,o[7]=0,o[11]=0,o[15]=1,this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<16;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<16;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t[e+9]=i[9],t[e+10]=i[10],t[e+11]=i[11],t[e+12]=i[12],t[e+13]=i[13],t[e+14]=i[14],t[e+15]=i[15],t}}),Object.assign(Be,{slerp:function(t,e,i,n){return i.copy(t).slerp(e,n)},slerpFlat:function(t,e,i,n,r,a,o){var s=i[n+0],c=i[n+1],h=i[n+2],l=i[n+3],u=r[a+0],d=r[a+1],p=r[a+2],f=r[a+3];if(l!==f||s!==u||c!==d||h!==p){var m=1-o,g=s*u+c*d+h*p+l*f,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var x=Math.sqrt(y),w=Math.atan2(x,g*v);m=Math.sin(m*w)/x,o=Math.sin(o*w)/x}var b=o*v;if(s=s*m+u*b,c=c*m+d*b,h=h*m+p*b,l=l*m+f*b,m===1-o){var L=1/Math.sqrt(s*s+c*c+h*h+l*l);s*=L,c*=L,h*=L,l*=L}}t[e]=s,t[e+1]=c,t[e+2]=h,t[e+3]=l}}),Object.defineProperties(Be.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(Be.prototype,{set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._w=n,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var i=t._x,n=t._y,r=t._z,a=t.order,o=Math.cos,s=Math.sin,c=o(i/2),h=o(n/2),l=o(r/2),u=s(i/2),d=s(n/2),p=s(r/2);return"XYZ"===a?(this._x=u*h*l+c*d*p,this._y=c*d*l-u*h*p,this._z=c*h*p+u*d*l,this._w=c*h*l-u*d*p):"YXZ"===a?(this._x=u*h*l+c*d*p,this._y=c*d*l-u*h*p,this._z=c*h*p-u*d*l,this._w=c*h*l+u*d*p):"ZXY"===a?(this._x=u*h*l-c*d*p,this._y=c*d*l+u*h*p,this._z=c*h*p+u*d*l,this._w=c*h*l-u*d*p):"ZYX"===a?(this._x=u*h*l-c*d*p,this._y=c*d*l+u*h*p,this._z=c*h*p-u*d*l,this._w=c*h*l+u*d*p):"YZX"===a?(this._x=u*h*l+c*d*p,this._y=c*d*l+u*h*p,this._z=c*h*p-u*d*l,this._w=c*h*l-u*d*p):"XZY"===a&&(this._x=u*h*l-c*d*p,this._y=c*d*l-u*h*p,this._z=c*h*p+u*d*l,this._w=c*h*l+u*d*p),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var i=e/2,n=Math.sin(i);return this._x=t.x*n,this._y=t.y*n,this._z=t.z*n,this._w=Math.cos(i),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,i=t.elements,n=i[0],r=i[4],a=i[8],o=i[1],s=i[5],c=i[9],h=i[2],l=i[6],u=i[10],d=n+s+u;return d>0?(e=.5/Math.sqrt(d+1),this._w=.25/e,this._x=(l-c)*e,this._y=(a-h)*e,this._z=(o-r)*e):n>s&&n>u?(e=2*Math.sqrt(1+n-s-u),this._w=(l-c)/e,this._x=.25*e,this._y=(r+o)/e,this._z=(a+h)/e):s>u?(e=2*Math.sqrt(1+s-n-u),this._w=(a-h)/e,this._x=(r+o)/e,this._y=.25*e,this._z=(c+l)/e):(e=2*Math.sqrt(1+u-n-s),this._w=(o-r)/e,this._x=(a+h)/e,this._y=(c+l)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new We;return function(i,n){return void 0===e&&(e=new We),(t=i.dot(n)+1)<1e-6?(t=0,Math.abs(i.x)>Math.abs(i.z)?e.set(-i.y,i.x,0):e.set(0,-i.z,i.y)):e.crossVectors(i,n),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var i=t._x,n=t._y,r=t._z,a=t._w,o=e._x,s=e._y,c=e._z,h=e._w;return this._x=i*h+a*o+n*c-r*s,this._y=n*h+a*s+r*o-i*c,this._z=r*h+a*c+i*s-n*o,this._w=a*h-i*o-n*s-r*c,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var i=this._x,n=this._y,r=this._z,a=this._w,o=a*t._w+i*t._x+n*t._y+r*t._z;if(o<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,o=-o):this.copy(t),o>=1)return this._w=a,this._x=i,this._y=n,this._z=r,this;var s=Math.sqrt(1-o*o);if(Math.abs(s)<.001)return this._w=.5*(a+this._w),this._x=.5*(i+this._x),this._y=.5*(n+this._y),this._z=.5*(r+this._z),this;var c=Math.atan2(s,o),h=Math.sin((1-e)*c)/s,l=Math.sin(e*c)/s;return this._w=a*h+this._w*l,this._x=i*h+this._x*l,this._y=n*h+this._y*l,this._z=r*h+this._z*l,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(We.prototype,{isVector3:!0,set:function(t,e,i){return this.x=t,this.y=e,this.z=i,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new Be;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new Be;return function(e,i){return this.applyQuaternion(t.setFromAxisAngle(e,i))}}(),applyMatrix3:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[3]*i+r[6]*n,this.y=r[1]*e+r[4]*i+r[7]*n,this.z=r[2]*e+r[5]*i+r[8]*n,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements,a=1/(r[3]*e+r[7]*i+r[11]*n+r[15]);return this.x=(r[0]*e+r[4]*i+r[8]*n+r[12])*a,this.y=(r[1]*e+r[5]*i+r[9]*n+r[13])*a,this.z=(r[2]*e+r[6]*i+r[10]*n+r[14])*a,this},applyQuaternion:function(t){var e=this.x,i=this.y,n=this.z,r=t.x,a=t.y,o=t.z,s=t.w,c=s*e+a*n-o*i,h=s*i+o*e-r*n,l=s*n+r*i-a*e,u=-r*e-a*i-o*n;return this.x=c*s+u*-r+h*-o-l*-a,this.y=h*s+u*-a+l*-r-c*-o,this.z=l*s+u*-o+c*-a-h*-r,this},project:function(){var t=new Ne;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new Ne;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,i=this.y,n=this.z,r=t.elements;return this.x=r[0]*e+r[4]*i+r[8]*n,this.y=r[1]*e+r[5]*i+r[9]*n,this.z=r[2]*e+r[6]*i+r[10]*n,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new We,e=new We;return function(i,n){return t.set(i,i,i),e.set(n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var i=t.x,n=t.y,r=t.z,a=e.x,o=e.y,s=e.z;return this.x=n*s-r*o,this.y=r*a-i*s,this.z=i*o-n*a,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new We;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new We;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Fe.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,i=this.y-t.y,n=this.z-t.z;return e*e+i*i+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),n=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=i,this.z=n,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(ze.prototype,{isMatrix3:!0,set:function(t,e,i,n,r,a,o,s,c){var h=this.elements;return h[0]=t,h[1]=n,h[2]=o,h[3]=e,h[4]=r,h[5]=s,h[6]=i,h[7]=a,h[8]=c,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,i=t.elements;return e[0]=i[0],e[1]=i[1],e[2]=i[2],e[3]=i[3],e[4]=i[4],e[5]=i[5],e[6]=i[6],e[7]=i[7],e[8]=i[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new We;return function(e){for(var i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.applyMatrix3(this),e.setXYZ(i,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var i=t.elements,n=e.elements,r=this.elements,a=i[0],o=i[3],s=i[6],c=i[1],h=i[4],l=i[7],u=i[2],d=i[5],p=i[8],f=n[0],m=n[3],g=n[6],v=n[1],y=n[4],x=n[7],w=n[2],b=n[5],L=n[8];return r[0]=a*f+o*v+s*w,r[3]=a*m+o*y+s*b,r[6]=a*g+o*x+s*L,r[1]=c*f+h*v+l*w,r[4]=c*m+h*y+l*b,r[7]=c*g+h*x+l*L,r[2]=u*f+d*v+p*w,r[5]=u*m+d*y+p*b,r[8]=u*g+d*x+p*L,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],i=t[1],n=t[2],r=t[3],a=t[4],o=t[5],s=t[6],c=t[7],h=t[8];return e*a*h-e*o*c-i*r*h+i*o*s+n*r*c-n*a*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var i=t.elements,n=this.elements,r=i[0],a=i[1],o=i[2],s=i[3],c=i[4],h=i[5],l=i[6],u=i[7],d=i[8],p=d*c-h*u,f=h*l-d*s,m=u*s-c*l,g=r*p+a*f+o*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return n[0]=p*y,n[1]=(o*u-d*a)*y,n[2]=(h*a-o*c)*y,n[3]=f*y,n[4]=(d*r-o*l)*y,n[5]=(o*s-h*r)*y,n[6]=m*y,n[7]=(a*l-u*r)*y,n[8]=(c*r-a*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,i,n,r,a,o){var s=Math.cos(r),c=Math.sin(r);this.set(i*s,i*c,-i*(s*a+c*o)+a+t,-n*c,n*s,-n*(-c*a+s*o)+o+e,0,0,1)},scale:function(t,e){var i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=e,i[4]*=e,i[7]*=e,this},rotate:function(t){var e=Math.cos(t),i=Math.sin(t),n=this.elements,r=n[0],a=n[3],o=n[6],s=n[1],c=n[4],h=n[7];return n[0]=e*r+i*s,n[3]=e*a+i*c,n[6]=e*o+i*h,n[1]=-i*r+e*s,n[4]=-i*a+e*c,n[7]=-i*o+e*h,this},translate:function(t,e){var i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=e*i[2],i[4]+=e*i[5],i[7]+=e*i[8],this},equals:function(t){for(var e=this.elements,i=t.elements,n=0;n<9;n++)if(e[n]!==i[n])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var i=0;i<9;i++)this.elements[i]=t[i+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var i=this.elements;return t[e]=i[0],t[e+1]=i[1],t[e+2]=i[2],t[e+3]=i[3],t[e+4]=i[4],t[e+5]=i[5],t[e+6]=i[6],t[e+7]=i[7],t[e+8]=i[8],t}});var ke=0;function He(t,e,i,n,r,a,o,s,c,h){Object.defineProperty(this,"id",{value:ke++}),this.uuid=Fe.generateUUID(),this.name="",this.image=void 0!==t?t:He.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:He.DEFAULT_MAPPING,this.wrapS=void 0!==i?i:gt,this.wrapT=void 0!==n?n:gt,this.magFilter=void 0!==r?r:bt,this.minFilter=void 0!==a?a:Mt,this.anisotropy=void 0!==c?c:1,this.format=void 0!==o?o:Bt,this.type=void 0!==s?s:_t,this.offset=new Ue(0,0),this.repeat=new Ue(1,1),this.center=new Ue(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new ze,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==h?h:Ae,this.version=0,this.onUpdate=null}function Ge(t,e,i,n){this.x=t||0,this.y=e||0,this.z=i||0,this.w=void 0!==n?n:1}function Ve(t,e,i){this.uuid=Fe.generateUUID(),this.width=t,this.height=e,this.scissor=new Ge(0,0,t,e),this.scissorTest=!1,this.viewport=new Ge(0,0,t,e),void 0===(i=i||{}).minFilter&&(i.minFilter=bt),this.texture=new He(void 0,void 0,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.depthBuffer=void 0===i.depthBuffer||i.depthBuffer,this.stencilBuffer=void 0===i.stencilBuffer||i.stencilBuffer,this.depthTexture=void 0!==i.depthTexture?i.depthTexture:null}function je(t,e,i){Ve.call(this,t,e,i),this.activeCubeFace=0,this.activeMipMapLevel=0}function Ye(t,e,i,n,r,a,o,s,c,h,l,u){He.call(this,null,a,o,s,c,h,n,r,l,u),this.image={data:t,width:e,height:i},this.magFilter=void 0!==c?c:yt,this.minFilter=void 0!==h?h:yt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function Xe(t,e,i,n,r,a,o,s,c,h){t=void 0!==t?t:[],e=void 0!==e?e:ct,He.call(this,t,e,i,n,r,a,o,s,c,h),this.flipY=!1}He.DEFAULT_IMAGE=void 0,He.DEFAULT_MAPPING=st,He.prototype=Object.assign(Object.create(n.prototype),{constructor:He,isTexture:!0,clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"==typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var n=this.image;void 0===n.uuid&&(n.uuid=Fe.generateUUID()),e||void 0!==t.images[n.uuid]||(t.images[n.uuid]={uuid:n.uuid,url:function(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{(e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).width=t.width,e.height=t.height;var i=e.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(n)}),i.image=n.uuid}return e||(t.textures[this.uuid]=i),i},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===st){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case mt:t.x=t.x-Math.floor(t.x);break;case gt:t.x=t.x<0?0:1;break;case vt:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case mt:t.y=t.y-Math.floor(t.y);break;case gt:t.y=t.y<0?0:1;break;case vt:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(He.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(Ge.prototype,{isVector4:!0,set:function(t,e,i,n){return this.x=t,this.y=e,this.z=i,this.w=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,i=this.y,n=this.z,r=this.w,a=t.elements;return this.x=a[0]*e+a[4]*i+a[8]*n+a[12]*r,this.y=a[1]*e+a[5]*i+a[9]*n+a[13]*r,this.z=a[2]*e+a[6]*i+a[10]*n+a[14]*r,this.w=a[3]*e+a[7]*i+a[11]*n+a[15]*r,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,i,n,r,a=t.elements,o=a[0],s=a[4],c=a[8],h=a[1],l=a[5],u=a[9],d=a[2],p=a[6],f=a[10];if(Math.abs(s-h)<.01&&Math.abs(c-d)<.01&&Math.abs(u-p)<.01){if(Math.abs(s+h)<.1&&Math.abs(c+d)<.1&&Math.abs(u+p)<.1&&Math.abs(o+l+f-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(o+1)/2,g=(l+1)/2,v=(f+1)/2,y=(s+h)/4,x=(c+d)/4,w=(u+p)/4;return m>g&&m>v?m<.01?(i=0,n=.707106781,r=.707106781):(n=y/(i=Math.sqrt(m)),r=x/i):g>v?g<.01?(i=.707106781,n=0,r=.707106781):(i=y/(n=Math.sqrt(g)),r=w/n):v<.01?(i=.707106781,n=.707106781,r=0):(i=x/(r=Math.sqrt(v)),n=w/r),this.set(i,n,r,e),this}var b=Math.sqrt((p-u)*(p-u)+(c-d)*(c-d)+(h-s)*(h-s));return Math.abs(b)<.001&&(b=1),this.x=(p-u)/b,this.y=(c-d)/b,this.z=(h-s)/b,this.w=Math.acos((o+l+f-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(i,n){return void 0===t&&(t=new Ge,e=new Ge),t.set(i,i,i,i),e.set(n,n,n,n),this.clamp(t,e)}}(),clampLength:function(t,e){var i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(e,i)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,i){return this.subVectors(e,t).multiplyScalar(i).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,i){return void 0!==i&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),Ve.prototype=Object.assign(Object.create(n.prototype),{constructor:Ve,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),je.prototype=Object.create(Ve.prototype),je.prototype.constructor=je,je.prototype.isWebGLRenderTargetCube=!0,Ye.prototype=Object.create(He.prototype),Ye.prototype.constructor=Ye,Ye.prototype.isDataTexture=!0,Xe.prototype=Object.create(He.prototype),Xe.prototype.constructor=Xe,Xe.prototype.isCubeTexture=!0,Object.defineProperty(Xe.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var qe=new He,Ze=new Xe;function Je(){this.seq=[],this.map={}}var Ke=[],Qe=[],$e=new Float32Array(16),ti=new Float32Array(9);function ei(t,e,i){var n=t[0];if(n<=0||n>0)return t;var r=e*i,a=Ke[r];if(void 0===a&&(a=new Float32Array(r),Ke[r]=a),0!==e){n.toArray(a,0);for(var o=1,s=0;o!==e;++o)s+=i,t[o].toArray(a,s)}return a}function ii(t,e){var i=Qe[e];void 0===i&&(i=new Int32Array(e),Qe[e]=i);for(var n=0;n!==e;++n)i[n]=t.allocTextureUnit();return i}function ni(t,e){t.uniform1f(this.addr,e)}function ri(t,e){t.uniform1i(this.addr,e)}function ai(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function oi(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function si(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function ci(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function hi(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(ti.set(e.elements),t.uniformMatrix3fv(this.addr,!1,ti))}function li(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):($e.set(e.elements),t.uniformMatrix4fv(this.addr,!1,$e))}function ui(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTexture2D(e||qe,n)}function di(t,e,i){var n=i.allocTextureUnit();t.uniform1i(this.addr,n),i.setTextureCube(e||Ze,n)}function pi(t,e){t.uniform2iv(this.addr,e)}function fi(t,e){t.uniform3iv(this.addr,e)}function mi(t,e){t.uniform4iv(this.addr,e)}function gi(t,e){t.uniform1fv(this.addr,e)}function vi(t,e){t.uniform1iv(this.addr,e)}function yi(t,e){t.uniform2fv(this.addr,ei(e,this.size,2))}function xi(t,e){t.uniform3fv(this.addr,ei(e,this.size,3))}function wi(t,e){t.uniform4fv(this.addr,ei(e,this.size,4))}function bi(t,e){t.uniformMatrix2fv(this.addr,!1,ei(e,this.size,4))}function Li(t,e){t.uniformMatrix3fv(this.addr,!1,ei(e,this.size,9))}function Mi(t,e){t.uniformMatrix4fv(this.addr,!1,ei(e,this.size,16))}function _i(t,e,i){var n=e.length,r=ii(i,n);t.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.setTexture2D(e[a]||qe,r[a])}function Ai(t,e,i){var n=e.length,r=ii(i,n);t.uniform1iv(this.addr,r);for(var a=0;a!==n;++a)i.setTextureCube(e[a]||Ze,r[a])}function Ei(t,e,i){this.id=t,this.addr=i,this.setValue=function(t){switch(e.type){case 5126:return ni;case 35664:return ai;case 35665:return oi;case 35666:return si;case 35674:return ci;case 35675:return hi;case 35676:return li;case 35678:case 36198:return ui;case 35680:return di;case 5124:case 35670:return ri;case 35667:case 35671:return pi;case 35668:case 35672:return fi;case 35669:case 35673:return mi}}()}function Si(t,e,i){this.id=t,this.addr=i,this.size=e.size,this.setValue=function(t){switch(e.type){case 5126:return gi;case 35664:return yi;case 35665:return xi;case 35666:return wi;case 35674:return bi;case 35675:return Li;case 35676:return Mi;case 35678:return _i;case 35680:return Ai;case 5124:case 35670:return vi;case 35667:case 35671:return pi;case 35668:case 35672:return fi;case 35669:case 35673:return mi}}()}function Ti(t){this.id=t,Je.call(this)}Ti.prototype.setValue=function(t,e){for(var i=this.seq,n=0,r=i.length;n!==r;++n){var a=i[n];a.setValue(t,e[a.id])}};var Ri=/([\w\d_]+)(\])?(\[|\.)?/g;function Oi(t,e){t.seq.push(e),t.map[e.id]=e}function Pi(t,e,i){var n=t.name,r=n.length;for(Ri.lastIndex=0;;){var a=Ri.exec(n),o=Ri.lastIndex,s=a[1],c="]"===a[2],h=a[3];if(c&&(s|=0),void 0===h||"["===h&&o+2===r){Oi(i,void 0===h?new Ei(s,t,e):new Si(s,t,e));break}var l=i.map[s];void 0===l&&Oi(i,l=new Ti(s)),i=l}}function Ci(t,e,i){Je.call(this),this.renderer=i;for(var n=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),r=0;r<n;++r){var a=t.getActiveUniform(e,r),o=a.name;Pi(a,t.getUniformLocation(e,o),this)}}Ci.prototype.setValue=function(t,e,i){var n=this.map[e];void 0!==n&&n.setValue(t,i,this.renderer)},Ci.prototype.setOptional=function(t,e,i){var n=e[i];void 0!==n&&this.setValue(t,i,n)},Ci.upload=function(t,e,i,n){for(var r=0,a=e.length;r!==a;++r){var o=e[r],s=i[o.id];!1!==s.needsUpdate&&o.setValue(t,s.value,n)}},Ci.seqWithValue=function(t,e){for(var i=[],n=0,r=t.length;n!==r;++n){var a=t[n];a.id in e&&i.push(a)}return i};var Ii={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Di(t,e,i){return void 0===e&&void 0===i?this.set(t):this.setRGB(t,e,i)}Object.assign(Di.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"==typeof t?this.setHex(t):"string"==typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,i){return this.r=t,this.g=e,this.b=i,this},setHSL:function(){function t(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+6*(e-t)*(2/3-i):t}return function(e,i,n){if(e=Fe.euclideanModulo(e,1),i=Fe.clamp(i,0,1),n=Fe.clamp(n,0,1),0===i)this.r=this.g=this.b=n;else{var r=n<=.5?n*(1+i):n+i-n*i,a=2*n-r;this.r=t(a,r,e+1/3),this.g=t(a,r,e),this.b=t(a,r,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var i;if(i=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var n,r=i[1],a=i[2];switch(r){case"rgb":case"rgba":if(n=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[5]),this;if(n=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[5]),this;break;case"hsl":case"hsla":if(n=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(a)){var o=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return e(n[5]),this.setHSL(o,s,c)}}}else if(i=/^\#([A-Fa-f0-9]+)$/.exec(t)){var h,l=(h=i[1]).length;if(3===l)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}return t&&t.length>0&&(void 0!==(h=Ii[t])?this.setHex(h):console.warn("THREE.Color: Unknown color "+t)),this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var i=e>0?1/e:1;return this.r=Math.pow(t.r,i),this.g=Math.pow(t.g,i),this.b=Math.pow(t.b,i),this},convertGammaToLinear:function(){var t=this.r,e=this.g,i=this.b;return this.r=t*t,this.g=e*e,this.b=i*i,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){var e,i,n=t||{h:0,s:0,l:0},r=this.r,a=this.g,o=this.b,s=Math.max(r,a,o),c=Math.min(r,a,o),h=(c+s)/2;if(c===s)e=0,i=0;else{var l=s-c;switch(i=h<=.5?l/(s+c):l/(2-s-c),s){case r:e=(a-o)/l+(a<o?6:0);break;case a:e=(o-r)/l+2;break;case o:e=(r-a)/l+4}e/=6}return n.h=e,n.s=i,n.l=h,n},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(t,e,i){var n=this.getHSL();return n.h+=t,n.s+=e,n.l+=i,this.setHSL(n.h,n.s,n.l),this},add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var Fi={common:{diffuse:{value:new Di(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new ze},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Ue(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Di(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new Di(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new ze}}},Ui={merge:function(t){for(var e={},i=0;i<t.length;i++){var n=this.clone(t[i]);for(var r in n)e[r]=n[r]}return e},clone:function(t){var e={};for(var i in t)for(var n in e[i]={},t[i]){var r=t[i][n];r&&(r.isColor||r.isMatrix3||r.isMatrix4||r.isVector2||r.isVector3||r.isVector4||r.isTexture)?e[i][n]=r.clone():Array.isArray(r)?e[i][n]=r.slice():e[i][n]=r}return e}},Ni={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_template:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, 8 );\n\t#endif\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tvec3 radiance = getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), 8 );\n\t#ifndef STANDARD\n\t\tvec3 clearCoatRadiance = getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), 8 );\n\t#else\n\t\tvec3 clearCoatRadiance = vec3( 0.0 );\n\t#endif\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 S = normalize( q0 * st1.t - q1 * st0.t );\n\t\tvec3 T = normalize( -q0 * st1.s + q1 * st0.s );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_template>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Bi={basic:{uniforms:Ui.merge([Fi.common,Fi.specularmap,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.fog]),vertexShader:Ni.meshbasic_vert,fragmentShader:Ni.meshbasic_frag},lambert:{uniforms:Ui.merge([Fi.common,Fi.specularmap,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.emissivemap,Fi.fog,Fi.lights,{emissive:{value:new Di(0)}}]),vertexShader:Ni.meshlambert_vert,fragmentShader:Ni.meshlambert_frag},phong:{uniforms:Ui.merge([Fi.common,Fi.specularmap,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.emissivemap,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,Fi.gradientmap,Fi.fog,Fi.lights,{emissive:{value:new Di(0)},specular:{value:new Di(1118481)},shininess:{value:30}}]),vertexShader:Ni.meshphong_vert,fragmentShader:Ni.meshphong_frag},standard:{uniforms:Ui.merge([Fi.common,Fi.envmap,Fi.aomap,Fi.lightmap,Fi.emissivemap,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,Fi.roughnessmap,Fi.metalnessmap,Fi.fog,Fi.lights,{emissive:{value:new Di(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Ni.meshphysical_vert,fragmentShader:Ni.meshphysical_frag},points:{uniforms:Ui.merge([Fi.points,Fi.fog]),vertexShader:Ni.points_vert,fragmentShader:Ni.points_frag},dashed:{uniforms:Ui.merge([Fi.common,Fi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ni.linedashed_vert,fragmentShader:Ni.linedashed_frag},depth:{uniforms:Ui.merge([Fi.common,Fi.displacementmap]),vertexShader:Ni.depth_vert,fragmentShader:Ni.depth_frag},normal:{uniforms:Ui.merge([Fi.common,Fi.bumpmap,Fi.normalmap,Fi.displacementmap,{opacity:{value:1}}]),vertexShader:Ni.normal_vert,fragmentShader:Ni.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ni.cube_vert,fragmentShader:Ni.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ni.equirect_vert,fragmentShader:Ni.equirect_frag},distanceRGBA:{uniforms:Ui.merge([Fi.common,Fi.displacementmap,{referencePosition:{value:new We},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ni.distanceRGBA_vert,fragmentShader:Ni.distanceRGBA_frag},shadow:{uniforms:Ui.merge([Fi.lights,Fi.fog,{color:{value:new Di(0)},opacity:{value:1}}]),vertexShader:Ni.shadow_vert,fragmentShader:Ni.shadow_frag}};function Wi(t,e,i,n,r,a,o,s,c){He.call(this,t,e,i,n,r,a,o,s,c),this.needsUpdate=!0}Bi.physical={uniforms:Ui.merge([Bi.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Ni.meshphysical_vert,fragmentShader:Ni.meshphysical_frag},Wi.prototype=Object.create(He.prototype),Wi.prototype.constructor=Wi;var zi=0;function ki(){Object.defineProperty(this,"id",{value:zi++}),this.uuid=Fe.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=_,this.side=m,this.flatShading=!1,this.vertexColors=w,this.opacity=1,this.transparent=!1,this.blendSrc=B,this.blendDst=W,this.blendEquation=R,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=q,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function Hi(t){ki.call(this),this.type="MeshDepthMaterial",this.depthPacking=Ie,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function Gi(t){ki.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new We,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Vi(t,e){this.min=void 0!==t?t:new We(1/0,1/0,1/0),this.max=void 0!==e?e:new We(-1/0,-1/0,-1/0)}function ji(t,e){this.center=void 0!==t?t:new We,this.radius=void 0!==e?e:0}function Yi(t,e){this.normal=void 0!==t?t:new We(1,0,0),this.constant=void 0!==e?e:0}function Xi(t,e,i,n,r,a){this.planes=[void 0!==t?t:new Yi,void 0!==e?e:new Yi,void 0!==i?i:new Yi,void 0!==n?n:new Yi,void 0!==r?r:new Yi,void 0!==a?a:new Yi]}function qi(t,e,i){for(var n=new Xi,r=new Ne,a=new Ue,o=new Ue(i,i),s=new We,c=new We,h=1,l=2,u=1+(h|l),d=new Array(u),f=new Array(u),y={},x={0:g,1:m,2:v},w=[new We(1,0,0),new We(-1,0,0),new We(0,0,1),new We(0,0,-1),new We(0,1,0),new We(0,-1,0)],b=[new We(0,1,0),new We(0,1,0),new We(0,1,0),new We(0,1,0),new We(0,0,1),new We(0,0,-1)],L=[new Ge,new Ge,new Ge,new Ge,new Ge,new Ge],M=0;M!==u;++M){var _=0!=(M&h),A=0!=(M&l),E=new Hi({depthPacking:De,morphTargets:_,skinning:A});d[M]=E;var S=new Gi({morphTargets:_,skinning:A});f[M]=S}var T=this;function R(e,i,n,r,a,o){var s=e.geometry,c=null,u=d,p=e.customDepthMaterial;if(n&&(u=f,p=e.customDistanceMaterial),p)c=p;else{var m=!1;i.morphTargets&&(s&&s.isBufferGeometry?m=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(m=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===i.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var g=e.isSkinnedMesh&&i.skinning,v=0;m&&(v|=h),g&&(v|=l),c=u[v]}if(t.localClippingEnabled&&!0===i.clipShadows&&0!==i.clippingPlanes.length){var w=c.uuid,b=i.uuid,L=y[w];void 0===L&&(L={},y[w]=L);var M=L[b];void 0===M&&(M=c.clone(),L[b]=M),c=M}return c.visible=i.visible,c.wireframe=i.wireframe,c.side=null!=i.shadowSide?i.shadowSide:x[i.side],c.clipShadows=i.clipShadows,c.clippingPlanes=i.clippingPlanes,c.clipIntersection=i.clipIntersection,c.wireframeLinewidth=i.wireframeLinewidth,c.linewidth=i.linewidth,n&&c.isMeshDistanceMaterial&&(c.referencePosition.copy(r),c.nearDistance=a,c.farDistance=o),c}function O(i,r,a,o){if(!1!==i.visible){if(i.layers.test(r.layers)&&(i.isMesh||i.isLine||i.isPoints)&&i.castShadow&&(!i.frustumCulled||n.intersectsObject(i))){i.modelViewMatrix.multiplyMatrices(a.matrixWorldInverse,i.matrixWorld);var s=e.update(i),h=i.material;if(Array.isArray(h))for(var l=s.groups,u=0,d=l.length;u<d;u++){var p=l[u],f=h[p.materialIndex];if(f&&f.visible){var m=R(i,f,o,c,a.near,a.far);t.renderBufferDirect(a,null,s,m,i,p)}}else h.visible&&(m=R(i,h,o,c,a.near,a.far),t.renderBufferDirect(a,null,s,m,i,null))}for(var g=i.children,v=0,y=g.length;v<y;v++)O(g[v],r,a,o)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=p,this.render=function(e,i,h){if(!1!==T.enabled&&(!1!==T.autoUpdate||!1!==T.needsUpdate)&&0!==e.length){var l,u=t.context,d=t.state;d.disable(u.BLEND),d.buffers.color.setClear(1,1,1,1),d.buffers.depth.setTest(!0),d.setScissorTest(!1);for(var p=0,f=e.length;p<f;p++){var m=e[p],g=m.shadow,v=m&&m.isPointLight;if(void 0!==g){var y=g.camera;if(a.copy(g.mapSize),a.min(o),v){var x=a.x,M=a.y;L[0].set(2*x,M,x,M),L[1].set(0,M,x,M),L[2].set(3*x,M,x,M),L[3].set(x,M,x,M),L[4].set(3*x,0,x,M),L[5].set(x,0,x,M),a.x*=4,a.y*=2}if(null===g.map){var _={minFilter:yt,magFilter:yt,format:Bt};g.map=new Ve(a.x,a.y,_),g.map.texture.name=m.name+".shadowMap",y.updateProjectionMatrix()}g.isSpotLightShadow&&g.update(m);var A=g.map,E=g.matrix;c.setFromMatrixPosition(m.matrixWorld),y.position.copy(c),v?(l=6,E.makeTranslation(-c.x,-c.y,-c.z)):(l=1,s.setFromMatrixPosition(m.target.matrixWorld),y.lookAt(s),y.updateMatrixWorld(),E.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),E.multiply(y.projectionMatrix),E.multiply(y.matrixWorldInverse)),t.setRenderTarget(A),t.clear();for(var S=0;S<l;S++){if(v){s.copy(y.position),s.add(w[S]),y.up.copy(b[S]),y.lookAt(s),y.updateMatrixWorld();var R=L[S];d.viewport(R)}r.multiplyMatrices(y.projectionMatrix,y.matrixWorldInverse),n.setFromMatrix(r),O(i,h,y,v)}}else console.warn("THREE.WebGLShadowMap:",m,"has no shadow.")}T.needsUpdate=!1}}}function Zi(t,e,i,n){this._x=t||0,this._y=e||0,this._z=i||0,this._order=n||Zi.DefaultOrder}function Ji(){this.mask=1}ki.prototype=Object.assign(Object.create(n.prototype),{constructor:ki,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var i=t[e];if(void 0!==i)if("shading"!==e){var n=this[e];void 0!==n?n&&n.isColor?n.set(i):n&&n.isVector3&&i&&i.isVector3?n.copy(i):this[e]="overdraw"===e?Number(i):i:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===y;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){var e=void 0===t||"string"==typeof t;e&&(t={textures:{},images:{}});var i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function n(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),void 0!==this.roughness&&(i.roughness=this.roughness),void 0!==this.metalness&&(i.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),void 0!==this.shininess&&(i.shininess=this.shininess),void 0!==this.clearCoat&&(i.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(i.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,i.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(i.size=this.size),void 0!==this.sizeAttenuation&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==_&&(i.blending=this.blending),!0===this.flatShading&&(i.flatShading=this.flatShading),this.side!==m&&(i.side=this.side),this.vertexColors!==w&&(i.vertexColors=this.vertexColors),this.opacity<1&&(i.opacity=this.opacity),!0===this.transparent&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,0!==this.rotation&&(i.rotation=this.rotation),1!==this.linewidth&&(i.linewidth=this.linewidth),void 0!==this.dashSize&&(i.dashSize=this.dashSize),void 0!==this.gapSize&&(i.gapSize=this.gapSize),void 0!==this.scale&&(i.scale=this.scale),!0===this.dithering&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(i.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(i.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(i.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(i.morphTargets=!0),!0===this.skinning&&(i.skinning=!0),!1===this.visible&&(i.visible=!1),"{}"!==JSON.stringify(this.userData)&&(i.userData=this.userData),e){var r=n(t.textures),a=n(t.images);r.length>0&&(i.textures=r),a.length>0&&(i.images=a)}return i},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,i=null;if(null!==e){var n=e.length;i=new Array(n);for(var r=0;r!==n;++r)i[r]=e[r].clone()}return this.clippingPlanes=i,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Hi.prototype=Object.create(ki.prototype),Hi.prototype.constructor=Hi,Hi.prototype.isMeshDepthMaterial=!0,Hi.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},Gi.prototype=Object.create(ki.prototype),Gi.prototype.constructor=Gi,Gi.prototype.isMeshDistanceMaterial=!0,Gi.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},Object.assign(Vi.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,c=t.length;s<c;s+=3){var h=t[s],l=t[s+1],u=t[s+2];h<e&&(e=h),l<i&&(i=l),u<n&&(n=u),h>r&&(r=h),l>a&&(a=l),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,a,o),this},setFromBufferAttribute:function(t){for(var e=1/0,i=1/0,n=1/0,r=-1/0,a=-1/0,o=-1/0,s=0,c=t.count;s<c;s++){var h=t.getX(s),l=t.getY(s),u=t.getZ(s);h<e&&(e=h),l<i&&(i=l),u<n&&(n=u),h>r&&(r=h),l>a&&(a=l),u>o&&(o=u)}return this.min.set(e,i,n),this.max.set(r,a,o),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new We;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){var e=t||new We;return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new We;return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){var t,e,i,n=new We;function r(r){var a=r.geometry;if(void 0!==a)if(a.isGeometry){var o=a.vertices;for(e=0,i=o.length;e<i;e++)n.copy(o[e]),n.applyMatrix4(r.matrixWorld),t.expandByPoint(n)}else if(a.isBufferGeometry){var s=a.attributes.position;if(void 0!==s)for(e=0,i=s.count;e<i;e++)n.fromBufferAttribute(s,e).applyMatrix4(r.matrixWorld),t.expandByPoint(n)}}return function(e){return t=this,e.updateMatrixWorld(!0),e.traverse(r),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return(e||new We).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new We;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,i;return t.normal.x>0?(e=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),e<=t.constant&&i>=t.constant},intersectsTriangle:function(){var t=new We,e=new We,i=new We,n=new We,r=new We,a=new We,o=new We,s=new We,c=new We,h=new We;function l(n){var r,a;for(r=0,a=n.length-3;r<=a;r+=3){o.fromArray(n,r);var s=c.x*Math.abs(o.x)+c.y*Math.abs(o.y)+c.z*Math.abs(o.z),h=t.dot(o),l=e.dot(o),u=i.dot(o);if(Math.max(-Math.max(h,l,u),Math.min(h,l,u))>s)return!1}return!0}return function(o){if(this.isEmpty())return!1;this.getCenter(s),c.subVectors(this.max,s),t.subVectors(o.a,s),e.subVectors(o.b,s),i.subVectors(o.c,s),n.subVectors(e,t),r.subVectors(i,e),a.subVectors(t,i);var u=[0,-n.z,n.y,0,-r.z,r.y,0,-a.z,a.y,n.z,0,-n.x,r.z,0,-r.x,a.z,0,-a.x,-n.y,n.x,0,-r.y,r.x,0,-a.y,a.x,0];return!!l(u)&&!!l(u=[1,0,0,0,1,0,0,0,1])&&(h.crossVectors(n,r),l(u=[h.x,h.y,h.z]))}}(),clampPoint:function(t,e){return(e||new We).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new We;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new We;return function(e){var i=e||new ji;return this.getCenter(i.center),i.radius=.5*this.getSize(t).length(),i}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new We,new We,new We,new We,new We,new We,new We,new We];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(ji.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new Vi;return function(e,i){var n=this.center;void 0!==i?n.copy(i):t.setFromPoints(e).getCenter(n);for(var r=0,a=0,o=e.length;a<o;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var i=this.center.distanceToSquared(t),n=e||new We;return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n},getBoundingBox:function(t){var e=t||new Vi;return e.set(this.center,this.center),e.expandByScalar(this.radius),e},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(Yi.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,i,n){return this.normal.set(t,e,i),this.constant=n,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new We,e=new We;return function(i,n,r){var a=t.subVectors(r,n).cross(e.subVectors(i,n)).normalize();return this.setFromNormalAndCoplanarPoint(a,i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return(e||new We).copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new We;return function(e,i){var n=i||new We,r=e.delta(t),a=this.normal.dot(r);if(0===a)return 0===this.distanceToPoint(e.start)?n.copy(e.start):void 0;var o=-(e.start.dot(this.normal)+this.constant)/a;return o<0||o>1?void 0:n.copy(r).multiplyScalar(o).add(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return e<0&&i>0||i<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return(t||new We).copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new We,e=new ze;return function(i,n){var r=n||e.getNormalMatrix(i),a=this.coplanarPoint(t).applyMatrix4(i),o=this.normal.applyMatrix3(r).normalize();return this.constant=-a.dot(o),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(Xi.prototype,{set:function(t,e,i,n,r,a){var o=this.planes;return o[0].copy(t),o[1].copy(e),o[2].copy(i),o[3].copy(n),o[4].copy(r),o[5].copy(a),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,i=0;i<6;i++)e[i].copy(t.planes[i]);return this},setFromMatrix:function(t){var e=this.planes,i=t.elements,n=i[0],r=i[1],a=i[2],o=i[3],s=i[4],c=i[5],h=i[6],l=i[7],u=i[8],d=i[9],p=i[10],f=i[11],m=i[12],g=i[13],v=i[14],y=i[15];return e[0].setComponents(o-n,l-s,f-u,y-m).normalize(),e[1].setComponents(o+n,l+s,f+u,y+m).normalize(),e[2].setComponents(o+r,l+c,f+d,y+g).normalize(),e[3].setComponents(o-r,l-c,f-d,y-g).normalize(),e[4].setComponents(o-a,l-h,f-p,y-v).normalize(),e[5].setComponents(o+a,l+h,f+p,y+v).normalize(),this},intersectsObject:function(){var t=new ji;return function(e){var i=e.geometry;return null===i.boundingSphere&&i.computeBoundingSphere(),t.copy(i.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new ji;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,i=t.center,n=-t.radius,r=0;r<6;r++)if(e[r].distanceToPoint(i)<n)return!1;return!0},intersectsBox:function(){var t=new We,e=new We;return function(i){for(var n=this.planes,r=0;r<6;r++){var a=n[r];t.x=a.normal.x>0?i.min.x:i.max.x,e.x=a.normal.x>0?i.max.x:i.min.x,t.y=a.normal.y>0?i.min.y:i.max.y,e.y=a.normal.y>0?i.max.y:i.min.y,t.z=a.normal.z>0?i.min.z:i.max.z,e.z=a.normal.z>0?i.max.z:i.min.z;var o=a.distanceToPoint(t),s=a.distanceToPoint(e);if(o<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,i=0;i<6;i++)if(e[i].distanceToPoint(t)<0)return!1;return!0}}),Zi.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],Zi.DefaultOrder="XYZ",Object.defineProperties(Zi.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(Zi.prototype,{isEuler:!0,set:function(t,e,i,n){return this._x=t,this._y=e,this._z=i,this._order=n||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,i){var n=Fe.clamp,r=t.elements,a=r[0],o=r[4],s=r[8],c=r[1],h=r[5],l=r[9],u=r[2],d=r[6],p=r[10];return"XYZ"===(e=e||this._order)?(this._y=Math.asin(n(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,p),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(d,h),this._z=0)):"YXZ"===e?(this._x=Math.asin(-n(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,p),this._z=Math.atan2(c,h)):(this._y=Math.atan2(-u,a),this._z=0)):"ZXY"===e?(this._x=Math.asin(n(d,-1,1)),Math.abs(d)<.99999?(this._y=Math.atan2(-u,p),this._z=Math.atan2(-o,h)):(this._y=0,this._z=Math.atan2(c,a))):"ZYX"===e?(this._y=Math.asin(-n(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(d,p),this._z=Math.atan2(c,a)):(this._x=0,this._z=Math.atan2(-o,h))):"YZX"===e?(this._z=Math.asin(n(c,-1,1)),Math.abs(c)<.99999?(this._x=Math.atan2(-l,h),this._y=Math.atan2(-u,a)):(this._x=0,this._y=Math.atan2(s,p))):"XZY"===e?(this._z=Math.asin(-n(o,-1,1)),Math.abs(o)<.99999?(this._x=Math.atan2(d,h),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-l,p),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==i&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new Ne;return function(e,i,n){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,i,n)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new Be;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new We(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(Ji.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!=(this.mask&t.mask)}});var Ki=0;function Qi(){Object.defineProperty(this,"id",{value:Ki++}),this.uuid=Fe.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Qi.DefaultUp.clone();var t=new We,e=new Zi,i=new Be,n=new We(1,1,1);e.onChange(function(){i.setFromEuler(e,!1)}),i.onChange(function(){e.setFromQuaternion(i,void 0,!1)}),Object.defineProperties(this,{position:{enumerable:!0,value:t},rotation:{enumerable:!0,value:e},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:n},modelViewMatrix:{value:new Ne},normalMatrix:{value:new ze}}),this.matrix=new Ne,this.matrixWorld=new Ne,this.matrixAutoUpdate=Qi.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new Ji,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function $i(){Qi.call(this),this.type="Camera",this.matrixWorldInverse=new Ne,this.projectionMatrix=new Ne}function tn(t,e,i,n,r,a){$i.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=i,this.bottom=n,this.near=void 0!==r?r:.1,this.far=void 0!==a?a:2e3,this.updateProjectionMatrix()}function en(t,e,i,n,r,a){this.a=t,this.b=e,this.c=i,this.normal=n&&n.isVector3?n:new We,this.vertexNormals=Array.isArray(n)?n:[],this.color=r&&r.isColor?r:new Di,this.vertexColors=Array.isArray(r)?r:[],this.materialIndex=void 0!==a?a:0}Qi.DefaultUp=new We(0,1,0),Qi.DefaultMatrixAutoUpdate=!0,Qi.prototype=Object.assign(Object.create(n.prototype),{constructor:Qi,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new Be;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new Be;return function(e,i){return t.setFromAxisAngle(e,i),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new We(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new We(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new We(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new We;return function(e,i){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(i)),this}}(),translateX:function(){var t=new We(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new We(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new We(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new Ne;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new Ne,e=new We;return function(i,n,r){i.isVector3?e.copy(i):e.set(i,n,r),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var i=this.children.indexOf(t);return-1!==i&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(i,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var i=0,n=this.children.length;i<n;i++){var r=this.children[i].getObjectByProperty(t,e);if(void 0!==r)return r}},getWorldPosition:function(t){var e=t||new We;return this.updateMatrixWorld(!0),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new We,e=new We;return function(i){var n=i||new Be;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldRotation:function(){var t=new Be;return function(e){var i=e||new Zi;return this.getWorldQuaternion(t),i.setFromQuaternion(t,this.rotation.order,!1)}}(),getWorldScale:function(){var t=new We,e=new Be;return function(i){var n=i||new We;return this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new Be;return function(e){var i=e||new We;return this.getWorldQuaternion(t),i.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,i=0,n=e.length;i<n;i++)e[i].updateMatrixWorld(t)},toJSON:function(t){var e=void 0===t||"string"==typeof t,i={};e&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var n={};function r(e,i){return void 0===e[i.uuid]&&(e[i.uuid]=i.toJSON(t)),i.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),"{}"!==JSON.stringify(this.userData)&&(n.userData=this.userData),n.matrix=this.matrix.toArray(),void 0!==this.geometry){n.geometry=r(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var o=a.shapes;if(Array.isArray(o))for(var s=0,c=o.length;s<c;s++){var h=o[s];r(t.shapes,h)}else r(t.shapes,o)}}if(void 0!==this.material)if(Array.isArray(this.material)){var l=[];for(s=0,c=this.material.length;s<c;s++)l.push(r(t.materials,this.material[s]));n.material=l}else n.material=r(t.materials,this.material);if(this.children.length>0)for(n.children=[],s=0;s<this.children.length;s++)n.children.push(this.children[s].toJSON(t).object);if(e){var u=m(t.geometries),d=m(t.materials),p=m(t.textures),f=m(t.images);o=m(t.shapes),u.length>0&&(i.geometries=u),d.length>0&&(i.materials=d),p.length>0&&(i.textures=p),f.length>0&&(i.images=f),o.length>0&&(i.shapes=o)}return i.object=n,i;function m(t){var e=[];for(var i in t){var n=t[i];delete n.metadata,e.push(n)}return e}},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var i=0;i<t.children.length;i++){var n=t.children[i];this.add(n.clone())}return this}}),$i.prototype=Object.assign(Object.create(Qi.prototype),{constructor:$i,isCamera:!0,copy:function(t,e){return Qi.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new Be;return function(e){var i=e||new We;return this.getWorldQuaternion(t),i.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){Qi.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),tn.prototype=Object.assign(Object.create($i.prototype),{constructor:tn,isOrthographicCamera:!0,copy:function(t,e){return $i.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,i,n,r,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,n=(this.top+this.bottom)/2,r=i-t,a=i+t,o=n+e,s=n-e;if(null!==this.view&&this.view.enabled){var c=this.zoom/(this.view.width/this.view.fullWidth),h=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,u=(this.top-this.bottom)/this.view.height;a=(r+=l*(this.view.offsetX/c))+l*(this.view.width/c),s=(o-=u*(this.view.offsetY/h))-u*(this.view.height/h)}this.projectionMatrix.makeOrthographic(r,a,o,s,this.near,this.far)},toJSON:function(t){var e=Qi.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(en.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,i=t.vertexNormals.length;e<i;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(e=0,i=t.vertexColors.length;e<i;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var nn=0;function rn(){Object.defineProperty(this,"id",{value:nn+=2}),this.uuid=Fe.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function an(t,e,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.uuid=Fe.generateUUID(),this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===i,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function on(t,e,i){an.call(this,new Int8Array(t),e,i)}function sn(t,e,i){an.call(this,new Uint8Array(t),e,i)}function cn(t,e,i){an.call(this,new Uint8ClampedArray(t),e,i)}function hn(t,e,i){an.call(this,new Int16Array(t),e,i)}function ln(t,e,i){an.call(this,new Uint16Array(t),e,i)}function un(t,e,i){an.call(this,new Int32Array(t),e,i)}function dn(t,e,i){an.call(this,new Uint32Array(t),e,i)}function pn(t,e,i){an.call(this,new Float32Array(t),e,i)}function fn(t,e,i){an.call(this,new Float64Array(t),e,i)}function mn(){this.indices=[],this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function gn(t){if(0===t.length)return-1/0;for(var e=t[0],i=1,n=t.length;i<n;++i)t[i]>e&&(e=t[i]);return e}rn.prototype=Object.assign(Object.create(n.prototype),{constructor:rn,isGeometry:!0,applyMatrix:function(t){for(var e=(new ze).getNormalMatrix(t),i=0,n=this.vertices.length;i<n;i++)this.vertices[i].applyMatrix4(t);for(i=0,n=this.faces.length;i<n;i++){var r=this.faces[i];r.normal.applyMatrix3(e).normalize();for(var a=0,o=r.vertexNormals.length;a<o;a++)r.vertexNormals[a].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new Ne;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ne;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ne;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ne;return function(e,i,n){return t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t=new Ne;return function(e,i,n){return t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new Qi;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){var e=this,i=null!==t.index?t.index.array:void 0,n=t.attributes,r=n.position.array,a=void 0!==n.normal?n.normal.array:void 0,o=void 0!==n.color?n.color.array:void 0,s=void 0!==n.uv?n.uv.array:void 0,c=void 0!==n.uv2?n.uv2.array:void 0;void 0!==c&&(this.faceVertexUvs[1]=[]);for(var h=[],l=[],u=[],d=0,p=0;d<r.length;d+=3,p+=2)e.vertices.push(new We(r[d],r[d+1],r[d+2])),void 0!==a&&h.push(new We(a[d],a[d+1],a[d+2])),void 0!==o&&e.colors.push(new Di(o[d],o[d+1],o[d+2])),void 0!==s&&l.push(new Ue(s[p],s[p+1])),void 0!==c&&u.push(new Ue(c[p],c[p+1]));function f(t,i,n,r){var d=new en(t,i,n,void 0!==a?[h[t].clone(),h[i].clone(),h[n].clone()]:[],void 0!==o?[e.colors[t].clone(),e.colors[i].clone(),e.colors[n].clone()]:[],r);e.faces.push(d),void 0!==s&&e.faceVertexUvs[0].push([l[t].clone(),l[i].clone(),l[n].clone()]),void 0!==c&&e.faceVertexUvs[1].push([u[t].clone(),u[i].clone(),u[n].clone()])}var m=t.groups;if(m.length>0)for(d=0;d<m.length;d++)for(var g=m[d],v=g.start,y=(p=v,v+g.count);p<y;p+=3)void 0!==i?f(i[p],i[p+1],i[p+2],g.materialIndex):f(p,p+1,p+2,g.materialIndex);else if(void 0!==i)for(d=0;d<i.length;d+=3)f(i[d],i[d+1],i[d+2]);else for(d=0;d<r.length/3;d+=3)f(d,d+1,d+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,i=0===e?1:1/e,n=new Ne;return n.set(i,0,0,-i*t.x,0,i,0,-i*t.y,0,0,i,-i*t.z,0,0,0,1),this.applyMatrix(n),this},computeFaceNormals:function(){for(var t=new We,e=new We,i=0,n=this.faces.length;i<n;i++){var r=this.faces[i],a=this.vertices[r.a],o=this.vertices[r.b],s=this.vertices[r.c];t.subVectors(s,o),e.subVectors(a,o),t.cross(e),t.normalize(),r.normal.copy(t)}},computeVertexNormals:function(t){var e,i,n,r,a,o;for(void 0===t&&(t=!0),o=new Array(this.vertices.length),e=0,i=this.vertices.length;e<i;e++)o[e]=new We;if(t){var s,c,h,l=new We,u=new We;for(n=0,r=this.faces.length;n<r;n++)a=this.faces[n],s=this.vertices[a.a],c=this.vertices[a.b],h=this.vertices[a.c],l.subVectors(h,c),u.subVectors(s,c),l.cross(u),o[a.a].add(l),o[a.b].add(l),o[a.c].add(l)}else for(this.computeFaceNormals(),n=0,r=this.faces.length;n<r;n++)o[(a=this.faces[n]).a].add(a.normal),o[a.b].add(a.normal),o[a.c].add(a.normal);for(e=0,i=this.vertices.length;e<i;e++)o[e].normalize();for(n=0,r=this.faces.length;n<r;n++){var d=(a=this.faces[n]).vertexNormals;3===d.length?(d[0].copy(o[a.a]),d[1].copy(o[a.b]),d[2].copy(o[a.c])):(d[0]=o[a.a].clone(),d[1]=o[a.b].clone(),d[2]=o[a.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,i;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){var n=(i=this.faces[t]).vertexNormals;3===n.length?(n[0].copy(i.normal),n[1].copy(i.normal),n[2].copy(i.normal)):(n[0]=i.normal.clone(),n[1]=i.normal.clone(),n[2]=i.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,i,n,r;for(i=0,n=this.faces.length;i<n;i++)for((r=this.faces[i]).__originalFaceNormal?r.__originalFaceNormal.copy(r.normal):r.__originalFaceNormal=r.normal.clone(),r.__originalVertexNormals||(r.__originalVertexNormals=[]),t=0,e=r.vertexNormals.length;t<e;t++)r.__originalVertexNormals[t]?r.__originalVertexNormals[t].copy(r.vertexNormals[t]):r.__originalVertexNormals[t]=r.vertexNormals[t].clone();var a=new rn;for(a.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var o=this.morphNormals[t].faceNormals,s=this.morphNormals[t].vertexNormals;for(i=0,n=this.faces.length;i<n;i++)c=new We,h={a:new We,b:new We,c:new We},o.push(c),s.push(h)}var c,h,l=this.morphNormals[t];for(a.vertices=this.morphTargets[t].vertices,a.computeFaceNormals(),a.computeVertexNormals(),i=0,n=this.faces.length;i<n;i++)r=this.faces[i],c=l.faceNormals[i],h=l.vertexNormals[i],c.copy(r.normal),h.a.copy(r.vertexNormals[0]),h.b.copy(r.vertexNormals[1]),h.c.copy(r.vertexNormals[2])}for(i=0,n=this.faces.length;i<n;i++)(r=this.faces[i]).normal=r.__originalFaceNormal,r.vertexNormals=r.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Vi),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new ji),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,i){if(t&&t.isGeometry){var n,r=this.vertices.length,a=this.vertices,o=t.vertices,s=this.faces,c=t.faces,h=this.faceVertexUvs[0],l=t.faceVertexUvs[0],u=this.colors,d=t.colors;void 0===i&&(i=0),void 0!==e&&(n=(new ze).getNormalMatrix(e));for(var p=0,f=o.length;p<f;p++){var m=o[p].clone();void 0!==e&&m.applyMatrix4(e),a.push(m)}for(p=0,f=d.length;p<f;p++)u.push(d[p].clone());for(p=0,f=c.length;p<f;p++){var g,v,y,x=c[p],w=x.vertexNormals,b=x.vertexColors;(g=new en(x.a+r,x.b+r,x.c+r)).normal.copy(x.normal),void 0!==n&&g.normal.applyMatrix3(n).normalize();for(var L=0,M=w.length;L<M;L++)v=w[L].clone(),void 0!==n&&v.applyMatrix3(n).normalize(),g.vertexNormals.push(v);for(g.color.copy(x.color),L=0,M=b.length;L<M;L++)y=b[L],g.vertexColors.push(y.clone());g.materialIndex=x.materialIndex+i,s.push(g)}for(p=0,f=l.length;p<f;p++){var _=l[p],A=[];if(void 0!==_){for(L=0,M=_.length;L<M;L++)A.push(_[L].clone());h.push(A)}}}else console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t)},mergeMesh:function(t){t&&t.isMesh?(t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)):console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t)},mergeVertices:function(){var t,e,i,n,r,a,o,s,c={},h=[],l=[],u=Math.pow(10,4);for(i=0,n=this.vertices.length;i<n;i++)t=this.vertices[i],void 0===c[e=Math.round(t.x*u)+"_"+Math.round(t.y*u)+"_"+Math.round(t.z*u)]?(c[e]=i,h.push(this.vertices[i]),l[i]=h.length-1):l[i]=l[c[e]];var d=[];for(i=0,n=this.faces.length;i<n;i++){(r=this.faces[i]).a=l[r.a],r.b=l[r.b],r.c=l[r.c],a=[r.a,r.b,r.c];for(var p=0;p<3;p++)if(a[p]===a[(p+1)%3]){d.push(i);break}}for(i=d.length-1;i>=0;i--){var f=d[i];for(this.faces.splice(f,1),o=0,s=this.faceVertexUvs.length;o<s;o++)this.faceVertexUvs[o].splice(f,1)}var m=this.vertices.length-h.length;return this.vertices=h,m},setFromPoints:function(t){this.vertices=[];for(var e=0,i=t.length;e<i;e++){var n=t[e];this.vertices.push(new We(n.x,n.y,n.z||0))}return this},sortFacesByMaterialIndex:function(){for(var t=this.faces,e=t.length,i=0;i<e;i++)t[i]._id=i;t.sort(function(t,e){return t.materialIndex-e.materialIndex});var n,r,a=this.faceVertexUvs[0],o=this.faceVertexUvs[1];for(a&&a.length===e&&(n=[]),o&&o.length===e&&(r=[]),i=0;i<e;i++){var s=t[i]._id;n&&n.push(a[s]),r&&r.push(o[s])}n&&(this.faceVertexUvs[0]=n),r&&(this.faceVertexUvs[1]=r)},toJSON:function(){var t={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}for(var n=[],r=0;r<this.vertices.length;r++){var a=this.vertices[r];n.push(a.x,a.y,a.z)}var o=[],s=[],c={},h=[],l={},u=[],d={};for(r=0;r<this.faces.length;r++){var p=this.faces[r],f=void 0!==this.faceVertexUvs[0][r],m=p.normal.length()>0,g=p.vertexNormals.length>0,v=1!==p.color.r||1!==p.color.g||1!==p.color.b,y=p.vertexColors.length>0,x=0;if(x=M(x=M(x=M(x=M(x=M(x=M(x=M(x=M(x,0,0),1,!0),2,!1),3,f),4,m),5,g),6,v),7,y),o.push(x),o.push(p.a,p.b,p.c),o.push(p.materialIndex),f){var w=this.faceVertexUvs[0][r];o.push(E(w[0]),E(w[1]),E(w[2]))}if(m&&o.push(_(p.normal)),g){var b=p.vertexNormals;o.push(_(b[0]),_(b[1]),_(b[2]))}if(v&&o.push(A(p.color)),y){var L=p.vertexColors;o.push(A(L[0]),A(L[1]),A(L[2]))}}function M(t,e,i){return i?t|1<<e:t&~(1<<e)}function _(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==c[e]?c[e]:(c[e]=s.length/3,s.push(t.x,t.y,t.z),c[e])}function A(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==l[e]?l[e]:(l[e]=h.length,h.push(t.getHex()),l[e])}function E(t){var e=t.x.toString()+t.y.toString();return void 0!==d[e]?d[e]:(d[e]=u.length/2,u.push(t.x,t.y),d[e])}return t.data={},t.data.vertices=n,t.data.normals=s,h.length>0&&(t.data.colors=h),u.length>0&&(t.data.uvs=[u]),t.data.faces=o,t},clone:function(){return(new rn).copy(this)},copy:function(t){var e,i,n,r,a,o;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,i=s.length;e<i;e++)this.vertices.push(s[e].clone());var c=t.colors;for(e=0,i=c.length;e<i;e++)this.colors.push(c[e].clone());var h=t.faces;for(e=0,i=h.length;e<i;e++)this.faces.push(h[e].clone());for(e=0,i=t.faceVertexUvs.length;e<i;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),n=0,r=l.length;n<r;n++){var u=l[n],d=[];for(a=0,o=u.length;a<o;a++){var p=u[a];d.push(p.clone())}this.faceVertexUvs[e].push(d)}}var f=t.morphTargets;for(e=0,i=f.length;e<i;e++){var m={};if(m.name=f[e].name,void 0!==f[e].vertices)for(m.vertices=[],n=0,r=f[e].vertices.length;n<r;n++)m.vertices.push(f[e].vertices[n].clone());if(void 0!==f[e].normals)for(m.normals=[],n=0,r=f[e].normals.length;n<r;n++)m.normals.push(f[e].normals[n].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,i=g.length;e<i;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],n=0,r=g[e].vertexNormals.length;n<r;n++){var y=g[e].vertexNormals[n],x={};x.a=y.a.clone(),x.b=y.b.clone(),x.c=y.c.clone(),v.vertexNormals.push(x)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],n=0,r=g[e].faceNormals.length;n<r;n++)v.faceNormals.push(g[e].faceNormals[n].clone());this.morphNormals.push(v)}var w=t.skinWeights;for(e=0,i=w.length;e<i;e++)this.skinWeights.push(w[e].clone());var b=t.skinIndices;for(e=0,i=b.length;e<i;e++)this.skinIndices.push(b[e].clone());var L=t.lineDistances;for(e=0,i=L.length;e<i;e++)this.lineDistances.push(L[e]);var M=t.boundingBox;null!==M&&(this.boundingBox=M.clone());var _=t.boundingSphere;return null!==_&&(this.boundingSphere=_.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(an.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(an.prototype,{isBufferAttribute:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.itemSize:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.itemSize,i*=e.itemSize;for(var n=0,r=this.itemSize;n<r;n++)this.array[t+n]=e.array[i+n];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",n),a=new Di),e[i++]=a.r,e[i++]=a.g,e[i++]=a.b}return this},copyIndicesArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];e[i++]=a.a,e[i++]=a.b,e[i++]=a.c}return this},copyVector2sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",n),a=new Ue),e[i++]=a.x,e[i++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",n),a=new We),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z}return this},copyVector4sArray:function(t){for(var e=this.array,i=0,n=0,r=t.length;n<r;n++){var a=t[n];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",n),a=new Ge),e[i++]=a.x,e[i++]=a.y,e[i++]=a.z,e[i++]=a.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=i,this.array[t+2]=n,this.array[t+3]=r,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),on.prototype=Object.create(an.prototype),on.prototype.constructor=on,sn.prototype=Object.create(an.prototype),sn.prototype.constructor=sn,cn.prototype=Object.create(an.prototype),cn.prototype.constructor=cn,hn.prototype=Object.create(an.prototype),hn.prototype.constructor=hn,ln.prototype=Object.create(an.prototype),ln.prototype.constructor=ln,un.prototype=Object.create(an.prototype),un.prototype.constructor=un,dn.prototype=Object.create(an.prototype),dn.prototype.constructor=dn,pn.prototype=Object.create(an.prototype),pn.prototype.constructor=pn,fn.prototype=Object.create(an.prototype),fn.prototype.constructor=fn,Object.assign(mn.prototype,{computeGroups:function(t){for(var e,i=[],n=void 0,r=t.faces,a=0;a<r.length;a++){var o=r[a];o.materialIndex!==n&&(n=o.materialIndex,void 0!==e&&(e.count=3*a-e.start,i.push(e)),e={start:3*a,materialIndex:n})}void 0!==e&&(e.count=3*a-e.start,i.push(e)),this.groups=i},fromGeometry:function(t){var e,i=t.faces,n=t.vertices,r=t.faceVertexUvs,a=r[0]&&r[0].length>0,o=r[1]&&r[1].length>0,s=t.morphTargets,c=s.length;if(c>0){e=[];for(var h=0;h<c;h++)e[h]=[];this.morphTargets.position=e}var l,u=t.morphNormals,d=u.length;if(d>0){for(l=[],h=0;h<d;h++)l[h]=[];this.morphTargets.normal=l}var p=t.skinIndices,f=t.skinWeights,m=p.length===n.length,g=f.length===n.length;for(h=0;h<i.length;h++){var v=i[h];this.vertices.push(n[v.a],n[v.b],n[v.c]);var y=v.vertexNormals;if(3===y.length)this.normals.push(y[0],y[1],y[2]);else{var x=v.normal;this.normals.push(x,x,x)}var w,b=v.vertexColors;if(3===b.length)this.colors.push(b[0],b[1],b[2]);else{var L=v.color;this.colors.push(L,L,L)}!0===a&&(void 0!==(w=r[0][h])?this.uvs.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",h),this.uvs.push(new Ue,new Ue,new Ue))),!0===o&&(void 0!==(w=r[1][h])?this.uvs2.push(w[0],w[1],w[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",h),this.uvs2.push(new Ue,new Ue,new Ue)));for(var M=0;M<c;M++){var _=s[M].vertices;e[M].push(_[v.a],_[v.b],_[v.c])}for(M=0;M<d;M++){var A=u[M].vertexNormals[h];l[M].push(A.a,A.b,A.c)}m&&this.skinIndices.push(p[v.a],p[v.b],p[v.c]),g&&this.skinWeights.push(f[v.a],f[v.b],f[v.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var vn=1;function yn(){Object.defineProperty(this,"id",{value:vn+=2}),this.uuid=Fe.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function xn(t,e,i,n,r,a){rn.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a},this.fromBufferGeometry(new wn(t,e,i,n,r,a)),this.mergeVertices()}function wn(t,e,i,n,r,a){yn.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:i,widthSegments:n,heightSegments:r,depthSegments:a};var o=this;t=t||1,e=e||1,i=i||1,n=Math.floor(n)||1,r=Math.floor(r)||1;var s=[],c=[],h=[],l=[],u=0,d=0;function p(t,e,i,n,r,a,p,f,m,g,v){var y,x,w=a/m,b=p/g,L=a/2,M=p/2,_=f/2,A=m+1,E=g+1,S=0,T=0,R=new We;for(x=0;x<E;x++){var O=x*b-M;for(y=0;y<A;y++){var P=y*w-L;R[t]=P*n,R[e]=O*r,R[i]=_,c.push(R.x,R.y,R.z),R[t]=0,R[e]=0,R[i]=f>0?1:-1,h.push(R.x,R.y,R.z),l.push(y/m),l.push(1-x/g),S+=1}}for(x=0;x<g;x++)for(y=0;y<m;y++){var C=u+y+A*x,I=u+y+A*(x+1),D=u+(y+1)+A*(x+1),F=u+(y+1)+A*x;s.push(C,I,F),s.push(I,D,F),T+=6}o.addGroup(d,T,v),d+=T,u+=S}p("z","y","x",-1,-1,i,e,t,a=Math.floor(a)||1,r,0),p("z","y","x",1,-1,i,e,-t,a,r,1),p("x","z","y",1,1,t,i,e,n,a,2),p("x","z","y",1,-1,t,i,-e,n,a,3),p("x","y","z",1,-1,t,e,i,n,r,4),p("x","y","z",-1,-1,t,e,-i,n,r,5),this.setIndex(s),this.addAttribute("position",new pn(c,3)),this.addAttribute("normal",new pn(h,3)),this.addAttribute("uv",new pn(l,2))}function bn(t,e,i,n){rn.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n},this.fromBufferGeometry(new Ln(t,e,i,n)),this.mergeVertices()}function Ln(t,e,i,n){yn.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:i,heightSegments:n};var r,a,o=(t=t||1)/2,s=(e=e||1)/2,c=Math.floor(i)||1,h=Math.floor(n)||1,l=c+1,u=h+1,d=t/c,p=e/h,f=[],m=[],g=[],v=[];for(a=0;a<u;a++){var y=a*p-s;for(r=0;r<l;r++){var x=r*d-o;m.push(x,-y,0),g.push(0,0,1),v.push(r/c),v.push(1-a/h)}}for(a=0;a<h;a++)for(r=0;r<c;r++){var w=r+l*a,b=r+l*(a+1),L=r+1+l*(a+1),M=r+1+l*a;f.push(w,b,M),f.push(b,L,M)}this.setIndex(f),this.addAttribute("position",new pn(m,3)),this.addAttribute("normal",new pn(g,3)),this.addAttribute("uv",new pn(v,2))}function Mn(t){ki.call(this),this.type="MeshBasicMaterial",this.color=new Di(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function _n(t){ki.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function An(t,e){this.origin=void 0!==t?t:new We,this.direction=void 0!==e?e:new We}function En(t,e){this.start=void 0!==t?t:new We,this.end=void 0!==e?e:new We}function Sn(t,e,i){this.a=void 0!==t?t:new We,this.b=void 0!==e?e:new We,this.c=void 0!==i?i:new We}function Tn(t,e){Qi.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new yn,this.material=void 0!==e?e:new Mn({color:16777215*Math.random()}),this.drawMode=Le,this.updateMorphTargets()}function Rn(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function On(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function Pn(t,e){return Math.abs(e[1])-Math.abs(t[1])}function Cn(t,e,i){var n=t.createShader(e);return t.shaderSource(n,i),t.compileShader(n),!1===t.getShaderParameter(n,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(n)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(n),function(t){for(var e=t.split("\n"),i=0;i<e.length;i++)e[i]=i+1+": "+e[i];return e.join("\n")}(i)),n}yn.prototype=Object.assign(Object.create(n.prototype),{constructor:yn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(gn(t)>65535?dn:ln)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new an(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,i){this.groups.push({start:t,count:e,materialIndex:void 0!==i?i:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var i=this.attributes.normal;return void 0!==i&&((new ze).getNormalMatrix(t).applyToBufferAttribute(i),i.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new Ne;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new Ne;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new Ne;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new Ne;return function(e,i,n){return t.makeTranslation(e,i,n),this.applyMatrix(t),this}}(),scale:function(){var t=new Ne;return function(e,i,n){return t.makeScale(e,i,n),this.applyMatrix(t),this}}(),lookAt:function(){var t=new Qi;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){this.computeBoundingBox();var t=this.boundingBox.getCenter().negate();return this.translate(t.x,t.y,t.z),t},setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var i=new pn(3*e.vertices.length,3),n=new pn(3*e.colors.length,3);if(this.addAttribute("position",i.copyVector3sArray(e.vertices)),this.addAttribute("color",n.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var r=new pn(e.lineDistances.length,1);this.addAttribute("lineDistance",r.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i];e.push(r.x,r.y,r.z||0)}return this.addAttribute("position",new pn(e,3)),this},updateFromObject:function(t){var e,i=t.geometry;if(t.isMesh){var n=i.__directGeometry;if(!0===i.elementsNeedUpdate&&(n=void 0,i.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(i);n.verticesNeedUpdate=i.verticesNeedUpdate,n.normalsNeedUpdate=i.normalsNeedUpdate,n.colorsNeedUpdate=i.colorsNeedUpdate,n.uvsNeedUpdate=i.uvsNeedUpdate,n.groupsNeedUpdate=i.groupsNeedUpdate,i.verticesNeedUpdate=!1,i.normalsNeedUpdate=!1,i.colorsNeedUpdate=!1,i.uvsNeedUpdate=!1,i.groupsNeedUpdate=!1,i=n}return!0===i.verticesNeedUpdate&&(void 0!==(e=this.attributes.position)&&(e.copyVector3sArray(i.vertices),e.needsUpdate=!0),i.verticesNeedUpdate=!1),!0===i.normalsNeedUpdate&&(void 0!==(e=this.attributes.normal)&&(e.copyVector3sArray(i.normals),e.needsUpdate=!0),i.normalsNeedUpdate=!1),!0===i.colorsNeedUpdate&&(void 0!==(e=this.attributes.color)&&(e.copyColorsArray(i.colors),e.needsUpdate=!0),i.colorsNeedUpdate=!1),i.uvsNeedUpdate&&(void 0!==(e=this.attributes.uv)&&(e.copyVector2sArray(i.uvs),e.needsUpdate=!0),i.uvsNeedUpdate=!1),i.lineDistancesNeedUpdate&&(void 0!==(e=this.attributes.lineDistance)&&(e.copyArray(i.lineDistances),e.needsUpdate=!0),i.lineDistancesNeedUpdate=!1),i.groupsNeedUpdate&&(i.computeGroups(t.geometry),this.groups=i.groups,i.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new mn).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new an(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var i=new Float32Array(3*t.normals.length);this.addAttribute("normal",new an(i,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var n=new Float32Array(3*t.colors.length);this.addAttribute("color",new an(n,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var r=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new an(r,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var a=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new an(a,2).copyVector2sArray(t.uvs2))}if(t.indices.length>0){var o=new(gn(t.indices)>65535?Uint32Array:Uint16Array)(3*t.indices.length);this.setIndex(new an(o,1).copyIndicesArray(t.indices))}for(var s in this.groups=t.groups,t.morphTargets){for(var c=[],h=t.morphTargets[s],l=0,u=h.length;l<u;l++){var d=h[l],p=new pn(3*d.length,3);c.push(p.copyVector3sArray(d))}this.morphAttributes[s]=c}if(t.skinIndices.length>0){var f=new pn(4*t.skinIndices.length,4);this.addAttribute("skinIndex",f.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var m=new pn(4*t.skinWeights.length,4);this.addAttribute("skinWeight",m.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new Vi);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new Vi,e=new We;return function(){null===this.boundingSphere&&(this.boundingSphere=new ji);var i=this.attributes.position;if(i){var n=this.boundingSphere.center;t.setFromBufferAttribute(i),t.getCenter(n);for(var r=0,a=0,o=i.count;a<o;a++)e.x=i.getX(a),e.y=i.getY(a),e.z=i.getZ(a),r=Math.max(r,n.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(r),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,i=this.groups;if(e.position){var n=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new an(new Float32Array(n.length),3));else for(var r=e.normal.array,a=0,o=r.length;a<o;a++)r[a]=0;var s,c,h,l=e.normal.array,u=new We,d=new We,p=new We,f=new We,m=new We;if(t){var g=t.array;0===i.length&&this.addGroup(0,g.length);for(var v=0,y=i.length;v<y;++v){var x=i[v],w=x.start;for(a=w,o=w+x.count;a<o;a+=3)s=3*g[a+0],c=3*g[a+1],h=3*g[a+2],u.fromArray(n,s),d.fromArray(n,c),p.fromArray(n,h),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),l[s]+=f.x,l[s+1]+=f.y,l[s+2]+=f.z,l[c]+=f.x,l[c+1]+=f.y,l[c+2]+=f.z,l[h]+=f.x,l[h+1]+=f.y,l[h+2]+=f.z}}else for(a=0,o=n.length;a<o;a+=9)u.fromArray(n,a),d.fromArray(n,a+3),p.fromArray(n,a+6),f.subVectors(p,d),m.subVectors(u,d),f.cross(m),l[a]=f.x,l[a+1]=f.y,l[a+2]=f.z,l[a+3]=f.x,l[a+4]=f.y,l[a+5]=f.z,l[a+6]=f.x,l[a+7]=f.y,l[a+8]=f.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(t&&t.isBufferGeometry){void 0===e&&(e=0);var i=this.attributes;for(var n in i)if(void 0!==t.attributes[n])for(var r=i[n].array,a=t.attributes[n],o=a.array,s=0,c=a.itemSize*e;s<o.length;s++,c++)r[c]=o[s];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t)},normalizeNormals:function(){var t=new We;return function(){for(var e=this.attributes.normal,i=0,n=e.count;i<n;i++)t.x=e.getX(i),t.y=e.getY(i),t.z=e.getZ(i),t.normalize(),e.setXYZ(i,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new yn,e=this.index.array,i=this.attributes;for(var n in i){for(var r=i[n],a=r.array,o=r.itemSize,s=new a.constructor(e.length*o),c=0,h=0,l=0,u=e.length;l<u;l++){c=e[l]*o;for(var d=0;d<o;d++)s[h++]=a[c++]}t.addAttribute(n,new an(s,o))}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var i in e)void 0!==e[i]&&(t[i]=e[i]);return t}t.data={attributes:{}};var n=this.index;if(null!==n){var r=Array.prototype.slice.call(n.array);t.data.index={type:n.array.constructor.name,array:r}}var a=this.attributes;for(var i in a){var o=a[i];r=Array.prototype.slice.call(o.array),t.data.attributes[i]={itemSize:o.itemSize,type:o.array.constructor.name,array:r,normalized:o.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var c=this.boundingSphere;return null!==c&&(t.data.boundingSphere={center:c.center.toArray(),radius:c.radius}),t},clone:function(){return(new yn).copy(this)},copy:function(t){var e,i,n;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var r=t.index;null!==r&&this.setIndex(r.clone());var a=t.attributes;for(e in a){var o=a[e];this.addAttribute(e,o.clone())}var s=t.morphAttributes;for(e in s){var c=[],h=s[e];for(i=0,n=h.length;i<n;i++)c.push(h[i].clone());this.morphAttributes[e]=c}var l=t.groups;for(i=0,n=l.length;i<n;i++){var u=l[i];this.addGroup(u.start,u.count,u.materialIndex)}var d=t.boundingBox;null!==d&&(this.boundingBox=d.clone());var p=t.boundingSphere;return null!==p&&(this.boundingSphere=p.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),xn.prototype=Object.create(rn.prototype),xn.prototype.constructor=xn,wn.prototype=Object.create(yn.prototype),wn.prototype.constructor=wn,bn.prototype=Object.create(rn.prototype),bn.prototype.constructor=bn,Ln.prototype=Object.create(yn.prototype),Ln.prototype.constructor=Ln,Mn.prototype=Object.create(ki.prototype),Mn.prototype.constructor=Mn,Mn.prototype.isMeshBasicMaterial=!0,Mn.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},_n.prototype=Object.create(ki.prototype),_n.prototype.constructor=_n,_n.prototype.isShaderMaterial=!0,_n.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Ui.clone(t.uniforms),this.defines=t.defines,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},_n.prototype.toJSON=function(t){var e=ki.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(An.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return(e||new We).copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new We;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){var i=e||new We;i.subVectors(t,this.origin);var n=i.dot(this.direction);return n<0?i.copy(this.origin):i.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new We;return function(e){var i=t.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(i).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new We,e=new We,i=new We;return function(n,r,a,o){t.copy(n).add(r).multiplyScalar(.5),e.copy(r).sub(n).normalize(),i.copy(this.origin).sub(t);var s,c,h,l,u=.5*n.distanceTo(r),d=-this.direction.dot(e),p=i.dot(this.direction),f=-i.dot(e),m=i.lengthSq(),g=Math.abs(1-d*d);if(g>0)if(c=d*p-f,l=u*g,(s=d*f-p)>=0)if(c>=-l)if(c<=l){var v=1/g;h=(s*=v)*(s+d*(c*=v)+2*p)+c*(d*s+c+2*f)+m}else c=u,h=-(s=Math.max(0,-(d*c+p)))*s+c*(c+2*f)+m;else c=-u,h=-(s=Math.max(0,-(d*c+p)))*s+c*(c+2*f)+m;else c<=-l?h=-(s=Math.max(0,-(-d*u+p)))*s+(c=s>0?-u:Math.min(Math.max(-u,-f),u))*(c+2*f)+m:c<=l?(s=0,h=(c=Math.min(Math.max(-u,-f),u))*(c+2*f)+m):h=-(s=Math.max(0,-(d*u+p)))*s+(c=s>0?u:Math.min(Math.max(-u,-f),u))*(c+2*f)+m;else c=d>0?-u:u,h=-(s=Math.max(0,-(d*c+p)))*s+c*(c+2*f)+m;return a&&a.copy(this.direction).multiplyScalar(s).add(this.origin),o&&o.copy(e).multiplyScalar(c).add(t),h}}(),intersectSphere:function(){var t=new We;return function(e,i){t.subVectors(e.center,this.origin);var n=t.dot(this.direction),r=t.dot(t)-n*n,a=e.radius*e.radius;if(r>a)return null;var o=Math.sqrt(a-r),s=n-o,c=n+o;return s<0&&c<0?null:s<0?this.at(c,i):this.at(s,i)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var i=-(this.origin.dot(t.normal)+t.constant)/e;return i>=0?i:null},intersectPlane:function(t,e){var i=this.distanceToPlane(t);return null===i?null:this.at(i,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var i,n,r,a,o,s,c=1/this.direction.x,h=1/this.direction.y,l=1/this.direction.z,u=this.origin;return c>=0?(i=(t.min.x-u.x)*c,n=(t.max.x-u.x)*c):(i=(t.max.x-u.x)*c,n=(t.min.x-u.x)*c),h>=0?(r=(t.min.y-u.y)*h,a=(t.max.y-u.y)*h):(r=(t.max.y-u.y)*h,a=(t.min.y-u.y)*h),i>a||r>n?null:((r>i||i!=i)&&(i=r),(a<n||n!=n)&&(n=a),l>=0?(o=(t.min.z-u.z)*l,s=(t.max.z-u.z)*l):(o=(t.max.z-u.z)*l,s=(t.min.z-u.z)*l),i>s||o>n?null:((o>i||i!=i)&&(i=o),(s<n||n!=n)&&(n=s),n<0?null:this.at(i>=0?i:n,e)))},intersectsBox:function(){var t=new We;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new We,e=new We,i=new We,n=new We;return function(r,a,o,s,c){e.subVectors(a,r),i.subVectors(o,r),n.crossVectors(e,i);var h,l=this.direction.dot(n);if(l>0){if(s)return null;h=1}else{if(!(l<0))return null;h=-1,l=-l}t.subVectors(this.origin,r);var u=h*this.direction.dot(i.crossVectors(t,i));if(u<0)return null;var d=h*this.direction.dot(e.cross(t));if(d<0)return null;if(u+d>l)return null;var p=-h*t.dot(n);return p<0?null:this.at(p/l,c)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(En.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return(t||new We).addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return(t||new We).subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){var i=e||new We;return this.delta(i).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new We,e=new We;return function(i,n){t.subVectors(i,this.start),e.subVectors(this.end,this.start);var r=e.dot(e),a=e.dot(t)/r;return n&&(a=Fe.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,i){var n=this.closestPointToPointParameter(t,e),r=i||new We;return this.delta(r).multiplyScalar(n).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(Sn,{normal:function(){var t=new We;return function(e,i,n,r){var a=r||new We;a.subVectors(n,i),t.subVectors(e,i),a.cross(t);var o=a.lengthSq();return o>0?a.multiplyScalar(1/Math.sqrt(o)):a.set(0,0,0)}}(),barycoordFromPoint:function(){var t=new We,e=new We,i=new We;return function(n,r,a,o,s){t.subVectors(o,r),e.subVectors(a,r),i.subVectors(n,r);var c=t.dot(t),h=t.dot(e),l=t.dot(i),u=e.dot(e),d=e.dot(i),p=c*u-h*h,f=s||new We;if(0===p)return f.set(-2,-1,-1);var m=1/p,g=(u*l-h*d)*m,v=(c*d-h*l)*m;return f.set(1-g-v,v,g)}}(),containsPoint:function(){var t=new We;return function(e,i,n,r){var a=Sn.barycoordFromPoint(e,i,n,r,t);return a.x>=0&&a.y>=0&&a.x+a.y<=1}}()}),Object.assign(Sn.prototype,{set:function(t,e,i){return this.a.copy(t),this.b.copy(e),this.c.copy(i),this},setFromPointsAndIndices:function(t,e,i,n){return this.a.copy(t[e]),this.b.copy(t[i]),this.c.copy(t[n]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},area:function(){var t=new We,e=new We;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),midpoint:function(t){return(t||new We).addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},normal:function(t){return Sn.normal(this.a,this.b,this.c,t)},plane:function(t){return(t||new Yi).setFromCoplanarPoints(this.a,this.b,this.c)},barycoordFromPoint:function(t,e){return Sn.barycoordFromPoint(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Sn.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new Yi,e=[new En,new En,new En],i=new We,n=new We;return function(r,a){var o=a||new We,s=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(r,i),!0===this.containsPoint(i))o.copy(i);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var c=0;c<e.length;c++){e[c].closestPointToPoint(i,!0,n);var h=i.distanceToSquared(n);h<s&&(s=h,o.copy(n))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),Tn.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Tn,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return Qi.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,i,n=this.geometry;if(n.isBufferGeometry){var r=n.morphAttributes,a=Object.keys(r);if(a.length>0){var o=r[a[0]];if(void 0!==o)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=o.length;t<e;t++)i=o[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}}else{var s=n.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)i=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=t}},raycast:function(){var t=new Ne,e=new An,i=new ji,n=new We,r=new We,a=new We,o=new We,s=new We,c=new We,h=new Ue,l=new Ue,u=new Ue,d=new We,p=new We,f=new We;function m(t,e,i,n,r,a,o){return Sn.barycoordFromPoint(t,e,i,n,d),r.multiplyScalar(d.x),a.multiplyScalar(d.y),o.multiplyScalar(d.z),r.add(a).add(o),r.clone()}function y(t,e,i,n,r,a,o,s){if(null===(e.side===g?n.intersectTriangle(o,a,r,!0,s):n.intersectTriangle(r,a,o,e.side!==v,s)))return null;f.copy(s),f.applyMatrix4(t.matrixWorld);var c=i.ray.origin.distanceTo(f);return c<i.near||c>i.far?null:{distance:c,point:f.clone(),object:t}}function x(t,e,i,o,s,c,d,f){n.fromBufferAttribute(o,c),r.fromBufferAttribute(o,d),a.fromBufferAttribute(o,f);var g=y(t,t.material,e,i,n,r,a,p);return g&&(s&&(h.fromBufferAttribute(s,c),l.fromBufferAttribute(s,d),u.fromBufferAttribute(s,f),g.uv=m(p,n,r,a,h,l,u)),g.face=new en(c,d,f,Sn.normal(n,r,a)),g.faceIndex=c),g}return function(d,f){var g,v=this.geometry,w=this.material,b=this.matrixWorld;if(void 0!==w&&(null===v.boundingSphere&&v.computeBoundingSphere(),i.copy(v.boundingSphere),i.applyMatrix4(b),!1!==d.ray.intersectsSphere(i)&&(t.getInverse(b),e.copy(d.ray).applyMatrix4(t),null===v.boundingBox||!1!==e.intersectsBox(v.boundingBox))))if(v.isBufferGeometry){var L,M,_,A,E,S=v.index,T=v.attributes.position,R=v.attributes.uv;if(null!==S)for(A=0,E=S.count;A<E;A+=3)L=S.getX(A),M=S.getX(A+1),_=S.getX(A+2),(g=x(this,d,e,T,R,L,M,_))&&(g.faceIndex=Math.floor(A/3),f.push(g));else if(void 0!==T)for(A=0,E=T.count;A<E;A+=3)(g=x(this,d,e,T,R,L=A,M=A+1,_=A+2))&&(g.index=L,f.push(g))}else if(v.isGeometry){var O,P,C,I,D=Array.isArray(w),F=v.vertices,U=v.faces,N=v.faceVertexUvs[0];N.length>0&&(I=N);for(var B=0,W=U.length;B<W;B++){var z=U[B],k=D?w[z.materialIndex]:w;if(void 0!==k){if(O=F[z.a],P=F[z.b],C=F[z.c],!0===k.morphTargets){var H=v.morphTargets,G=this.morphTargetInfluences;n.set(0,0,0),r.set(0,0,0),a.set(0,0,0);for(var V=0,j=H.length;V<j;V++){var Y=G[V];if(0!==Y){var X=H[V].vertices;n.addScaledVector(o.subVectors(X[z.a],O),Y),r.addScaledVector(s.subVectors(X[z.b],P),Y),a.addScaledVector(c.subVectors(X[z.c],C),Y)}}n.add(O),r.add(P),a.add(C),O=n,P=r,C=a}if(g=y(this,k,d,e,O,P,C,p)){if(I&&I[B]){var q=I[B];h.copy(q[0]),l.copy(q[1]),u.copy(q[2]),g.uv=m(p,O,P,C,h,l,u)}g.face=z,g.faceIndex=B,f.push(g)}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}});var In=0;function Dn(t){switch(t){case Ae:return["Linear","( value )"];case Ee:return["sRGB","( value )"];case Te:return["RGBE","( value )"];case Oe:return["RGBM","( value, 7.0 )"];case Pe:return["RGBM","( value, 16.0 )"];case Ce:return["RGBD","( value, 256.0 )"];case Se:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function Fn(t,e){var i=Dn(e);return"vec4 "+t+"( vec4 value ) { return "+i[0]+"ToLinear"+i[1]+"; }"}function Un(t){return""!==t}function Nn(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function Bn(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function Wn(t){return t.replace(/^[ \t]*#include +<([\w\d.]+)>/gm,function(t,e){var i=Ni[e];if(void 0===i)throw new Error("Can not resolve #include <"+e+">");return Wn(i)})}function zn(t){return t.replace(/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(t,e,i,n){for(var r="",a=parseInt(e);a<parseInt(i);a++)r+=n.replace(/\[ i \]/g,"[ "+a+" ]");return r})}function kn(t,e,i){var n=[],r={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},a=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];function o(t,e){var i;return t?t.isTexture?i=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),i=t.texture.encoding):i=Ae,i===Ae&&e&&(i=Se),i}this.getParameters=function(e,n,a,s,c,h,l){var u=r[e.type],d=l.isSkinnedMesh?function(t){var e=l.skeleton.bones;if(i.floatVertexTextures)return 1024;var n=i.maxVertexUniforms,r=Math.floor((n-20)/4),a=Math.min(r,e.length);return a<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+a+"."),0):a}():0,p=i.precision;null!==e.precision&&(p=i.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",p,"instead.");var f=t.getRenderTarget();return{shaderID:u,precision:p,supportsVertexTextures:i.vertexTextures,outputEncoding:o(f?f.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:o(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:o(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===pt||e.envMap.mapping===ft),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:o(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!s,useFog:e.fog,fogExp:s&&s.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:i.logarithmicDepthBuffer,skinning:e.skinning&&d>0,maxBones:d,useVertexTexture:i.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:n.directional.length,numPointLights:n.point.length,numSpotLights:n.spot.length,numRectAreaLights:n.rectArea.length,numHemiLights:n.hemi.length,numClippingPlanes:c,numClipIntersection:h,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&l.receiveShadow&&a.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===v,flipSided:e.side===g,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,i){var n=[];if(i.shaderID?n.push(i.shaderID):(n.push(e.fragmentShader),n.push(e.vertexShader)),void 0!==e.defines)for(var r in e.defines)n.push(r),n.push(e.defines[r]);for(var o=0;o<a.length;o++)n.push(i[a[o]]);return n.push(e.onBeforeCompile.toString()),n.push(t.gammaOutput),n.join()},this.acquireProgram=function(i,r,a,o){for(var s,c=0,h=n.length;c<h;c++){var l=n[c];if(l.code===o){++(s=l).usedTimes;break}}return void 0===s&&(s=new function(t,e,i,n,r,a){var o=t.context,s=n.defines,c=r.vertexShader,h=r.fragmentShader,l="SHADOWMAP_TYPE_BASIC";a.shadowMapType===p?l="SHADOWMAP_TYPE_PCF":a.shadowMapType===f&&(l="SHADOWMAP_TYPE_PCF_SOFT");var u="ENVMAP_TYPE_CUBE",d="ENVMAP_MODE_REFLECTION",m="ENVMAP_BLENDING_MULTIPLY";if(a.envMap){switch(n.envMap.mapping){case ct:case ht:u="ENVMAP_TYPE_CUBE";break;case pt:case ft:u="ENVMAP_TYPE_CUBE_UV";break;case lt:case ut:u="ENVMAP_TYPE_EQUIREC";break;case dt:u="ENVMAP_TYPE_SPHERE"}switch(n.envMap.mapping){case ht:case ut:d="ENVMAP_MODE_REFRACTION"}switch(n.combine){case $:m="ENVMAP_BLENDING_MULTIPLY";break;case tt:m="ENVMAP_BLENDING_MIX";break;case et:m="ENVMAP_BLENDING_ADD"}}var g,v,y=t.gammaFactor>0?t.gammaFactor:1,x=function(t,e,i){return[(t=t||{}).derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&i.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&i.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&i.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Un).join("\n")}(n.extensions,a,e),w=function(t){var e=[];for(var i in t){var n=t[i];!1!==n&&e.push("#define "+i+" "+n)}return e.join("\n")}(s),b=o.createProgram();n.isRawShaderMaterial?((g=[w].filter(Un).join("\n")).length>0&&(g+="\n"),(v=[x,w].filter(Un).join("\n")).length>0&&(v+="\n")):(g=["precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+r.name,w,a.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+y,"#define MAX_BONES "+a.maxBones,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+d:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.displacementMap&&a.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.flatShading?"#define FLAT_SHADED":"",a.skinning?"#define USE_SKINNING":"",a.useVertexTexture?"#define BONE_TEXTURE":"",a.morphTargets?"#define USE_MORPHTARGETS":"",a.morphNormals&&!1===a.flatShading?"#define USE_MORPHNORMALS":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.sizeAttenuation?"#define USE_SIZEATTENUATION":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Un).join("\n"),v=[x,"precision "+a.precision+" float;","precision "+a.precision+" int;","#define SHADER_NAME "+r.name,w,a.alphaTest?"#define ALPHATEST "+a.alphaTest:"","#define GAMMA_FACTOR "+y,a.useFog&&a.fog?"#define USE_FOG":"",a.useFog&&a.fogExp?"#define FOG_EXP2":"",a.map?"#define USE_MAP":"",a.envMap?"#define USE_ENVMAP":"",a.envMap?"#define "+u:"",a.envMap?"#define "+d:"",a.envMap?"#define "+m:"",a.lightMap?"#define USE_LIGHTMAP":"",a.aoMap?"#define USE_AOMAP":"",a.emissiveMap?"#define USE_EMISSIVEMAP":"",a.bumpMap?"#define USE_BUMPMAP":"",a.normalMap?"#define USE_NORMALMAP":"",a.specularMap?"#define USE_SPECULARMAP":"",a.roughnessMap?"#define USE_ROUGHNESSMAP":"",a.metalnessMap?"#define USE_METALNESSMAP":"",a.alphaMap?"#define USE_ALPHAMAP":"",a.vertexColors?"#define USE_COLOR":"",a.gradientMap?"#define USE_GRADIENTMAP":"",a.flatShading?"#define FLAT_SHADED":"",a.doubleSided?"#define DOUBLE_SIDED":"",a.flipSided?"#define FLIP_SIDED":"",a.shadowMapEnabled?"#define USE_SHADOWMAP":"",a.shadowMapEnabled?"#define "+l:"",a.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",a.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",a.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",a.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",a.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",a.toneMapping!==it?"#define TONE_MAPPING":"",a.toneMapping!==it?Ni.tonemapping_pars_fragment:"",a.toneMapping!==it?function(t,e){var i;switch(e){case nt:i="Linear";break;case rt:i="Reinhard";break;case at:i="Uncharted2";break;case ot:i="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 toneMapping( vec3 color ) { return "+i+"ToneMapping( color ); }"}(0,a.toneMapping):"",a.dithering?"#define DITHERING":"",a.outputEncoding||a.mapEncoding||a.envMapEncoding||a.emissiveMapEncoding?Ni.encodings_pars_fragment:"",a.mapEncoding?Fn("mapTexelToLinear",a.mapEncoding):"",a.envMapEncoding?Fn("envMapTexelToLinear",a.envMapEncoding):"",a.emissiveMapEncoding?Fn("emissiveMapTexelToLinear",a.emissiveMapEncoding):"",a.outputEncoding?function(t,e){var i=Dn(a.outputEncoding);return"vec4 linearToOutputTexel( vec4 value ) { return LinearTo"+i[0]+i[1]+"; }"}():"",a.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Un).join("\n")),c=Bn(c=Nn(c=Wn(c),a),a),h=Bn(h=Nn(h=Wn(h),a),a);var L=g+(c=zn(c)),M=v+(h=zn(h)),_=Cn(o,o.VERTEX_SHADER,L),A=Cn(o,o.FRAGMENT_SHADER,M);o.attachShader(b,_),o.attachShader(b,A),void 0!==n.index0AttributeName?o.bindAttribLocation(b,0,n.index0AttributeName):!0===a.morphTargets&&o.bindAttribLocation(b,0,"position"),o.linkProgram(b);var E,S,T=o.getProgramInfoLog(b).trim(),R=o.getShaderInfoLog(_).trim(),O=o.getShaderInfoLog(A).trim(),P=!0,C=!0;return!1===o.getProgramParameter(b,o.LINK_STATUS)?(P=!1,console.error("THREE.WebGLProgram: shader error: ",o.getError(),"gl.VALIDATE_STATUS",o.getProgramParameter(b,o.VALIDATE_STATUS),"gl.getProgramInfoLog",T,R,O)):""!==T?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",T):""!==R&&""!==O||(C=!1),C&&(this.diagnostics={runnable:P,material:n,programLog:T,vertexShader:{log:R,prefix:g},fragmentShader:{log:O,prefix:v}}),o.deleteShader(_),o.deleteShader(A),this.getUniforms=function(){return void 0===E&&(E=new Ci(o,b,t)),E},this.getAttributes=function(){return void 0===S&&(S=function(t,e){for(var i={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),r=0;r<n;r++){var a=t.getActiveAttrib(e,r).name;i[a]=t.getAttribLocation(e,a)}return i}(o,b)),S},this.destroy=function(){o.deleteProgram(b),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.id=In++,this.code=i,this.usedTimes=1,this.program=b,this.vertexShader=_,this.fragmentShader=A,this}(t,e,o,i,r,a),n.push(s)),s},this.releaseProgram=function(t){if(0==--t.usedTimes){var e=n.indexOf(t);n[e]=n[n.length-1],n.pop(),t.destroy()}},this.programs=n}function Hn(t,e,i,n,r,a,o,s){var c,h="undefined"!=typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,l={};function u(t,e){if(t.width>e||t.height>e){var i=e/Math.max(t.width,t.height),n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");return n.width=Math.floor(t.width*i),n.height=Math.floor(t.height*i),n.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,n.width,n.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+n.width+"x"+n.height,t),n}return t}function d(t){return Fe.isPowerOfTwo(t.width)&&Fe.isPowerOfTwo(t.height)}function p(t,e){return t.generateMipmaps&&e&&t.minFilter!==yt&&t.minFilter!==bt}function f(e){return e===yt||e===xt||e===wt?t.NEAREST:t.LINEAR}function m(e){var i=e.target;i.removeEventListener("dispose",m),function(e){var i=n.get(e);if(e.image&&i.__image__webglTextureCube)t.deleteTexture(i.__image__webglTextureCube);else{if(void 0===i.__webglInit)return;t.deleteTexture(i.__webglTexture)}n.remove(e)}(i),i.isVideoTexture&&delete l[i.id],o.textures--}function g(e){var i=e.target;i.removeEventListener("dispose",g),function(e){var i=n.get(e),r=n.get(e.texture);if(e){if(void 0!==r.__webglTexture&&t.deleteTexture(r.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var a=0;a<6;a++)t.deleteFramebuffer(i.__webglFramebuffer[a]),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer[a]);else t.deleteFramebuffer(i.__webglFramebuffer),i.__webglDepthbuffer&&t.deleteRenderbuffer(i.__webglDepthbuffer);n.remove(e.texture),n.remove(e)}}(i),o.textures--}function v(e,f){var g=n.get(e);if(e.isVideoTexture&&function(t){var e=t.id,i=s.frame;l[e]!==i&&(l[e]=i,t.update())}(e),e.version>0&&g.__version!==e.version){var v=e.image;if(void 0===v)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==v.complete)return void function(e,n,s){void 0===e.__webglInit&&(e.__webglInit=!0,n.addEventListener("dispose",m),e.__webglTexture=t.createTexture(),o.textures++),i.activeTexture(t.TEXTURE0+s),i.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,n.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,n.unpackAlignment);var l=u(n.image,r.maxTextureSize);(function(t){return t.wrapS!==gt||t.wrapT!==gt||t.minFilter!==yt&&t.minFilter!==bt})(n)&&!1===d(l)&&(l=function(t){return t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap?(void 0===c&&(c=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),c.width=Fe.floorPowerOfTwo(t.width),c.height=Fe.floorPowerOfTwo(t.height),c.getContext("2d").drawImage(t,0,0,c.width,c.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+c.width+"x"+c.height,t),c):t}(l));var f=d(l),g=a.convert(n.format),v=a.convert(n.type);y(t.TEXTURE_2D,n,f);var x,w=n.mipmaps;if(n.isDepthTexture){var b=t.DEPTH_COMPONENT;if(n.type===Ot){if(!h)throw new Error("Float Depth Texture only supported in WebGL2.0");b=t.DEPTH_COMPONENT32F}else h&&(b=t.DEPTH_COMPONENT16);n.format===Ht&&b===t.DEPTH_COMPONENT&&n.type!==St&&n.type!==Rt&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),n.type=St,v=a.convert(n.type)),n.format===Gt&&(b=t.DEPTH_STENCIL,n.type!==Ft&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),n.type=Ft,v=a.convert(n.type))),i.texImage2D(t.TEXTURE_2D,0,b,l.width,l.height,0,g,v,null)}else if(n.isDataTexture)if(w.length>0&&f){for(var L=0,M=w.length;L<M;L++)x=w[L],i.texImage2D(t.TEXTURE_2D,L,g,x.width,x.height,0,g,v,x.data);n.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,g,l.width,l.height,0,g,v,l.data);else if(n.isCompressedTexture)for(L=0,M=w.length;L<M;L++)x=w[L],n.format!==Bt&&n.format!==Nt?i.getCompressedTextureFormats().indexOf(g)>-1?i.compressedTexImage2D(t.TEXTURE_2D,L,g,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):i.texImage2D(t.TEXTURE_2D,L,g,x.width,x.height,0,g,v,x.data);else if(w.length>0&&f){for(L=0,M=w.length;L<M;L++)x=w[L],i.texImage2D(t.TEXTURE_2D,L,g,g,v,x);n.generateMipmaps=!1}else i.texImage2D(t.TEXTURE_2D,0,g,g,v,l);p(n,f)&&t.generateMipmap(t.TEXTURE_2D),e.__version=n.version,n.onUpdate&&n.onUpdate(n)}(g,e,f);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}i.activeTexture(t.TEXTURE0+f),i.bindTexture(t.TEXTURE_2D,g.__webglTexture)}function y(i,o,s){var c;if(s?(t.texParameteri(i,t.TEXTURE_WRAP_S,a.convert(o.wrapS)),t.texParameteri(i,t.TEXTURE_WRAP_T,a.convert(o.wrapT)),t.texParameteri(i,t.TEXTURE_MAG_FILTER,a.convert(o.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,a.convert(o.minFilter))):(t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),o.wrapS===gt&&o.wrapT===gt||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",o),t.texParameteri(i,t.TEXTURE_MAG_FILTER,f(o.magFilter)),t.texParameteri(i,t.TEXTURE_MIN_FILTER,f(o.minFilter)),o.minFilter!==yt&&o.minFilter!==bt&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",o)),c=e.get("EXT_texture_filter_anisotropic")){if(o.type===Ot&&null===e.get("OES_texture_float_linear"))return;if(o.type===Pt&&null===e.get("OES_texture_half_float_linear"))return;(o.anisotropy>1||n.get(o).__currentAnisotropy)&&(t.texParameterf(i,c.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,r.getMaxAnisotropy())),n.get(o).__currentAnisotropy=o.anisotropy)}}function x(e,r,o,s){var c=a.convert(r.texture.format),h=a.convert(r.texture.type);i.texImage2D(s,0,c,r.width,r.height,0,c,h,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,o,s,n.get(r.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function w(e,i){t.bindRenderbuffer(t.RENDERBUFFER,e),i.depthBuffer&&!i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):i.depthBuffer&&i.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,i.width,i.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,i.width,i.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}this.setTexture2D=v,this.setTextureCube=function(e,s){var c=n.get(e);if(6===e.image.length)if(e.version>0&&c.__version!==e.version){c.__image__webglTextureCube||(e.addEventListener("dispose",m),c.__image__webglTextureCube=t.createTexture(),o.textures++),i.activeTexture(t.TEXTURE0+s),i.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var h=e&&e.isCompressedTexture,l=e.image[0]&&e.image[0].isDataTexture,f=[],g=0;g<6;g++)f[g]=h||l?l?e.image[g].image:e.image[g]:u(e.image[g],r.maxCubemapSize);var v=d(f[0]),x=a.convert(e.format),w=a.convert(e.type);for(y(t.TEXTURE_CUBE_MAP,e,v),g=0;g<6;g++)if(h)for(var b,L=f[g].mipmaps,M=0,_=L.length;M<_;M++)b=L[M],e.format!==Bt&&e.format!==Nt?i.getCompressedTextureFormats().indexOf(x)>-1?i.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,M,x,b.width,b.height,0,b.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,M,x,b.width,b.height,0,x,w,b.data);else l?i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,x,f[g].width,f[g].height,0,x,w,f[g].data):i.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+g,0,x,x,w,f[g]);p(e,v)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),c.__version=e.version,e.onUpdate&&e.onUpdate(e)}else i.activeTexture(t.TEXTURE0+s),i.bindTexture(t.TEXTURE_CUBE_MAP,c.__image__webglTextureCube)},this.setTextureCubeDynamic=function(e,r){i.activeTexture(t.TEXTURE0+r),i.bindTexture(t.TEXTURE_CUBE_MAP,n.get(e).__webglTexture)},this.setupRenderTarget=function(e){var r=n.get(e),a=n.get(e.texture);e.addEventListener("dispose",g),a.__webglTexture=t.createTexture(),o.textures++;var s=!0===e.isWebGLRenderTargetCube,c=d(e);if(s){r.__webglFramebuffer=[];for(var h=0;h<6;h++)r.__webglFramebuffer[h]=t.createFramebuffer()}else r.__webglFramebuffer=t.createFramebuffer();if(s){for(i.bindTexture(t.TEXTURE_CUBE_MAP,a.__webglTexture),y(t.TEXTURE_CUBE_MAP,e.texture,c),h=0;h<6;h++)x(r.__webglFramebuffer[h],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+h);p(e.texture,c)&&t.generateMipmap(t.TEXTURE_CUBE_MAP),i.bindTexture(t.TEXTURE_CUBE_MAP,null)}else i.bindTexture(t.TEXTURE_2D,a.__webglTexture),y(t.TEXTURE_2D,e.texture,c),x(r.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),p(e.texture,c)&&t.generateMipmap(t.TEXTURE_2D),i.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&function(e){var i=n.get(e),r=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(r)throw new Error("target.depthTexture not supported in Cube render targets");!function(e,i){if(i&&i.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!i.depthTexture||!i.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");n.get(i.depthTexture).__webglTexture&&i.depthTexture.image.width===i.width&&i.depthTexture.image.height===i.height||(i.depthTexture.image.width=i.width,i.depthTexture.image.height=i.height,i.depthTexture.needsUpdate=!0),v(i.depthTexture,0);var r=n.get(i.depthTexture).__webglTexture;if(i.depthTexture.format===Ht)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,r,0);else{if(i.depthTexture.format!==Gt)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,r,0)}}(i.__webglFramebuffer,e)}else if(r){i.__webglDepthbuffer=[];for(var a=0;a<6;a++)t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer[a]),i.__webglDepthbuffer[a]=t.createRenderbuffer(),w(i.__webglDepthbuffer[a],e)}else t.bindFramebuffer(t.FRAMEBUFFER,i.__webglFramebuffer),i.__webglDepthbuffer=t.createRenderbuffer(),w(i.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}(e)},this.updateRenderTargetMipmap=function(e){var r=e.texture;if(p(r,d(e))){var a=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,o=n.get(r).__webglTexture;i.bindTexture(a,o),t.generateMipmap(a),i.bindTexture(a,null)}}}function Gn(t,e,i,n){$i.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==i?i:.1,this.far=void 0!==n?n:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function Vn(t){Gn.call(this),this.cameras=t||[]}function jn(t){var e=this,i=null,n=null,r=null,a=new Ne,o=new Ne;"undefined"!=typeof window&&"VRFrameData"in window&&(n=new window.VRFrameData);var s=new Ne,c=new Gn;c.bounds=new Ge(0,0,.5,1),c.layers.enable(1);var h=new Gn;h.bounds=new Ge(.5,0,.5,1),h.layers.enable(2);var l,u,d=new Vn([c,h]);function p(){if(null!==i&&i.isPresenting){var n=i.getEyeParameters("left"),r=n.renderWidth,a=n.renderHeight;u=t.getPixelRatio(),l=t.getSize(),t.setDrawingBufferSize(2*r,a,1)}else e.enabled&&t.setDrawingBufferSize(l.width,l.height,u)}d.layers.enable(1),d.layers.enable(2),"undefined"!=typeof window&&window.addEventListener("vrdisplaypresentchange",p,!1),this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return i},this.setDevice=function(t){void 0!==t&&(i=t)},this.setPoseTarget=function(t){void 0!==t&&(r=t)},this.getCamera=function(t){if(null===i)return t;i.depthNear=t.near,i.depthFar=t.far,i.getFrameData(n);var l=n.pose,u=null!==r?r:t;null!==l.position?u.position.fromArray(l.position):u.position.set(0,0,0),null!==l.orientation&&u.quaternion.fromArray(l.orientation);var p=i.stageParameters;if(p?a.fromArray(p.sittingToStandingTransform):a.makeTranslation(0,e.userHeight,0),u.position.applyMatrix4(a),u.updateMatrixWorld(),!1===i.isPresenting)return t;c.near=t.near,h.near=t.near,c.far=t.far,h.far=t.far,d.matrixWorld.copy(t.matrixWorld),d.matrixWorldInverse.copy(t.matrixWorldInverse),c.matrixWorldInverse.fromArray(n.leftViewMatrix),h.matrixWorldInverse.fromArray(n.rightViewMatrix),o.getInverse(a),c.matrixWorldInverse.multiply(o),h.matrixWorldInverse.multiply(o);var f=u.parent;null!==f&&(s.getInverse(f.matrixWorld),c.matrixWorldInverse.multiply(s),h.matrixWorldInverse.multiply(s)),c.matrixWorld.getInverse(c.matrixWorldInverse),h.matrixWorld.getInverse(h.matrixWorldInverse),c.projectionMatrix.fromArray(n.leftProjectionMatrix),h.projectionMatrix.fromArray(n.rightProjectionMatrix),d.projectionMatrix.copy(c.projectionMatrix);var m=i.getLayers();if(m.length){var g=m[0];null!==g.leftBounds&&4===g.leftBounds.length&&c.bounds.fromArray(g.leftBounds),null!==g.rightBounds&&4===g.rightBounds.length&&h.bounds.fromArray(g.rightBounds)}return d},this.getStandingMatrix=function(){return a},this.submitFrame=function(){i&&i.isPresenting&&i.submitFrame()},this.dispose=function(){"undefined"!=typeof window&&window.removeEventListener("vrdisplaypresentchange",p)}}function Yn(t,e){return{convert:function(i){var n;if(i===mt)return t.REPEAT;if(i===gt)return t.CLAMP_TO_EDGE;if(i===vt)return t.MIRRORED_REPEAT;if(i===yt)return t.NEAREST;if(i===xt)return t.NEAREST_MIPMAP_NEAREST;if(i===wt)return t.NEAREST_MIPMAP_LINEAR;if(i===bt)return t.LINEAR;if(i===Lt)return t.LINEAR_MIPMAP_NEAREST;if(i===Mt)return t.LINEAR_MIPMAP_LINEAR;if(i===_t)return t.UNSIGNED_BYTE;if(i===Ct)return t.UNSIGNED_SHORT_4_4_4_4;if(i===It)return t.UNSIGNED_SHORT_5_5_5_1;if(i===Dt)return t.UNSIGNED_SHORT_5_6_5;if(i===At)return t.BYTE;if(i===Et)return t.SHORT;if(i===St)return t.UNSIGNED_SHORT;if(i===Tt)return t.INT;if(i===Rt)return t.UNSIGNED_INT;if(i===Ot)return t.FLOAT;if(i===Pt&&null!==(n=e.get("OES_texture_half_float")))return n.HALF_FLOAT_OES;if(i===Ut)return t.ALPHA;if(i===Nt)return t.RGB;if(i===Bt)return t.RGBA;if(i===Wt)return t.LUMINANCE;if(i===zt)return t.LUMINANCE_ALPHA;if(i===Ht)return t.DEPTH_COMPONENT;if(i===Gt)return t.DEPTH_STENCIL;if(i===R)return t.FUNC_ADD;if(i===O)return t.FUNC_SUBTRACT;if(i===P)return t.FUNC_REVERSE_SUBTRACT;if(i===D)return t.ZERO;if(i===F)return t.ONE;if(i===U)return t.SRC_COLOR;if(i===N)return t.ONE_MINUS_SRC_COLOR;if(i===B)return t.SRC_ALPHA;if(i===W)return t.ONE_MINUS_SRC_ALPHA;if(i===z)return t.DST_ALPHA;if(i===k)return t.ONE_MINUS_DST_ALPHA;if(i===H)return t.DST_COLOR;if(i===G)return t.ONE_MINUS_DST_COLOR;if(i===V)return t.SRC_ALPHA_SATURATE;if((i===Vt||i===jt||i===Yt||i===Xt)&&null!==(n=e.get("WEBGL_compressed_texture_s3tc"))){if(i===Vt)return n.COMPRESSED_RGB_S3TC_DXT1_EXT;if(i===jt)return n.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(i===Yt)return n.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(i===Xt)return n.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((i===qt||i===Zt||i===Jt||i===Kt)&&null!==(n=e.get("WEBGL_compressed_texture_pvrtc"))){if(i===qt)return n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(i===Zt)return n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(i===Jt)return n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(i===Kt)return n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(i===Qt&&null!==(n=e.get("WEBGL_compressed_texture_etc1")))return n.COMPRESSED_RGB_ETC1_WEBGL;if((i===$t||i===te||i===ee||i===ie||i===ne||i===re||i===ae||i===oe||i===se||i===ce||i===he||i===le||i===ue||i===de)&&null!==(n=e.get("WEBGL_compressed_texture_astc")))return i;if((i===C||i===I)&&null!==(n=e.get("EXT_blend_minmax"))){if(i===C)return n.MIN_EXT;if(i===I)return n.MAX_EXT}return i===Ft&&null!==(n=e.get("WEBGL_depth_texture"))?n.UNSIGNED_INT_24_8_WEBGL:0}}}Gn.prototype=Object.assign(Object.create($i.prototype),{constructor:Gn,isPerspectiveCamera:!0,copy:function(t,e){return $i.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Fe.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Fe.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Fe.RAD2DEG*Math.atan(Math.tan(.5*Fe.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,i,n,r,a){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=i,this.view.offsetY=n,this.view.width=r,this.view.height=a,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Fe.DEG2RAD*this.fov)/this.zoom,i=2*e,n=this.aspect*i,r=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){var o=a.fullWidth,s=a.fullHeight;r+=a.offsetX*n/o,e-=a.offsetY*i/s,n*=a.width/o,i*=a.height/s}var c=this.filmOffset;0!==c&&(r+=t*c/this.getFilmWidth()),this.projectionMatrix.makePerspective(r,r+n,e,e-i,t,this.far)},toJSON:function(t){var e=Qi.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),Vn.prototype=Object.assign(Object.create(Gn.prototype),{constructor:Vn,isArrayCamera:!0});var Xn=0;function qn(){var t={};return{get:function(e,i){var n=e.id+","+i.id,r=t[n];return void 0===r&&(r=new function(){var t=new function(){var t=new function(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var i;switch(e.type){case"DirectionalLight":i={direction:new We,color:new Di,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"SpotLight":i={position:new We,direction:new We,color:new Di,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ue};break;case"PointLight":i={position:new We,color:new Di,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new Ue,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":i={direction:new We,skyColor:new Di,groundColor:new Di};break;case"RectAreaLight":i={color:new Di,position:new We,halfWidth:new We,halfHeight:new We}}return t[e.id]=i,i}}},e={id:Xn++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},i=new We,n=new Ne,r=new Ne;return{setup:function(a,o,s){for(var c=0,h=0,l=0,u=0,d=0,p=0,f=0,m=0,g=s.matrixWorldInverse,v=0,y=a.length;v<y;v++){var x=a[v],w=x.color,b=x.intensity,L=x.distance,M=x.shadow&&x.shadow.map?x.shadow.map.texture:null;if(x.isAmbientLight)c+=w.r*b,h+=w.g*b,l+=w.b*b;else if(x.isDirectionalLight){if((A=t.get(x)).color.copy(x.color).multiplyScalar(x.intensity),A.direction.setFromMatrixPosition(x.matrixWorld),i.setFromMatrixPosition(x.target.matrixWorld),A.direction.sub(i),A.direction.transformDirection(g),A.shadow=x.castShadow,x.castShadow){var _=x.shadow;A.shadowBias=_.bias,A.shadowRadius=_.radius,A.shadowMapSize=_.mapSize}e.directionalShadowMap[u]=M,e.directionalShadowMatrix[u]=x.shadow.matrix,e.directional[u]=A,u++}else if(x.isSpotLight)(A=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),A.position.applyMatrix4(g),A.color.copy(w).multiplyScalar(b),A.distance=L,A.direction.setFromMatrixPosition(x.matrixWorld),i.setFromMatrixPosition(x.target.matrixWorld),A.direction.sub(i),A.direction.transformDirection(g),A.coneCos=Math.cos(x.angle),A.penumbraCos=Math.cos(x.angle*(1-x.penumbra)),A.decay=0===x.distance?0:x.decay,A.shadow=x.castShadow,x.castShadow&&(_=x.shadow,A.shadowBias=_.bias,A.shadowRadius=_.radius,A.shadowMapSize=_.mapSize),e.spotShadowMap[p]=M,e.spotShadowMatrix[p]=x.shadow.matrix,e.spot[p]=A,p++;else if(x.isRectAreaLight)(A=t.get(x)).color.copy(w).multiplyScalar(b),A.position.setFromMatrixPosition(x.matrixWorld),A.position.applyMatrix4(g),r.identity(),n.copy(x.matrixWorld),n.premultiply(g),r.extractRotation(n),A.halfWidth.set(.5*x.width,0,0),A.halfHeight.set(0,.5*x.height,0),A.halfWidth.applyMatrix4(r),A.halfHeight.applyMatrix4(r),e.rectArea[f]=A,f++;else if(x.isPointLight)(A=t.get(x)).position.setFromMatrixPosition(x.matrixWorld),A.position.applyMatrix4(g),A.color.copy(x.color).multiplyScalar(x.intensity),A.distance=x.distance,A.decay=0===x.distance?0:x.decay,A.shadow=x.castShadow,x.castShadow&&(_=x.shadow,A.shadowBias=_.bias,A.shadowRadius=_.radius,A.shadowMapSize=_.mapSize,A.shadowCameraNear=_.camera.near,A.shadowCameraFar=_.camera.far),e.pointShadowMap[d]=M,e.pointShadowMatrix[d]=x.shadow.matrix,e.point[d]=A,d++;else if(x.isHemisphereLight){var A;(A=t.get(x)).direction.setFromMatrixPosition(x.matrixWorld),A.direction.transformDirection(g),A.direction.normalize(),A.skyColor.copy(x.color).multiplyScalar(b),A.groundColor.copy(x.groundColor).multiplyScalar(b),e.hemi[m]=A,m++}}e.ambient[0]=c,e.ambient[1]=h,e.ambient[2]=l,e.directional.length=u,e.spot.length=p,e.rectArea.length=f,e.point.length=d,e.hemi.length=m,e.hash=e.id+","+u+","+d+","+p+","+f+","+m+","+o.length},state:e}},e=[],i=[],n=[];return{init:function(){e.length=0,i.length=0,n.length=0},state:{lightsArray:e,shadowsArray:i,spritesArray:n,lights:t},setupLights:function(n){t.setup(e,i,n)},pushLight:function(t){e.push(t)},pushShadow:function(t){i.push(t)},pushSprite:function(t){n.push(t)}}},t[n]=r),r},dispose:function(){t={}}}}function Zn(t){console.log("THREE.WebGLRenderer",r);var e=void 0!==(t=t||{}).canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),i=void 0!==t.context?t.context:null,n=void 0!==t.alpha&&t.alpha,a=void 0===t.depth||t.depth,h=void 0===t.stencil||t.stencil,l=void 0!==t.antialias&&t.antialias,u=void 0===t.premultipliedAlpha||t.premultipliedAlpha,d=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,p=void 0!==t.powerPreference?t.powerPreference:"default",f=null,m=null;this.domElement=e,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=nt,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var y,x,b,L,R,O,P,C,I,D,F,U,N,B,W,z,k,H,G=this,V=!1,$=null,tt=null,et=-1,it="",rt=null,at=null,ot=new Ge,st=new Ge,ct=null,ht=0,lt=e.width,ut=e.height,dt=1,pt=new Ge(0,0,lt,ut),ft=new Ge(0,0,lt,ut),mt=!1,gt=new Xi,vt=new function(){var t=this,e=null,i=0,n=!1,r=!1,a=new Yi,o=new ze,s={value:null,needsUpdate:!1};function c(){s.value!==e&&(s.value=e,s.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function h(e,i,n,r){var c=null!==e?e.length:0,h=null;if(0!==c){if(h=s.value,!0!==r||null===h){var l=n+4*c,u=i.matrixWorldInverse;o.getNormalMatrix(u),(null===h||h.length<l)&&(h=new Float32Array(l));for(var d=0,p=n;d!==c;++d,p+=4)a.copy(e[d]).applyMatrix4(u,o),a.normal.toArray(h,p),h[p+3]=a.constant}s.value=h,s.needsUpdate=!0}return t.numPlanes=c,h}this.uniform=s,this.numPlanes=0,this.numIntersection=0,this.init=function(t,r,a){var o=0!==t.length||r||0!==i||n;return n=r,e=h(t,a,0),i=t.length,o},this.beginShadows=function(){r=!0,h(null)},this.endShadows=function(){r=!1,c()},this.setState=function(t,a,o,l,u,d){if(!n||null===t||0===t.length||r&&!o)r?h(null):c();else{var p=r?0:i,f=4*p,m=u.clippingState||null;s.value=m,m=h(t,l,f,d);for(var g=0;g!==f;++g)m[g]=e[g];u.clippingState=m,this.numIntersection=a?this.numPlanes:0,this.numPlanes+=p}}},yt=!1,xt=!1,wt=new Ne,bt=new We,Lt={geometries:0,textures:0},Mt={frame:0,calls:0,vertices:0,faces:0,points:0};function At(){return null===$?dt:1}this.info={render:Mt,memory:Lt,programs:null,autoReset:!0,reset:function(){Mt.frame++,Mt.calls=0,Mt.vertices=0,Mt.faces=0,Mt.points=0}};try{var Et={alpha:n,depth:a,stencil:h,antialias:l,premultipliedAlpha:u,preserveDrawingBuffer:d,powerPreference:p};if(e.addEventListener("webglcontextlost",Ct,!1),e.addEventListener("webglcontextrestored",It,!1),null===(y=i||e.getContext("webgl",Et)||e.getContext("experimental-webgl",Et)))throw null!==e.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===y.getShaderPrecisionFormat&&(y.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}function St(){(x=new function(t){var e={};return{get:function(i){if(void 0!==e[i])return e[i];var n;switch(i){case"WEBGL_depth_texture":n=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":n=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":n=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":n=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;case"WEBGL_compressed_texture_etc1":n=t.getExtension("WEBGL_compressed_texture_etc1");break;default:n=t.getExtension(i)}return null===n&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),e[i]=n,n}}}(y)).get("WEBGL_depth_texture"),x.get("OES_texture_float"),x.get("OES_texture_float_linear"),x.get("OES_texture_half_float"),x.get("OES_texture_half_float_linear"),x.get("OES_standard_derivatives"),x.get("OES_element_index_uint"),x.get("ANGLE_instanced_arrays"),H=new Yn(y,x),b=new function(t,e,i){var n;function r(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var a=void 0!==i.precision?i.precision:"highp",o=r(a);o!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",o,"instead."),a=o);var s=!0===i.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_TEXTURE_SIZE),u=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),f=t.getParameter(t.MAX_VARYING_VECTORS),m=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),g=h>0,v=!!e.get("OES_texture_float");return{getMaxAnisotropy:function(){if(void 0!==n)return n;var i=e.get("EXT_texture_filter_anisotropic");return n=null!==i?t.getParameter(i.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:r,precision:a,logarithmicDepthBuffer:s,maxTextures:c,maxVertexTextures:h,maxTextureSize:l,maxCubemapSize:u,maxAttributes:d,maxVertexUniforms:p,maxVaryings:f,maxFragmentUniforms:m,vertexTextures:g,floatFragmentTextures:v,floatVertexTextures:g&&v}}(y,x,t),(L=new function(t,e,i){var n=new function(){var e=!1,i=new Ge,n=null,r=new Ge(0,0,0,0);return{setMask:function(i){n===i||e||(t.colorMask(i,i,i,i),n=i)},setLocked:function(t){e=t},setClear:function(e,n,a,o,s){!0===s&&(e*=o,n*=o,a*=o),i.set(e,n,a,o),!1===r.equals(i)&&(t.clearColor(e,n,a,o),r.copy(i))},reset:function(){e=!1,n=null,r.set(-1,0,0,0)}}},r=new function(){var e=!1,i=null,n=null,r=null;return{setTest:function(e){e?et(t.DEPTH_TEST):it(t.DEPTH_TEST)},setMask:function(n){i===n||e||(t.depthMask(n),i=n)},setFunc:function(e){if(n!==e){if(e)switch(e){case j:t.depthFunc(t.NEVER);break;case Y:t.depthFunc(t.ALWAYS);break;case X:t.depthFunc(t.LESS);break;case q:t.depthFunc(t.LEQUAL);break;case Z:t.depthFunc(t.EQUAL);break;case J:t.depthFunc(t.GEQUAL);break;case K:t.depthFunc(t.GREATER);break;case Q:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);n=e}},setLocked:function(t){e=t},setClear:function(e){r!==e&&(t.clearDepth(e),r=e)},reset:function(){e=!1,i=null,n=null,r=null}}},a=new function(){var e=!1,i=null,n=null,r=null,a=null,o=null,s=null,c=null,h=null;return{setTest:function(e){e?et(t.STENCIL_TEST):it(t.STENCIL_TEST)},setMask:function(n){i===n||e||(t.stencilMask(n),i=n)},setFunc:function(e,i,o){n===e&&r===i&&a===o||(t.stencilFunc(e,i,o),n=e,r=i,a=o)},setOp:function(e,i,n){o===e&&s===i&&c===n||(t.stencilOp(e,i,n),o=e,s=i,c=n)},setLocked:function(t){e=t},setClear:function(e){h!==e&&(t.clearStencil(e),h=e)},reset:function(){e=!1,i=null,n=null,r=null,a=null,o=null,s=null,c=null,h=null}}},h=t.getParameter(t.MAX_VERTEX_ATTRIBS),l=new Uint8Array(h),u=new Uint8Array(h),d=new Uint8Array(h),p={},f=null,m=null,y=null,x=null,w=null,b=null,L=null,R=null,O=null,P=!1,C=null,I=null,D=null,F=null,U=null,N=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),B=!1,W=0,z=t.getParameter(t.VERSION);-1!==z.indexOf("WebGL")?(W=parseFloat(/^WebGL\ ([0-9])/.exec(z)[1]),B=W>=1):-1!==z.indexOf("OpenGL ES")&&(W=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(z)[1]),B=W>=2);var k=null,H={},G=new Ge,V=new Ge;function $(e,i,n){var r=new Uint8Array(4),a=t.createTexture();t.bindTexture(e,a),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var o=0;o<n;o++)t.texImage2D(i+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,r);return a}var tt={};function et(e){!0!==p[e]&&(t.enable(e),p[e]=!0)}function it(e){!1!==p[e]&&(t.disable(e),p[e]=!1)}function nt(e,n,r,a,o,s,c,h){if(e!==M?et(t.BLEND):it(t.BLEND),e!==T){if(e!==y||h!==P)switch(e){case A:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case E:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case S:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:h?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}x=null,w=null,b=null,L=null,R=null,O=null}else o=o||n,s=s||r,c=c||a,n===x&&o===L||(t.blendEquationSeparate(i.convert(n),i.convert(o)),x=n,L=o),r===w&&a===b&&s===R&&c===O||(t.blendFuncSeparate(i.convert(r),i.convert(a),i.convert(s),i.convert(c)),w=r,b=a,R=s,O=c);y=e,P=h}function rt(e){C!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),C=e)}function at(e){e!==o?(et(t.CULL_FACE),e!==I&&(e===s?t.cullFace(t.BACK):e===c?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):it(t.CULL_FACE),I=e}function ot(e,i,n){e?(et(t.POLYGON_OFFSET_FILL),F===i&&U===n||(t.polygonOffset(i,n),F=i,U=n)):it(t.POLYGON_OFFSET_FILL)}function st(e){void 0===e&&(e=t.TEXTURE0+N-1),k!==e&&(t.activeTexture(e),k=e)}return tt[t.TEXTURE_2D]=$(t.TEXTURE_2D,t.TEXTURE_2D,1),tt[t.TEXTURE_CUBE_MAP]=$(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),n.setClear(0,0,0,1),r.setClear(1),a.setClear(0),et(t.DEPTH_TEST),r.setFunc(q),rt(!1),at(s),et(t.CULL_FACE),et(t.BLEND),nt(_),{buffers:{color:n,depth:r,stencil:a},initAttributes:function(){for(var t=0,e=l.length;t<e;t++)l[t]=0},enableAttribute:function(i){l[i]=1,0===u[i]&&(t.enableVertexAttribArray(i),u[i]=1),0!==d[i]&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,0),d[i]=0)},enableAttributeAndDivisor:function(i,n){l[i]=1,0===u[i]&&(t.enableVertexAttribArray(i),u[i]=1),d[i]!==n&&(e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(i,n),d[i]=n)},disableUnusedAttributes:function(){for(var e=0,i=u.length;e!==i;++e)u[e]!==l[e]&&(t.disableVertexAttribArray(e),u[e]=0)},enable:et,disable:it,getCompressedTextureFormats:function(){if(null===f&&(f=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var i=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),n=0;n<i.length;n++)f.push(i[n]);return f},useProgram:function(e){return m!==e&&(t.useProgram(e),m=e,!0)},setBlending:nt,setMaterial:function(e,i){e.side===v?it(t.CULL_FACE):et(t.CULL_FACE);var a=e.side===g;i&&(a=!a),rt(a),!0===e.transparent?nt(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):nt(M),r.setFunc(e.depthFunc),r.setTest(e.depthTest),r.setMask(e.depthWrite),n.setMask(e.colorWrite),ot(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)},setFlipSided:rt,setCullFace:at,setLineWidth:function(e){e!==D&&(B&&t.lineWidth(e),D=e)},setPolygonOffset:ot,setScissorTest:function(e){e?et(t.SCISSOR_TEST):it(t.SCISSOR_TEST)},activeTexture:st,bindTexture:function(e,i){null===k&&st();var n=H[k];void 0===n&&(n={type:void 0,texture:void 0},H[k]=n),n.type===e&&n.texture===i||(t.bindTexture(e,i||tt[e]),n.type=e,n.texture=i)},compressedTexImage2D:function(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(e){!1===G.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),G.copy(e))},viewport:function(e){!1===V.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),V.copy(e))},reset:function(){for(var e=0;e<u.length;e++)1===u[e]&&(t.disableVertexAttribArray(e),u[e]=0);p={},f=null,k=null,H={},m=null,y=null,C=null,I=null,n.reset(),r.reset(),a.reset()}}}(y,x,H)).scissor(st.copy(ft).multiplyScalar(dt)),L.viewport(ot.copy(pt).multiplyScalar(dt)),R=new function(){var t={};return{get:function(e){var i=e.uuid,n=t[i];return void 0===n&&(n={},t[i]=n),n},remove:function(e){delete t[e.uuid]},update:function(e,i,n){var r=e.uuid;t[r][i]=n},dispose:function(){t={}}}},O=new Hn(y,x,L,R,b,H,Lt,Mt),P=new function(t){var e={};return{get:function(t){return t.isInterleavedBufferAttribute&&(t=t.data),e[t.uuid]},remove:function(i){i.isInterleavedBufferAttribute&&(i=i.data);var n=e[i.uuid];n&&(t.deleteBuffer(n.buffer),delete e[i.uuid])},update:function(i,n){i.isInterleavedBufferAttribute&&(i=i.data);var r=e[i.uuid];void 0===r?e[i.uuid]=function(e,i){var n=e.array,r=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,a=t.createBuffer();t.bindBuffer(i,a),t.bufferData(i,n,r),e.onUploadCallback();var o=t.FLOAT;return n instanceof Float32Array?o=t.FLOAT:n instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):n instanceof Uint16Array?o=t.UNSIGNED_SHORT:n instanceof Int16Array?o=t.SHORT:n instanceof Uint32Array?o=t.UNSIGNED_INT:n instanceof Int32Array?o=t.INT:n instanceof Int8Array?o=t.BYTE:n instanceof Uint8Array&&(o=t.UNSIGNED_BYTE),{buffer:a,type:o,bytesPerElement:n.BYTES_PER_ELEMENT,version:e.version}}(i,n):r.version<i.version&&(function(e,i,n){var r=i.array,a=i.updateRange;t.bindBuffer(n,e),!1===i.dynamic?t.bufferData(n,r,t.STATIC_DRAW):-1===a.count?t.bufferSubData(n,0,r):0===a.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(n,a.offset*r.BYTES_PER_ELEMENT,r.subarray(a.offset,a.offset+a.count)),a.count=-1)}(r.buffer,i,n),r.version=i.version)}}}(y),C=new function(t,e,i){var n={},r={};function a(t){var o=t.target,s=n[o.id];for(var c in null!==s.index&&e.remove(s.index),s.attributes)e.remove(s.attributes[c]);o.removeEventListener("dispose",a),delete n[o.id];var h=r[o.id];h&&(e.remove(h),delete r[o.id]),(h=r[s.id])&&(e.remove(h),delete r[s.id]),i.geometries--}return{get:function(t,e){var r=n[e.id];return r||(e.addEventListener("dispose",a),e.isBufferGeometry?r=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new yn).setFromObject(t)),r=e._bufferGeometry),n[e.id]=r,i.geometries++,r)},update:function(i){var n=i.index,r=i.attributes;for(var a in null!==n&&e.update(n,t.ELEMENT_ARRAY_BUFFER),r)e.update(r[a],t.ARRAY_BUFFER);var o=i.morphAttributes;for(var a in o)for(var s=o[a],c=0,h=s.length;c<h;c++)e.update(s[c],t.ARRAY_BUFFER)},getWireframeAttribute:function(i){var n=r[i.id];if(n)return n;var a,o=[],s=i.index,c=i.attributes;if(null!==s)for(var h=0,l=(a=s.array).length;h<l;h+=3){var u=a[h+0],d=a[h+1],p=a[h+2];o.push(u,d,d,p,p,u)}else for(h=0,l=(a=c.position.array).length/3-1;h<l;h+=3)u=h+0,d=h+1,p=h+2,o.push(u,d,d,p,p,u);return n=new(gn(o)>65535?dn:ln)(o,1),e.update(n,t.ELEMENT_ARRAY_BUFFER),r[i.id]=n,n}}}(y,P,Lt),I=new function(t,e){var i={};return{update:function(n){var r=e.frame,a=n.geometry,o=t.get(n,a);return i[o.id]!==r&&(a.isGeometry&&o.updateFromObject(n),t.update(o),i[o.id]=r),o},dispose:function(){i={}}}}(C,Mt),B=new function(t){var e={},i=new Float32Array(8);return{update:function(n,r,a,o){var s=n.morphTargetInfluences,c=s.length,h=e[r.id];if(void 0===h){h=[];for(var l=0;l<c;l++)h[l]=[l,0];e[r.id]=h}var u=a.morphTargets&&r.morphAttributes.position,d=a.morphNormals&&r.morphAttributes.normal;for(l=0;l<c;l++)0!==(p=h[l])[1]&&(u&&r.removeAttribute("morphTarget"+l),d&&r.removeAttribute("morphNormal"+l));for(l=0;l<c;l++)(p=h[l])[0]=l,p[1]=s[l];for(h.sort(Pn),l=0;l<8;l++){var p;if(p=h[l]){var f=p[0],m=p[1];if(m){u&&r.addAttribute("morphTarget"+l,u[f]),d&&r.addAttribute("morphNormal"+l,d[f]),i[l]=m;continue}}i[l]=0}o.getUniforms().setValue(t,"morphTargetInfluences",i)}}}(y),D=new kn(G,x,b),F=new function(){var t={};return{get:function(e,i){var n=e.id+","+i.id,r=t[n];return void 0===r&&(r=new function(){var t=[],e=0,i=[],n=[];return{opaque:i,transparent:n,init:function(){e=0,i.length=0,n.length=0},push:function(r,a,o,s,c){var h=t[e];void 0===h?(h={id:r.id,object:r,geometry:a,material:o,program:o.program,renderOrder:r.renderOrder,z:s,group:c},t[e]=h):(h.id=r.id,h.object=r,h.geometry=a,h.material=o,h.program=o.program,h.renderOrder=r.renderOrder,h.z=s,h.group=c),(!0===o.transparent?n:i).push(h),e++},sort:function(){i.length>1&&i.sort(Rn),n.length>1&&n.sort(On)}}},t[n]=r),r},dispose:function(){t={}}}},U=new qn,N=new function(t,e,i,n){var r,a,o,s=new Di(0),c=0;function h(t,i){e.buffers.color.setClear(t.r,t.g,t.b,i,n)}return{getClearColor:function(){return s},setClearColor:function(t,e){s.set(t),h(s,c=void 0!==e?e:1)},getClearAlpha:function(){return c},setClearAlpha:function(t){h(s,c=t)},render:function(e,n,l,u){var d=n.background;null===d?h(s,c):d&&d.isColor&&(h(d,1),u=!0),(t.autoClear||u)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),d&&d.isCubeTexture?(void 0===o&&((o=new Tn(new wn(1,1,1),new _n({uniforms:Bi.cube.uniforms,vertexShader:Bi.cube.vertexShader,fragmentShader:Bi.cube.fragmentShader,side:g,depthTest:!0,depthWrite:!1,fog:!1}))).geometry.removeAttribute("normal"),o.geometry.removeAttribute("uv"),o.onBeforeRender=function(t,e,i){this.matrixWorld.copyPosition(i.matrixWorld)},i.update(o.geometry)),o.material.uniforms.tCube.value=d,e.push(o,o.geometry,o.material,0,null)):d&&d.isTexture&&(void 0===r&&(r=new tn(-1,1,1,-1,0,1),a=new Tn(new Ln(2,2),new Mn({depthTest:!1,depthWrite:!1,fog:!1})),i.update(a.geometry)),a.material.map=d,t.renderBufferDirect(r,null,a.geometry,a.material,a,null))}}}(G,L,C,u),W=new function(t,e,i){var n;this.setMode=function(t){n=t},this.render=function(e,r){t.drawArrays(n,e,r),i.calls++,i.vertices+=r,n===t.TRIANGLES?i.faces+=r/3:n===t.POINTS&&(i.points+=r)},this.renderInstances=function(r,a,o){var s=e.get("ANGLE_instanced_arrays");if(null!==s){var c=r.attributes.position;c.isInterleavedBufferAttribute?(o=c.data.count,s.drawArraysInstancedANGLE(n,0,o,r.maxInstancedCount)):s.drawArraysInstancedANGLE(n,a,o,r.maxInstancedCount),i.calls++,i.vertices+=o*r.maxInstancedCount,n===t.TRIANGLES?i.faces+=r.maxInstancedCount*o/3:n===t.POINTS&&(i.points+=r.maxInstancedCount*o)}else console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(y,x,Mt),z=new function(t,e,i){var n,r,a;this.setMode=function(t){n=t},this.setIndex=function(t){r=t.type,a=t.bytesPerElement},this.render=function(e,o){t.drawElements(n,o,r,e*a),i.calls++,i.vertices+=o,n===t.TRIANGLES?i.faces+=o/3:n===t.POINTS&&(i.points+=o)},this.renderInstances=function(o,s,c){var h=e.get("ANGLE_instanced_arrays");null!==h?(h.drawElementsInstancedANGLE(n,c,r,s*a,o.maxInstancedCount),i.calls++,i.vertices+=c*o.maxInstancedCount,n===t.TRIANGLES?i.faces+=o.maxInstancedCount*c/3:n===t.POINTS&&(i.points+=o.maxInstancedCount*c)):console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.")}}(y,x,Mt),k=new function(t,e,i,n,r){var a,o,s,c,h,l,u=new We,d=new Be,p=new We;function f(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),i=new Uint16Array([0,1,2,0,2,3]);a=e.createBuffer(),o=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,a),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.bufferData(e.ELEMENT_ARRAY_BUFFER,i,e.STATIC_DRAW),s=function(){var t=e.createProgram(),i=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(i,["precision "+r.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(n,["precision "+r.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(i),e.compileShader(n),e.attachShader(t,i),e.attachShader(t,n),e.linkProgram(t),t}(),c={position:e.getAttribLocation(s,"position"),uv:e.getAttribLocation(s,"uv")},h={uvOffset:e.getUniformLocation(s,"uvOffset"),uvScale:e.getUniformLocation(s,"uvScale"),rotation:e.getUniformLocation(s,"rotation"),center:e.getUniformLocation(s,"center"),scale:e.getUniformLocation(s,"scale"),color:e.getUniformLocation(s,"color"),map:e.getUniformLocation(s,"map"),opacity:e.getUniformLocation(s,"opacity"),modelViewMatrix:e.getUniformLocation(s,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(s,"projectionMatrix"),fogType:e.getUniformLocation(s,"fogType"),fogDensity:e.getUniformLocation(s,"fogDensity"),fogNear:e.getUniformLocation(s,"fogNear"),fogFar:e.getUniformLocation(s,"fogFar"),fogColor:e.getUniformLocation(s,"fogColor"),fogDepth:e.getUniformLocation(s,"fogDepth"),alphaTest:e.getUniformLocation(s,"alphaTest")};var n=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");n.width=8,n.height=8;var u=n.getContext("2d");u.fillStyle="white",u.fillRect(0,0,8,8),l=new Wi(n)}function m(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}this.render=function(r,g,v){if(0!==r.length){void 0===s&&f(),i.useProgram(s),i.initAttributes(),i.enableAttribute(c.position),i.enableAttribute(c.uv),i.disableUnusedAttributes(),i.disable(e.CULL_FACE),i.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,a),e.vertexAttribPointer(c.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(c.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,o),e.uniformMatrix4fv(h.projectionMatrix,!1,v.projectionMatrix.elements),i.activeTexture(e.TEXTURE0),e.uniform1i(h.map,0);var y=0,x=0,w=g.fog;w?(e.uniform3f(h.fogColor,w.color.r,w.color.g,w.color.b),w.isFog?(e.uniform1f(h.fogNear,w.near),e.uniform1f(h.fogFar,w.far),e.uniform1i(h.fogType,1),y=1,x=1):w.isFogExp2&&(e.uniform1f(h.fogDensity,w.density),e.uniform1i(h.fogType,2),y=2,x=2)):(e.uniform1i(h.fogType,0),y=0,x=0);for(var b=0,L=r.length;b<L;b++)(A=r[b]).modelViewMatrix.multiplyMatrices(v.matrixWorldInverse,A.matrixWorld),A.z=-A.modelViewMatrix.elements[14];r.sort(m);var M=[],_=[];for(b=0,L=r.length;b<L;b++){var A,E=(A=r[b]).material;if(!1!==E.visible){A.onBeforeRender(t,g,v,void 0,E,void 0),e.uniform1f(h.alphaTest,E.alphaTest),e.uniformMatrix4fv(h.modelViewMatrix,!1,A.modelViewMatrix.elements),A.matrixWorld.decompose(u,d,p),M[0]=p.x,M[1]=p.y,_[0]=A.center.x-.5,_[1]=A.center.y-.5;var S=0;g.fog&&E.fog&&(S=x),y!==S&&(e.uniform1i(h.fogType,S),y=S),null!==E.map?(e.uniform2f(h.uvOffset,E.map.offset.x,E.map.offset.y),e.uniform2f(h.uvScale,E.map.repeat.x,E.map.repeat.y)):(e.uniform2f(h.uvOffset,0,0),e.uniform2f(h.uvScale,1,1)),e.uniform1f(h.opacity,E.opacity),e.uniform3f(h.color,E.color.r,E.color.g,E.color.b),e.uniform1f(h.rotation,E.rotation),e.uniform2fv(h.center,_),e.uniform2fv(h.scale,M),i.setBlending(E.blending,E.blendEquation,E.blendSrc,E.blendDst,E.blendEquationAlpha,E.blendSrcAlpha,E.blendDstAlpha,E.premultipliedAlpha),i.buffers.depth.setTest(E.depthTest),i.buffers.depth.setMask(E.depthWrite),i.buffers.color.setMask(E.colorWrite),n.setTexture2D(E.map||l,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),A.onAfterRender(t,g,v,void 0,E,void 0)}}i.enable(e.CULL_FACE),i.reset()}}}(G,y,L,O,b),G.info.programs=D.programs,G.context=y,G.capabilities=b,G.extensions=x,G.properties=R,G.renderLists=F,G.state=L}St();var Tt=new jn(G);this.vr=Tt;var Rt=new qi(G,I,b.maxTextureSize);function Ct(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),V=!0}function It(){console.log("THREE.WebGLRenderer: Context Restored."),V=!1,St()}function Dt(t){var e=t.target;e.removeEventListener("dispose",Dt),function(t){Ft(t),R.remove(t)}(e)}function Ft(t){var e=R.get(t).program;t.program=void 0,void 0!==e&&D.releaseProgram(e)}this.shadowMap=Rt,this.getContext=function(){return y},this.getContextAttributes=function(){return y.getContextAttributes()},this.forceContextLoss=function(){var t=x.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=x.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return dt},this.setPixelRatio=function(t){void 0!==t&&(dt=t,this.setSize(lt,ut,!1))},this.getSize=function(){return{width:lt,height:ut}},this.setSize=function(t,i,n){var r=Tt.getDevice();r&&r.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(lt=t,ut=i,e.width=t*dt,e.height=i*dt,!1!==n&&(e.style.width=t+"px",e.style.height=i+"px"),this.setViewport(0,0,t,i))},this.getDrawingBufferSize=function(){return{width:lt*dt,height:ut*dt}},this.setDrawingBufferSize=function(t,i,n){lt=t,ut=i,dt=n,e.width=t*n,e.height=i*n,this.setViewport(0,0,t,i)},this.getCurrentViewport=function(){return ot},this.setViewport=function(t,e,i,n){pt.set(t,ut-e-n,i,n),L.viewport(ot.copy(pt).multiplyScalar(dt))},this.setScissor=function(t,e,i,n){ft.set(t,ut-e-n,i,n),L.scissor(st.copy(ft).multiplyScalar(dt))},this.setScissorTest=function(t){L.setScissorTest(mt=t)},this.getClearColor=function(){return N.getClearColor()},this.setClearColor=function(){N.setClearColor.apply(N,arguments)},this.getClearAlpha=function(){return N.getClearAlpha()},this.setClearAlpha=function(){N.setClearAlpha.apply(N,arguments)},this.clear=function(t,e,i){var n=0;(void 0===t||t)&&(n|=y.COLOR_BUFFER_BIT),(void 0===e||e)&&(n|=y.DEPTH_BUFFER_BIT),(void 0===i||i)&&(n|=y.STENCIL_BUFFER_BIT),y.clear(n)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,i,n){this.setRenderTarget(t),this.clear(e,i,n)},this.dispose=function(){e.removeEventListener("webglcontextlost",Ct,!1),e.removeEventListener("webglcontextrestored",It,!1),F.dispose(),U.dispose(),R.dispose(),I.dispose(),Tt.dispose(),Wt()},this.renderBufferImmediate=function(t,e,i){L.initAttributes();var n=R.get(t);t.hasPositions&&!n.position&&(n.position=y.createBuffer()),t.hasNormals&&!n.normal&&(n.normal=y.createBuffer()),t.hasUvs&&!n.uv&&(n.uv=y.createBuffer()),t.hasColors&&!n.color&&(n.color=y.createBuffer());var r=e.getAttributes();if(t.hasPositions&&(y.bindBuffer(y.ARRAY_BUFFER,n.position),y.bufferData(y.ARRAY_BUFFER,t.positionArray,y.DYNAMIC_DRAW),L.enableAttribute(r.position),y.vertexAttribPointer(r.position,3,y.FLOAT,!1,0,0)),t.hasNormals){if(y.bindBuffer(y.ARRAY_BUFFER,n.normal),!i.isMeshPhongMaterial&&!i.isMeshStandardMaterial&&!i.isMeshNormalMaterial&&!0===i.flatShading)for(var a=0,o=3*t.count;a<o;a+=9){var s=t.normalArray,c=(s[a+0]+s[a+3]+s[a+6])/3,h=(s[a+1]+s[a+4]+s[a+7])/3,l=(s[a+2]+s[a+5]+s[a+8])/3;s[a+0]=c,s[a+1]=h,s[a+2]=l,s[a+3]=c,s[a+4]=h,s[a+5]=l,s[a+6]=c,s[a+7]=h,s[a+8]=l}y.bufferData(y.ARRAY_BUFFER,t.normalArray,y.DYNAMIC_DRAW),L.enableAttribute(r.normal),y.vertexAttribPointer(r.normal,3,y.FLOAT,!1,0,0)}t.hasUvs&&i.map&&(y.bindBuffer(y.ARRAY_BUFFER,n.uv),y.bufferData(y.ARRAY_BUFFER,t.uvArray,y.DYNAMIC_DRAW),L.enableAttribute(r.uv),y.vertexAttribPointer(r.uv,2,y.FLOAT,!1,0,0)),t.hasColors&&i.vertexColors!==w&&(y.bindBuffer(y.ARRAY_BUFFER,n.color),y.bufferData(y.ARRAY_BUFFER,t.colorArray,y.DYNAMIC_DRAW),L.enableAttribute(r.color),y.vertexAttribPointer(r.color,3,y.FLOAT,!1,0,0)),L.disableUnusedAttributes(),y.drawArrays(y.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,e,i,n,r,a){var o=r.isMesh&&r.matrixWorld.determinant()<0;L.setMaterial(n,o);var s=jt(t,e,n,r),c=i.id+"_"+s.id+"_"+(!0===n.wireframe),h=!1;c!==it&&(it=c,h=!0),r.morphTargetInfluences&&(B.update(r,i,n,s),h=!0);var l,u=i.index,d=i.attributes.position,p=1;!0===n.wireframe&&(u=C.getWireframeAttribute(i),p=2);var f=W;null!==u&&(l=P.get(u),(f=z).setIndex(l)),h&&(function(t,e,i,n){if(i&&i.isInstancedBufferGeometry&&null===x.get("ANGLE_instanced_arrays"))console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");else{void 0===n&&(n=0),L.initAttributes();var r=i.attributes,a=e.getAttributes(),o=t.defaultAttributeValues;for(var s in a){var c=a[s];if(c>=0){var h=r[s];if(void 0!==h){var l=h.normalized,u=h.itemSize,d=P.get(h);if(void 0===d)continue;var p=d.buffer,f=d.type,m=d.bytesPerElement;if(h.isInterleavedBufferAttribute){var g=h.data,v=g.stride,w=h.offset;g&&g.isInstancedInterleavedBuffer?(L.enableAttributeAndDivisor(c,g.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=g.meshPerAttribute*g.count)):L.enableAttribute(c),y.bindBuffer(y.ARRAY_BUFFER,p),y.vertexAttribPointer(c,u,f,l,v*m,(n*v+w)*m)}else h.isInstancedBufferAttribute?(L.enableAttributeAndDivisor(c,h.meshPerAttribute),void 0===i.maxInstancedCount&&(i.maxInstancedCount=h.meshPerAttribute*h.count)):L.enableAttribute(c),y.bindBuffer(y.ARRAY_BUFFER,p),y.vertexAttribPointer(c,u,f,l,0,n*u*m)}else if(void 0!==o){var b=o[s];if(void 0!==b)switch(b.length){case 2:y.vertexAttrib2fv(c,b);break;case 3:y.vertexAttrib3fv(c,b);break;case 4:y.vertexAttrib4fv(c,b);break;default:y.vertexAttrib1fv(c,b)}}}}L.disableUnusedAttributes()}}(n,s,i),null!==u&&y.bindBuffer(y.ELEMENT_ARRAY_BUFFER,l.buffer));var m=1/0;null!==u?m=u.count:void 0!==d&&(m=d.count);var g=i.drawRange.start*p,v=i.drawRange.count*p,w=null!==a?a.start*p:0,b=null!==a?a.count*p:1/0,M=Math.max(g,w),_=Math.min(m,g+v,w+b)-1,A=Math.max(0,_-M+1);if(0!==A){if(r.isMesh)if(!0===n.wireframe)L.setLineWidth(n.wireframeLinewidth*At()),f.setMode(y.LINES);else switch(r.drawMode){case Le:f.setMode(y.TRIANGLES);break;case Me:f.setMode(y.TRIANGLE_STRIP);break;case _e:f.setMode(y.TRIANGLE_FAN)}else if(r.isLine){var E=n.linewidth;void 0===E&&(E=1),L.setLineWidth(E*At()),r.isLineSegments?f.setMode(y.LINES):r.isLineLoop?f.setMode(y.LINE_LOOP):f.setMode(y.LINE_STRIP)}else r.isPoints&&f.setMode(y.POINTS);i&&i.isInstancedBufferGeometry?i.maxInstancedCount>0&&f.renderInstances(i,M,A):f.render(M,A)}},this.compile=function(t,e){(m=U.get(t,e)).init(),t.traverse(function(t){t.isLight&&(m.pushLight(t),t.castShadow&&m.pushShadow(t))}),m.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var i=0;i<e.material.length;i++)Vt(e.material[i],t.fog,e);else Vt(e.material,t.fog,e)})};var Ut=!1,Nt=null;function Wt(){Ut=!1}function zt(){var t=Tt.getDevice();t&&t.isPresenting?t.requestAnimationFrame(kt):window.requestAnimationFrame(kt)}function kt(t){!1!==Ut&&(Nt(t),zt())}function Ht(t,e,i,n){for(var r=0,a=t.length;r<a;r++){var o=t[r],s=o.object,c=o.geometry,h=void 0===n?o.material:n,l=o.group;if(i.isArrayCamera){at=i;for(var u=i.cameras,d=0,p=u.length;d<p;d++){var f=u[d];if(s.layers.test(f.layers)){var m=f.bounds,g=m.x*lt,v=m.y*ut,y=m.z*lt,x=m.w*ut;L.viewport(ot.set(g,v,y,x).multiplyScalar(dt)),Gt(s,e,f,c,h,l)}}}else at=null,Gt(s,e,i,c,h,l)}}function Gt(t,e,i,n,r,a){if(t.onBeforeRender(G,e,i,n,r,a),m=U.get(e,at||i),t.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var o=t.isMesh&&t.matrixWorld.determinant()<0;L.setMaterial(r,o);var s=jt(i,e.fog,r,t);it="",function(t,e,i){t.render(function(t){G.renderBufferImmediate(t,e,i)})}(t,s,r)}else G.renderBufferDirect(i,e.fog,n,r,t,a);t.onAfterRender(G,e,i,n,r,a),m=U.get(e,at||i)}function Vt(t,e,i){var n=R.get(t),r=m.state.lights,a=m.state.shadowsArray,o=D.getParameters(t,r.state,a,e,vt.numPlanes,vt.numIntersection,i),s=D.getProgramCode(t,o),c=n.program,h=!0;if(void 0===c)t.addEventListener("dispose",Dt);else if(c.code!==s)Ft(t);else if(n.lightsHash!==r.state.hash)R.update(t,"lightsHash",r.state.hash),h=!1;else{if(void 0!==o.shaderID)return;h=!1}if(h){if(o.shaderID){var l=Bi[o.shaderID];n.shader={name:t.type,uniforms:Ui.clone(l.uniforms),vertexShader:l.vertexShader,fragmentShader:l.fragmentShader}}else n.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(n.shader),c=D.acquireProgram(t,n.shader,o,s),n.program=c,t.program=c}var u=c.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var d=0;d<G.maxMorphTargets;d++)u["morphTarget"+d]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals)for(t.numSupportedMorphNormals=0,d=0;d<G.maxMorphNormals;d++)u["morphNormal"+d]>=0&&t.numSupportedMorphNormals++;var p=n.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(n.numClippingPlanes=vt.numPlanes,n.numIntersection=vt.numIntersection,p.clippingPlanes=vt.uniform),n.fog=e,n.lightsHash=r.state.hash,t.lights&&(p.ambientLightColor.value=r.state.ambient,p.directionalLights.value=r.state.directional,p.spotLights.value=r.state.spot,p.rectAreaLights.value=r.state.rectArea,p.pointLights.value=r.state.point,p.hemisphereLights.value=r.state.hemi,p.directionalShadowMap.value=r.state.directionalShadowMap,p.directionalShadowMatrix.value=r.state.directionalShadowMatrix,p.spotShadowMap.value=r.state.spotShadowMap,p.spotShadowMatrix.value=r.state.spotShadowMatrix,p.pointShadowMap.value=r.state.pointShadowMap,p.pointShadowMatrix.value=r.state.pointShadowMatrix);var f=n.program.getUniforms(),g=Ci.seqWithValue(f.seq,p);n.uniformsList=g}function jt(t,e,i,n){ht=0;var r=R.get(i),a=m.state.lights;if(yt&&(xt||t!==rt)){var o=t===rt&&i.id===et;vt.setState(i.clippingPlanes,i.clipIntersection,i.clipShadows,t,r,o)}!1===i.needsUpdate&&(void 0===r.program?i.needsUpdate=!0:i.fog&&r.fog!==e?i.needsUpdate=!0:i.lights&&r.lightsHash!==a.state.hash?i.needsUpdate=!0:void 0===r.numClippingPlanes||r.numClippingPlanes===vt.numPlanes&&r.numIntersection===vt.numIntersection||(i.needsUpdate=!0)),i.needsUpdate&&(Vt(i,e,n),i.needsUpdate=!1);var s=!1,c=!1,h=!1,l=r.program,u=l.getUniforms(),d=r.shader.uniforms;if(L.useProgram(l.program)&&(s=!0,c=!0,h=!0),i.id!==et&&(et=i.id,c=!0),s||t!==rt){if(u.setValue(y,"projectionMatrix",t.projectionMatrix),b.logarithmicDepthBuffer&&u.setValue(y,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),rt!==(at||t)&&(rt=at||t,c=!0,h=!0),i.isShaderMaterial||i.isMeshPhongMaterial||i.isMeshStandardMaterial||i.envMap){var p=u.map.cameraPosition;void 0!==p&&p.setValue(y,bt.setFromMatrixPosition(t.matrixWorld))}(i.isMeshPhongMaterial||i.isMeshLambertMaterial||i.isMeshBasicMaterial||i.isMeshStandardMaterial||i.isShaderMaterial||i.skinning)&&u.setValue(y,"viewMatrix",t.matrixWorldInverse)}if(i.skinning){u.setOptional(y,n,"bindMatrix"),u.setOptional(y,n,"bindMatrixInverse");var f=n.skeleton;if(f){var g=f.bones;if(b.floatVertexTextures){if(void 0===f.boneTexture){var v=Math.sqrt(4*g.length);v=Fe.ceilPowerOfTwo(v),v=Math.max(v,4);var x=new Float32Array(v*v*4);x.set(f.boneMatrices);var w=new Ye(x,v,v,Bt,Ot);w.needsUpdate=!0,f.boneMatrices=x,f.boneTexture=w,f.boneTextureSize=v}u.setValue(y,"boneTexture",f.boneTexture),u.setValue(y,"boneTextureSize",f.boneTextureSize)}else u.setOptional(y,f,"boneMatrices")}}return c&&(u.setValue(y,"toneMappingExposure",G.toneMappingExposure),u.setValue(y,"toneMappingWhitePoint",G.toneMappingWhitePoint),i.lights&&function(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}(d,h),e&&i.fog&&function(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}(d,e),i.isMeshBasicMaterial?Yt(d,i):i.isMeshLambertMaterial?(Yt(d,i),function(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}(d,i)):i.isMeshPhongMaterial?(Yt(d,i),i.isMeshToonMaterial?function(t,e){Xt(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}(d,i):Xt(d,i)):i.isMeshStandardMaterial?(Yt(d,i),i.isMeshPhysicalMaterial?function(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,qt(t,e)}(d,i):qt(d,i)):i.isMeshDepthMaterial?(Yt(d,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(d,i)):i.isMeshDistanceMaterial?(Yt(d,i),function(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}(d,i)):i.isMeshNormalMaterial?(Yt(d,i),function(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}(d,i)):i.isLineBasicMaterial?(function(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}(d,i),i.isLineDashedMaterial&&function(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}(d,i)):i.isPointsMaterial?function(t,e){if(t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*dt,t.scale.value=.5*ut,t.map.value=e.map,null!==e.map){if(!0===e.map.matrixAutoUpdate){var i=e.map.offset,n=e.map.repeat,r=e.map.rotation,a=e.map.center;e.map.matrix.setUvTransform(i.x,i.y,n.x,n.y,r,a.x,a.y)}t.uvTransform.value.copy(e.map.matrix)}}(d,i):i.isShadowMaterial&&(d.color.value=i.color,d.opacity.value=i.opacity),void 0!==d.ltc_1&&(d.ltc_1.value=Fi.LTC_1),void 0!==d.ltc_2&&(d.ltc_2.value=Fi.LTC_2),Ci.upload(y,r.uniformsList,d,G)),i.isShaderMaterial&&!0===i.uniformsNeedUpdate&&(Ci.upload(y,r.uniformsList,d,G),i.uniformsNeedUpdate=!1),u.setValue(y,"modelViewMatrix",n.modelViewMatrix),u.setValue(y,"normalMatrix",n.normalMatrix),u.setValue(y,"modelMatrix",n.matrixWorld),l}function Yt(t,e){var i;if(t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity),e.map?i=e.map:e.specularMap?i=e.specularMap:e.displacementMap?i=e.displacementMap:e.normalMap?i=e.normalMap:e.bumpMap?i=e.bumpMap:e.roughnessMap?i=e.roughnessMap:e.metalnessMap?i=e.metalnessMap:e.alphaMap?i=e.alphaMap:e.emissiveMap&&(i=e.emissiveMap),void 0!==i){if(i.isWebGLRenderTarget&&(i=i.texture),!0===i.matrixAutoUpdate){var n=i.offset,r=i.repeat,a=i.rotation,o=i.center;i.matrix.setUvTransform(n.x,n.y,r.x,r.y,a,o.x,o.y)}t.uvTransform.value.copy(i.matrix)}}function Xt(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function qt(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}this.animate=function(t){null!==(Nt=t)?Ut||(zt(),Ut=!0):Wt()},this.render=function(t,e,i,n){if(e&&e.isCamera){if(!V){it="",et=-1,rt=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),Tt.enabled&&(e=Tt.getCamera(e)),(m=U.get(t,e)).init(),t.onBeforeRender(G,t,e,i),wt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),gt.setFromMatrix(wt),xt=this.localClippingEnabled,yt=vt.init(this.clippingPlanes,xt,e),(f=F.get(t,e)).init(),function t(e,i,n){if(!1!==e.visible){if(e.layers.test(i.layers))if(e.isLight)m.pushLight(e),e.castShadow&&m.pushShadow(e);else if(e.isSprite)e.frustumCulled&&!gt.intersectsSprite(e)||m.pushSprite(e);else if(e.isImmediateRenderObject)n&&bt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(wt),f.push(e,null,e.material,bt.z,null);else if((e.isMesh||e.isLine||e.isPoints)&&(e.isSkinnedMesh&&e.skeleton.update(),!e.frustumCulled||gt.intersectsObject(e))){n&&bt.setFromMatrixPosition(e.matrixWorld).applyMatrix4(wt);var r=I.update(e),a=e.material;if(Array.isArray(a))for(var o=r.groups,s=0,c=o.length;s<c;s++){var h=o[s],l=a[h.materialIndex];l&&l.visible&&f.push(e,r,l,bt.z,h)}else a.visible&&f.push(e,r,a,bt.z,null)}var u=e.children;for(s=0,c=u.length;s<c;s++)t(u[s],i,n)}}(t,e,G.sortObjects),!0===G.sortObjects&&f.sort(),yt&&vt.beginShadows();var r=m.state.shadowsArray;Rt.render(r,t,e),m.setupLights(e),yt&&vt.endShadows(),this.info.autoReset&&this.info.reset(),void 0===i&&(i=null),this.setRenderTarget(i),N.render(f,t,e,n);var a=f.opaque,o=f.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;a.length&&Ht(a,t,e,s),o.length&&Ht(o,t,e,s)}else a.length&&Ht(a,t,e),o.length&&Ht(o,t,e);var c=m.state.spritesArray;k.render(c,t,e),i&&O.updateRenderTargetMipmap(i),L.buffers.depth.setTest(!0),L.buffers.depth.setMask(!0),L.buffers.color.setMask(!0),L.setPolygonOffset(!1),t.onAfterRender(G,t,e),Tt.enabled&&Tt.submitFrame(),f=null,m=null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.allocTextureUnit=function(){var t=ht;return t>=b.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+b.maxTextures),ht+=1,t},this.setTexture2D=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),O.setTexture2D(e,i)}}(),this.setTexture=function(){var t=!1;return function(e,i){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),O.setTexture2D(e,i)}}(),this.setTextureCube=function(){var t=!1;return function(e,i){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?O.setTextureCube(e,i):O.setTextureCubeDynamic(e,i)}}(),this.getRenderTarget=function(){return $},this.setRenderTarget=function(t){$=t,t&&void 0===R.get(t).__webglFramebuffer&&O.setupRenderTarget(t);var e=null,i=!1;if(t){var n=R.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=n[t.activeCubeFace],i=!0):e=n,ot.copy(t.viewport),st.copy(t.scissor),ct=t.scissorTest}else ot.copy(pt).multiplyScalar(dt),st.copy(ft).multiplyScalar(dt),ct=mt;if(tt!==e&&(y.bindFramebuffer(y.FRAMEBUFFER,e),tt=e),L.viewport(ot),L.scissor(st),L.setScissorTest(ct),i){var r=R.get(t.texture);y.framebufferTexture2D(y.FRAMEBUFFER,y.COLOR_ATTACHMENT0,y.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,r.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,i,n,r,a){if(t&&t.isWebGLRenderTarget){var o=R.get(t).__webglFramebuffer;if(o){var s=!1;o!==tt&&(y.bindFramebuffer(y.FRAMEBUFFER,o),s=!0);try{var c=t.texture,h=c.format,l=c.type;if(h!==Bt&&H.convert(h)!==y.getParameter(y.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(!(l===_t||H.convert(l)===y.getParameter(y.IMPLEMENTATION_COLOR_READ_TYPE)||l===Ot&&(x.get("OES_texture_float")||x.get("WEBGL_color_buffer_float"))||l===Pt&&x.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");y.checkFramebufferStatus(y.FRAMEBUFFER)===y.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-n&&i>=0&&i<=t.height-r&&y.readPixels(e,i,n,r,H.convert(h),H.convert(l),a):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&y.bindFramebuffer(y.FRAMEBUFFER,tt)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(t,e,i){var n=e.image.width,r=e.image.height,a=H.convert(e.format);this.setTexture2D(e,0),y.copyTexImage2D(y.TEXTURE_2D,i||0,a,t.x,t.y,n,r,0)}}function Jn(t,e){this.name="",this.color=new Di(t),this.density=void 0!==e?e:25e-5}function Kn(t,e,i){this.name="",this.color=new Di(t),this.near=void 0!==e?e:1,this.far=void 0!==i?i:1e3}function Qn(){Qi.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function $n(t){ki.call(this),this.type="SpriteMaterial",this.color=new Di(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function tr(t){Qi.call(this),this.type="Sprite",this.material=void 0!==t?t:new $n,this.center=new Ue(.5,.5)}function er(){Qi.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function ir(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var i=0,n=this.bones.length;i<n;i++)this.boneInverses.push(new Ne)}}function nr(){Qi.call(this),this.type="Bone"}function rr(t,e){Tn.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Ne,this.bindMatrixInverse=new Ne;var i=new ir(this.initBones());this.bind(i,this.matrixWorld),this.normalizeSkinWeights()}function ar(t){ki.call(this),this.type="LineBasicMaterial",this.color=new Di(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function or(t,e,i){if(1===i)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new sr(t,e);Qi.call(this),this.type="Line",this.geometry=void 0!==t?t:new yn,this.material=void 0!==e?e:new ar({color:16777215*Math.random()})}function sr(t,e){or.call(this,t,e),this.type="LineSegments"}function cr(t,e){or.call(this,t,e),this.type="LineLoop"}function hr(t){ki.call(this),this.type="PointsMaterial",this.color=new Di(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function lr(t,e){Qi.call(this),this.type="Points",this.geometry=void 0!==t?t:new yn,this.material=void 0!==e?e:new hr({color:16777215*Math.random()})}function ur(){Qi.call(this),this.type="Group"}function dr(t,e,i,n,r,a,o,s,c){He.call(this,t,e,i,n,r,a,o,s,c),this.generateMipmaps=!1}function pr(t,e,i,n,r,a,o,s,c,h,l,u){He.call(this,null,a,o,s,c,h,n,r,l,u),this.image={width:e,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function fr(t,e,i,n,r,a,o,s,c,h){if((h=void 0!==h?h:Ht)!==Ht&&h!==Gt)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===i&&h===Ht&&(i=St),void 0===i&&h===Gt&&(i=Ft),He.call(this,null,n,r,a,o,s,h,i,c),this.image={width:t,height:e},this.magFilter=void 0!==o?o:yt,this.minFilter=void 0!==s?s:yt,this.flipY=!1,this.generateMipmaps=!1}function mr(t){yn.call(this),this.type="WireframeGeometry";var e,i,n,r,a,o,s,c,h,l,u=[],d=[0,0],p={},f=["a","b","c"];if(t&&t.isGeometry){var m=t.faces;for(e=0,n=m.length;e<n;e++){var g=m[e];for(i=0;i<3;i++)s=g[f[i]],c=g[f[(i+1)%3]],d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[h=d[0]+","+d[1]]&&(p[h]={index1:d[0],index2:d[1]})}for(h in p)o=p[h],l=t.vertices[o.index1],u.push(l.x,l.y,l.z),l=t.vertices[o.index2],u.push(l.x,l.y,l.z)}else if(t&&t.isBufferGeometry){var v,y,x,w,b,L,M;if(l=new We,null!==t.index){for(v=t.attributes.position,y=t.index,0===(x=t.groups).length&&(x=[{start:0,count:y.count,materialIndex:0}]),r=0,a=x.length;r<a;++r)for(e=b=(w=x[r]).start,n=b+w.count;e<n;e+=3)for(i=0;i<3;i++)s=y.getX(e+i),c=y.getX(e+(i+1)%3),d[0]=Math.min(s,c),d[1]=Math.max(s,c),void 0===p[h=d[0]+","+d[1]]&&(p[h]={index1:d[0],index2:d[1]});for(h in p)o=p[h],l.fromBufferAttribute(v,o.index1),u.push(l.x,l.y,l.z),l.fromBufferAttribute(v,o.index2),u.push(l.x,l.y,l.z)}else for(e=0,n=(v=t.attributes.position).count/3;e<n;e++)for(i=0;i<3;i++)L=3*e+i,l.fromBufferAttribute(v,L),u.push(l.x,l.y,l.z),M=3*e+(i+1)%3,l.fromBufferAttribute(v,M),u.push(l.x,l.y,l.z)}this.addAttribute("position",new pn(u,3))}function gr(t,e,i){rn.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:i},this.fromBufferGeometry(new vr(t,e,i)),this.mergeVertices()}function vr(t,e,i){yn.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:i};var n,r,a=[],o=[],s=[],c=[],h=new We,l=new We,u=new We,d=new We,p=new We,f=e+1;for(n=0;n<=i;n++){var m=n/i;for(r=0;r<=e;r++){var g=r/e;l=t(g,m,l),o.push(l.x,l.y,l.z),g-1e-5>=0?(u=t(g-1e-5,m,u),d.subVectors(l,u)):(u=t(g+1e-5,m,u),d.subVectors(u,l)),m-1e-5>=0?(u=t(g,m-1e-5,u),p.subVectors(l,u)):(u=t(g,m+1e-5,u),p.subVectors(u,l)),h.crossVectors(d,p).normalize(),s.push(h.x,h.y,h.z),c.push(g,m)}}for(n=0;n<i;n++)for(r=0;r<e;r++){var v=n*f+r,y=n*f+r+1,x=(n+1)*f+r+1,w=(n+1)*f+r;a.push(v,y,w),a.push(y,x,w)}this.setIndex(a),this.addAttribute("position",new pn(o,3)),this.addAttribute("normal",new pn(s,3)),this.addAttribute("uv",new pn(c,2))}function yr(t,e,i,n){rn.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},this.fromBufferGeometry(new xr(t,e,i,n)),this.mergeVertices()}function xr(t,e,i,n){yn.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:i,detail:n},i=i||1;var r=[],a=[];function o(t,e,i,n){var r,a,o=Math.pow(2,n),c=[];for(r=0;r<=o;r++){c[r]=[];var h=t.clone().lerp(i,r/o),l=e.clone().lerp(i,r/o),u=o-r;for(a=0;a<=u;a++)c[r][a]=0===a&&r===o?h:h.clone().lerp(l,a/u)}for(r=0;r<o;r++)for(a=0;a<2*(o-r)-1;a++){var d=Math.floor(a/2);a%2==0?(s(c[r][d+1]),s(c[r+1][d]),s(c[r][d])):(s(c[r][d+1]),s(c[r+1][d+1]),s(c[r+1][d]))}}function s(t){r.push(t.x,t.y,t.z)}function c(e,i){var n=3*e;i.x=t[n+0],i.y=t[n+1],i.z=t[n+2]}function h(t,e,i,n){n<0&&1===t.x&&(a[e]=t.x-1),0===i.x&&0===i.z&&(a[e]=n/2/Math.PI+.5)}function l(t){return Math.atan2(t.z,-t.x)}function u(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}!function(t){for(var i=new We,n=new We,r=new We,a=0;a<e.length;a+=3)c(e[a+0],i),c(e[a+1],n),c(e[a+2],r),o(i,n,r,t)}(n=n||0),function(t){for(var e=new We,i=0;i<r.length;i+=3)e.x=r[i+0],e.y=r[i+1],e.z=r[i+2],e.normalize().multiplyScalar(t),r[i+0]=e.x,r[i+1]=e.y,r[i+2]=e.z}(i),function(){for(var t=new We,e=0;e<r.length;e+=3){t.x=r[e+0],t.y=r[e+1],t.z=r[e+2];var i=l(t)/2/Math.PI+.5,n=u(t)/Math.PI+.5;a.push(i,1-n)}(function(){for(var t=new We,e=new We,i=new We,n=new We,o=new Ue,s=new Ue,c=new Ue,u=0,d=0;u<r.length;u+=9,d+=6){t.set(r[u+0],r[u+1],r[u+2]),e.set(r[u+3],r[u+4],r[u+5]),i.set(r[u+6],r[u+7],r[u+8]),o.set(a[d+0],a[d+1]),s.set(a[d+2],a[d+3]),c.set(a[d+4],a[d+5]),n.copy(t).add(e).add(i).divideScalar(3);var p=l(n);h(o,d+0,t,p),h(s,d+2,e,p),h(c,d+4,i,p)}})(),function(){for(var t=0;t<a.length;t+=6){var e=a[t+0],i=a[t+2],n=a[t+4],r=Math.max(e,i,n),o=Math.min(e,i,n);r>.9&&o<.1&&(e<.2&&(a[t+0]+=1),i<.2&&(a[t+2]+=1),n<.2&&(a[t+4]+=1))}}()}(),this.addAttribute("position",new pn(r,3)),this.addAttribute("normal",new pn(r.slice(),3)),this.addAttribute("uv",new pn(a,2)),0===n?this.computeVertexNormals():this.normalizeNormals()}function wr(t,e){rn.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new br(t,e)),this.mergeVertices()}function br(t,e){xr.call(this,[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],[2,1,0,0,3,2,1,3,0,2,3,1],t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Lr(t,e){rn.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Mr(t,e)),this.mergeVertices()}function Mr(t,e){xr.call(this,[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2],t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function _r(t,e){rn.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Ar(t,e)),this.mergeVertices()}function Ar(t,e){var i=(1+Math.sqrt(5))/2,n=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1];xr.call(this,n,[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1],t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Er(t,e){rn.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Sr(t,e)),this.mergeVertices()}function Sr(t,e){var i=(1+Math.sqrt(5))/2,n=1/i,r=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-n,-i,0,-n,i,0,n,-i,0,n,i,-n,-i,0,-n,i,0,n,-i,0,n,i,0,-i,0,-n,i,0,-n,-i,0,n,i,0,n];xr.call(this,r,[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9],t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Tr(t,e,i,n,r,a){rn.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},void 0!==a&&console.warn("THREE.TubeGeometry: taper has been removed.");var o=new Rr(t,e,i,n,r);this.tangents=o.tangents,this.normals=o.normals,this.binormals=o.binormals,this.fromBufferGeometry(o),this.mergeVertices()}function Rr(t,e,i,n,r){yn.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:i,radialSegments:n,closed:r},e=e||64,i=i||1,n=n||8,r=r||!1;var a=t.computeFrenetFrames(e,r);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;var o,s,c=new We,h=new We,l=new Ue,u=new We,d=[],p=[],f=[],m=[];function g(r){u=t.getPointAt(r/e,u);var o=a.normals[r],l=a.binormals[r];for(s=0;s<=n;s++){var f=s/n*Math.PI*2,m=Math.sin(f),g=-Math.cos(f);h.x=g*o.x+m*l.x,h.y=g*o.y+m*l.y,h.z=g*o.z+m*l.z,h.normalize(),p.push(h.x,h.y,h.z),c.x=u.x+i*h.x,c.y=u.y+i*h.y,c.z=u.z+i*h.z,d.push(c.x,c.y,c.z)}}!function(){for(o=0;o<e;o++)g(o);g(!1===r?e:0),function(){for(o=0;o<=e;o++)for(s=0;s<=n;s++)l.x=o/e,l.y=s/n,f.push(l.x,l.y)}(),function(){for(s=1;s<=e;s++)for(o=1;o<=n;o++){var t=(n+1)*(s-1)+(o-1),i=(n+1)*s+(o-1),r=(n+1)*s+o,a=(n+1)*(s-1)+o;m.push(t,i,a),m.push(i,r,a)}}()}(),this.setIndex(m),this.addAttribute("position",new pn(d,3)),this.addAttribute("normal",new pn(p,3)),this.addAttribute("uv",new pn(f,2))}function Or(t,e,i,n,r,a,o){rn.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:a},void 0!==o&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new Pr(t,e,i,n,r,a)),this.mergeVertices()}function Pr(t,e,i,n,r,a){yn.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:i,radialSegments:n,p:r,q:a},t=t||1,e=e||.4,i=Math.floor(i)||64,n=Math.floor(n)||8,r=r||2,a=a||3;var o,s,c=[],h=[],l=[],u=[],d=new We,p=new We,f=new We,m=new We,g=new We,v=new We,y=new We;for(o=0;o<=i;++o){var x=o/i*r*Math.PI*2;for(S(x,r,a,t,f),S(x+.01,r,a,t,m),v.subVectors(m,f),y.addVectors(m,f),g.crossVectors(v,y),y.crossVectors(g,v),g.normalize(),y.normalize(),s=0;s<=n;++s){var w=s/n*Math.PI*2,b=-e*Math.cos(w),L=e*Math.sin(w);d.x=f.x+(b*y.x+L*g.x),d.y=f.y+(b*y.y+L*g.y),d.z=f.z+(b*y.z+L*g.z),h.push(d.x,d.y,d.z),p.subVectors(d,f).normalize(),l.push(p.x,p.y,p.z),u.push(o/i),u.push(s/n)}}for(s=1;s<=i;s++)for(o=1;o<=n;o++){var M=(n+1)*(s-1)+(o-1),_=(n+1)*s+(o-1),A=(n+1)*s+o,E=(n+1)*(s-1)+o;c.push(M,_,E),c.push(_,A,E)}function S(t,e,i,n,r){var a=Math.cos(t),o=Math.sin(t),s=i/e*t,c=Math.cos(s);r.x=n*(2+c)*.5*a,r.y=n*(2+c)*o*.5,r.z=n*Math.sin(s)*.5}this.setIndex(c),this.addAttribute("position",new pn(h,3)),this.addAttribute("normal",new pn(l,3)),this.addAttribute("uv",new pn(u,2))}function Cr(t,e,i,n,r){rn.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},this.fromBufferGeometry(new Ir(t,e,i,n,r)),this.mergeVertices()}function Ir(t,e,i,n,r){yn.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:i,tubularSegments:n,arc:r},t=t||1,e=e||.4,i=Math.floor(i)||8,n=Math.floor(n)||6,r=r||2*Math.PI;var a,o,s=[],c=[],h=[],l=[],u=new We,d=new We,p=new We;for(a=0;a<=i;a++)for(o=0;o<=n;o++){var f=o/n*r,m=a/i*Math.PI*2;d.x=(t+e*Math.cos(m))*Math.cos(f),d.y=(t+e*Math.cos(m))*Math.sin(f),d.z=e*Math.sin(m),c.push(d.x,d.y,d.z),u.x=t*Math.cos(f),u.y=t*Math.sin(f),p.subVectors(d,u).normalize(),h.push(p.x,p.y,p.z),l.push(o/n),l.push(a/i)}for(a=1;a<=i;a++)for(o=1;o<=n;o++){var g=(n+1)*a+o-1,v=(n+1)*(a-1)+o-1,y=(n+1)*(a-1)+o,x=(n+1)*a+o;s.push(g,v,x),s.push(v,y,x)}this.setIndex(s),this.addAttribute("position",new pn(c,3)),this.addAttribute("normal",new pn(h,3)),this.addAttribute("uv",new pn(l,2))}Jn.prototype.isFogExp2=!0,Jn.prototype.clone=function(){return new Jn(this.color.getHex(),this.density)},Jn.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Kn.prototype.isFog=!0,Kn.prototype.clone=function(){return new Kn(this.color.getHex(),this.near,this.far)},Kn.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Qn.prototype=Object.assign(Object.create(Qi.prototype),{constructor:Qn,copy:function(t,e){return Qi.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=Qi.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),$n.prototype=Object.create(ki.prototype),$n.prototype.constructor=$n,$n.prototype.isSpriteMaterial=!0,$n.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},tr.prototype=Object.assign(Object.create(Qi.prototype),{constructor:tr,isSprite:!0,raycast:function(){var t=new We,e=new We,i=new We;return function(n,r){e.setFromMatrixPosition(this.matrixWorld),n.ray.closestPointToPoint(e,t),i.setFromMatrixScale(this.matrixWorld);var a=i.x*i.y/4;if(!(e.distanceToSquared(t)>a)){var o=n.ray.origin.distanceTo(t);o<n.near||o>n.far||r.push({distance:o,point:t.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return Qi.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),er.prototype=Object.assign(Object.create(Qi.prototype),{constructor:er,copy:function(t){Qi.prototype.copy.call(this,t,!1);for(var e=t.levels,i=0,n=e.length;i<n;i++){var r=e[i];this.addLevel(r.object.clone(),r.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var i=this.levels,n=0;n<i.length&&!(e<i[n].distance);n++);i.splice(n,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,i=1,n=e.length;i<n&&!(t<e[i].distance);i++);return e[i-1].object},raycast:function(){var t=new We;return function(e,i){t.setFromMatrixPosition(this.matrixWorld);var n=e.ray.origin.distanceTo(t);this.getObjectForDistance(n).raycast(e,i)}}(),update:function(){var t=new We,e=new We;return function(i){var n=this.levels;if(n.length>1){t.setFromMatrixPosition(i.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var r=t.distanceTo(e);n[0].object.visible=!0;for(var a=1,o=n.length;a<o&&r>=n[a].distance;a++)n[a-1].object.visible=!1,n[a].object.visible=!0;for(;a<o;a++)n[a].object.visible=!1}}}(),toJSON:function(t){var e=Qi.prototype.toJSON.call(this,t);e.object.levels=[];for(var i=this.levels,n=0,r=i.length;n<r;n++){var a=i[n];e.object.levels.push({object:a.object.uuid,distance:a.distance})}return e}}),Object.assign(ir.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var i=new Ne;this.bones[t]&&i.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(i)}},pose:function(){var t,e,i;for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,i=this.bones.length;e<i;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new Ne,e=new Ne;return function(){for(var i=this.bones,n=this.boneInverses,r=this.boneMatrices,a=this.boneTexture,o=0,s=i.length;o<s;o++){var c=i[o]?i[o].matrixWorld:e;t.multiplyMatrices(c,n[o]),t.toArray(r,16*o)}void 0!==a&&(a.needsUpdate=!0)}}(),clone:function(){return new ir(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,i=this.bones.length;e<i;e++){var n=this.bones[e];if(n.name===t)return n}}}),nr.prototype=Object.assign(Object.create(Qi.prototype),{constructor:nr,isBone:!0}),rr.prototype=Object.assign(Object.create(Tn.prototype),{constructor:rr,isSkinnedMesh:!0,initBones:function(){var t,e,i,n,r=[];if(this.geometry&&void 0!==this.geometry.bones){for(i=0,n=this.geometry.bones.length;i<n;i++)e=this.geometry.bones[i],t=new nr,r.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(i=0,n=this.geometry.bones.length;i<n;i++)-1!==(e=this.geometry.bones[i]).parent&&null!==e.parent&&void 0!==r[e.parent]?r[e.parent].add(r[i]):this.add(r[i])}return this.updateMatrixWorld(!0),r},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var i=this.geometry.skinWeights[e];(t=1/i.manhattanLength())!=1/0?i.multiplyScalar(t):i.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var n=new Ge,r=this.geometry.attributes.skinWeight;for(e=0;e<r.count;e++)n.x=r.getX(e),n.y=r.getY(e),n.z=r.getZ(e),n.w=r.getW(e),(t=1/n.manhattanLength())!=1/0?n.multiplyScalar(t):n.set(1,0,0,0),r.setXYZW(e,n.x,n.y,n.z,n.w)}},updateMatrixWorld:function(t){Tn.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ar.prototype=Object.create(ki.prototype),ar.prototype.constructor=ar,ar.prototype.isLineBasicMaterial=!0,ar.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},or.prototype=Object.assign(Object.create(Qi.prototype),{constructor:or,isLine:!0,computeLineDistances:function(){var t=new We,e=new We;return function(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){for(var n=i.attributes.position,r=[0],a=1,o=n.count;a<o;a++)t.fromBufferAttribute(n,a-1),e.fromBufferAttribute(n,a),r[a]=r[a-1],r[a]+=t.distanceTo(e);i.addAttribute("lineDistance",new THREE.Float32BufferAttribute(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var s=i.vertices;for((r=i.lineDistances)[0]=0,a=1,o=s.length;a<o;a++)r[a]=r[a-1],r[a]+=s[a-1].distanceTo(s[a])}return this}}(),raycast:function(){var t=new Ne,e=new An,i=new ji;return function(n,r){var a=n.linePrecision,o=a*a,s=this.geometry,c=this.matrixWorld;if(null===s.boundingSphere&&s.computeBoundingSphere(),i.copy(s.boundingSphere),i.applyMatrix4(c),!1!==n.ray.intersectsSphere(i)){t.getInverse(c),e.copy(n.ray).applyMatrix4(t);var h=new We,l=new We,u=new We,d=new We,p=this&&this.isLineSegments?2:1;if(s.isBufferGeometry){var f=s.index,m=s.attributes.position.array;if(null!==f)for(var g=f.array,v=0,y=g.length-1;v<y;v+=p){var x=g[v],w=g[v+1];h.fromArray(m,3*x),l.fromArray(m,3*w),e.distanceSqToSegment(h,l,d,u)>o||(d.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(d))<n.near||M>n.far||r.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else for(v=0,y=m.length/3-1;v<y;v+=p)h.fromArray(m,3*v),l.fromArray(m,3*v+3),e.distanceSqToSegment(h,l,d,u)>o||(d.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(d))<n.near||M>n.far||r.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}else if(s.isGeometry){var b=s.vertices,L=b.length;for(v=0;v<L-1;v+=p){var M;e.distanceSqToSegment(b[v],b[v+1],d,u)>o||(d.applyMatrix4(this.matrixWorld),(M=n.ray.origin.distanceTo(d))<n.near||M>n.far||r.push({distance:M,point:u.clone().applyMatrix4(this.matrixWorld),index:v,face:null,faceIndex:null,object:this}))}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),sr.prototype=Object.assign(Object.create(or.prototype),{constructor:sr,isLineSegments:!0,computeLineDistances:function(){var t=new We,e=new We;return function(){var i=this.geometry;if(i.isBufferGeometry)if(null===i.index){for(var n=i.attributes.position,r=[],a=0,o=n.count;a<o;a+=2)t.fromBufferAttribute(n,a),e.fromBufferAttribute(n,a+1),r[a]=0===a?0:r[a-1],r[a+1]=r[a]+t.distanceTo(e);i.addAttribute("lineDistance",new THREE.Float32BufferAttribute(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(i.isGeometry){var s=i.vertices;for(r=i.lineDistances,a=0,o=s.length;a<o;a+=2)t.copy(s[a]),e.copy(s[a+1]),r[a]=0===a?0:r[a-1],r[a+1]=r[a]+t.distanceTo(e)}return this}}()}),cr.prototype=Object.assign(Object.create(or.prototype),{constructor:cr,isLineLoop:!0}),hr.prototype=Object.create(ki.prototype),hr.prototype.constructor=hr,hr.prototype.isPointsMaterial=!0,hr.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},lr.prototype=Object.assign(Object.create(Qi.prototype),{constructor:lr,isPoints:!0,raycast:function(){var t=new Ne,e=new An,i=new ji;return function(n,r){var a=this,o=this.geometry,s=this.matrixWorld,c=n.params.Points.threshold;if(null===o.boundingSphere&&o.computeBoundingSphere(),i.copy(o.boundingSphere),i.applyMatrix4(s),i.radius+=c,!1!==n.ray.intersectsSphere(i)){t.getInverse(s),e.copy(n.ray).applyMatrix4(t);var h=c/((this.scale.x+this.scale.y+this.scale.z)/3),l=h*h,u=new We;if(o.isBufferGeometry){var d=o.index,p=o.attributes.position.array;if(null!==d)for(var f=d.array,m=0,g=f.length;m<g;m++){var v=f[m];u.fromArray(p,3*v),w(u,v)}else{m=0;for(var y=p.length/3;m<y;m++)u.fromArray(p,3*m),w(u,m)}}else{var x=o.vertices;for(m=0,y=x.length;m<y;m++)w(x[m],m)}}function w(t,i){var o=e.distanceSqToPoint(t);if(o<l){var c=e.closestPointToPoint(t);c.applyMatrix4(s);var h=n.ray.origin.distanceTo(c);if(h<n.near||h>n.far)return;r.push({distance:h,distanceToRay:Math.sqrt(o),point:c.clone(),index:i,face:null,object:a})}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ur.prototype=Object.assign(Object.create(Qi.prototype),{constructor:ur,isGroup:!0}),dr.prototype=Object.assign(Object.create(He.prototype),{constructor:dr,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),pr.prototype=Object.create(He.prototype),pr.prototype.constructor=pr,pr.prototype.isCompressedTexture=!0,fr.prototype=Object.create(He.prototype),fr.prototype.constructor=fr,fr.prototype.isDepthTexture=!0,mr.prototype=Object.create(yn.prototype),mr.prototype.constructor=mr,gr.prototype=Object.create(rn.prototype),gr.prototype.constructor=gr,vr.prototype=Object.create(yn.prototype),vr.prototype.constructor=vr,yr.prototype=Object.create(rn.prototype),yr.prototype.constructor=yr,xr.prototype=Object.create(yn.prototype),xr.prototype.constructor=xr,wr.prototype=Object.create(rn.prototype),wr.prototype.constructor=wr,br.prototype=Object.create(xr.prototype),br.prototype.constructor=br,Lr.prototype=Object.create(rn.prototype),Lr.prototype.constructor=Lr,Mr.prototype=Object.create(xr.prototype),Mr.prototype.constructor=Mr,_r.prototype=Object.create(rn.prototype),_r.prototype.constructor=_r,Ar.prototype=Object.create(xr.prototype),Ar.prototype.constructor=Ar,Er.prototype=Object.create(rn.prototype),Er.prototype.constructor=Er,Sr.prototype=Object.create(xr.prototype),Sr.prototype.constructor=Sr,Tr.prototype=Object.create(rn.prototype),Tr.prototype.constructor=Tr,Rr.prototype=Object.create(yn.prototype),Rr.prototype.constructor=Rr,Or.prototype=Object.create(rn.prototype),Or.prototype.constructor=Or,Pr.prototype=Object.create(yn.prototype),Pr.prototype.constructor=Pr,Cr.prototype=Object.create(rn.prototype),Cr.prototype.constructor=Cr,Ir.prototype=Object.create(yn.prototype),Ir.prototype.constructor=Ir;function Dr(t,e,i,n,r){var a,o;if(r===function(t,e,i,n){for(var r=0,a=e,o=i-n;a<i;a+=n)r+=(t[o]-t[a])*(t[a+1]+t[o+1]),o=a;return r}(t,e,i,n)>0)for(a=e;a<i;a+=n)o=Qr(a,t[a],t[a+1],o);else for(a=i-n;a>=e;a-=n)o=Qr(a,t[a],t[a+1],o);return o&&qr(o,o.next)&&($r(o),o=o.next),o}function Fr(t,e){if(!t)return t;e||(e=t);var i,n=t;do{if(i=!1,n.steiner||!qr(n,n.next)&&0!==Xr(n.prev,n,n.next))n=n.next;else{if($r(n),(n=e=n.prev)===n.next)break;i=!0}}while(i||n!==e);return e}function Ur(t,e,i,n,r,a,o){if(t){!o&&a&&function(t,e,i,n){var r=t;do{null===r.z&&(r.z=Gr(r.x,r.y,e,i,n)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==t);r.prevZ.nextZ=null,r.prevZ=null,function(t){var e,i,n,r,a,o,s,c,h=1;do{for(i=t,t=null,a=null,o=0;i;){for(o++,n=i,s=0,e=0;e<h&&(s++,n=n.nextZ);e++);for(c=h;s>0||c>0&&n;)0!==s&&(0===c||!n||i.z<=n.z)?(r=i,i=i.nextZ,s--):(r=n,n=n.nextZ,c--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;i=n}a.nextZ=null,h*=2}while(o>1)}(r)}(t,n,r,a);for(var s,c,h=t;t.prev!==t.next;)if(s=t.prev,c=t.next,a?Br(t,n,r,a):Nr(t))e.push(s.i/i),e.push(t.i/i),e.push(c.i/i),$r(t),t=c.next,h=c.next;else if((t=c)===h){o?1===o?Ur(t=Wr(t,e,i),e,i,n,r,a,2):2===o&&zr(t,e,i,n,r,a):Ur(Fr(t),e,i,n,r,a,1);break}}}function Nr(t){var e=t.prev,i=t,n=t.next;if(Xr(e,i,n)>=0)return!1;for(var r=t.next.next;r!==t.prev;){if(jr(e.x,e.y,i.x,i.y,n.x,n.y,r.x,r.y)&&Xr(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function Br(t,e,i,n){var r=t.prev,a=t,o=t.next;if(Xr(r,a,o)>=0)return!1;for(var s=r.x<a.x?r.x<o.x?r.x:o.x:a.x<o.x?a.x:o.x,c=r.y<a.y?r.y<o.y?r.y:o.y:a.y<o.y?a.y:o.y,h=r.x>a.x?r.x>o.x?r.x:o.x:a.x>o.x?a.x:o.x,l=r.y>a.y?r.y>o.y?r.y:o.y:a.y>o.y?a.y:o.y,u=Gr(s,c,e,i,n),d=Gr(h,l,e,i,n),p=t.nextZ;p&&p.z<=d;){if(p!==t.prev&&p!==t.next&&jr(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Xr(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(p=t.prevZ;p&&p.z>=u;){if(p!==t.prev&&p!==t.next&&jr(r.x,r.y,a.x,a.y,o.x,o.y,p.x,p.y)&&Xr(p.prev,p,p.next)>=0)return!1;p=p.prevZ}return!0}function Wr(t,e,i){var n=t;do{var r=n.prev,a=n.next.next;!qr(r,a)&&Zr(r,n,n.next,a)&&Jr(r,a)&&Jr(a,r)&&(e.push(r.i/i),e.push(n.i/i),e.push(a.i/i),$r(n),$r(n.next),n=t=a),n=n.next}while(n!==t);return n}function zr(t,e,i,n,r,a){var o=t;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Yr(o,s)){var c=Kr(o,s);return o=Fr(o,o.next),c=Fr(c,c.next),Ur(o,e,i,n,r,a),void Ur(c,e,i,n,r,a)}s=s.next}o=o.next}while(o!==t)}function kr(t,e){return t.x-e.x}function Hr(t,e){if(e=function(t,e){var i,n=e,r=t.x,a=t.y,o=-1/0;do{if(a<=n.y&&a>=n.next.y&&n.next.y!==n.y){var s=n.x+(a-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=r&&s>o){if(o=s,s===r){if(a===n.y)return n;if(a===n.next.y)return n.next}i=n.x<n.next.x?n:n.next}}n=n.next}while(n!==e);if(!i)return null;if(r===o)return i.prev;var c,h=i,l=i.x,u=i.y,d=1/0;for(n=i.next;n!==h;)r>=n.x&&n.x>=l&&r!==n.x&&jr(a<u?r:o,a,l,u,a<u?o:r,a,n.x,n.y)&&((c=Math.abs(a-n.y)/(r-n.x))<d||c===d&&n.x>i.x)&&Jr(n,t)&&(i=n,d=c),n=n.next;return i}(t,e)){var i=Kr(e,t);Fr(i,i.next)}}function Gr(t,e,i,n,r){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Vr(t){var e=t,i=t;do{e.x<i.x&&(i=e),e=e.next}while(e!==t);return i}function jr(t,e,i,n,r,a,o,s){return(r-o)*(e-s)-(t-o)*(a-s)>=0&&(t-o)*(n-s)-(i-o)*(e-s)>=0&&(i-o)*(a-s)-(r-o)*(n-s)>=0}function Yr(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(t,e){var i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&Zr(i,i.next,t,e))return!0;i=i.next}while(i!==t);return!1}(t,e)&&Jr(t,e)&&Jr(e,t)&&function(t,e){var i=t,n=!1,r=(t.x+e.x)/2,a=(t.y+e.y)/2;do{i.y>a!=i.next.y>a&&i.next.y!==i.y&&r<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(n=!n),i=i.next}while(i!==t);return n}(t,e)}function Xr(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function qr(t,e){return t.x===e.x&&t.y===e.y}function Zr(t,e,i,n){return!!(qr(t,e)&&qr(i,n)||qr(t,n)&&qr(i,e))||Xr(t,e,i)>0!=Xr(t,e,n)>0&&Xr(i,n,t)>0!=Xr(i,n,e)>0}function Jr(t,e){return Xr(t.prev,t,t.next)<0?Xr(t,e,t.next)>=0&&Xr(t,t.prev,e)>=0:Xr(t,e,t.prev)<0||Xr(t,t.next,e)<0}function Kr(t,e){var i=new ta(t.i,t.x,t.y),n=new ta(e.i,e.x,e.y),r=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=r,r.prev=i,n.next=i,i.prev=n,a.next=n,n.prev=a,n}function Qr(t,e,i,n){var r=new ta(t,e,i);return n?(r.next=n.next,r.prev=n,n.next.prev=r,n.next=r):(r.prev=r,r.next=r),r}function $r(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function ta(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var ea={area:function(t){for(var e=t.length,i=0,n=e-1,r=0;r<e;n=r++)i+=t[n].x*t[r].y-t[r].x*t[n].y;return.5*i},isClockWise:function(t){return ea.area(t)<0},triangulateShape:function(t,e){var i=[],n=[],r=[];ia(t),na(i,t);var a=t.length;e.forEach(ia);for(var o=0;o<e.length;o++)n.push(a),a+=e[o].length,na(i,e[o]);var s=function(t,e,i){i=i||2;var n,r,a,o,s,c,h,l=e&&e.length,u=l?e[0]*i:t.length,d=Dr(t,0,u,i,!0),p=[];if(!d)return p;if(l&&(d=function(t,e,i,n){var r,a,o,s=[];for(r=0,a=e.length;r<a;r++)(o=Dr(t,e[r]*n,r<a-1?e[r+1]*n:t.length,n,!1))===o.next&&(o.steiner=!0),s.push(Vr(o));for(s.sort(kr),r=0;r<s.length;r++)Hr(s[r],i),i=Fr(i,i.next);return i}(t,e,d,i)),t.length>80*i){n=a=t[0],r=o=t[1];for(var f=i;f<u;f+=i)s=t[f],c=t[f+1],s<n&&(n=s),c<r&&(r=c),s>a&&(a=s),c>o&&(o=c);h=0!==(h=Math.max(a-n,o-r))?1/h:0}return Ur(d,p,i,n,r,h),p}(i,n);for(o=0;o<s.length;o+=3)r.push(s.slice(o,o+3));return r}};function ia(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function na(t,e){for(var i=0;i<e.length;i++)t.push(e[i].x),t.push(e[i].y)}function ra(t,e){rn.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new aa(t,e)),this.mergeVertices()}function aa(t,e){void 0!==t&&(yn.call(this),this.type="ExtrudeBufferGeometry",t=Array.isArray(t)?t:[t],this.addShapeList(t,e),this.computeVertexNormals())}function oa(t,e){rn.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new sa(t,e)),this.mergeVertices()}function sa(t,e){var i=(e=e||{}).font;if(!i||!i.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new rn;var n=i.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),aa.call(this,n,e),this.type="TextBufferGeometry"}function ca(t,e,i,n,r,a,o){rn.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},this.fromBufferGeometry(new ha(t,e,i,n,r,a,o)),this.mergeVertices()}function ha(t,e,i,n,r,a,o){yn.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:i,phiStart:n,phiLength:r,thetaStart:a,thetaLength:o},t=t||1,e=Math.max(3,Math.floor(e)||8),i=Math.max(2,Math.floor(i)||6),n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var s,c,h=(a=void 0!==a?a:0)+(o=void 0!==o?o:Math.PI),l=0,u=[],d=new We,p=new We,f=[],m=[],g=[],v=[];for(c=0;c<=i;c++){var y=[],x=c/i;for(s=0;s<=e;s++){var w=s/e;d.x=-t*Math.cos(n+w*r)*Math.sin(a+x*o),d.y=t*Math.cos(a+x*o),d.z=t*Math.sin(n+w*r)*Math.sin(a+x*o),m.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),g.push(p.x,p.y,p.z),v.push(w,1-x),y.push(l++)}u.push(y)}for(c=0;c<i;c++)for(s=0;s<e;s++){var b=u[c][s+1],L=u[c][s],M=u[c+1][s],_=u[c+1][s+1];(0!==c||a>0)&&f.push(b,L,_),(c!==i-1||h<Math.PI)&&f.push(L,M,_)}this.setIndex(f),this.addAttribute("position",new pn(m,3)),this.addAttribute("normal",new pn(g,3)),this.addAttribute("uv",new pn(v,2))}function la(t,e,i,n,r,a){rn.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},this.fromBufferGeometry(new ua(t,e,i,n,r,a)),this.mergeVertices()}function ua(t,e,i,n,r,a){yn.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:i,phiSegments:n,thetaStart:r,thetaLength:a},t=t||.5,e=e||1,r=void 0!==r?r:0,a=void 0!==a?a:2*Math.PI,i=void 0!==i?Math.max(3,i):8;var o,s,c,h=[],l=[],u=[],d=[],p=t,f=(e-t)/(n=void 0!==n?Math.max(1,n):1),m=new We,g=new Ue;for(s=0;s<=n;s++){for(c=0;c<=i;c++)o=r+c/i*a,m.x=p*Math.cos(o),m.y=p*Math.sin(o),l.push(m.x,m.y,m.z),u.push(0,0,1),g.x=(m.x/e+1)/2,g.y=(m.y/e+1)/2,d.push(g.x,g.y);p+=f}for(s=0;s<n;s++){var v=s*(i+1);for(c=0;c<i;c++){var y=o=c+v,x=o+i+1,w=o+i+2,b=o+1;h.push(y,x,b),h.push(x,w,b)}}this.setIndex(h),this.addAttribute("position",new pn(l,3)),this.addAttribute("normal",new pn(u,3)),this.addAttribute("uv",new pn(d,2))}function da(t,e,i,n){rn.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},this.fromBufferGeometry(new pa(t,e,i,n)),this.mergeVertices()}function pa(t,e,i,n){yn.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:i,phiLength:n},e=Math.floor(e)||12,i=i||0,n=n||2*Math.PI,n=Fe.clamp(n,0,2*Math.PI);var r,a,o,s=[],c=[],h=[],l=1/e,u=new We,d=new Ue;for(a=0;a<=e;a++){var p=i+a*l*n,f=Math.sin(p),m=Math.cos(p);for(o=0;o<=t.length-1;o++)u.x=t[o].x*f,u.y=t[o].y,u.z=t[o].x*m,c.push(u.x,u.y,u.z),d.x=a/e,d.y=o/(t.length-1),h.push(d.x,d.y)}for(a=0;a<e;a++)for(o=0;o<t.length-1;o++){var g=r=o+a*t.length,v=r+t.length,y=r+t.length+1,x=r+1;s.push(g,v,x),s.push(v,y,x)}if(this.setIndex(s),this.addAttribute("position",new pn(c,3)),this.addAttribute("uv",new pn(h,2)),this.computeVertexNormals(),n===2*Math.PI){var w=this.attributes.normal.array,b=new We,L=new We,M=new We;for(r=e*t.length*3,a=0,o=0;a<t.length;a++,o+=3)b.x=w[o+0],b.y=w[o+1],b.z=w[o+2],L.x=w[r+o+0],L.y=w[r+o+1],L.z=w[r+o+2],M.addVectors(b,L).normalize(),w[o+0]=w[r+o+0]=M.x,w[o+1]=w[r+o+1]=M.y,w[o+2]=w[r+o+2]=M.z}}function fa(t,e){rn.call(this),this.type="ShapeGeometry","object"==typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new ma(t,e)),this.mergeVertices()}function ma(t,e){yn.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var i=[],n=[],r=[],a=[],o=0,s=0;if(!1===Array.isArray(t))h(t);else for(var c=0;c<t.length;c++)h(t[c]),this.addGroup(o,s,c),o+=s,s=0;function h(t){var o,c,h,l=n.length/3,u=t.extractPoints(e),d=u.shape,p=u.holes;if(!1===ea.isClockWise(d))for(d=d.reverse(),o=0,c=p.length;o<c;o++)h=p[o],!0===ea.isClockWise(h)&&(p[o]=h.reverse());var f=ea.triangulateShape(d,p);for(o=0,c=p.length;o<c;o++)h=p[o],d=d.concat(h);for(o=0,c=d.length;o<c;o++){var m=d[o];n.push(m.x,m.y,0),r.push(0,0,1),a.push(m.x,m.y)}for(o=0,c=f.length;o<c;o++){var g=f[o],v=g[0]+l,y=g[1]+l,x=g[2]+l;i.push(v,y,x),s+=3}}this.setIndex(i),this.addAttribute("position",new pn(n,3)),this.addAttribute("normal",new pn(r,3)),this.addAttribute("uv",new pn(a,2))}function ga(t,e){if(e.shapes=[],Array.isArray(t))for(var i=0,n=t.length;i<n;i++){var r=t[i];e.shapes.push(r.uuid)}else e.shapes.push(t.uuid);return e}function va(t,e){yn.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var i,n,r,a,o=[],s=Math.cos(Fe.DEG2RAD*e),c=[0,0],h={},l=["a","b","c"];t.isBufferGeometry?(a=new rn).fromBufferGeometry(t):a=t.clone(),a.mergeVertices(),a.computeFaceNormals();for(var u=a.vertices,d=a.faces,p=0,f=d.length;p<f;p++)for(var m=d[p],g=0;g<3;g++)i=m[l[g]],n=m[l[(g+1)%3]],c[0]=Math.min(i,n),c[1]=Math.max(i,n),void 0===h[r=c[0]+","+c[1]]?h[r]={index1:c[0],index2:c[1],face1:p,face2:void 0}:h[r].face2=p;for(r in h){var v=h[r];if(void 0===v.face2||d[v.face1].normal.dot(d[v.face2].normal)<=s){var y=u[v.index1];o.push(y.x,y.y,y.z),y=u[v.index2],o.push(y.x,y.y,y.z)}}this.addAttribute("position",new pn(o,3))}function ya(t,e,i,n,r,a,o,s){rn.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s},this.fromBufferGeometry(new xa(t,e,i,n,r,a,o,s)),this.mergeVertices()}function xa(t,e,i,n,r,a,o,s){yn.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:i,radialSegments:n,heightSegments:r,openEnded:a,thetaStart:o,thetaLength:s};var c=this;t=void 0!==t?t:1,e=void 0!==e?e:1,i=i||1,n=Math.floor(n)||8,r=Math.floor(r)||1,a=void 0!==a&&a,o=void 0!==o?o:0,s=void 0!==s?s:2*Math.PI;var h=[],l=[],u=[],d=[],p=0,f=[],m=i/2,g=0;function v(i){var r,a,f,v=new Ue,y=new We,x=0,w=!0===i?t:e,b=!0===i?1:-1;for(a=p,r=1;r<=n;r++)l.push(0,m*b,0),u.push(0,b,0),d.push(.5,.5),p++;for(f=p,r=0;r<=n;r++){var L=r/n*s+o,M=Math.cos(L),_=Math.sin(L);y.x=w*_,y.y=m*b,y.z=w*M,l.push(y.x,y.y,y.z),u.push(0,b,0),v.x=.5*M+.5,v.y=.5*_*b+.5,d.push(v.x,v.y),p++}for(r=0;r<n;r++){var A=a+r,E=f+r;!0===i?h.push(E,E+1,A):h.push(E+1,E,A),x+=3}c.addGroup(g,x,!0===i?1:2),g+=x}!function(){var a,v,y=new We,x=new We,w=0,b=(e-t)/i;for(v=0;v<=r;v++){var L=[],M=v/r,_=M*(e-t)+t;for(a=0;a<=n;a++){var A=a/n,E=A*s+o,S=Math.sin(E),T=Math.cos(E);x.x=_*S,x.y=-M*i+m,x.z=_*T,l.push(x.x,x.y,x.z),y.set(S,b,T).normalize(),u.push(y.x,y.y,y.z),d.push(A,1-M),L.push(p++)}f.push(L)}for(a=0;a<n;a++)for(v=0;v<r;v++){var R=f[v][a],O=f[v+1][a],P=f[v+1][a+1],C=f[v][a+1];h.push(R,O,C),h.push(O,P,C),w+=6}c.addGroup(g,w,0),g+=w}(),!1===a&&(t>0&&v(!0),e>0&&v(!1)),this.setIndex(h),this.addAttribute("position",new pn(l,3)),this.addAttribute("normal",new pn(u,3)),this.addAttribute("uv",new pn(d,2))}function wa(t,e,i,n,r,a,o){ya.call(this,0,t,e,i,n,r,a,o),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function ba(t,e,i,n,r,a,o){xa.call(this,0,t,e,i,n,r,a,o),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:i,heightSegments:n,openEnded:r,thetaStart:a,thetaLength:o}}function La(t,e,i,n){rn.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},this.fromBufferGeometry(new Ma(t,e,i,n)),this.mergeVertices()}function Ma(t,e,i,n){yn.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:i,thetaLength:n},t=t||1,e=void 0!==e?Math.max(3,e):8,i=void 0!==i?i:0,n=void 0!==n?n:2*Math.PI;var r,a,o=[],s=[],c=[],h=[],l=new We,u=new Ue;for(s.push(0,0,0),c.push(0,0,1),h.push(.5,.5),a=0,r=3;a<=e;a++,r+=3){var d=i+a/e*n;l.x=t*Math.cos(d),l.y=t*Math.sin(d),s.push(l.x,l.y,l.z),c.push(0,0,1),u.x=(s[r]/t+1)/2,u.y=(s[r+1]/t+1)/2,h.push(u.x,u.y)}for(r=1;r<=e;r++)o.push(r,r+1,0);this.setIndex(o),this.addAttribute("position",new pn(s,3)),this.addAttribute("normal",new pn(c,3)),this.addAttribute("uv",new pn(h,2))}ra.prototype=Object.create(rn.prototype),ra.prototype.constructor=ra,aa.prototype=Object.create(yn.prototype),aa.prototype.constructor=aa,aa.prototype.getArrays=function(){var t=this.getAttribute("position"),e=t?Array.prototype.slice.call(t.array):[],i=this.getAttribute("uv"),n=i?Array.prototype.slice.call(i.array):[],r=this.index;return{position:e,uv:n,index:r?Array.prototype.slice.call(r.array):[]}},aa.prototype.addShapeList=function(t,e){var i=t.length;e.arrays=this.getArrays();for(var n=0;n<i;n++){var r=t[n];this.addShape(r,e)}this.setIndex(e.arrays.index),this.addAttribute("position",new pn(e.arrays.position,3)),this.addAttribute("uv",new pn(e.arrays.uv,2))},aa.prototype.addShape=function(t,e){var i,n,r,a,o,s,c,h,l=e.arrays?e.arrays:this.getArrays(),u=l.position,d=l.index,p=l.uv,f=[],m=void 0!==e.amount?e.amount:100,g=void 0!==e.bevelThickness?e.bevelThickness:6,v=void 0!==e.bevelSize?e.bevelSize:g-2,y=void 0!==e.bevelSegments?e.bevelSegments:3,x=void 0===e.bevelEnabled||e.bevelEnabled,w=void 0!==e.curveSegments?e.curveSegments:12,b=void 0!==e.steps?e.steps:1,L=e.extrudePath,M=!1,_=void 0!==e.UVGenerator?e.UVGenerator:ra.WorldUVGenerator;L&&(i=L.getSpacedPoints(b),M=!0,x=!1,n=void 0!==e.frames?e.frames:L.computeFrenetFrames(b,!1),r=new We,a=new We,o=new We),x||(y=0,g=0,v=0);var A=this,E=t.extractPoints(w),S=E.shape,T=E.holes;if(!ea.isClockWise(S))for(S=S.reverse(),c=0,h=T.length;c<h;c++)s=T[c],ea.isClockWise(s)&&(T[c]=s.reverse());var R=ea.triangulateShape(S,T),O=S;for(c=0,h=T.length;c<h;c++)s=T[c],S=S.concat(s);function P(t,e,i){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(i).add(t)}var C,I,D,F,U,N,B=S.length,W=R.length;function z(t,e,i){var n,r,a,o=t.x-e.x,s=t.y-e.y,c=i.x-t.x,h=i.y-t.y,l=o*o+s*s,u=o*h-s*c;if(Math.abs(u)>Number.EPSILON){var d=Math.sqrt(l),p=Math.sqrt(c*c+h*h),f=e.x-s/d,m=e.y+o/d,g=((i.x-h/p-f)*h-(i.y+c/p-m)*c)/(o*h-s*c),v=(n=f+o*g-t.x)*n+(r=m+s*g-t.y)*r;if(v<=2)return new Ue(n,r);a=Math.sqrt(v/2)}else{var y=!1;o>Number.EPSILON?c>Number.EPSILON&&(y=!0):o<-Number.EPSILON?c<-Number.EPSILON&&(y=!0):Math.sign(s)===Math.sign(h)&&(y=!0),y?(n=-s,r=o,a=Math.sqrt(l)):(n=o,r=s,a=Math.sqrt(l/2))}return new Ue(n/a,r/a)}for(var k=[],H=0,G=O.length,V=G-1,j=H+1;H<G;H++,V++,j++)V===G&&(V=0),j===G&&(j=0),k[H]=z(O[H],O[V],O[j]);var Y,X,q=[],Z=k.concat();for(c=0,h=T.length;c<h;c++){for(s=T[c],Y=[],H=0,V=(G=s.length)-1,j=H+1;H<G;H++,V++,j++)V===G&&(V=0),j===G&&(j=0),Y[H]=z(s[H],s[V],s[j]);q.push(Y),Z=Z.concat(Y)}for(C=0;C<y;C++){for(D=C/y,F=g*Math.cos(D*Math.PI/2),I=v*Math.sin(D*Math.PI/2),H=0,G=O.length;H<G;H++)K((U=P(O[H],k[H],I)).x,U.y,-F);for(c=0,h=T.length;c<h;c++)for(s=T[c],Y=q[c],H=0,G=s.length;H<G;H++)K((U=P(s[H],Y[H],I)).x,U.y,-F)}for(I=v,H=0;H<B;H++)U=x?P(S[H],Z[H],I):S[H],M?(a.copy(n.normals[0]).multiplyScalar(U.x),r.copy(n.binormals[0]).multiplyScalar(U.y),o.copy(i[0]).add(a).add(r),K(o.x,o.y,o.z)):K(U.x,U.y,0);for(X=1;X<=b;X++)for(H=0;H<B;H++)U=x?P(S[H],Z[H],I):S[H],M?(a.copy(n.normals[X]).multiplyScalar(U.x),r.copy(n.binormals[X]).multiplyScalar(U.y),o.copy(i[X]).add(a).add(r),K(o.x,o.y,o.z)):K(U.x,U.y,m/b*X);for(C=y-1;C>=0;C--){for(D=C/y,F=g*Math.cos(D*Math.PI/2),I=v*Math.sin(D*Math.PI/2),H=0,G=O.length;H<G;H++)K((U=P(O[H],k[H],I)).x,U.y,m+F);for(c=0,h=T.length;c<h;c++)for(s=T[c],Y=q[c],H=0,G=s.length;H<G;H++)U=P(s[H],Y[H],I),M?K(U.x,U.y+i[b-1].y,i[b-1].x+F):K(U.x,U.y,m+F)}function J(t,e){var i,n;for(H=t.length;--H>=0;){i=H,(n=H-1)<0&&(n=t.length-1);var r=0,a=b+2*y;for(r=0;r<a;r++){var o=B*r,s=B*(r+1);$(e+i+o,e+n+o,e+n+s,e+i+s)}}}function K(t,e,i){f.push(t),f.push(e),f.push(i)}function Q(t,e,i){tt(t),tt(e),tt(i);var n=u.length/3,r=_.generateTopUV(A,u,n-3,n-2,n-1);et(r[0]),et(r[1]),et(r[2])}function $(t,e,i,n){tt(t),tt(e),tt(n),tt(e),tt(i),tt(n);var r=u.length/3,a=_.generateSideWallUV(A,u,r-6,r-3,r-2,r-1);et(a[0]),et(a[1]),et(a[3]),et(a[1]),et(a[2]),et(a[3])}function tt(t){d.push(u.length/3),u.push(f[3*t+0]),u.push(f[3*t+1]),u.push(f[3*t+2])}function et(t){p.push(t.x),p.push(t.y)}!function(){var t=u.length/3;if(x){var i=0,n=B*i;for(H=0;H<W;H++)Q((N=R[H])[2]+n,N[1]+n,N[0]+n);for(n=B*(i=b+2*y),H=0;H<W;H++)Q((N=R[H])[0]+n,N[1]+n,N[2]+n)}else{for(H=0;H<W;H++)Q((N=R[H])[2],N[1],N[0]);for(H=0;H<W;H++)Q((N=R[H])[0]+B*b,N[1]+B*b,N[2]+B*b)}A.addGroup(t,u.length/3-t,void 0!==e.material?e.material:0)}(),function(){var t=u.length/3,i=0;for(J(O,i),i+=O.length,c=0,h=T.length;c<h;c++)J(s=T[c],i),i+=s.length;A.addGroup(t,u.length/3-t,void 0!==e.extrudeMaterial?e.extrudeMaterial:1)}(),e.arrays||(this.setIndex(d),this.addAttribute("position",new pn(u,3)),this.addAttribute("uv",new pn(p,2)))},ra.WorldUVGenerator={generateTopUV:function(t,e,i,n,r){var a=e[3*i],o=e[3*i+1],s=e[3*n],c=e[3*n+1],h=e[3*r],l=e[3*r+1];return[new Ue(a,o),new Ue(s,c),new Ue(h,l)]},generateSideWallUV:function(t,e,i,n,r,a){var o=e[3*i],s=e[3*i+1],c=e[3*i+2],h=e[3*n],l=e[3*n+1],u=e[3*n+2],d=e[3*r],p=e[3*r+1],f=e[3*r+2],m=e[3*a],g=e[3*a+1],v=e[3*a+2];return Math.abs(s-l)<.01?[new Ue(o,1-c),new Ue(h,1-u),new Ue(d,1-f),new Ue(m,1-v)]:[new Ue(s,1-c),new Ue(l,1-u),new Ue(p,1-f),new Ue(g,1-v)]}},oa.prototype=Object.create(rn.prototype),oa.prototype.constructor=oa,sa.prototype=Object.create(aa.prototype),sa.prototype.constructor=sa,ca.prototype=Object.create(rn.prototype),ca.prototype.constructor=ca,ha.prototype=Object.create(yn.prototype),ha.prototype.constructor=ha,la.prototype=Object.create(rn.prototype),la.prototype.constructor=la,ua.prototype=Object.create(yn.prototype),ua.prototype.constructor=ua,da.prototype=Object.create(rn.prototype),da.prototype.constructor=da,pa.prototype=Object.create(yn.prototype),pa.prototype.constructor=pa,fa.prototype=Object.create(rn.prototype),fa.prototype.constructor=fa,fa.prototype.toJSON=function(){var t=rn.prototype.toJSON.call(this);return ga(this.parameters.shapes,t)},ma.prototype=Object.create(yn.prototype),ma.prototype.constructor=ma,ma.prototype.toJSON=function(){var t=yn.prototype.toJSON.call(this);return ga(this.parameters.shapes,t)},va.prototype=Object.create(yn.prototype),va.prototype.constructor=va,ya.prototype=Object.create(rn.prototype),ya.prototype.constructor=ya,xa.prototype=Object.create(yn.prototype),xa.prototype.constructor=xa,wa.prototype=Object.create(ya.prototype),wa.prototype.constructor=wa,ba.prototype=Object.create(xa.prototype),ba.prototype.constructor=ba,La.prototype=Object.create(rn.prototype),La.prototype.constructor=La,Ma.prototype=Object.create(yn.prototype),Ma.prototype.constructor=Ma;var _a=Object.freeze({WireframeGeometry:mr,ParametricGeometry:gr,ParametricBufferGeometry:vr,TetrahedronGeometry:wr,TetrahedronBufferGeometry:br,OctahedronGeometry:Lr,OctahedronBufferGeometry:Mr,IcosahedronGeometry:_r,IcosahedronBufferGeometry:Ar,DodecahedronGeometry:Er,DodecahedronBufferGeometry:Sr,PolyhedronGeometry:yr,PolyhedronBufferGeometry:xr,TubeGeometry:Tr,TubeBufferGeometry:Rr,TorusKnotGeometry:Or,TorusKnotBufferGeometry:Pr,TorusGeometry:Cr,TorusBufferGeometry:Ir,TextGeometry:oa,TextBufferGeometry:sa,SphereGeometry:ca,SphereBufferGeometry:ha,RingGeometry:la,RingBufferGeometry:ua,PlaneGeometry:bn,PlaneBufferGeometry:Ln,LatheGeometry:da,LatheBufferGeometry:pa,ShapeGeometry:fa,ShapeBufferGeometry:ma,ExtrudeGeometry:ra,ExtrudeBufferGeometry:aa,EdgesGeometry:va,ConeGeometry:wa,ConeBufferGeometry:ba,CylinderGeometry:ya,CylinderBufferGeometry:xa,CircleGeometry:La,CircleBufferGeometry:Ma,BoxGeometry:xn,BoxBufferGeometry:wn});function Aa(t){ki.call(this),this.type="ShadowMaterial",this.color=new Di(0),this.opacity=1,this.lights=!0,this.transparent=!0,this.setValues(t)}function Ea(t){_n.call(this,t),this.type="RawShaderMaterial"}function Sa(t){ki.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Di(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Di(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ta(t){Sa.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function Ra(t){ki.call(this),this.type="MeshPhongMaterial",this.color=new Di(16777215),this.specular=new Di(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Di(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Oa(t){Ra.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function Pa(t){ki.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new Ue(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ca(t){ki.call(this),this.type="MeshLambertMaterial",this.color=new Di(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Di(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=$,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function Ia(t){ar.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}Aa.prototype=Object.create(ki.prototype),Aa.prototype.constructor=Aa,Aa.prototype.isShadowMaterial=!0,Ea.prototype=Object.create(_n.prototype),Ea.prototype.constructor=Ea,Ea.prototype.isRawShaderMaterial=!0,Sa.prototype=Object.create(ki.prototype),Sa.prototype.constructor=Sa,Sa.prototype.isMeshStandardMaterial=!0,Sa.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ta.prototype=Object.create(Sa.prototype),Ta.prototype.constructor=Ta,Ta.prototype.isMeshPhysicalMaterial=!0,Ta.prototype.copy=function(t){return Sa.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},Ra.prototype=Object.create(ki.prototype),Ra.prototype.constructor=Ra,Ra.prototype.isMeshPhongMaterial=!0,Ra.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Oa.prototype=Object.create(Ra.prototype),Oa.prototype.constructor=Oa,Oa.prototype.isMeshToonMaterial=!0,Oa.prototype.copy=function(t){return Ra.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},Pa.prototype=Object.create(ki.prototype),Pa.prototype.constructor=Pa,Pa.prototype.isMeshNormalMaterial=!0,Pa.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ca.prototype=Object.create(ki.prototype),Ca.prototype.constructor=Ca,Ca.prototype.isMeshLambertMaterial=!0,Ca.prototype.copy=function(t){return ki.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},Ia.prototype=Object.create(ar.prototype),Ia.prototype.constructor=Ia,Ia.prototype.isLineDashedMaterial=!0,Ia.prototype.copy=function(t){return ar.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Da=Object.freeze({ShadowMaterial:Aa,SpriteMaterial:$n,RawShaderMaterial:Ea,ShaderMaterial:_n,PointsMaterial:hr,MeshPhysicalMaterial:Ta,MeshStandardMaterial:Sa,MeshPhongMaterial:Ra,MeshToonMaterial:Oa,MeshNormalMaterial:Pa,MeshLambertMaterial:Ca,MeshDepthMaterial:Hi,MeshDistanceMaterial:Gi,MeshBasicMaterial:Mn,LineDashedMaterial:Ia,LineBasicMaterial:ar,Material:ki}),Fa={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}};function Ua(t,e,i){var n=this,r=!1,a=0,o=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=i,this.itemStart=function(t){o++,!1===r&&void 0!==n.onStart&&n.onStart(t,a,o),r=!0},this.itemEnd=function(t){a++,void 0!==n.onProgress&&n.onProgress(t,a,o),a===o&&(r=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(t){void 0!==n.onError&&n.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}var Na=new Ua,Ba={};function Wa(t){this.manager=void 0!==t?t:Na}function za(t){this.manager=void 0!==t?t:Na,this._parser=null}function ka(t){this.manager=void 0!==t?t:Na,this._parser=null}function Ha(t){this.manager=void 0!==t?t:Na}function Ga(t){this.manager=void 0!==t?t:Na}function Va(t){this.manager=void 0!==t?t:Na}function ja(){this.type="Curve",this.arcLengthDivisions=200}function Ya(t,e,i,n,r,a,o,s){ja.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=i||1,this.yRadius=n||1,this.aStartAngle=r||0,this.aEndAngle=a||2*Math.PI,this.aClockwise=o||!1,this.aRotation=s||0}function Xa(t,e,i,n,r,a){Ya.call(this,t,e,i,i,n,r,a),this.type="ArcCurve"}function qa(){var t=0,e=0,i=0,n=0;function r(r,a,o,s){t=r,e=o,i=-3*r+3*a-2*o-s,n=2*r-2*a+o+s}return{initCatmullRom:function(t,e,i,n,a){r(e,i,a*(i-t),a*(n-e))},initNonuniformCatmullRom:function(t,e,i,n,a,o,s){var c=(e-t)/a-(i-t)/(a+o)+(i-e)/o,h=(i-e)/o-(n-e)/(o+s)+(n-i)/s;r(e,i,c*=o,h*=o)},calc:function(r){var a=r*r;return t+e*r+i*a+n*(a*r)}}}Object.assign(Wa.prototype,{load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=Fa.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout(function(){e&&e(a),r.manager.itemEnd(t)},0),a;if(void 0===Ba[t]){var o=t.match(/^data:(.*?)(;base64)?,(.*)$/);if(o){var s=o[1],c=!!o[2],h=o[3];h=window.decodeURIComponent(h),c&&(h=window.atob(h));try{var l,u=(this.responseType||"").toLowerCase();switch(u){case"arraybuffer":case"blob":for(var d=new Uint8Array(h.length),p=0;p<h.length;p++)d[p]=h.charCodeAt(p);l="blob"===u?new Blob([d.buffer],{type:s}):d.buffer;break;case"document":var f=new DOMParser;l=f.parseFromString(h,s);break;case"json":l=JSON.parse(h);break;default:l=h}window.setTimeout(function(){e&&e(l),r.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){n&&n(e),r.manager.itemEnd(t),r.manager.itemError(t)},0)}}else{Ba[t]=[],Ba[t].push({onLoad:e,onProgress:i,onError:n});var m=new XMLHttpRequest;for(var g in m.open("GET",t,!0),m.addEventListener("load",function(e){var i=this.response;Fa.add(t,i);var n=Ba[t];if(delete Ba[t],200===this.status){for(var a=0,o=n.length;a<o;a++)(s=n[a]).onLoad&&s.onLoad(i);r.manager.itemEnd(t)}else if(0===this.status){for(console.warn("THREE.FileLoader: HTTP Status 0 received."),a=0,o=n.length;a<o;a++)(s=n[a]).onLoad&&s.onLoad(i);r.manager.itemEnd(t)}else{for(a=0,o=n.length;a<o;a++){var s;(s=n[a]).onError&&s.onError(e)}r.manager.itemEnd(t),r.manager.itemError(t)}},!1),m.addEventListener("progress",function(e){for(var i=Ba[t],n=0,r=i.length;n<r;n++){var a=i[n];a.onProgress&&a.onProgress(e)}},!1),m.addEventListener("error",function(e){var i=Ba[t];delete Ba[t];for(var n=0,a=i.length;n<a;n++){var o=i[n];o.onError&&o.onError(e)}r.manager.itemEnd(t),r.manager.itemError(t)},!1),void 0!==this.responseType&&(m.responseType=this.responseType),void 0!==this.withCredentials&&(m.withCredentials=this.withCredentials),m.overrideMimeType&&m.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)m.setRequestHeader(g,this.requestHeader[g]);m.send(null)}return r.manager.itemStart(t),m}Ba[t].push({onLoad:e,onProgress:i,onError:n})},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(za.prototype,{load:function(t,e,i,n){var r=this,a=[],o=new pr;o.image=a;var s=new Wa(this.manager);function c(c){s.load(t[c],function(t){var i=r._parser(t,!0);a[c]={width:i.width,height:i.height,format:i.format,mipmaps:i.mipmaps},6===(h+=1)&&(1===i.mipmapCount&&(o.minFilter=bt),o.format=i.format,o.needsUpdate=!0,e&&e(o))},i,n)}if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var h=0,l=0,u=t.length;l<u;++l)c(l);else s.load(t,function(t){var i=r._parser(t,!0);if(i.isCubemap)for(var n=i.mipmaps.length/i.mipmapCount,s=0;s<n;s++){a[s]={mipmaps:[]};for(var c=0;c<i.mipmapCount;c++)a[s].mipmaps.push(i.mipmaps[s*i.mipmapCount+c]),a[s].format=i.format,a[s].width=i.width,a[s].height=i.height}else o.image.width=i.width,o.image.height=i.height,o.mipmaps=i.mipmaps;1===i.mipmapCount&&(o.minFilter=bt),o.format=i.format,o.needsUpdate=!0,e&&e(o)},i,n);return o},setPath:function(t){return this.path=t,this}}),Object.assign(ka.prototype,{load:function(t,e,i,n){var r=this,a=new Ye,o=new Wa(this.manager);return o.setResponseType("arraybuffer"),o.load(t,function(t){var i=r._parser(t);i&&(void 0!==i.image?a.image=i.image:void 0!==i.data&&(a.image.width=i.width,a.image.height=i.height,a.image.data=i.data),a.wrapS=void 0!==i.wrapS?i.wrapS:gt,a.wrapT=void 0!==i.wrapT?i.wrapT:gt,a.magFilter=void 0!==i.magFilter?i.magFilter:bt,a.minFilter=void 0!==i.minFilter?i.minFilter:Mt,a.anisotropy=void 0!==i.anisotropy?i.anisotropy:1,void 0!==i.format&&(a.format=i.format),void 0!==i.type&&(a.type=i.type),void 0!==i.mipmaps&&(a.mipmaps=i.mipmaps),1===i.mipmapCount&&(a.minFilter=bt),a.needsUpdate=!0,e&&e(a,i))},i,n),a}}),Object.assign(Ha.prototype,{crossOrigin:"Anonymous",load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var r=this,a=Fa.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout(function(){e&&e(a),r.manager.itemEnd(t)},0),a;var o=document.createElementNS("http://www.w3.org/1999/xhtml","img");return o.addEventListener("load",function(){Fa.add(t,this),e&&e(this),r.manager.itemEnd(t)},!1),o.addEventListener("error",function(e){n&&n(e),r.manager.itemEnd(t),r.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),r.manager.itemStart(t),o.src=t,o},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Ga.prototype,{crossOrigin:"Anonymous",load:function(t,e,i,n){var r=new Xe,a=new Ha(this.manager);a.setCrossOrigin(this.crossOrigin),a.setPath(this.path);var o=0;function s(i){a.load(t[i],function(t){r.images[i]=t,6==++o&&(r.needsUpdate=!0,e&&e(r))},void 0,n)}for(var c=0;c<t.length;++c)s(c);return r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Va.prototype,{crossOrigin:"Anonymous",load:function(t,e,i,n){var r=new He,a=new Ha(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(t,function(i){r.image=i;var n=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);r.format=n?Nt:Bt,r.needsUpdate=!0,void 0!==e&&e(r)},i,n),r},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(ja.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var i=this.getUtoTmapping(t);return this.getPoint(i,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],i=0;i<=t;i++)e.push(this.getPointAt(i/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,i,n=[],r=this.getPoint(0),a=0;for(n.push(0),i=1;i<=t;i++)a+=(e=this.getPoint(i/t)).distanceTo(r),n.push(a),r=e;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var i,n=this.getLengths(),r=0,a=n.length;i=e||t*n[a-1];for(var o,s=0,c=a-1;s<=c;)if((o=n[r=Math.floor(s+(c-s)/2)]-i)<0)s=r+1;else{if(!(o>0)){c=r;break}c=r-1}if(n[r=c]===i)return r/(a-1);var h=n[r];return(r+(i-h)/(n[r+1]-h))/(a-1)},getTangent:function(t){var e=t-1e-4,i=t+1e-4;e<0&&(e=0),i>1&&(i=1);var n=this.getPoint(e);return this.getPoint(i).clone().sub(n).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var i,n,r,a=new We,o=[],s=[],c=[],h=new We,l=new Ne;for(i=0;i<=t;i++)n=i/t,o[i]=this.getTangentAt(n),o[i].normalize();s[0]=new We,c[0]=new We;var u=Number.MAX_VALUE,d=Math.abs(o[0].x),p=Math.abs(o[0].y),f=Math.abs(o[0].z);for(d<=u&&(u=d,a.set(1,0,0)),p<=u&&(u=p,a.set(0,1,0)),f<=u&&a.set(0,0,1),h.crossVectors(o[0],a).normalize(),s[0].crossVectors(o[0],h),c[0].crossVectors(o[0],s[0]),i=1;i<=t;i++)s[i]=s[i-1].clone(),c[i]=c[i-1].clone(),h.crossVectors(o[i-1],o[i]),h.length()>Number.EPSILON&&(h.normalize(),r=Math.acos(Fe.clamp(o[i-1].dot(o[i]),-1,1)),s[i].applyMatrix4(l.makeRotationAxis(h,r))),c[i].crossVectors(o[i],s[i]);if(!0===e)for(r=Math.acos(Fe.clamp(s[0].dot(s[t]),-1,1)),r/=t,o[0].dot(h.crossVectors(s[0],s[t]))>0&&(r=-r),i=1;i<=t;i++)s[i].applyMatrix4(l.makeRotationAxis(o[i],r*i)),c[i].crossVectors(o[i],s[i]);return{tangents:o,normals:s,binormals:c}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Ya.prototype=Object.create(ja.prototype),Ya.prototype.constructor=Ya,Ya.prototype.isEllipseCurve=!0,Ya.prototype.getPoint=function(t,e){for(var i=e||new Ue,n=2*Math.PI,r=this.aEndAngle-this.aStartAngle,a=Math.abs(r)<Number.EPSILON;r<0;)r+=n;for(;r>n;)r-=n;r<Number.EPSILON&&(r=a?0:n),!0!==this.aClockwise||a||(r===n?r=-n:r-=n);var o=this.aStartAngle+t*r,s=this.aX+this.xRadius*Math.cos(o),c=this.aY+this.yRadius*Math.sin(o);if(0!==this.aRotation){var h=Math.cos(this.aRotation),l=Math.sin(this.aRotation),u=s-this.aX,d=c-this.aY;s=u*h-d*l+this.aX,c=u*l+d*h+this.aY}return i.set(s,c)},Ya.prototype.copy=function(t){return ja.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Ya.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Ya.prototype.fromJSON=function(t){return ja.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Xa.prototype=Object.create(Ya.prototype),Xa.prototype.constructor=Xa,Xa.prototype.isArcCurve=!0;var Za=new We,Ja=new qa,Ka=new qa,Qa=new qa;function $a(t,e,i,n){ja.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=i||"centripetal",this.tension=n||.5}function to(t,e,i,n,r){var a=.5*(n-e),o=.5*(r-i),s=t*t;return(2*i-2*n+a+o)*(t*s)+(-3*i+3*n-2*a-o)*s+a*t+i}function eo(t,e,i,n){return function(t,e){var i=1-t;return i*i*e}(t,e)+function(t,e){return 2*(1-t)*t*i}(t)+function(t,e){return t*t*n}(t)}function io(t,e,i,n,r){return function(t,e){var i=1-t;return i*i*i*e}(t,e)+function(t,e){var i=1-t;return 3*i*i*t*e}(t,i)+function(t,e){return 3*(1-t)*t*t*n}(t)+function(t,e){return t*t*t*r}(t)}function no(t,e,i,n){ja.call(this),this.type="CubicBezierCurve",this.v0=t||new Ue,this.v1=e||new Ue,this.v2=i||new Ue,this.v3=n||new Ue}function ro(t,e,i,n){ja.call(this),this.type="CubicBezierCurve3",this.v0=t||new We,this.v1=e||new We,this.v2=i||new We,this.v3=n||new We}function ao(t,e){ja.call(this),this.type="LineCurve",this.v1=t||new Ue,this.v2=e||new Ue}function oo(t,e){ja.call(this),this.type="LineCurve3",this.v1=t||new We,this.v2=e||new We}function so(t,e,i){ja.call(this),this.type="QuadraticBezierCurve",this.v0=t||new Ue,this.v1=e||new Ue,this.v2=i||new Ue}function co(t,e,i){ja.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new We,this.v1=e||new We,this.v2=i||new We}function ho(t){ja.call(this),this.type="SplineCurve",this.points=t||[]}$a.prototype=Object.create(ja.prototype),$a.prototype.constructor=$a,$a.prototype.isCatmullRomCurve3=!0,$a.prototype.getPoint=function(t,e){var i,n,r,a,o=e||new We,s=this.points,c=s.length,h=(c-(this.closed?0:1))*t,l=Math.floor(h),u=h-l;if(this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/s.length)+1)*s.length:0===u&&l===c-1&&(l=c-2,u=1),this.closed||l>0?i=s[(l-1)%c]:(Za.subVectors(s[0],s[1]).add(s[0]),i=Za),n=s[l%c],r=s[(l+1)%c],this.closed||l+2<c?a=s[(l+2)%c]:(Za.subVectors(s[c-1],s[c-2]).add(s[c-1]),a=Za),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(i.distanceToSquared(n),d),f=Math.pow(n.distanceToSquared(r),d),m=Math.pow(r.distanceToSquared(a),d);f<1e-4&&(f=1),p<1e-4&&(p=f),m<1e-4&&(m=f),Ja.initNonuniformCatmullRom(i.x,n.x,r.x,a.x,p,f,m),Ka.initNonuniformCatmullRom(i.y,n.y,r.y,a.y,p,f,m),Qa.initNonuniformCatmullRom(i.z,n.z,r.z,a.z,p,f,m)}else"catmullrom"===this.curveType&&(Ja.initCatmullRom(i.x,n.x,r.x,a.x,this.tension),Ka.initCatmullRom(i.y,n.y,r.y,a.y,this.tension),Qa.initCatmullRom(i.z,n.z,r.z,a.z,this.tension));return o.set(Ja.calc(u),Ka.calc(u),Qa.calc(u)),o},$a.prototype.copy=function(t){ja.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push(n.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},$a.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var n=this.points[e];t.points.push(n.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},$a.prototype.fromJSON=function(t){ja.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new We).fromArray(n))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},no.prototype=Object.create(ja.prototype),no.prototype.constructor=no,no.prototype.isCubicBezierCurve=!0,no.prototype.getPoint=function(t,e){var i=e||new Ue,n=this.v0,r=this.v1,a=this.v2,o=this.v3;return i.set(io(t,n.x,r.x,a.x,o.x),io(t,n.y,r.y,a.y,o.y)),i},no.prototype.copy=function(t){return ja.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},no.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},no.prototype.fromJSON=function(t){return ja.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ro.prototype=Object.create(ja.prototype),ro.prototype.constructor=ro,ro.prototype.isCubicBezierCurve3=!0,ro.prototype.getPoint=function(t,e){var i=e||new We,n=this.v0,r=this.v1,a=this.v2,o=this.v3;return i.set(io(t,n.x,r.x,a.x,o.x),io(t,n.y,r.y,a.y,o.y),io(t,n.z,r.z,a.z,o.z)),i},ro.prototype.copy=function(t){return ja.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},ro.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},ro.prototype.fromJSON=function(t){return ja.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},ao.prototype=Object.create(ja.prototype),ao.prototype.constructor=ao,ao.prototype.isLineCurve=!0,ao.prototype.getPoint=function(t,e){var i=e||new Ue;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},ao.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},ao.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},ao.prototype.copy=function(t){return ja.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},ao.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},ao.prototype.fromJSON=function(t){return ja.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},oo.prototype=Object.create(ja.prototype),oo.prototype.constructor=oo,oo.prototype.isLineCurve3=!0,oo.prototype.getPoint=function(t,e){var i=e||new We;return 1===t?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i},oo.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},oo.prototype.copy=function(t){return ja.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},oo.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},oo.prototype.fromJSON=function(t){return ja.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},so.prototype=Object.create(ja.prototype),so.prototype.constructor=so,so.prototype.isQuadraticBezierCurve=!0,so.prototype.getPoint=function(t,e){var i=e||new Ue,n=this.v0,r=this.v1,a=this.v2;return i.set(eo(t,n.x,r.x,a.x),eo(t,n.y,r.y,a.y)),i},so.prototype.copy=function(t){return ja.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},so.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},so.prototype.fromJSON=function(t){return ja.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},co.prototype=Object.create(ja.prototype),co.prototype.constructor=co,co.prototype.isQuadraticBezierCurve3=!0,co.prototype.getPoint=function(t,e){var i=e||new We,n=this.v0,r=this.v1,a=this.v2;return i.set(eo(t,n.x,r.x,a.x),eo(t,n.y,r.y,a.y),eo(t,n.z,r.z,a.z)),i},co.prototype.copy=function(t){return ja.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},co.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},co.prototype.fromJSON=function(t){return ja.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},ho.prototype=Object.create(ja.prototype),ho.prototype.constructor=ho,ho.prototype.isSplineCurve=!0,ho.prototype.getPoint=function(t,e){var i=e||new Ue,n=this.points,r=(n.length-1)*t,a=Math.floor(r),o=r-a,s=n[0===a?a:a-1],c=n[a],h=n[a>n.length-2?n.length-1:a+1],l=n[a>n.length-3?n.length-1:a+2];return i.set(to(o,s.x,c.x,h.x,l.x),to(o,s.y,c.y,h.y,l.y)),i},ho.prototype.copy=function(t){ja.prototype.copy.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push(n.clone())}return this},ho.prototype.toJSON=function(){var t=ja.prototype.toJSON.call(this);t.points=[];for(var e=0,i=this.points.length;e<i;e++){var n=this.points[e];t.points.push(n.toArray())}return t},ho.prototype.fromJSON=function(t){ja.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,i=t.points.length;e<i;e++){var n=t.points[e];this.points.push((new Ue).fromArray(n))}return this};var lo=Object.freeze({ArcCurve:Xa,CatmullRomCurve3:$a,CubicBezierCurve:no,CubicBezierCurve3:ro,EllipseCurve:Ya,LineCurve:ao,LineCurve3:oo,QuadraticBezierCurve:so,QuadraticBezierCurve3:co,SplineCurve:ho});function uo(){ja.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function po(t){uo.call(this),this.type="Path",this.currentPoint=new Ue,t&&this.setFromPoints(t)}function fo(t){po.call(this,t),this.uuid=Fe.generateUUID(),this.type="Shape",this.holes=[]}function mo(t,e){Qi.call(this),this.type="Light",this.color=new Di(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function go(t,e,i){mo.call(this,t,i),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(Qi.DefaultUp),this.updateMatrix(),this.groundColor=new Di(e)}function vo(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new Ue(512,512),this.map=null,this.matrix=new Ne}function yo(){vo.call(this,new Gn(50,1,.5,500))}function xo(t,e,i,n,r,a){mo.call(this,t,e),this.type="SpotLight",this.position.copy(Qi.DefaultUp),this.updateMatrix(),this.target=new Qi,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==i?i:0,this.angle=void 0!==n?n:Math.PI/3,this.penumbra=void 0!==r?r:0,this.decay=void 0!==a?a:1,this.shadow=new yo}function wo(t,e,i,n){mo.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==i?i:0,this.decay=void 0!==n?n:1,this.shadow=new vo(new Gn(90,1,.5,500))}function bo(){vo.call(this,new tn(-5,5,5,-5,.5,500))}function Lo(t,e){mo.call(this,t,e),this.type="DirectionalLight",this.position.copy(Qi.DefaultUp),this.updateMatrix(),this.target=new Qi,this.shadow=new bo}function Mo(t,e){mo.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function _o(t,e,i,n){mo.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==i?i:10,this.height=void 0!==n?n:10}function Ao(t,e,i,n){Uo.call(this,t,e,i,n)}function Eo(t,e,i){Uo.call(this,t,e,i)}function So(t,e,i,n){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new e.constructor(i),this.sampleValues=e,this.valueSize=i}function To(t,e,i,n){So.call(this,t,e,i,n)}function Ro(t,e,i,n){Uo.call(this,t,e,i,n)}function Oo(t,e,i,n){Uo.call(this,t,e,i,n)}function Po(t,e,i,n){Uo.call(this,t,e,i,n)}function Co(t,e,i,n){So.call(this,t,e,i,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Io(t,e,i,n){So.call(this,t,e,i,n)}function Do(t,e,i,n){So.call(this,t,e,i,n)}uo.prototype=Object.assign(Object.create(ja.prototype),{constructor:uo,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new ao(e,t))},getPoint:function(t){for(var e=t*this.getLength(),i=this.getCurveLengths(),n=0;n<i.length;){if(i[n]>=e){var r=i[n]-e,a=this.curves[n],o=a.getLength(),s=0===o?0:1-r/o;return a.getPointAt(s)}n++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,i=0,n=this.curves.length;i<n;i++)e+=this.curves[i].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],i=0;i<=t;i++)e.push(this.getPoint(i/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,i=[],n=0,r=this.curves;n<r.length;n++)for(var a=r[n],o=a&&a.isEllipseCurve?2*t:a&&a.isLineCurve?1:a&&a.isSplineCurve?t*a.points.length:t,s=a.getPoints(o),c=0;c<s.length;c++){var h=s[c];e&&e.equals(h)||(i.push(h),e=h)}return this.autoClose&&i.length>1&&!i[i.length-1].equals(i[0])&&i.push(i[0]),i},copy:function(t){ja.prototype.copy.call(this,t),this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push(n.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=ja.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,i=this.curves.length;e<i;e++){var n=this.curves[e];t.curves.push(n.toJSON())}return t},fromJSON:function(t){ja.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,i=t.curves.length;e<i;e++){var n=t.curves[e];this.curves.push((new lo[n.type]).fromJSON(n))}return this}}),po.prototype=Object.assign(Object.create(uo.prototype),{constructor:po,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,i=t.length;e<i;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var i=new ao(this.currentPoint.clone(),new Ue(t,e));this.curves.push(i),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,i,n){var r=new so(this.currentPoint.clone(),new Ue(t,e),new Ue(i,n));this.curves.push(r),this.currentPoint.set(i,n)},bezierCurveTo:function(t,e,i,n,r,a){var o=new no(this.currentPoint.clone(),new Ue(t,e),new Ue(i,n),new Ue(r,a));this.curves.push(o),this.currentPoint.set(r,a)},splineThru:function(t){var e=new ho([this.currentPoint.clone()].concat(t));this.curves.push(e),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,i,n,r,a){var o=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+o,e+s,i,n,r,a)},absarc:function(t,e,i,n,r,a){this.absellipse(t,e,i,i,n,r,a)},ellipse:function(t,e,i,n,r,a,o,s){var c=this.currentPoint.x,h=this.currentPoint.y;this.absellipse(t+c,e+h,i,n,r,a,o,s)},absellipse:function(t,e,i,n,r,a,o,s){var c=new Ya(t,e,i,n,r,a,o,s);if(this.curves.length>0){var h=c.getPoint(0);h.equals(this.currentPoint)||this.lineTo(h.x,h.y)}this.curves.push(c);var l=c.getPoint(1);this.currentPoint.copy(l)},copy:function(t){return uo.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=uo.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return uo.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),fo.prototype=Object.assign(Object.create(po.prototype),{constructor:fo,getPointsHoles:function(t){for(var e=[],i=0,n=this.holes.length;i<n;i++)e[i]=this.holes[i].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){po.prototype.copy.call(this,t),this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push(n.clone())}return this},toJSON:function(){var t=po.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,i=this.holes.length;e<i;e++){var n=this.holes[e];t.holes.push(n.toJSON())}return t},fromJSON:function(t){po.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,i=t.holes.length;e<i;e++){var n=t.holes[e];this.holes.push((new po).fromJSON(n))}return this}}),mo.prototype=Object.assign(Object.create(Qi.prototype),{constructor:mo,isLight:!0,copy:function(t){return Qi.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=Qi.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),go.prototype=Object.assign(Object.create(mo.prototype),{constructor:go,isHemisphereLight:!0,copy:function(t){return mo.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(vo.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),yo.prototype=Object.assign(Object.create(vo.prototype),{constructor:yo,isSpotLightShadow:!0,update:function(t){var e=this.camera,i=2*Fe.RAD2DEG*t.angle,n=this.mapSize.width/this.mapSize.height,r=t.distance||e.far;i===e.fov&&n===e.aspect&&r===e.far||(e.fov=i,e.aspect=n,e.far=r,e.updateProjectionMatrix())}}),xo.prototype=Object.assign(Object.create(mo.prototype),{constructor:xo,isSpotLight:!0,copy:function(t){return mo.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),wo.prototype=Object.assign(Object.create(mo.prototype),{constructor:wo,isPointLight:!0,copy:function(t){return mo.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),bo.prototype=Object.assign(Object.create(vo.prototype),{constructor:bo}),Lo.prototype=Object.assign(Object.create(mo.prototype),{constructor:Lo,isDirectionalLight:!0,copy:function(t){return mo.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),Mo.prototype=Object.assign(Object.create(mo.prototype),{constructor:Mo,isAmbientLight:!0}),_o.prototype=Object.assign(Object.create(mo.prototype),{constructor:_o,isRectAreaLight:!0,copy:function(t){return mo.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=mo.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),Ao.prototype=Object.assign(Object.create(Uo.prototype),{constructor:Ao,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:ge,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Eo.prototype=Object.assign(Object.create(Uo.prototype),{constructor:Eo,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:ge,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(So.prototype,{evaluate:function(t){var e=this.parameterPositions,i=this._cachedIndex,n=e[i],r=e[i-1];t:{e:{var a;i:{n:if(!(t<n)){for(var o=i+2;;){if(void 0===n){if(t<r)break n;return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,t,r)}if(i===o)break;if(r=n,t<(n=e[++i]))break e}a=e.length;break i}if(t>=r)break t;var s=e[1];for(t<s&&(i=2,r=s),o=i-2;;){if(void 0===r)return this._cachedIndex=0,this.beforeStart_(0,t,n);if(i===o)break;if(n=r,t>=(r=e[--i-1]))break e}a=i,i=0}for(;i<a;){var c=i+a>>>1;t<e[c]?a=c:i=c+1}if(n=e[i],void 0===(r=e[i-1]))return this._cachedIndex=0,this.beforeStart_(0,t,n);if(void 0===n)return i=e.length,this._cachedIndex=i,this.afterEnd_(i-1,r,t)}this._cachedIndex=i,this.intervalChanged_(i,r,n)}return this.interpolate_(i,r,t,n)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,i=this.sampleValues,n=this.valueSize,r=t*n,a=0;a!==n;++a)e[a]=i[r+a];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(So.prototype,{beforeStart_:So.prototype.copySampleValue_,afterEnd_:So.prototype.copySampleValue_}),To.prototype=Object.assign(Object.create(So.prototype),{constructor:To,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=(i-e)/(n-e),h=s+o;s!==h;s+=4)Be.slerpFlat(r,0,a,s-o,a,s,c);return r}}),Ro.prototype=Object.assign(Object.create(Uo.prototype),{constructor:Ro,ValueTypeName:"quaternion",DefaultInterpolation:ve,InterpolantFactoryMethodLinear:function(t){return new To(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),Oo.prototype=Object.assign(Object.create(Uo.prototype),{constructor:Oo,ValueTypeName:"color"}),Po.prototype=Object.assign(Object.create(Uo.prototype),{constructor:Po,ValueTypeName:"number"}),Co.prototype=Object.assign(Object.create(So.prototype),{constructor:Co,DefaultSettings_:{endingStart:xe,endingEnd:xe},intervalChanged_:function(t,e,i){var n=this.parameterPositions,r=t-2,a=t+1,o=n[r],s=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case we:r=t,o=2*e-i;break;case be:o=e+n[r=n.length-2]-n[r+1];break;default:r=t,o=i}if(void 0===s)switch(this.getSettings_().endingEnd){case we:a=t,s=2*i-e;break;case be:a=1,s=i+n[1]-n[0];break;default:a=t-1,s=e}var c=.5*(i-e),h=this.valueSize;this._weightPrev=c/(e-o),this._weightNext=c/(s-i),this._offsetPrev=r*h,this._offsetNext=a*h},interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,h=this._offsetPrev,l=this._offsetNext,u=this._weightPrev,d=this._weightNext,p=(i-e)/(n-e),f=p*p,m=f*p,g=-u*m+2*u*f-u*p,v=(1+u)*m+(-1.5-2*u)*f+(-.5+u)*p+1,y=(-1-d)*m+(1.5+d)*f+.5*p,x=d*m-d*f,w=0;w!==o;++w)r[w]=g*a[h+w]+v*a[c+w]+y*a[s+w]+x*a[l+w];return r}}),Io.prototype=Object.assign(Object.create(So.prototype),{constructor:Io,interpolate_:function(t,e,i,n){for(var r=this.resultBuffer,a=this.sampleValues,o=this.valueSize,s=t*o,c=s-o,h=(i-e)/(n-e),l=1-h,u=0;u!==o;++u)r[u]=a[c+u]*l+a[s+u]*h;return r}}),Do.prototype=Object.assign(Object.create(So.prototype),{constructor:Do,interpolate_:function(t){return this.copySampleValue_(t-1)}});var Fo={arraySlice:function(t,e,i){return Fo.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==i?i:t.length)):t.slice(e,i)},convertArray:function(t,e,i){return!t||!i&&t.constructor===e?t:"number"==typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){for(var e=t.length,i=new Array(e),n=0;n!==e;++n)i[n]=n;return i.sort(function(e,i){return t[e]-t[i]}),i},sortedArray:function(t,e,i){for(var n=t.length,r=new t.constructor(n),a=0,o=0;o!==n;++a)for(var s=i[a]*e,c=0;c!==e;++c)r[o++]=t[s+c];return r},flattenJSON:function(t,e,i,n){for(var r=1,a=t[0];void 0!==a&&void 0===a[n];)a=t[r++];if(void 0!==a){var o=a[n];if(void 0!==o)if(Array.isArray(o))do{void 0!==(o=a[n])&&(e.push(a.time),i.push.apply(i,o)),a=t[r++]}while(void 0!==a);else if(void 0!==o.toArray)do{void 0!==(o=a[n])&&(e.push(a.time),o.toArray(i,i.length)),a=t[r++]}while(void 0!==a);else do{void 0!==(o=a[n])&&(e.push(a.time),i.push(o)),a=t[r++]}while(void 0!==a)}}};function Uo(t,e,i,n){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Fo.convertArray(e,this.TimeBufferType),this.values=Fo.convertArray(i,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation),this.validate(),this.optimize()}function No(t,e,i,n){Uo.call(this,t,e,i,n)}function Bo(t,e,i){this.name=t,this.tracks=i,this.duration=void 0!==e?e:-1,this.uuid=Fe.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function Wo(t){this.manager=void 0!==t?t:Na,this.textures={}}function zo(t){this.manager=void 0!==t?t:Na}Object.assign(Uo,{parse:function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=Uo._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var i=[],n=[];Fo.flattenJSON(t.keys,i,n,"value"),t.times=i,t.values=n}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,i=t.constructor;if(void 0!==i.toJSON)e=i.toJSON(t);else{e={name:t.name,times:Fo.convertArray(t.times,Array),values:Fo.convertArray(t.values,Array)};var n=t.getInterpolation();n!==t.DefaultInterpolation&&(e.interpolation=n)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Po;case"vector":case"vector2":case"vector3":case"vector4":return No;case"color":return Oo;case"quaternion":return Ro;case"bool":case"boolean":return Eo;case"string":return Ao}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(Uo.prototype,{constructor:Uo,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:ve,InterpolantFactoryMethodDiscrete:function(t){return new Do(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new Io(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new Co(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case ge:e=this.InterpolantFactoryMethodDiscrete;break;case ve:e=this.InterpolantFactoryMethodLinear;break;case ye:e=this.InterpolantFactoryMethodSmooth}if(void 0!==e)this.createInterpolant=e;else{var i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(i);this.setInterpolation(this.DefaultInterpolation)}console.warn("THREE.KeyframeTrack:",i)}},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ge;case this.InterpolantFactoryMethodLinear:return ve;case this.InterpolantFactoryMethodSmooth:return ye}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,i=0,n=e.length;i!==n;++i)e[i]*=t;return this},trim:function(t,e){for(var i=this.times,n=i.length,r=0,a=n-1;r!==n&&i[r]<t;)++r;for(;-1!==a&&i[a]>e;)--a;if(++a,0!==r||a!==n){r>=a&&(r=(a=Math.max(a,1))-1);var o=this.getValueSize();this.times=Fo.arraySlice(i,r,a),this.values=Fo.arraySlice(this.values,r*o,a*o)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var i=this.times,n=this.values,r=i.length;0===r&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var a=null,o=0;o!==r;o++){var s=i[o];if("number"==typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),t=!1;break}if(null!==a&&a>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,a),t=!1;break}a=s}if(void 0!==n&&Fo.isTypedArray(n)){o=0;for(var c=n.length;o!==c;++o){var h=n[o];if(isNaN(h)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,o,h),t=!1;break}}}return t},optimize:function(){for(var t=this.times,e=this.values,i=this.getValueSize(),n=this.getInterpolation()===ye,r=1,a=t.length-1,o=1;o<a;++o){var s=!1,c=t[o];if(c!==t[o+1]&&(1!==o||c!==c[0]))if(n)s=!0;else for(var h=o*i,l=h-i,u=h+i,d=0;d!==i;++d){var p=e[h+d];if(p!==e[l+d]||p!==e[u+d]){s=!0;break}}if(s){if(o!==r){t[r]=t[o];var f=o*i,m=r*i;for(d=0;d!==i;++d)e[m+d]=e[f+d]}++r}}if(a>0){for(t[r]=t[a],f=a*i,m=r*i,d=0;d!==i;++d)e[m+d]=e[f+d];++r}return r!==t.length&&(this.times=Fo.arraySlice(t,0,r),this.values=Fo.arraySlice(e,0,r*i)),this}}),No.prototype=Object.assign(Object.create(Uo.prototype),{constructor:No,ValueTypeName:"vector"}),Object.assign(Bo,{parse:function(t){for(var e=[],i=t.tracks,n=1/(t.fps||1),r=0,a=i.length;r!==a;++r)e.push(Uo.parse(i[r]).scale(n));return new Bo(t.name,t.duration,e)},toJSON:function(t){for(var e=[],i=t.tracks,n={name:t.name,duration:t.duration,tracks:e},r=0,a=i.length;r!==a;++r)e.push(Uo.toJSON(i[r]));return n},CreateFromMorphTargetSequence:function(t,e,i,n){for(var r=e.length,a=[],o=0;o<r;o++){var s=[],c=[];s.push((o+r-1)%r,o,(o+1)%r),c.push(0,1,0);var h=Fo.getKeyframeOrder(s);s=Fo.sortedArray(s,1,h),c=Fo.sortedArray(c,1,h),n||0!==s[0]||(s.push(r),c.push(c[0])),a.push(new Po(".morphTargetInfluences["+e[o].name+"]",s,c).scale(1/i))}return new Bo(t,-1,a)},findByName:function(t,e){var i=t;if(!Array.isArray(t)){var n=t;i=n.geometry&&n.geometry.animations||n.animations}for(var r=0;r<i.length;r++)if(i[r].name===e)return i[r];return null},CreateClipsFromMorphTargetSequences:function(t,e,i){for(var n={},r=/^([\w-]*?)([\d]+)$/,a=0,o=t.length;a<o;a++){var s=t[a],c=s.name.match(r);if(c&&c.length>1){var h=n[u=c[1]];h||(n[u]=h=[]),h.push(s)}}var l=[];for(var u in n)l.push(Bo.CreateFromMorphTargetSequence(u,n[u],e,i));return l},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var i=function(t,e,i,n,r){if(0!==i.length){var a=[],o=[];Fo.flattenJSON(i,a,o,n),0!==a.length&&r.push(new t(e,a,o))}},n=[],r=t.name||"default",a=t.length||-1,o=t.fps||30,s=t.hierarchy||[],c=0;c<s.length;c++){var h=s[c].keys;if(h&&0!==h.length)if(h[0].morphTargets){for(var l={},u=0;u<h.length;u++)if(h[u].morphTargets)for(var d=0;d<h[u].morphTargets.length;d++)l[h[u].morphTargets[d]]=-1;for(var p in l){var f=[],m=[];for(d=0;d!==h[u].morphTargets.length;++d){var g=h[u];f.push(g.time),m.push(g.morphTarget===p?1:0)}n.push(new Po(".morphTargetInfluence["+p+"]",f,m))}a=l.length*(o||1)}else{var v=".bones["+e[c].name+"]";i(No,v+".position",h,"pos",n),i(Ro,v+".quaternion",h,"rot",n),i(No,v+".scale",h,"scl",n)}}return 0===n.length?null:new Bo(r,a,n)}}),Object.assign(Bo.prototype,{resetDuration:function(){for(var t=0,e=0,i=this.tracks.length;e!==i;++e){var n=this.tracks[e];t=Math.max(t,n.times[n.times.length-1])}this.duration=t},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(Wo.prototype,{load:function(t,e,i,n){var r=this;new Wa(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},setTextures:function(t){this.textures=t},parse:function(t){var e=this.textures;function i(t){return void 0===e[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),e[t]}var n=new Da[t.type];if(void 0!==t.uuid&&(n.uuid=t.uuid),void 0!==t.name&&(n.name=t.name),void 0!==t.color&&n.color.setHex(t.color),void 0!==t.roughness&&(n.roughness=t.roughness),void 0!==t.metalness&&(n.metalness=t.metalness),void 0!==t.emissive&&n.emissive.setHex(t.emissive),void 0!==t.specular&&n.specular.setHex(t.specular),void 0!==t.shininess&&(n.shininess=t.shininess),void 0!==t.clearCoat&&(n.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(n.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(n.uniforms=t.uniforms),void 0!==t.vertexShader&&(n.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(n.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(n.vertexColors=t.vertexColors),void 0!==t.fog&&(n.fog=t.fog),void 0!==t.flatShading&&(n.flatShading=t.flatShading),void 0!==t.blending&&(n.blending=t.blending),void 0!==t.side&&(n.side=t.side),void 0!==t.opacity&&(n.opacity=t.opacity),void 0!==t.transparent&&(n.transparent=t.transparent),void 0!==t.alphaTest&&(n.alphaTest=t.alphaTest),void 0!==t.depthTest&&(n.depthTest=t.depthTest),void 0!==t.depthWrite&&(n.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(n.colorWrite=t.colorWrite),void 0!==t.wireframe&&(n.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(n.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(n.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(n.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(n.rotation=t.rotation),1!==t.linewidth&&(n.linewidth=t.linewidth),void 0!==t.dashSize&&(n.dashSize=t.dashSize),void 0!==t.gapSize&&(n.gapSize=t.gapSize),void 0!==t.scale&&(n.scale=t.scale),void 0!==t.skinning&&(n.skinning=t.skinning),void 0!==t.morphTargets&&(n.morphTargets=t.morphTargets),void 0!==t.dithering&&(n.dithering=t.dithering),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.shading&&(n.flatShading=1===t.shading),void 0!==t.size&&(n.size=t.size),void 0!==t.sizeAttenuation&&(n.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(n.map=i(t.map)),void 0!==t.alphaMap&&(n.alphaMap=i(t.alphaMap),n.transparent=!0),void 0!==t.bumpMap&&(n.bumpMap=i(t.bumpMap)),void 0!==t.bumpScale&&(n.bumpScale=t.bumpScale),void 0!==t.normalMap&&(n.normalMap=i(t.normalMap)),void 0!==t.normalScale){var r=t.normalScale;!1===Array.isArray(r)&&(r=[r,r]),n.normalScale=(new Ue).fromArray(r)}return void 0!==t.displacementMap&&(n.displacementMap=i(t.displacementMap)),void 0!==t.displacementScale&&(n.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(n.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(n.roughnessMap=i(t.roughnessMap)),void 0!==t.metalnessMap&&(n.metalnessMap=i(t.metalnessMap)),void 0!==t.emissiveMap&&(n.emissiveMap=i(t.emissiveMap)),void 0!==t.emissiveIntensity&&(n.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(n.specularMap=i(t.specularMap)),void 0!==t.envMap&&(n.envMap=i(t.envMap)),void 0!==t.reflectivity&&(n.reflectivity=t.reflectivity),void 0!==t.lightMap&&(n.lightMap=i(t.lightMap)),void 0!==t.lightMapIntensity&&(n.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(n.aoMap=i(t.aoMap)),void 0!==t.aoMapIntensity&&(n.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(n.gradientMap=i(t.gradientMap)),n}}),Object.assign(zo.prototype,{load:function(t,e,i,n){var r=this;new Wa(r.manager).load(t,function(t){e(r.parse(JSON.parse(t)))},i,n)},parse:function(t){var e=new yn,i=t.data.index;if(void 0!==i){var n=new ko[i.type](i.array);e.setIndex(new an(n,1))}var r=t.data.attributes;for(var a in r){var o=r[a];n=new ko[o.type](o.array),e.addAttribute(a,new an(n,o.itemSize,o.normalized))}var s=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==s)for(var c=0,h=s.length;c!==h;++c){var l=s[c];e.addGroup(l.start,l.count,l.materialIndex)}var u=t.data.boundingSphere;if(void 0!==u){var d=new We;void 0!==u.center&&d.fromArray(u.center),e.boundingSphere=new ji(d,u.radius)}return e}});var ko={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};function Ho(){this.onLoadStart=function(){},this.onLoadProgress=function(){},this.onLoadComplete=function(){}}Ho.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,i=0,n=e.length;i<n;i+=2){var r=e[i],a=e[i+1];if(r.test(t))return a}return null}},Object.assign(Ho.prototype,{crossOrigin:void 0,initMaterials:function(t,e,i){for(var n=[],r=0;r<t.length;++r)n[r]=this.createMaterial(t[r],e,i);return n},createMaterial:function(){var t={NoBlending:M,NormalBlending:_,AdditiveBlending:A,SubtractiveBlending:E,MultiplyBlending:S,CustomBlending:T},e=new Di,i=new Va,n=new Wo;return function(r,a,o){var s={};function c(t,e,n,r,c){var h,l=a+t,u=Ho.Handlers.get(l);null!==u?h=u.load(l):(i.setCrossOrigin(o),h=i.load(l)),void 0!==e&&(h.repeat.fromArray(e),1!==e[0]&&(h.wrapS=mt),1!==e[1]&&(h.wrapT=mt)),void 0!==n&&h.offset.fromArray(n),void 0!==r&&("repeat"===r[0]&&(h.wrapS=mt),"mirror"===r[0]&&(h.wrapS=vt),"repeat"===r[1]&&(h.wrapT=mt),"mirror"===r[1]&&(h.wrapT=vt)),void 0!==c&&(h.anisotropy=c);var d=Fe.generateUUID();return s[d]=h,d}var h={uuid:Fe.generateUUID(),type:"MeshLambertMaterial"};for(var l in r){var u=r[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":h.name=u;break;case"blending":h.blending=t[u];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":h.color=e.fromArray(u).getHex();break;case"colorSpecular":h.specular=e.fromArray(u).getHex();break;case"colorEmissive":h.emissive=e.fromArray(u).getHex();break;case"specularCoef":h.shininess=u;break;case"shading":"basic"===u.toLowerCase()&&(h.type="MeshBasicMaterial"),"phong"===u.toLowerCase()&&(h.type="MeshPhongMaterial"),"standard"===u.toLowerCase()&&(h.type="MeshStandardMaterial");break;case"mapDiffuse":h.map=c(u,r.mapDiffuseRepeat,r.mapDiffuseOffset,r.mapDiffuseWrap,r.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":h.emissiveMap=c(u,r.mapEmissiveRepeat,r.mapEmissiveOffset,r.mapEmissiveWrap,r.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":h.lightMap=c(u,r.mapLightRepeat,r.mapLightOffset,r.mapLightWrap,r.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":h.aoMap=c(u,r.mapAORepeat,r.mapAOOffset,r.mapAOWrap,r.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":h.bumpMap=c(u,r.mapBumpRepeat,r.mapBumpOffset,r.mapBumpWrap,r.mapBumpAnisotropy);break;case"mapBumpScale":h.bumpScale=u;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":h.normalMap=c(u,r.mapNormalRepeat,r.mapNormalOffset,r.mapNormalWrap,r.mapNormalAnisotropy);break;case"mapNormalFactor":h.normalScale=[u,u];break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":h.specularMap=c(u,r.mapSpecularRepeat,r.mapSpecularOffset,r.mapSpecularWrap,r.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":h.metalnessMap=c(u,r.mapMetalnessRepeat,r.mapMetalnessOffset,r.mapMetalnessWrap,r.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":h.roughnessMap=c(u,r.mapRoughnessRepeat,r.mapRoughnessOffset,r.mapRoughnessWrap,r.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":h.alphaMap=c(u,r.mapAlphaRepeat,r.mapAlphaOffset,r.mapAlphaWrap,r.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":h.side=g;break;case"doubleSided":h.side=v;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),h.opacity=u;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":h[l]=u;break;case"vertexColors":!0===u&&(h.vertexColors=L),"face"===u&&(h.vertexColors=b);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,u)}}return"MeshBasicMaterial"===h.type&&delete h.emissive,"MeshPhongMaterial"!==h.type&&delete h.specular,h.opacity<1&&(h.transparent=!0),n.setTextures(s),n.parse(h)}}()});var Go={decodeText:function(t){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",i=0,n=t.length;i<n;i++)e+=String.fromCharCode(t[i]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.split("/");return 1===e.length?"./":(e.pop(),e.join("/")+"/")}};function Vo(t){"boolean"==typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:Na,this.withCredentials=!1}function jo(t){this.manager=void 0!==t?t:Na,this.texturePath=""}Object.assign(Vo.prototype,{load:function(t,e,i,n){var r=this,a=this.texturePath&&"string"==typeof this.texturePath?this.texturePath:Go.extractUrlBase(t),o=new Wa(this.manager);o.setWithCredentials(this.withCredentials),o.load(t,function(i){var n=JSON.parse(i),o=n.metadata;if(void 0!==o){var s=o.type;if(void 0!==s){if("object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.");if("scene"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.SceneLoader instead.")}}var c=r.parse(n,a);e(c.geometry,c.materials)},i,n)},setTexturePath:function(t){this.texturePath=t},parse:function(t,e){void 0!==t.data&&(t=t.data),void 0!==t.scale?t.scale=1/t.scale:t.scale=1;var i=new rn;return function(t,e){function i(t,e){return t&1<<e}var n,r,a,o,s,c,h,l,u,d,p,f,m,g,v,y,x,w,b,L,M,_,A,E,S,T=t.faces,R=t.vertices,O=t.normals,P=t.colors,C=t.scale,I=0;if(void 0!==t.uvs){for(n=0;n<t.uvs.length;n++)t.uvs[n].length&&I++;for(n=0;n<I;n++)e.faceVertexUvs[n]=[]}for(o=0,s=R.length;o<s;)(w=new We).x=R[o++]*C,w.y=R[o++]*C,w.z=R[o++]*C,e.vertices.push(w);for(o=0,s=T.length;o<s;)if(p=i(d=T[o++],0),f=i(d,1),m=i(d,3),g=i(d,4),v=i(d,5),y=i(d,6),x=i(d,7),p){if((L=new en).a=T[o],L.b=T[o+1],L.c=T[o+3],(M=new en).a=T[o+1],M.b=T[o+2],M.c=T[o+3],o+=4,f&&(u=T[o++],L.materialIndex=u,M.materialIndex=u),a=e.faces.length,m)for(n=0;n<I;n++)for(E=t.uvs[n],e.faceVertexUvs[n][a]=[],e.faceVertexUvs[n][a+1]=[],r=0;r<4;r++)S=new Ue(E[2*(l=T[o++])],E[2*l+1]),2!==r&&e.faceVertexUvs[n][a].push(S),0!==r&&e.faceVertexUvs[n][a+1].push(S);if(g&&(h=3*T[o++],L.normal.set(O[h++],O[h++],O[h]),M.normal.copy(L.normal)),v)for(n=0;n<4;n++)h=3*T[o++],A=new We(O[h++],O[h++],O[h]),2!==n&&L.vertexNormals.push(A),0!==n&&M.vertexNormals.push(A);if(y&&(_=P[c=T[o++]],L.color.setHex(_),M.color.setHex(_)),x)for(n=0;n<4;n++)_=P[c=T[o++]],2!==n&&L.vertexColors.push(new Di(_)),0!==n&&M.vertexColors.push(new Di(_));e.faces.push(L),e.faces.push(M)}else{if((b=new en).a=T[o++],b.b=T[o++],b.c=T[o++],f&&(u=T[o++],b.materialIndex=u),a=e.faces.length,m)for(n=0;n<I;n++)for(E=t.uvs[n],e.faceVertexUvs[n][a]=[],r=0;r<3;r++)S=new Ue(E[2*(l=T[o++])],E[2*l+1]),e.faceVertexUvs[n][a].push(S);if(g&&(h=3*T[o++],b.normal.set(O[h++],O[h++],O[h])),v)for(n=0;n<3;n++)h=3*T[o++],A=new We(O[h++],O[h++],O[h]),b.vertexNormals.push(A);if(y&&(c=T[o++],b.color.setHex(P[c])),x)for(n=0;n<3;n++)c=T[o++],b.vertexColors.push(new Di(P[c]));e.faces.push(b)}}(t,i),function(t,e){var i=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var n=0,r=t.skinWeights.length;n<r;n+=i){var a=t.skinWeights[n],o=i>1?t.skinWeights[n+1]:0,s=i>2?t.skinWeights[n+2]:0,c=i>3?t.skinWeights[n+3]:0;e.skinWeights.push(new Ge(a,o,s,c))}if(t.skinIndices)for(n=0,r=t.skinIndices.length;n<r;n+=i){var h=t.skinIndices[n],l=i>1?t.skinIndices[n+1]:0,u=i>2?t.skinIndices[n+2]:0,d=i>3?t.skinIndices[n+3]:0;e.skinIndices.push(new Ge(h,l,u,d))}e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}(t,i),function(t,e){var i=t.scale;if(void 0!==t.morphTargets)for(var n=0,r=t.morphTargets.length;n<r;n++){e.morphTargets[n]={},e.morphTargets[n].name=t.morphTargets[n].name,e.morphTargets[n].vertices=[];for(var a=e.morphTargets[n].vertices,o=t.morphTargets[n].vertices,s=0,c=o.length;s<c;s+=3){var h=new We;h.x=o[s]*i,h.y=o[s+1]*i,h.z=o[s+2]*i,a.push(h)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');var l=e.faces,u=t.morphColors[0].colors;for(n=0,r=l.length;n<r;n++)l[n].color.fromArray(u,3*n)}}(t,i),function(t,e){var i=[],n=[];void 0!==t.animation&&n.push(t.animation),void 0!==t.animations&&(t.animations.length?n=n.concat(t.animations):n.push(t.animations));for(var r=0;r<n.length;r++){var a=Bo.parseAnimation(n[r],e.bones);a&&i.push(a)}if(e.morphTargets){var o=Bo.CreateClipsFromMorphTargetSequences(e.morphTargets,10);i=i.concat(o)}i.length>0&&(e.animations=i)}(t,i),i.computeFaceNormals(),i.computeBoundingSphere(),void 0===t.materials||0===t.materials.length?{geometry:i}:{geometry:i,materials:Ho.prototype.initMaterials(t.materials,e,this.crossOrigin)}}}),Object.assign(jo.prototype,{load:function(t,e,i,n){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var r=this;new Wa(r.manager).load(t,function(i){var a=null;try{a=JSON.parse(i)}catch(e){return void 0!==n&&n(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var o=a.metadata;void 0!==o&&void 0!==o.type&&"geometry"!==o.type.toLowerCase()?r.parse(a,e):console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead.")},i,n)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var i=this.parseShape(t.shapes),n=this.parseGeometries(t.geometries,i),r=this.parseImages(t.images,function(){void 0!==e&&e(s)}),a=this.parseTextures(t.textures,r),o=this.parseMaterials(t.materials,a),s=this.parseObject(t.object,n,o);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var i=0,n=t.length;i<n;i++){var r=(new fo).fromJSON(t[i]);e[r.uuid]=r}return e},parseGeometries:function(t,e){var i={};if(void 0!==t)for(var n=new Vo,r=new zo,a=0,o=t.length;a<o;a++){var s,c=t[a];switch(c.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new _a[c.type](c.width,c.height,c.widthSegments,c.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new _a[c.type](c.width,c.height,c.depth,c.widthSegments,c.heightSegments,c.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new _a[c.type](c.radius,c.segments,c.thetaStart,c.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new _a[c.type](c.radiusTop,c.radiusBottom,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new _a[c.type](c.radius,c.height,c.radialSegments,c.heightSegments,c.openEnded,c.thetaStart,c.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new _a[c.type](c.radius,c.widthSegments,c.heightSegments,c.phiStart,c.phiLength,c.thetaStart,c.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new _a[c.type](c.radius,c.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new _a[c.type](c.innerRadius,c.outerRadius,c.thetaSegments,c.phiSegments,c.thetaStart,c.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new _a[c.type](c.radius,c.tube,c.radialSegments,c.tubularSegments,c.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new _a[c.type](c.radius,c.tube,c.tubularSegments,c.radialSegments,c.p,c.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new _a[c.type](c.points,c.segments,c.phiStart,c.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new _a[c.type](c.vertices,c.indices,c.radius,c.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":var h=[];for(a=0,o=c.shapes.length;a<o;a++){var l=e[c.shapes[a]];h.push(l)}s=new _a[c.type](h,c.curveSegments);break;case"BufferGeometry":s=r.parse(c);break;case"Geometry":s=n.parse(c,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+c.type+'"');continue}s.uuid=c.uuid,void 0!==c.name&&(s.name=c.name),i[c.uuid]=s}return i},parseMaterials:function(t,e){var i={};if(void 0!==t){var n=new Wo;n.setTextures(e);for(var r=0,a=t.length;r<a;r++){var o=t[r];if("MultiMaterial"===o.type){for(var s=[],c=0;c<o.materials.length;c++)s.push(n.parse(o.materials[c]));i[o.uuid]=s}else i[o.uuid]=n.parse(o)}}return i},parseAnimations:function(t){for(var e=[],i=0;i<t.length;i++){var n=Bo.parse(t[i]);e.push(n)}return e},parseImages:function(t,e){var i=this,n={};function r(t){return i.manager.itemStart(t),a.load(t,function(){i.manager.itemEnd(t)},void 0,function(){i.manager.itemEnd(t),i.manager.itemError(t)})}if(void 0!==t&&t.length>0){var a=new Ha(new Ua(e));a.setCrossOrigin(this.crossOrigin);for(var o=0,s=t.length;o<s;o++){var c=t[o],h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(c.url)?c.url:i.texturePath+c.url;n[c.uuid]=r(h)}}return n},parseTextures:function(t,e){function i(t,e){return"number"==typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var n={};if(void 0!==t)for(var r=0,a=t.length;r<a;r++){var o=t[r];void 0===o.image&&console.warn('THREE.ObjectLoader: No "image" specified for',o.uuid),void 0===e[o.image]&&console.warn("THREE.ObjectLoader: Undefined image",o.image);var s=new He(e[o.image]);s.needsUpdate=!0,s.uuid=o.uuid,void 0!==o.name&&(s.name=o.name),void 0!==o.mapping&&(s.mapping=i(o.mapping,Xo)),void 0!==o.offset&&s.offset.fromArray(o.offset),void 0!==o.repeat&&s.repeat.fromArray(o.repeat),void 0!==o.center&&s.center.fromArray(o.center),void 0!==o.rotation&&(s.rotation=o.rotation),void 0!==o.wrap&&(s.wrapS=i(o.wrap[0],qo),s.wrapT=i(o.wrap[1],qo)),void 0!==o.minFilter&&(s.minFilter=i(o.minFilter,Zo)),void 0!==o.magFilter&&(s.magFilter=i(o.magFilter,Zo)),void 0!==o.anisotropy&&(s.anisotropy=o.anisotropy),void 0!==o.flipY&&(s.flipY=o.flipY),n[o.uuid]=s}return n},parseObject:function(t,e,i){var n;function r(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function a(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],n=0,r=t.length;n<r;n++){var a=t[n];void 0===i[a]&&console.warn("THREE.ObjectLoader: Undefined material",a),e.push(i[a])}return e}return void 0===i[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),i[t]}}switch(t.type){case"Scene":n=new Qn,void 0!==t.background&&Number.isInteger(t.background)&&(n.background=new Di(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?n.fog=new Kn(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(n.fog=new Jn(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":n=new Gn(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(n.focus=t.focus),void 0!==t.zoom&&(n.zoom=t.zoom),void 0!==t.filmGauge&&(n.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(n.filmOffset=t.filmOffset),void 0!==t.view&&(n.view=Object.assign({},t.view));break;case"OrthographicCamera":n=new tn(t.left,t.right,t.top,t.bottom,t.near,t.far);break;case"AmbientLight":n=new Mo(t.color,t.intensity);break;case"DirectionalLight":n=new Lo(t.color,t.intensity);break;case"PointLight":n=new wo(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":n=new _o(t.color,t.intensity,t.width,t.height);break;case"SpotLight":n=new xo(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":n=new go(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var o=r(t.geometry),s=a(t.material);n=o.bones&&o.bones.length>0?new rr(o,s):new Tn(o,s);break;case"LOD":n=new er;break;case"Line":n=new or(r(t.geometry),a(t.material),t.mode);break;case"LineLoop":n=new cr(r(t.geometry),a(t.material));break;case"LineSegments":n=new sr(r(t.geometry),a(t.material));break;case"PointCloud":case"Points":n=new lr(r(t.geometry),a(t.material));break;case"Sprite":n=new tr(a(t.material));break;case"Group":n=new ur;break;default:n=new Qi}if(n.uuid=t.uuid,void 0!==t.name&&(n.name=t.name),void 0!==t.matrix?(n.matrix.fromArray(t.matrix),n.matrix.decompose(n.position,n.quaternion,n.scale)):(void 0!==t.position&&n.position.fromArray(t.position),void 0!==t.rotation&&n.rotation.fromArray(t.rotation),void 0!==t.quaternion&&n.quaternion.fromArray(t.quaternion),void 0!==t.scale&&n.scale.fromArray(t.scale)),void 0!==t.castShadow&&(n.castShadow=t.castShadow),void 0!==t.receiveShadow&&(n.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(n.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(n.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&n.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(n.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(n.visible=t.visible),void 0!==t.userData&&(n.userData=t.userData),void 0!==t.children)for(var c=t.children,h=0;h<c.length;h++)n.add(this.parseObject(c[h],e,i));if("LOD"===t.type)for(var l=t.levels,u=0;u<l.length;u++){var d=l[u],p=n.getObjectByProperty("uuid",d.object);void 0!==p&&n.addLevel(p,d.distance)}return n}});var Yo,Xo={UVMapping:st,CubeReflectionMapping:ct,CubeRefractionMapping:ht,EquirectangularReflectionMapping:lt,EquirectangularRefractionMapping:ut,SphericalReflectionMapping:dt,CubeUVReflectionMapping:pt,CubeUVRefractionMapping:ft},qo={RepeatWrapping:mt,ClampToEdgeWrapping:gt,MirroredRepeatWrapping:vt},Zo={NearestFilter:yt,NearestMipMapNearestFilter:xt,NearestMipMapLinearFilter:wt,LinearFilter:bt,LinearMipMapNearestFilter:Lt,LinearMipMapLinearFilter:Mt};function Jo(t){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:Na,this.options=void 0}function Ko(){this.type="ShapePath",this.subPaths=[],this.currentPath=null}function Qo(t){this.type="Font",this.data=t}function $o(t,e,i,n,r,a){var o=a.glyphs[t]||a.glyphs["?"];if(o){var s,c,h,l,u,d,p,f,m=new Ko;if(o.o)for(var g=o._cachedOutline||(o._cachedOutline=o.o.split(" ")),v=0,y=g.length;v<y;)switch(g[v++]){case"m":s=g[v++]*i+n,c=g[v++]*i+r,m.moveTo(s,c);break;case"l":s=g[v++]*i+n,c=g[v++]*i+r,m.lineTo(s,c);break;case"q":h=g[v++]*i+n,l=g[v++]*i+r,u=g[v++]*i+n,d=g[v++]*i+r,m.quadraticCurveTo(u,d,h,l);break;case"b":h=g[v++]*i+n,l=g[v++]*i+r,u=g[v++]*i+n,d=g[v++]*i+r,p=g[v++]*i+n,f=g[v++]*i+r,m.bezierCurveTo(u,d,p,f,h,l)}return{offsetX:o.ha*i,path:m}}}function ts(t){this.manager=void 0!==t?t:Na}Jo.prototype={constructor:Jo,setOptions:function(t){return this.options=t,this},load:function(t,e,i,n){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var r=this,a=Fa.get(t);if(void 0!==a)return r.manager.itemStart(t),setTimeout(function(){e&&e(a),r.manager.itemEnd(t)},0),a;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,r.options)}).then(function(i){Fa.add(t,i),e&&e(i),r.manager.itemEnd(t)}).catch(function(e){n&&n(e),r.manager.itemEnd(t),r.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(Ko.prototype,{moveTo:function(t,e){this.currentPath=new po,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,i,n){this.currentPath.quadraticCurveTo(t,e,i,n)},bezierCurveTo:function(t,e,i,n,r,a){this.currentPath.bezierCurveTo(t,e,i,n,r,a)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function i(t){for(var e=[],i=0,n=t.length;i<n;i++){var r=t[i],a=new fo;a.curves=r.curves,e.push(a)}return e}function n(t,e){for(var i=e.length,n=!1,r=i-1,a=0;a<i;r=a++){var o=e[r],s=e[a],c=s.x-o.x,h=s.y-o.y;if(Math.abs(h)>Number.EPSILON){if(h<0&&(o=e[a],c=-c,s=e[r],h=-h),t.y<o.y||t.y>s.y)continue;if(t.y===o.y){if(t.x===o.x)return!0}else{var l=h*(t.x-o.x)-c*(t.y-o.y);if(0===l)return!0;if(l<0)continue;n=!n}}else{if(t.y!==o.y)continue;if(s.x<=t.x&&t.x<=o.x||o.x<=t.x&&t.x<=s.x)return!0}}return n}var r=ea.isClockWise,a=this.subPaths;if(0===a.length)return[];if(!0===e)return i(a);var o,s,c,h=[];if(1===a.length)return s=a[0],(c=new fo).curves=s.curves,h.push(c),h;var l=!r(a[0].getPoints());l=t?!l:l;var u,d,p=[],f=[],m=[],g=0;f[g]=void 0,m[g]=[];for(var v=0,y=a.length;v<y;v++)o=r(u=(s=a[v]).getPoints()),(o=t?!o:o)?(!l&&f[g]&&g++,f[g]={s:new fo,p:u},f[g].s.curves=s.curves,l&&g++,m[g]=[]):m[g].push({h:s,p:u[0]});if(!f[0])return i(a);if(f.length>1){for(var x=!1,w=[],b=0,L=f.length;b<L;b++)p[b]=[];for(b=0,L=f.length;b<L;b++)for(var M=m[b],_=0;_<M.length;_++){for(var A=M[_],E=!0,S=0;S<f.length;S++)n(A.p,f[S].p)&&(b!==S&&w.push({froms:b,tos:S,hole:_}),E?(E=!1,p[S].push(A)):x=!0);E&&p[b].push(A)}w.length>0&&(x||(m=p))}v=0;for(var T=f.length;v<T;v++){c=f[v].s,h.push(c);for(var R=0,O=(d=m[v]).length;R<O;R++)c.holes.push(d[R].h)}return h}}),Object.assign(Qo.prototype,{isFont:!0,generateShapes:function(t,e,i){void 0===e&&(e=100),void 0===i&&(i=4);for(var n=[],r=function(t,e,i,n){for(var r=String(t).split(""),a=e/n.resolution,o=(n.boundingBox.yMax-n.boundingBox.yMin+n.underlineThickness)*a,s=[],c=0,h=0,l=0;l<r.length;l++){var u=r[l];if("\n"===u)c=0,h-=o;else{var d=$o(u,0,a,c,h,n);c+=d.offsetX,s.push(d.path)}}return s}(t,e,0,this.data),a=0,o=r.length;a<o;a++)Array.prototype.push.apply(n,r[a].toShapes());return n}}),Object.assign(ts.prototype,{load:function(t,e,i,n){var r=this,a=new Wa(this.manager);a.setPath(this.path),a.load(t,function(t){var i;try{i=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),i=JSON.parse(t.substring(65,t.length-2))}var n=r.parse(i);e&&e(n)},i,n)},parse:function(t){return new Qo(t)},setPath:function(t){return this.path=t,this}});var es,is,ns={getContext:function(){return void 0===Yo&&(Yo=new(window.AudioContext||window.webkitAudioContext)),Yo},setContext:function(t){Yo=t}};function rs(t){this.manager=void 0!==t?t:Na}function as(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Gn,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Gn,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function os(t,e,i){Qi.call(this),this.type="CubeCamera";var n=new Gn(90,1,t,e);n.up.set(0,-1,0),n.lookAt(new We(1,0,0)),this.add(n);var r=new Gn(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new We(-1,0,0)),this.add(r);var a=new Gn(90,1,t,e);a.up.set(0,0,1),a.lookAt(new We(0,1,0)),this.add(a);var o=new Gn(90,1,t,e);o.up.set(0,0,-1),o.lookAt(new We(0,-1,0)),this.add(o);var s=new Gn(90,1,t,e);s.up.set(0,-1,0),s.lookAt(new We(0,0,1)),this.add(s);var c=new Gn(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new We(0,0,-1)),this.add(c);var h={format:Nt,magFilter:bt,minFilter:bt};this.renderTarget=new je(i,i,h),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var i=this.renderTarget,h=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,i.activeCubeFace=0,t.render(e,n,i),i.activeCubeFace=1,t.render(e,r,i),i.activeCubeFace=2,t.render(e,a,i),i.activeCubeFace=3,t.render(e,o,i),i.activeCubeFace=4,t.render(e,s,i),i.texture.generateMipmaps=h,i.activeCubeFace=5,t.render(e,c,i),t.setRenderTarget(null)},this.clear=function(t,e,i,n){for(var r=this.renderTarget,a=0;a<6;a++)r.activeCubeFace=a,t.setRenderTarget(r),t.clear(e,i,n);t.setRenderTarget(null)}}function ss(){Qi.call(this),this.type="AudioListener",this.context=ns.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function cs(t){Qi.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function hs(t){cs.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function ls(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function us(t,e,i){this.binding=t,this.valueSize=i;var n,r=Float64Array;switch(e){case"quaternion":n=this._slerp;break;case"string":case"bool":r=Array,n=this._select;break;default:n=this._lerp}this.buffer=new r(4*i),this._mixBufferRegion=n,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function ds(t,e,i){var n=i||ps.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,n)}function ps(t,e,i){this.path=e,this.parsedPath=i||ps.parseTrackName(e),this.node=ps.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function fs(){this.uuid=Fe.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,i=arguments.length;e!==i;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}function ms(t,e,i){this._mixer=t,this._clip=e,this._localRoot=i||null;for(var n=e.tracks,r=n.length,a=new Array(r),o={endingStart:xe,endingEnd:xe},s=0;s!==r;++s){var c=n[s].createInterpolant(null);a[s]=c,c.settings=o}this._interpolantSettings=o,this._interpolants=a,this._propertyBindings=new Array(r),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=fe,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function gs(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function vs(t){"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function ys(){yn.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function xs(t,e,i,n){this.uuid=Fe.generateUUID(),this.data=t,this.itemSize=e,this.offset=i,this.normalized=!0===n}function ws(t,e){this.uuid=Fe.generateUUID(),this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.onUploadCallback=function(){},this.version=0}function bs(t,e,i){ws.call(this,t,e),this.meshPerAttribute=i||1}function Ls(t,e,i){an.call(this,t,e),this.meshPerAttribute=i||1}function Ms(t,e,i,n){this.ray=new An(t,e),this.near=i||0,this.far=n||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function _s(t,e){return t.distance-e.distance}function As(t,e,i,n){if(!1!==t.visible&&(t.raycast(e,i),!0===n))for(var r=t.children,a=0,o=r.length;a<o;a++)As(r[a],e,i,!0)}function Es(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ss(t,e,i){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==i?i:0,this}function Ts(t,e,i){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==i?i:0,this}function Rs(t,e){this.min=void 0!==t?t:new Ue(1/0,1/0),this.max=void 0!==e?e:new Ue(-1/0,-1/0)}function Os(t){Qi.call(this),this.material=t,this.render=function(){}}function Ps(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16711680,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=3*s.faces.length:s&&s.isBufferGeometry&&(o=s.attributes.normal.count);var c=new yn,h=new pn(2*o*3,3);c.addAttribute("position",h),sr.call(this,c,new ar({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function Cs(t,e){Qi.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var i=new yn,n=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],r=0,a=1;r<32;r++,a++){var o=r/32*Math.PI*2,s=a/32*Math.PI*2;n.push(Math.cos(o),Math.sin(o),1,Math.cos(s),Math.sin(s),1)}i.addAttribute("position",new pn(n,3));var c=new ar({fog:!1});this.cone=new sr(i,c),this.add(this.cone),this.update()}function Is(t){for(var e=function t(e){var i=[];e&&e.isBone&&i.push(e);for(var n=0;n<e.children.length;n++)i.push.apply(i,t(e.children[n]));return i}(t),i=new yn,n=[],r=[],a=new Di(0,0,1),o=new Di(0,1,0),s=0;s<e.length;s++){var c=e[s];c.parent&&c.parent.isBone&&(n.push(0,0,0),n.push(0,0,0),r.push(a.r,a.g,a.b),r.push(o.r,o.g,o.b))}i.addAttribute("position",new pn(n,3)),i.addAttribute("color",new pn(r,3));var h=new ar({vertexColors:L,depthTest:!1,depthWrite:!1,transparent:!0});sr.call(this,i,h),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function Ds(t,e,i){this.light=t,this.light.updateMatrixWorld(),this.color=i;var n=new ha(e,4,2),r=new Mn({wireframe:!0,fog:!1});Tn.call(this,n,r),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function Fs(t,e){Qi.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var i=new ar({fog:!1}),n=new yn;n.addAttribute("position",new an(new Float32Array(15),3)),this.line=new or(n,i),this.add(this.line),this.update()}function Us(t,e,i){Qi.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;var n=new Mr(e);n.rotateY(.5*Math.PI),this.material=new Mn({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=L);var r=n.getAttribute("position"),a=new Float32Array(3*r.count);n.addAttribute("color",new an(a,3)),this.add(new Tn(n,this.material)),this.update()}function Ns(t,e,i,n){t=t||10,e=e||10,i=new Di(void 0!==i?i:4473924),n=new Di(void 0!==n?n:8947848);for(var r=e/2,a=t/e,o=t/2,s=[],c=[],h=0,l=0,u=-o;h<=e;h++,u+=a){s.push(-o,0,u,o,0,u),s.push(u,0,-o,u,0,o);var d=h===r?i:n;d.toArray(c,l),l+=3,d.toArray(c,l),l+=3,d.toArray(c,l),l+=3,d.toArray(c,l),l+=3}var p=new yn;p.addAttribute("position",new pn(s,3)),p.addAttribute("color",new pn(c,3));var f=new ar({vertexColors:L});sr.call(this,p,f)}function Bs(t,e,i,n,r,a){t=t||10,e=e||16,i=i||8,n=n||64,r=new Di(void 0!==r?r:4473924),a=new Di(void 0!==a?a:8947848);var o,s,c,h,l,u,d,p=[],f=[];for(h=0;h<=e;h++)c=h/e*(2*Math.PI),o=Math.sin(c)*t,s=Math.cos(c)*t,p.push(0,0,0),p.push(o,0,s),d=1&h?r:a,f.push(d.r,d.g,d.b),f.push(d.r,d.g,d.b);for(h=0;h<=i;h++)for(d=1&h?r:a,u=t-t/i*h,l=0;l<n;l++)c=l/n*(2*Math.PI),o=Math.sin(c)*u,s=Math.cos(c)*u,p.push(o,0,s),f.push(d.r,d.g,d.b),c=(l+1)/n*(2*Math.PI),o=Math.sin(c)*u,s=Math.cos(c)*u,p.push(o,0,s),f.push(d.r,d.g,d.b);var m=new yn;m.addAttribute("position",new pn(p,3)),m.addAttribute("color",new pn(f,3));var g=new ar({vertexColors:L});sr.call(this,m,g)}function Ws(t,e,i,n){this.object=t,this.size=void 0!==e?e:1;var r=void 0!==i?i:16776960,a=void 0!==n?n:1,o=0,s=this.object.geometry;s&&s.isGeometry?o=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var c=new yn,h=new pn(2*o*3,3);c.addAttribute("position",h),sr.call(this,c,new ar({color:r,linewidth:a})),this.matrixAutoUpdate=!1,this.update()}function zs(t,e,i){Qi.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,void 0===e&&(e=1);var n=new yn;n.addAttribute("position",new pn([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var r=new ar({fog:!1});this.lightPlane=new or(n,r),this.add(this.lightPlane),(n=new yn).addAttribute("position",new pn([0,0,0,0,0,1],3)),this.targetLine=new or(n,r),this.add(this.targetLine),this.update()}function ks(t){var e=new yn,i=new ar({color:16777215,vertexColors:b}),n=[],r=[],a={},o=new Di(16755200),s=new Di(16711680),c=new Di(43775),h=new Di(16777215),l=new Di(3355443);function u(t,e,i){d(t,i),d(e,i)}function d(t,e){n.push(0,0,0),r.push(e.r,e.g,e.b),void 0===a[t]&&(a[t]=[]),a[t].push(n.length/3-1)}u("n1","n2",o),u("n2","n4",o),u("n4","n3",o),u("n3","n1",o),u("f1","f2",o),u("f2","f4",o),u("f4","f3",o),u("f3","f1",o),u("n1","f1",o),u("n2","f2",o),u("n3","f3",o),u("n4","f4",o),u("p","n1",s),u("p","n2",s),u("p","n3",s),u("p","n4",s),u("u1","u2",c),u("u2","u3",c),u("u3","u1",c),u("c","t",h),u("p","c",l),u("cn1","cn2",l),u("cn3","cn4",l),u("cf1","cf2",l),u("cf3","cf4",l),e.addAttribute("position",new pn(n,3)),e.addAttribute("color",new pn(r,3)),sr.call(this,e,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=a,this.update()}function Hs(t,e){this.object=t,void 0===e&&(e=16776960);var i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),n=new Float32Array(24),r=new yn;r.setIndex(new an(i,1)),r.addAttribute("position",new an(n,3)),sr.call(this,r,new ar({color:e})),this.matrixAutoUpdate=!1,this.update()}function Gs(t,e){this.type="Box3Helper",this.box=t;var i=void 0!==e?e:16776960,n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new yn;r.setIndex(new an(n,1)),r.addAttribute("position",new pn([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3)),sr.call(this,r,new ar({color:i})),this.geometry.computeBoundingSphere()}function Vs(t,e,i){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var n=void 0!==i?i:16776960,r=new yn;r.addAttribute("position",new pn([1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],3)),r.computeBoundingSphere(),or.call(this,r,new ar({color:n}));var a=new yn;a.addAttribute("position",new pn([1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],3)),a.computeBoundingSphere(),this.add(new Tn(a,new Mn({color:n,opacity:.2,transparent:!0,depthWrite:!1})))}function js(t,e,i,n,r,a){Qi.call(this),void 0===n&&(n=16776960),void 0===i&&(i=1),void 0===r&&(r=.2*i),void 0===a&&(a=.2*r),void 0===es&&((es=new yn).addAttribute("position",new pn([0,0,0,0,1,0],3)),(is=new xa(0,.5,1,5,1)).translate(0,-.5,0)),this.position.copy(e),this.line=new or(es,new ar({color:n})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Tn(is,new Mn({color:n})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,r,a)}function Ys(t){var e=[0,0,0,t=t||1,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=new yn;i.addAttribute("position",new pn(e,3)),i.addAttribute("color",new pn([1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],3));var n=new ar({vertexColors:L});sr.call(this,i,n)}function Xs(t,e,i,n,r,a,o){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new en(t,e,i,r,a,o)}Object.assign(rs.prototype,{load:function(t,e,i,n){var r=new Wa(this.manager);r.setResponseType("arraybuffer"),r.load(t,function(t){ns.getContext().decodeAudioData(t,function(t){e(t)})},i,n)}}),Object.assign(as.prototype,{update:function(){var t,e,i,n,r,a,o,s,c=new Ne,h=new Ne;return function(l){if(t!==this||e!==l.focus||i!==l.fov||n!==l.aspect*this.aspect||r!==l.near||a!==l.far||o!==l.zoom||s!==this.eyeSep){t=this,e=l.focus,i=l.fov,n=l.aspect*this.aspect,r=l.near,a=l.far,o=l.zoom;var u,d,p=l.projectionMatrix.clone(),f=(s=this.eyeSep/2)*r/e,m=r*Math.tan(Fe.DEG2RAD*i*.5)/o;h.elements[12]=-s,c.elements[12]=s,u=-m*n+f,d=m*n+f,p.elements[0]=2*r/(d-u),p.elements[8]=(d+u)/(d-u),this.cameraL.projectionMatrix.copy(p),u=-m*n-f,d=m*n-f,p.elements[0]=2*r/(d-u),p.elements[8]=(d+u)/(d-u),this.cameraR.projectionMatrix.copy(p)}this.cameraL.matrixWorld.copy(l.matrixWorld).multiply(h),this.cameraR.matrixWorld.copy(l.matrixWorld).multiply(c)}}()}),os.prototype=Object.create(Qi.prototype),os.prototype.constructor=os,ss.prototype=Object.assign(Object.create(Qi.prototype),{constructor:ss,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.value=t},updateMatrixWorld:function(){var t=new We,e=new Be,i=new We,n=new We;return function(r){Qi.prototype.updateMatrixWorld.call(this,r);var a=this.context.listener,o=this.up;this.matrixWorld.decompose(t,e,i),n.set(0,0,-1).applyQuaternion(e),a.positionX?(a.positionX.setValueAtTime(t.x,this.context.currentTime),a.positionY.setValueAtTime(t.y,this.context.currentTime),a.positionZ.setValueAtTime(t.z,this.context.currentTime),a.forwardX.setValueAtTime(n.x,this.context.currentTime),a.forwardY.setValueAtTime(n.y,this.context.currentTime),a.forwardZ.setValueAtTime(n.z,this.context.currentTime),a.upX.setValueAtTime(o.x,this.context.currentTime),a.upY.setValueAtTime(o.y,this.context.currentTime),a.upZ.setValueAtTime(o.z,this.context.currentTime)):(a.setPosition(t.x,t.y,t.z),a.setOrientation(n.x,n.y,n.z,o.x,o.y,o.z))}}()}),cs.prototype=Object.assign(Object.create(Qi.prototype),{constructor:cs,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")},pause:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")},stop:function(){if(!1!==this.hasPlaybackControl)return this.source.stop(),this.offset=0,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){if(!1!==this.hasPlaybackControl)return this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this;console.warn("THREE.Audio: this Audio has no playback control.")},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){if(!1!==this.hasPlaybackControl)return this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.value=t,this}}),hs.prototype=Object.assign(Object.create(cs.prototype),{constructor:hs,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new We;return function(e){Qi.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(ls.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),i=0;i<e.length;i++)t+=e[i];return t/e.length}}),Object.assign(us.prototype,{accumulate:function(t,e){var i=this.buffer,n=this.valueSize,r=t*n+n,a=this.cumulativeWeight;if(0===a){for(var o=0;o!==n;++o)i[r+o]=i[o];a=e}else{var s=e/(a+=e);this._mixBufferRegion(i,r,0,s,n)}this.cumulativeWeight=a},apply:function(t){var e=this.valueSize,i=this.buffer,n=t*e+e,r=this.cumulativeWeight,a=this.binding;if(this.cumulativeWeight=0,r<1){var o=3*e;this._mixBufferRegion(i,n,o,1-r,e)}for(var s=e,c=e+e;s!==c;++s)if(i[s]!==i[s+e]){a.setValue(i,n);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,i=this.valueSize,n=3*i;t.getValue(e,n);for(var r=i,a=n;r!==a;++r)e[r]=e[n+r%i];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,i,n,r){if(n>=.5)for(var a=0;a!==r;++a)t[e+a]=t[i+a]},_slerp:function(t,e,i,n){Be.slerpFlat(t,e,t,e,t,i,n)},_lerp:function(t,e,i,n,r){for(var a=1-n,o=0;o!==r;++o){var s=e+o;t[s]=t[s]*a+t[i+o]*n}}}),Object.assign(ds.prototype,{getValue:function(t,e){this.bind();var i=this._targetGroup.nCachedObjects_,n=this._bindings[i];void 0!==n&&n.getValue(t,e)},setValue:function(t,e){for(var i=this._bindings,n=this._targetGroup.nCachedObjects_,r=i.length;n!==r;++n)i[n].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,i=t.length;e!==i;++e)t[e].unbind()}}),Object.assign(ps,{Composite:ds,create:function(t,e,i){return t&&t.isAnimationObjectGroup?new ps.Composite(t,e,i):new ps(t,e,i)},sanitizeNodeName:function(){var t=new RegExp("[\\[\\]\\.:\\/]","g");return function(e){return e.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^\\[\\]\\.:\\/]",e="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",i=/((?:WC+[\/:])*)/.source.replace("WC",t),n=/(WCOD+)?/.source.replace("WCOD",e),r=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),a=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),o=new RegExp("^"+i+n+r+a+"$"),s=["material","materials","bones"];return function(t){var e=o.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var i={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},n=i.nodeName&&i.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){var r=i.nodeName.substring(n+1);-1!==s.indexOf(r)&&(i.nodeName=i.nodeName.substring(0,n),i.objectName=r)}if(null===i.propertyName||0===i.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var i=t.skeleton.getBoneByName(e);if(void 0!==i)return i}if(t.children){var n=function(t){for(var i=0;i<t.length;i++){var r=t[i];if(r.name===e||r.uuid===e)return r;var a=n(r.children);if(a)return a}return null},r=n(t.children);if(r)return r}return null}}),Object.assign(ps.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)t[e++]=i[n]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++]},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var i=this.resolvedProperty,n=0,r=i.length;n!==r;++n)i[n]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,i=e.objectName,n=e.propertyName,r=e.propertyIndex;if(t||(t=ps.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(i){var a=e.objectIndex;switch(i){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var o=0;o<t.length;o++)if(t[o].name===a){a=o;break}break;default:if(void 0===t[i])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[i]}if(void 0!==a){if(void 0===t[a])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[a]}}var s=t[n];if(void 0!==s){var c=this.Versioning.None;void 0!==t.needsUpdate?(c=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var h=this.BindingType.Direct;if(void 0!==r){if("morphTargetInfluences"===n){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(o=0;o<this.node.geometry.morphAttributes.position.length;o++)if(t.geometry.morphAttributes.position[o].name===r){r=o;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(o=0;o<this.node.geometry.morphTargets.length;o++)if(t.geometry.morphTargets[o].name===r){r=o;break}}}h=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=r}else void 0!==s.fromArray&&void 0!==s.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(h=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=n;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][c]}else{var l=e.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+l+"."+n+" but it wasn't found.",t)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),
//!\ DECLARE ALIAS AFTER assign prototype !
Object.assign(ps.prototype,{_getValue_unbound:ps.prototype.getValue,_setValue_unbound:ps.prototype.setValue}),Object.assign(fs.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._paths,a=this._parsedPaths,o=this._bindings,s=o.length,c=void 0,h=0,l=arguments.length;h!==l;++h){var u=arguments[h],d=u.uuid,p=n[d];if(void 0===p){p=e++,n[d]=p,t.push(u);for(var f=0,m=s;f!==m;++f)o[f].push(new ps(u,r[f],a[f]))}else if(p<i){c=t[p];var g=--i,v=t[g];for(n[v.uuid]=p,t[p]=v,n[d]=g,t[g]=u,f=0,m=s;f!==m;++f){var y=o[f],x=y[g],w=y[p];y[p]=x,void 0===w&&(w=new ps(u,r[f],a[f])),y[g]=w}}else t[p]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=i},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,i=this._indicesByUUID,n=this._bindings,r=n.length,a=0,o=arguments.length;a!==o;++a){var s=arguments[a],c=s.uuid,h=i[c];if(void 0!==h&&h>=e){var l=e++,u=t[l];i[u.uuid]=h,t[h]=u,i[c]=l,t[l]=s;for(var d=0,p=r;d!==p;++d){var f=n[d],m=f[l],g=f[h];f[h]=m,f[l]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,i=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,a=r.length,o=0,s=arguments.length;o!==s;++o){var c=arguments[o].uuid,h=n[c];if(void 0!==h)if(delete n[c],h<i){var l=--i,u=t[l],d=t[v=--e];n[u.uuid]=h,t[h]=u,n[d.uuid]=l,t[l]=d,t.pop();for(var p=0,f=a;p!==f;++p){var m=(y=r[p])[l],g=y[v];y[h]=m,y[l]=g,y.pop()}}else{var v;for(n[(d=t[v=--e]).uuid]=h,t[h]=d,t.pop(),p=0,f=a;p!==f;++p){var y;(y=r[p])[h]=y[v],y.pop()}}}this.nCachedObjects_=i},subscribe_:function(t,e){var i=this._bindingsIndicesByPath,n=i[t],r=this._bindings;if(void 0!==n)return r[n];var a=this._paths,o=this._parsedPaths,s=this._objects,c=s.length,h=this.nCachedObjects_,l=new Array(c);n=r.length,i[t]=n,a.push(t),o.push(e),r.push(l);for(var u=h,d=s.length;u!==d;++u){var p=s[u];l[u]=new ps(p,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,i=e[t];if(void 0!==i){var n=this._paths,r=this._parsedPaths,a=this._bindings,o=a.length-1,s=a[o];e[t[o]]=i,a[i]=s,a.pop(),r[i]=r[o],r.pop(),n[i]=n[o],n.pop()}}}),Object.assign(ms.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,i){if(t.fadeOut(e),this.fadeIn(e),i){var n=this._clip.duration,r=t._clip.duration,a=r/n,o=n/r;t.warp(1,a,e),this.warp(o,1,e)}return this},crossFadeTo:function(t,e,i){return t.crossFadeFrom(this,e,i)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,i){var n=this._mixer,r=n.time,a=this._timeScaleInterpolant,o=this.timeScale;null===a&&(a=n._lendControlInterpolant(),this._timeScaleInterpolant=a);var s=a.parameterPositions,c=a.sampleValues;return s[0]=r,s[1]=r+i,c[0]=t/o,c[1]=e/o,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,i,n){if(this.enabled){var r=this._startTime;if(null!==r){var a=(t-r)*i;if(a<0||0===i)return;this._startTime=null,e=i*a}e*=this._updateTimeScale(t);var o=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var c=this._interpolants,h=this._propertyBindings,l=0,u=c.length;l!==u;++l)c[l].evaluate(o),h[l].accumulate(n,s)}else this._updateWeight(t)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var i=this._weightInterpolant;if(null!==i){var n=i.evaluate(t)[0];e*=n,t>i.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var i=this._timeScaleInterpolant;null!==i&&(e*=i.evaluate(t)[0],t>i.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e))}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var i=this._clip.duration,n=this.loop,r=this._loopCount;if(n===pe){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=i)e=i;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var a=n===me;if(-1===r&&(t>=0?(r=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),e>=i||e<0){var o=Math.floor(e/i);e-=i*o,r+=Math.abs(o);var s=this.repetitions-r;if(s<0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?i:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(0===s){var c=t<0;this._setEndings(c,!c,a)}else this._setEndings(!1,!1,a);this._loopCount=r,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:o})}}if(a&&1==(1&r))return this.time=e,i-e}return this.time=e,e},_setEndings:function(t,e,i){var n=this._interpolantSettings;i?(n.endingStart=we,n.endingEnd=we):(n.endingStart=t?this.zeroSlopeAtStart?we:xe:be,n.endingEnd=e?this.zeroSlopeAtEnd?we:xe:be)},_scheduleFading:function(t,e,i){var n=this._mixer,r=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);var o=a.parameterPositions,s=a.sampleValues;return o[0]=r,s[0]=e,o[1]=r+t,s[1]=i,this}}),gs.prototype=Object.assign(Object.create(n.prototype),{constructor:gs,_bindAction:function(t,e){var i=t._localRoot||this._root,n=t._clip.tracks,r=n.length,a=t._propertyBindings,o=t._interpolants,s=i.uuid,c=this._bindingsByRootAndName,h=c[s];void 0===h&&(h={},c[s]=h);for(var l=0;l!==r;++l){var u=n[l],d=u.name,p=h[d];if(void 0!==p)a[l]=p;else{if(void 0!==(p=a[l])){null===p._cacheIndex&&(++p.referenceCount,this._addInactiveBinding(p,s,d));continue}var f=e&&e._propertyBindings[l].binding.parsedPath;++(p=new us(ps.create(i,d,f),u.ValueTypeName,u.getValueSize())).referenceCount,this._addInactiveBinding(p,s,d),a[l]=p}o[l].resultBuffer=p.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,i=t._clip.uuid,n=this._actionsByClip[i];this._bindAction(t,n&&n.knownActions[0]),this._addInactiveAction(t,i,e)}for(var r=t._propertyBindings,a=0,o=r.length;a!==o;++a){var s=r[a];0==s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,i){var n=this._actions,r=this._actionsByClip,a=r[e];if(void 0===a)a={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,r[e]=a;else{var o=a.knownActions;t._byClipCacheIndex=o.length,o.push(t)}t._cacheIndex=n.length,n.push(t),a.actionByRoot[i]=t},_removeInactiveAction:function(t){var e=this._actions,i=e[e.length-1],n=t._cacheIndex;i._cacheIndex=n,e[n]=i,e.pop(),t._cacheIndex=null;var r=t._clip.uuid,a=this._actionsByClip,o=a[r],s=o.knownActions,c=s[s.length-1],h=t._byClipCacheIndex;c._byClipCacheIndex=h,s[h]=c,s.pop(),t._byClipCacheIndex=null,delete o.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete a[r],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,i=0,n=e.length;i!==n;++i){var r=e[i];0==--r.referenceCount&&this._removeInactiveBinding(r)}},_lendAction:function(t){var e=this._actions,i=t._cacheIndex,n=this._nActiveActions++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackAction:function(t){var e=this._actions,i=t._cacheIndex,n=--this._nActiveActions,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_addInactiveBinding:function(t,e,i){var n=this._bindingsByRootAndName,r=n[e],a=this._bindings;void 0===r&&(r={},n[e]=r),r[i]=t,t._cacheIndex=a.length,a.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,i=t.binding,n=i.rootNode.uuid,r=i.path,a=this._bindingsByRootAndName,o=a[n],s=e[e.length-1],c=t._cacheIndex;s._cacheIndex=c,e[c]=s,e.pop(),delete o[r];t:{for(var h in o)break t;delete a[n]}},_lendBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=this._nActiveBindings++,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_takeBackBinding:function(t){var e=this._bindings,i=t._cacheIndex,n=--this._nActiveBindings,r=e[n];t._cacheIndex=n,e[n]=t,r._cacheIndex=i,e[i]=r},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,i=t[e];return void 0===i&&((i=new Io(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=e,t[e]=i),i},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,i=t.__cacheIndex,n=--this._nActiveControlInterpolants,r=e[n];t.__cacheIndex=n,e[n]=t,r.__cacheIndex=i,e[i]=r},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?Bo.findByName(i,t):t,a=null!==r?r.uuid:t,o=this._actionsByClip[a],s=null;if(void 0!==o){var c=o.actionByRoot[n];if(void 0!==c)return c;s=o.knownActions[0],null===r&&(r=s._clip)}if(null===r)return null;var h=new ms(this,r,e);return this._bindAction(h,s),this._addInactiveAction(h,a,n),h},existingAction:function(t,e){var i=e||this._root,n=i.uuid,r="string"==typeof t?Bo.findByName(i,t):t,a=r?r.uuid:t,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,i=this._bindings,n=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var r=0;r!==e;++r)t[r].reset();for(r=0;r!==n;++r)i[r].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,i=this._nActiveActions,n=this.time+=t,r=Math.sign(t),a=this._accuIndex^=1,o=0;o!==i;++o)e[o]._update(n,t,r,a);var s=this._bindings,c=this._nActiveBindings;for(o=0;o!==c;++o)s[o].apply(a);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,i=t.uuid,n=this._actionsByClip,r=n[i];if(void 0!==r){for(var a=r.knownActions,o=0,s=a.length;o!==s;++o){var c=a[o];this._deactivateAction(c);var h=c._cacheIndex,l=e[e.length-1];c._cacheIndex=null,c._byClipCacheIndex=null,l._cacheIndex=h,e[h]=l,e.pop(),this._removeInactiveBindingsForAction(c)}delete n[i]}},uncacheRoot:function(t){var e=t.uuid,i=this._actionsByClip;for(var n in i){var r=i[n].actionByRoot[e];void 0!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}var a=this._bindingsByRootAndName[e];if(void 0!==a)for(var o in a){var s=a[o];s.restoreOriginalState(),this._removeInactiveBinding(s)}},uncacheAction:function(t,e){var i=this.existingAction(t,e);null!==i&&(this._deactivateAction(i),this._removeInactiveAction(i))}}),vs.prototype.clone=function(){return new vs(void 0===this.value.clone?this.value:this.value.clone())},ys.prototype=Object.assign(Object.create(yn.prototype),{constructor:ys,isInstancedBufferGeometry:!0,copy:function(t){return yn.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(xs.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(xs.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this},setXYZ:function(t,e,i,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this},setXYZW:function(t,e,i,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=i,this.data.array[t+2]=n,this.data.array[t+3]=r,this}}),Object.defineProperty(ws.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(ws.prototype,{isInterleavedBuffer:!0,setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.count=void 0!==t?t.length/this.stride:0,this.array=t},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,i){t*=this.stride,i*=e.stride;for(var n=0,r=this.stride;n<r;n++)this.array[t+n]=e.array[i+n];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),bs.prototype=Object.assign(Object.create(ws.prototype),{constructor:bs,isInstancedInterleavedBuffer:!0,copy:function(t){return ws.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Ls.prototype=Object.assign(Object.create(an.prototype),{constructor:Ls,isInstancedBufferAttribute:!0,copy:function(t){return an.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Ms.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e){var i=[];return As(t,this,i,e),i.sort(_s),i},intersectObjects:function(t,e){var i=[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),i;for(var n=0,r=t.length;n<r;n++)As(t[n],this,i,e);return i.sort(_s),i}}),Object.assign(Es.prototype,{start:function(){this.startTime=("undefined"==typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"==typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(Ss.prototype,{set:function(t,e,i){return this.radius=t,this.phi=e,this.theta=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Fe.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(Ts.prototype,{set:function(t,e,i){return this.radius=t,this.theta=e,this.y=i,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),Object.assign(Rs.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,i=t.length;e<i;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new Ue;return function(e,i){var n=t.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){var e=t||new Ue;return this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){var e=t||new Ue;return this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return(e||new Ue).set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return(e||new Ue).copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new Ue;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Os.prototype=Object.create(Qi.prototype),Os.prototype.constructor=Os,Os.prototype.isImmediateRenderObject=!0,Ps.prototype=Object.create(sr.prototype),Ps.prototype.constructor=Ps,Ps.prototype.update=function(){var t=new We,e=new We,i=new ze;return function(){var n=["a","b","c"];this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);var r=this.object.matrixWorld,a=this.geometry.attributes.position,o=this.object.geometry;if(o&&o.isGeometry)for(var s=o.vertices,c=o.faces,h=0,l=0,u=c.length;l<u;l++)for(var d=c[l],p=0,f=d.vertexNormals.length;p<f;p++){var m=s[d[n[p]]],g=d.vertexNormals[p];t.copy(m).applyMatrix4(r),e.copy(g).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),a.setXYZ(h,t.x,t.y,t.z),h+=1,a.setXYZ(h,e.x,e.y,e.z),h+=1}else if(o&&o.isBufferGeometry){var v=o.attributes.position,y=o.attributes.normal;for(h=0,p=0,f=v.count;p<f;p++)t.set(v.getX(p),v.getY(p),v.getZ(p)).applyMatrix4(r),e.set(y.getX(p),y.getY(p),y.getZ(p)),e.applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),a.setXYZ(h,t.x,t.y,t.z),h+=1,a.setXYZ(h,e.x,e.y,e.z),h+=1}a.needsUpdate=!0}}(),Cs.prototype=Object.create(Qi.prototype),Cs.prototype.constructor=Cs,Cs.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},Cs.prototype.update=function(){var t=new We,e=new We;return function(){this.light.updateMatrixWorld();var i=this.light.distance?this.light.distance:1e3,n=i*Math.tan(this.light.angle);this.cone.scale.set(n,n,i),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),Is.prototype=Object.create(sr.prototype),Is.prototype.constructor=Is,Is.prototype.updateMatrixWorld=function(){var t=new We,e=new Ne,i=new Ne;return function(n){var r=this.bones,a=this.geometry,o=a.getAttribute("position");i.getInverse(this.root.matrixWorld);for(var s=0,c=0;s<r.length;s++){var h=r[s];h.parent&&h.parent.isBone&&(e.multiplyMatrices(i,h.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(c,t.x,t.y,t.z),e.multiplyMatrices(i,h.parent.matrixWorld),t.setFromMatrixPosition(e),o.setXYZ(c+1,t.x,t.y,t.z),c+=2)}a.getAttribute("position").needsUpdate=!0,Qi.prototype.updateMatrixWorld.call(this,n)}}(),Ds.prototype=Object.create(Tn.prototype),Ds.prototype.constructor=Ds,Ds.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},Ds.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},Fs.prototype=Object.create(Qi.prototype),Fs.prototype.constructor=Fs,Fs.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Fs.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,i=this.line.geometry.attributes.position,n=i.array;n[0]=t,n[1]=-e,n[2]=0,n[3]=t,n[4]=e,n[5]=0,n[6]=-t,n[7]=e,n[8]=0,n[9]=-t,n[10]=-e,n[11]=0,n[12]=t,n[13]=-e,n[14]=0,i.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},Us.prototype=Object.create(Qi.prototype),Us.prototype.constructor=Us,Us.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},Us.prototype.update=function(){var t=new We,e=new Di,i=new Di;return function(){var n=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var r=n.geometry.getAttribute("color");e.copy(this.light.color),i.copy(this.light.groundColor);for(var a=0,o=r.count;a<o;a++){var s=a<o/2?e:i;r.setXYZ(a,s.r,s.g,s.b)}r.needsUpdate=!0}n.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),Ns.prototype=Object.create(sr.prototype),Ns.prototype.constructor=Ns,Bs.prototype=Object.create(sr.prototype),Bs.prototype.constructor=Bs,Ws.prototype=Object.create(sr.prototype),Ws.prototype.constructor=Ws,Ws.prototype.update=function(){var t=new We,e=new We,i=new ze;return function(){this.object.updateMatrixWorld(!0),i.getNormalMatrix(this.object.matrixWorld);for(var n=this.object.matrixWorld,r=this.geometry.attributes.position,a=this.object.geometry,o=a.vertices,s=a.faces,c=0,h=0,l=s.length;h<l;h++){var u=s[h],d=u.normal;t.copy(o[u.a]).add(o[u.b]).add(o[u.c]).divideScalar(3).applyMatrix4(n),e.copy(d).applyMatrix3(i).normalize().multiplyScalar(this.size).add(t),r.setXYZ(c,t.x,t.y,t.z),c+=1,r.setXYZ(c,e.x,e.y,e.z),c+=1}r.needsUpdate=!0}}(),zs.prototype=Object.create(Qi.prototype),zs.prototype.constructor=zs,zs.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},zs.prototype.update=function(){var t=new We,e=new We,i=new We;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),i.subVectors(e,t),this.lightPlane.lookAt(i),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(i),this.targetLine.scale.z=i.length()}}(),ks.prototype=Object.create(sr.prototype),ks.prototype.constructor=ks,ks.prototype.update=function(){var t,e,i=new We,n=new $i;function r(r,a,o,s){i.set(a,o,s).unproject(n);var c=e[r];if(void 0!==c)for(var h=t.getAttribute("position"),l=0,u=c.length;l<u;l++)h.setXYZ(c[l],i.x,i.y,i.z)}return function(){t=this.geometry,e=this.pointMap,n.projectionMatrix.copy(this.camera.projectionMatrix),r("c",0,0,-1),r("t",0,0,1),r("n1",-1,-1,-1),r("n2",1,-1,-1),r("n3",-1,1,-1),r("n4",1,1,-1),r("f1",-1,-1,1),r("f2",1,-1,1),r("f3",-1,1,1),r("f4",1,1,1),r("u1",.7,1.1,-1),r("u2",-.7,1.1,-1),r("u3",0,2,-1),r("cf1",-1,0,1),r("cf2",1,0,1),r("cf3",0,-1,1),r("cf4",0,1,1),r("cn1",-1,0,-1),r("cn2",1,0,-1),r("cn3",0,-1,-1),r("cn4",0,1,-1),t.getAttribute("position").needsUpdate=!0}}(),Hs.prototype=Object.create(sr.prototype),Hs.prototype.constructor=Hs,Hs.prototype.update=function(){var t=new Vi;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var i=t.min,n=t.max,r=this.geometry.attributes.position,a=r.array;a[0]=n.x,a[1]=n.y,a[2]=n.z,a[3]=i.x,a[4]=n.y,a[5]=n.z,a[6]=i.x,a[7]=i.y,a[8]=n.z,a[9]=n.x,a[10]=i.y,a[11]=n.z,a[12]=n.x,a[13]=n.y,a[14]=i.z,a[15]=i.x,a[16]=n.y,a[17]=i.z,a[18]=i.x,a[19]=i.y,a[20]=i.z,a[21]=n.x,a[22]=i.y,a[23]=i.z,r.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),Hs.prototype.setFromObject=function(t){return this.object=t,this.update(),this},Gs.prototype=Object.create(sr.prototype),Gs.prototype.constructor=Gs,Gs.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),Qi.prototype.updateMatrixWorld.call(this,t))},Vs.prototype=Object.create(or.prototype),Vs.prototype.constructor=Vs,Vs.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),Qi.prototype.updateMatrixWorld.call(this,t)},js.prototype=Object.create(Qi.prototype),js.prototype.constructor=js,js.prototype.setDirection=function(){var t,e=new We;return function(i){i.y>.99999?this.quaternion.set(0,0,0,1):i.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(i.z,0,-i.x).normalize(),t=Math.acos(i.y),this.quaternion.setFromAxisAngle(e,t))}}(),js.prototype.setLength=function(t,e,i){void 0===e&&(e=.2*t),void 0===i&&(i=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(i,e,i),this.cone.position.y=t,this.cone.updateMatrix()},js.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},Ys.prototype=Object.create(sr.prototype),Ys.prototype.constructor=Ys;var qs=0,Zs=1;function Js(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function Ks(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Qs(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new lr(t,e)}function $s(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new tr(t)}function tc(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new lr(t,e)}function ec(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new hr(t)}function ic(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new hr(t)}function nc(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new hr(t)}function rc(t,e,i){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new We(t,e,i)}function ac(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new an(t,e).setDynamic(!0)}function oc(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new on(t,e)}function sc(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new sn(t,e)}function cc(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new cn(t,e)}function hc(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new hn(t,e)}function lc(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new ln(t,e)}function uc(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new un(t,e)}function dc(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new dn(t,e)}function pc(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new pn(t,e)}function fc(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new fn(t,e)}function mc(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),$a.call(this,t),this.type="catmullrom",this.closed=!0}function gc(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),$a.call(this,t),this.type="catmullrom"}function vc(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),$a.call(this,t),this.type="catmullrom"}function yc(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new Ys(t)}function xc(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new Hs(t,e)}function wc(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new sr(new va(t.geometry),new ar({color:void 0!==e?e:16777215}))}function bc(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new sr(new mr(t.geometry),new ar({color:void 0!==e?e:16777215}))}function Lc(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new Wa(t)}function Mc(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new ka(t)}ja.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(ja.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(uo.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new rn,i=0,n=t.length;i<n;i++){var r=t[i];e.vertices.push(new We(r.x,r.y,r.z||0))}return e}}),Object.assign(po.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),mc.prototype=Object.create($a.prototype),gc.prototype=Object.create($a.prototype),vc.prototype=Object.create($a.prototype),Object.assign(vc.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),Ns.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Is.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(Ho.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),Go.extractUrlBase(t)}}),Object.assign(Rs.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(Vi.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),En.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Fe,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Fe.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Fe.ceilPowerOfTwo(t)}}),Object.assign(ze.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(Ne.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new We),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,i,n,r,a){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,n,i,r,a)}}),Yi.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},Be.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(An.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(fo.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new ra(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new fa(this,t)}}),Object.assign(Ue.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(We.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,i){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(Ge.prototype,{fromAttribute:function(t,e,i){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,i)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(rn.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(Qi.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)}}),Object.defineProperties(Qi.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(er.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(ir.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(ja.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Gn.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(mo.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(an.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}}}),Object.assign(yn.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,i){void 0!==i&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(yn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(vs.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(ki.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Di}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===y}}}),Object.defineProperties(Ra.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(_n.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Zn.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Zn.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(qi.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Ve.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(jn.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),cs.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new rs).load(t,function(t){e.setBuffer(t)}),this},ls.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},os.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var _c={merge:function(t,e,i){var n;console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead."),e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),n=e.matrix,e=e.geometry),t.merge(e,n,i)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},Ac={crossOrigin:void 0,loadTexture:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var r=new Va;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},loadTextureCube:function(t,e,i,n){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var r=new Ga;r.setCrossOrigin(this.crossOrigin);var a=r.load(t,i,void 0,n);return e&&(a.mapping=e),a},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}};function Ec(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Sc(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}var Tc={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}};function Rc(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}},function(t,e,i){var n=i(4);e.createCodec=s,e.install=function(t){for(var e in t)a.prototype[e]=o(a.prototype[e],t[e])},e.filter=function(t){return n(t)?function(t){return t=t.slice(),function(i){return t.reduce(e,i)};function e(t,e){return e(t)}}(t):t};var r=i(0);function a(t){if(!(this instanceof a))return new a(t);this.options=t,this.init()}function o(t,e){return t&&e?function(){return t.apply(this,arguments),e.apply(this,arguments)}:t||e}function s(t){return new a(t)}a.prototype.init=function(){var t=this.options;return t&&t.uint8array&&(this.bufferish=r.Uint8Array),this},e.preset=s({preset:!0})},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e,i){var n=i(9).ExtBuffer,r=i(32),a=i(15).readUint8,o=i(31),s=i(3);function c(){var t=this.options;return this.decode=function(t){var e=o.getReadToken(t);return function(t){var i=a(t),n=e[i];if(!n)throw new Error("Invalid type: "+(i?"0x"+i.toString(16):i));return n(t)}}(t),t&&t.preset&&r.setExtUnpackers(this),this}s.install({addExtUnpacker:function(t,e){(this.extUnpackers||(this.extUnpackers=[]))[t]=s.filter(e)},getExtUnpacker:function(t){return(this.extUnpackers||(this.extUnpackers=[]))[t]||function(e){return new n(e,t)}},init:c}),e.preset=c.call(s.preset)},function(t,e,i){(function(t){!function(e){var i,n="undefined",r=n!==typeof t&&t,a=n!==typeof Uint8Array&&Uint8Array,o=n!==typeof ArrayBuffer&&ArrayBuffer,s=[0,0,0,0,0,0,0,0],c=Array.isArray||function(t){return!!t&&"[object Array]"==Object.prototype.toString.call(t)},h=4294967296,l=16777216;function u(t,c,u){var L=c?0:4,M=c?4:0,_=c?0:3,A=c?1:2,E=c?2:1,S=c?3:0,T=c?y:w,R=c?x:b,O=I.prototype,P="is"+t,C="_"+P;return O.buffer=void 0,O.offset=0,O[C]=!0,O.toNumber=D,O.toString=function(t){var e=this.buffer,i=this.offset,n=U(e,i+L),r=U(e,i+M),a="",o=!u&&2147483648&n;for(o&&(n=~n,r=h-r),t=t||10;;){var s=n%t*h+r;if(n=Math.floor(n/t),r=Math.floor(s/t),a=(s%t).toString(t)+a,!n&&!r)break}return o&&(a="-"+a),a},O.toJSON=D,O.toArray=d,r&&(O.toBuffer=p),a&&(O.toArrayBuffer=f),I[P]=function(t){return!(!t||!t[C])},e[t]=I,I;function I(t,e,r,c){return this instanceof I?function(t,e,r,c,l){if(a&&o&&(e instanceof o&&(e=new a(e)),c instanceof o&&(c=new a(c))),e||r||c||i){if(!m(e,r))l=r,c=e,r=0,e=new(i||Array)(8);t.buffer=e,t.offset=r|=0,n!==typeof c&&("string"==typeof c?function(t,e,i,n){var r=0,a=i.length,o=0,s=0;"-"===i[0]&&r++;for(var c=r;r<a;){var l=parseInt(i[r++],n);if(!(l>=0))break;s=s*n+l,o=o*n+Math.floor(s/h),s%=h}c&&(o=~o,s?s=h-s:o++),F(t,e+L,o),F(t,e+M,s)}(e,r,c,l||10):m(c,l)?g(e,r,c,l):"number"==typeof l?(F(e,r+L,c),F(e,r+M,l)):c>0?T(e,r,c):c<0?R(e,r,c):g(e,r,s,0))}else t.buffer=v(s,0)}(this,t,e,r,c):new I(t,e,r,c)}function D(){var t=this.buffer,e=this.offset,i=U(t,e+L),n=U(t,e+M);return u||(i|=0),i?i*h+n:n}function F(t,e,i){t[e+S]=255&i,i>>=8,t[e+E]=255&i,i>>=8,t[e+A]=255&i,i>>=8,t[e+_]=255&i}function U(t,e){return t[e+_]*l+(t[e+A]<<16)+(t[e+E]<<8)+t[e+S]}}function d(t){var e=this.buffer,n=this.offset;return i=null,!1!==t&&0===n&&8===e.length&&c(e)?e:v(e,n)}function p(e){var n=this.buffer,a=this.offset;if(i=r,!1!==e&&0===a&&8===n.length&&t.isBuffer(n))return n;var o=new r(8);return g(o,0,n,a),o}function f(t){var e=this.buffer,n=this.offset,r=e.buffer;if(i=a,!1!==t&&0===n&&r instanceof o&&8===r.byteLength)return r;var s=new a(8);return g(s,0,e,n),s.buffer}function m(t,e){var i=t&&t.length;return e|=0,i&&e+8<=i&&"string"!=typeof t[e]}function g(t,e,i,n){e|=0,n|=0;for(var r=0;r<8;r++)t[e++]=255&i[n++]}function v(t,e){return Array.prototype.slice.call(t,e,e+8)}function y(t,e,i){for(var n=e+8;n>e;)t[--n]=255&i,i/=256}function x(t,e,i){var n=e+8;for(i++;n>e;)t[--n]=255&-i^255,i/=256}function w(t,e,i){for(var n=e+8;e<n;)t[e++]=255&i,i/=256}function b(t,e,i){var n=e+8;for(i++;e<n;)t[e++]=255&-i^255,i/=256}u("Uint64BE",!0,!0),u("Int64BE",!0,!1),u("Uint64LE",!1,!0),u("Int64LE",!1,!1)}("object"==typeof e&&"string"!=typeof e.nodeName?e:this||{})}).call(this,i(20).Buffer)},function(t,e,i){var n=i(36);e.copy=c,e.slice=h,e.toString=function(t,e,i){return(!o&&r.isBuffer(this)?this.toString:n.toString).apply(this,arguments)},e.write=function(t){return function(){return(this[t]||n[t]).apply(this,arguments)}}("write");var r=i(0),a=r.global,o=r.hasBuffer&&"TYPED_ARRAY_SUPPORT"in a,s=o&&!a.TYPED_ARRAY_SUPPORT;function c(t,e,i,a){var o=r.isBuffer(this),c=r.isBuffer(t);if(o&&c)return this.copy(t,e,i,a);if(s||o||c||!r.isView(this)||!r.isView(t))return n.copy.call(this,t,e,i,a);var l=i||null!=a?h.call(this,i,a):this;return t.set(l,e),l.length}function h(t,e){var i=this.slice||!s&&this.subarray;if(i)return i.call(this,t,e);var n=r.alloc.call(this,e-t);return c.call(this,n,0,t,e),n}},function(t,e){e.read=function(t,e,i,n,r){var a,o,s=8*r-n-1,c=(1<<s)-1,h=c>>1,l=-7,u=i?r-1:0,d=i?-1:1,p=t[e+u];for(u+=d,a=p&(1<<-l)-1,p>>=-l,l+=s;l>0;a=256*a+t[e+u],u+=d,l-=8);for(o=a&(1<<-l)-1,a>>=-l,l+=n;l>0;o=256*o+t[e+u],u+=d,l-=8);if(0===a)a=1-h;else{if(a===c)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,n),a-=h}return(p?-1:1)*o*Math.pow(2,a-n)},e.write=function(t,e,i,n,r,a){var o,s,c,h=8*a-r-1,l=(1<<h)-1,u=l>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:a-1,f=n?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,o=l):(o=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-o))<1&&(o--,c*=2),(e+=o+u>=1?d/c:d*Math.pow(2,1-u))*c>=2&&(o++,c/=2),o+u>=l?(s=0,o=l):o+u>=1?(s=(e*c-1)*Math.pow(2,r),o+=u):(s=e*Math.pow(2,u-1)*Math.pow(2,r),o=0));r>=8;t[i+p]=255&s,p+=f,s/=256,r-=8);for(o=o<<r|s,h+=r;h>0;t[i+p]=255&o,p+=f,o/=256,h-=8);t[i+p-f]|=128*m}},function(t,e,i){e.ExtBuffer=function t(e,i){if(!(this instanceof t))return new t(e,i);this.buffer=n.from(e),this.type=i};var n=i(0)},function(t,e,i){var n=i(9).ExtBuffer,r=i(35),a=i(34),o=i(3);function s(){var t=this.options;return this.encode=function(t){var e=a.getWriteType(t);return function(t,i){var n=e[typeof i];if(!n)throw new Error('Unsupported type "'+typeof i+'": '+i);n(t,i)}}(t),t&&t.preset&&r.setExtPackers(this),this}o.install({addExtPacker:function(t,e,i){i=o.filter(i);var r=e.name;r&&"Object"!==r?(this.extPackers||(this.extPackers={}))[r]=a:(this.extEncoderList||(this.extEncoderList=[])).unshift([e,a]);function a(e){return i&&(e=i(e)),new n(e,t)}},getExtPacker:function(t){var e=this.extPackers||(this.extPackers={}),i=t.constructor,n=i&&i.name&&e[i.name];if(n)return n;for(var r=this.extEncoderList||(this.extEncoderList=[]),a=r.length,o=0;o<a;o++){var s=r[o];if(i===s[0])return s[1]}},init:s}),e.preset=s.call(o.preset)},function(t,e,i){let n=i(2);const r=i(1);i(13);let a=new n.TextureLoader;function o(t,e,i,r){return new Promise(o=>{(new n.OBJLoader).load(e,e=>{let s;i&&(s=a.load(i,t=>{t.wrapS=n.RepeatWrapping,t.wrapT=n.RepeatWrapping,t.repeat.set(1,1),t.minFilter=n.NearestFilter,t.magFilter=n.NearestFilter,t.needsUpdate=!0}));let c=new n.MeshLambertMaterial({map:s}),h=new n.Geometry;e.traverse(t=>{t instanceof n.Mesh&&(t.geometry.isBufferGeometry?(h.fromBufferGeometry(t.geometry),h.computeFlatVertexNormals(),t.geometry.fromGeometry(h)):t.geometry.computeFlatVertexNormals(),t.material=c)}),e.scale.setScalar(r||1),t.add(e),o()})})}function s(t,e,i){let r=(new n.TextureLoader).load(e);r.magFilter=n.NearestFilter;let a=new n.SpriteMaterial({map:r,color:16777215}),o=new n.Sprite(a);i&&o.scale.set(i,i,1),t.add(o)}function c(t,e,i){let r=new n.BoxBufferGeometry(t,e,i),a=r.getAttribute("position"),o=r.getAttribute("uv");for(let t=0;t<o.count;t++)t<8?o.setXY(t,a.getZ(t),a.getY(t)):t<16?o.setXY(t,a.getX(t),a.getZ(t)):o.setXY(t,a.getX(t),a.getY(t));return r}new n.BoxBufferGeometry(1,1,1),new n.PlaneBufferGeometry(1,1).rotateX(-Math.PI/2),new n.MeshLambertMaterial({color:65280}),new n.MeshLambertMaterial({color:5592405}),t.exports.prefabs={CRATE:{dontRound:!0,gen:t=>o(t,"models/crate_0.obj","textures/crate_0.png",r.crateScale),dummy:!1,castShadow:!0,receiveShadow:!0},STACK:{dontRound:!0,gen:t=>o(t,"models/stack_0.obj","textures/stack_0.png",r.crateScale),dummy:!1,castShadow:!0,receiveShadow:!0},BARREL:{dontRound:!0,complex:!0,gen:t=>o(t,"models/barrel_0.obj","textures/barrel_0.png",r.barrelScale),castShadow:!0,receiveShadow:!0},VEHICLE:{dontRound:!0,complex:!0,gen:t=>o(t,"models/vehicle_0.obj","textures/vehicle_0.png",r.vehicleScale),castShadow:!0,receiveShadow:!0},LADDER:{defaultSize:[2,10,4],scalable:!0,scaleWithSize:!1,hideBoundingBox:!1,texturable:!1,genGeo:async t=>c(...t),customDirection:!0,stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},CUBE:{defaultSize:[4,4,4],scalable:!0,scaleWithSize:!1,editDarkness:!0,hideBoundingBox:!1,texturable:!0,genGeo:async t=>c(...t),stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},RAMP:{defaultSize:[10,5,10],scalable:!0,scaleWithSize:!1,hideBoundingBox:!1,texturable:!0,genGeo:async t=>(function(t,e,i){let r=t/2,a=NaN,o=NaN,s=new n.BufferGeometry,c=new Float32Array([-r,-o,-a,-r,-o,a,r,o,a,r,o,a,r,o,-a,-r,-o,-a]);r=Math.sqrt(Math.pow(r,2)+Math.pow(o,2));let h=new Float32Array([-r,-a,-r,a,r,a,r,a,r,-a,-r,-a]),l=-o,u=new Float32Array([l,a,0,l,a,0,l,a,0,l,a,0,l,a,0,l,a,0]);return s.addAttribute("position",new n.BufferAttribute(c,3)),s.addAttribute("uv",new n.BufferAttribute(h,2)),s.addAttribute("normal",new n.BufferAttribute(u,3)),s})(...t),shootable:!0,customDirection:!0,stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},PLANE:{defaultSize:[4,.01,4],dontRound:!0,scalable:!0,canTerrain:!0,scaleWithSize:!1,editDarkness:!0,hideBoundingBox:!1,texturable:!0,genGeo:async t=>(function(t,e){let i=new n.PlaneBufferGeometry(t,e);i.rotateX(-Math.PI/2);let r=i.getAttribute("position"),a=i.getAttribute("uv");for(let t=0;t<a.count;t++)a.setXY(t,r.getX(t),r.getZ(t));return i})(t[0],t[2]),stepSrc:"a",dummy:!1,castShadow:!0,receiveShadow:!0},SPAWN_POINT:{defaultSize:[8,8,8],scalable:!1,scaleWithSize:!1,hideBoundingBox:!0,editorGen:t=>s(t,"img/favicon.png",8),stepSrc:"a",assignTeam:!0,dummy:!1,castShadow:!1,receiveShadow:!1},CAMERA_POSITION:{defaultSize:[2,2,2],scalable:!1,scaleWithSize:!1,hideBoundingBox:!0,editorGen:t=>s(t,"img/crosshair.png",5),stepSrc:"a",dummy:!1,castShadow:!1,receiveShadow:!1}},t.exports.texturePrefabs={DEFAULT:{src:"default",filter:n.NearestFilter},DIRT:{src:"dirt_0",filter:n.NearestFilter},FLOOR:{src:"floor_0",filter:n.NearestFilter},ORANGE:{src:"orange_0",filter:n.NearestFilter},GREY:{src:"grey_0",filter:n.NearestFilter},WALL:{src:"wall_0",filter:n.NearestFilter},WATER:{src:"water_0",filter:n.NearestFilter},ROOF:{src:"roof_0",filter:n.NearestFilter}},t.exports.loadTexturePrefab=function(e){let i=t.exports.texturePrefabs[e];return a.load("/textures/"+i.src+".png",t=>{t.wrapS=n.RepeatWrapping,t.wrapT=n.RepeatWrapping,t.minFilter=i.filter,t.magFilter=i.filter,t.repeat.set(1/r.worldUV,1/r.worldUV),t.needsUpdate=!0})}},function(t,e,i){const n=i(1);var r=[{name:"Desert",sky:14477549,fog:11447982,fogD:950,light:16777215,ambient:11511205,terrain:"dirt_0",particles:function(t,e){t.area(0,0,0,e,10,{src:"fog_0",count:Math.round(e/15),spd:.01,scl:[50,60],dir:0})}},{name:"Snow",sky:15727359,fog:15397375,fogD:800,light:16777215,ambient:10988727,terrain:"snow_0",particles:function(t,e){t.area(0,0,0,e,20,{src:"fog_0",count:Math.round(e/15),spd:.005,scl:[50,60],dir:0}),t.area(0,0,0,e,100,{src:"glow_0",blending:2,count:Math.round(e/2),spd:.01,grav:[-.02,-.01],scl:[.7,1],dir:0})}},{name:"Orange",sky:14477549,fog:16772317,fogD:850,light:16772317,ambient:13417905}];t.exports.biomes=r,t.exports.modes=[{id:"ffa",name:"Free for All",alias:"ffa"},{id:"tdm",name:"Team Deathmatch",alias:"tdm",teams:!0}];for(var a=[{name:"Burg",modes:[0],biomes:[1],shadScale:380,camPos:[0,70,0],spawns:[[332,0,52],[255,0,215],[41,0,-271],[-309,0,-216],[-307,0,108],[94,0,-361],[263,0,-217],[-103,0,227],[332,0,-53]],objects:[{id:4,p:[0,0,0],s:[751,0,921],v:1,ter:1,t:"DIRT"},{id:0,p:[-354,0,0],s:[12,76,500],t:"WALL"},{id:0,p:[354,0,0],s:[12,76,500],t:"WALL"},{id:0,p:[0,0,257],s:[700,76,18],t:"WALL"},{id:0,p:[-1,0,0],s:[50,26,46],t:"WALL"},{id:0,p:[-2,30,0],s:[28,44,28],da:1.1,t:"WALL"},{id:0,p:[-2,26,0],s:[38,4,36],da:1.04,t:"WALL"},{id:2,p:[-75,0,-43],s:[7,8,7]},{id:0,p:[261,0,241],s:[174,70,14],da:.88,t:"WALL"},{id:0,p:[230,0,173],s:[112,70,46],da:.88,t:"WALL"},{id:0,p:[258,0,111],s:[56,70,78],da:.88,t:"WALL"},{id:0,p:[340,0,-153],s:[16,74,162],da:1.3,t:"WALL"},{id:0,p:[253,40,215],s:[158,30,38],da:.86,t:"WALL"},{id:0,p:[227,0,-173],s:[118,74,46],da:1.28,t:"WALL"},{id:0,p:[258,0,-241],s:[180,74,14],da:1.28,t:"WALL"},{id:0,p:[318,0,153],s:[64,70,162],da:.88,t:"WALL"},{id:0,p:[309,40,-134],s:[46,34,124],da:1.26,t:"WALL"},{id:0,p:[250,40,-215],s:[164,34,38],da:1.28,t:"WALL"},{id:0,p:[-230,0,-173],s:[112,90,46],da:1.21,t:"WALL"},{id:0,p:[-261,0,-274],s:[174,90,80],da:1.17,t:"WALL"},{id:0,p:[-342,0,-153],s:[20,90,162],da:1.21,t:"WALL"},{id:0,p:[-309,40,-134],s:[46,50,124],da:1.21,t:"WALL"},{id:0,p:[-253,40,-215],s:[158,50,38],da:1.19,t:"WALL"},{id:0,p:[-253,0,199],s:[158,84,98],da:1.37,t:"WALL"},{id:0,p:[-340,0,153],s:[16,84,162],da:1.37,t:"WALL"},{id:0,p:[-309,40,111],s:[46,44,78],da:1.37,t:"WALL"},{id:0,p:[7,0,-195],s:[182,86,106],da:1.23,t:"WALL"},{id:0,p:[75,0,195],s:[82,94,106],da:1.21,t:"WALL"},{id:0,p:[-134,0,-85],s:[68,94,24],da:.84,t:"WALL"},{id:0,p:[258,0,-111],s:[56,74,78],da:1.28,t:"WALL"},{id:0,p:[-258,0,-111],s:[56,54,78],da:1.06,t:"WALL"},{id:0,p:[-258,0,111],s:[56,84,78],da:1.37,t:"WALL"},{id:0,p:[-73,-1,147],s:[132,78,114],da:1.39,t:"WALL"},{id:0,p:[156,0,-74],s:[44,150,50],da:1.41,t:"WALL"},{id:1,p:[11,0,-136],s:[12,12,12]},{id:2,p:[181,0,146],s:[7,8,7]},{id:1,p:[193,0,144],s:[12,12,12]},{id:2,p:[182,0,-78],s:[7,8,7]},{id:1,p:[-90,0,-176],s:[12,12,12]},{id:2,p:[104,0,99],s:[7,8,7]},{id:1,p:[-275,0,-202],s:[12,12,12]},{id:2,p:[-291,0,124],s:[7,8,7]},{id:0,p:[-89,0,-45],s:[22,96,116],da:.84,t:"WALL"},{id:0,p:[-115,0,70],s:[118,88,40],da:1.1,t:"WALL"},{id:0,p:[-151,0,7],s:[34,70,86],da:1.32,t:"WALL"},{id:0,p:[92,0,-72],s:[84,82,38],da:1.1,t:"WALL"},{id:0,p:[89,0,51],s:[22,70,88],t:"WALL"},{id:0,p:[135,0,81],s:[70,70,28],col:1,t:"WALL"},{id:0,p:[283,0,-1],s:[132,100,70],t:"WALL"},{id:0,p:[-317,0,0],s:[64,104,66],da:1.48,t:"WALL"},{id:3,p:[116,0,196],s:[2,62,12],d:0},{id:0,p:[90,48,159],s:[78,2,60],t:"FLOOR"},{id:0,p:[170,0,102],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[106,0,24],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[-49,0,82],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-70,0,-97],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[38,0,-84],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-235,0,27],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-178,0,42],s:[8,2,4],col:1,t:"WALL"},{id:0,p:[-174,0,-75],s:[4,2,10],col:1,t:"WALL"},{id:0,p:[-167,0,-178],s:[10,2,10],col:1,t:"WALL"},{id:0,p:[69,0,93],s:[8,2,4],col:1,t:"WALL"},{id:0,p:[36,0,-29],s:[10,2,6],col:1,t:"WALL"},{id:0,p:[-191,0,143],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-220,0,-136],s:[10,6,18],t:"WALL"},{id:0,p:[-209,0,-140],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[-224,0,-120],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-107,0,-104],s:[10,2,6],col:1,t:"WALL"},{id:0,p:[163,0,-149],s:[8,2,4],col:1,da:.84,t:"WALL"},{id:0,p:[291,-1,-197],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-340,0,40],s:[8,2,6],col:1,t:"WALL"},{id:0,p:[-168,0,188],s:[8,2,14],col:1,da:1.04,t:"WALL"},{id:0,p:[-32,48,-174],s:[130,2,90],t:"FLOOR"},{id:3,p:[-84,0,-225],s:[2,62,10],d:2},{id:0,p:[63,46,135],s:[2,2,14],col:1,da:.86,t:"FLOOR"},{id:0,p:[88,46,135],s:[2,2,14],col:1,da:.84,t:"FLOOR"},{id:0,p:[110,46,135],s:[2,2,14],col:1,da:.79,t:"FLOOR"},{id:0,p:[123,46,146],s:[14,2,2],col:1,da:.86,t:"FLOOR"},{id:0,p:[123,46,163],s:[14,2,2],col:1,da:.88,t:"FLOOR"},{id:0,p:[123,46,184],s:[14,2,2],col:1,da:.84,t:"FLOOR"},{id:0,p:[-38,46,-135],s:[2,2,14],col:1,da:.88,t:"FLOOR"},{id:0,p:[-69,46,-135],s:[2,2,14],col:1,da:.82,t:"FLOOR"},{id:0,p:[-91,46,-149],s:[14,2,2],col:1,da:.88,t:"FLOOR"},{id:0,p:[-91,46,-175],s:[14,2,2],col:1,da:.84,t:"FLOOR"},{id:0,p:[-91,46,-201],s:[14,2,2],col:1,da:.86,t:"FLOOR"},{id:0,p:[-8,46,-135],s:[2,2,14],col:1,da:.88,t:"FLOOR"},{id:0,p:[24,46,-135],s:[2,2,14],col:1,da:.88,t:"FLOOR"},{id:0,p:[7,86,-195],s:[192,10,116],da:.99,t:"ROOF"},{id:0,p:[75,92,195],s:[94,8,118],da:.79,t:"ROOF"},{id:0,p:[156,107,-74],s:[52,4,10],col:1,da:.95,t:"WALL"},{id:0,p:[156,111,-74],s:[46,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[156,107,-74],s:[10,4,56],col:1,da:.88,t:"WALL"},{id:0,p:[156,111,-74],s:[6,24,52],col:1,da:.13,t:"WALL"},{id:0,p:[139,150,-93],s:[10,6,12],col:1,da:1.41,t:"WALL"},{id:0,p:[138,150,-56],s:[8,6,14],col:1,da:1.41,t:"WALL"},{id:0,p:[136,150,-74],s:[4,6,8],col:1,da:1.41,t:"WALL"},{id:0,p:[176,150,-93],s:[4,6,12],col:1,da:1.41,t:"WALL"},{id:0,p:[176,150,-74],s:[4,4,16],col:1,da:1.41,t:"WALL"},{id:0,p:[169,150,-52],s:[18,6,6],col:1,da:1.41,t:"WALL"},{id:0,p:[149,150,-52],s:[6,4,6],col:1,da:1.41,t:"WALL"},{id:0,p:[159,150,-96],s:[14,6,6],col:1,da:1.41,t:"WALL"},{id:0,p:[94,82,-72],s:[94,6,44],da:.84,t:"ROOF"},{id:0,p:[232,74,-136],s:[4,6,20],col:1,da:1.28,t:"WALL"},{id:0,p:[232,74,-103],s:[4,4,18],col:1,da:1.28,t:"WALL"},{id:0,p:[239,74,-76],s:[18,4,8],col:1,da:1.28,t:"WALL"},{id:0,p:[270,74,-74],s:[18,6,4],col:1,da:1.28,t:"WALL"},{id:0,p:[298,74,-74],s:[14,6,4],col:1,da:1.28,t:"WALL"},{id:0,p:[326,74,-74],s:[22,4,4],col:1,da:1.28,t:"WALL"},{id:0,p:[204,74,-152],s:[18,6,4],col:1,da:1.28,t:"WALL"},{id:0,p:[174,74,-158],s:[12,6,16],col:1,da:1.28,t:"WALL"},{id:0,p:[171,74,-188],s:[6,4,16],col:1,da:1.28,t:"WALL"},{id:0,p:[171,74,-228],s:[6,6,24],col:1,da:1.28,t:"WALL"},{id:0,p:[98,53,-219],s:[2,20,8],col:1,da:.13,t:"WALL"},{id:0,p:[99,49,-219],s:[4,4,12],col:1,da:.79,t:"WALL"},{id:0,p:[144,70,94],s:[18,4,2],col:1,t:"WALL"},{id:0,p:[121,70,94],s:[12,6,2],col:1,t:"WALL"},{id:0,p:[105,70,94],s:[8,4,2],col:1,t:"WALL"},{id:0,p:[82,70,90],s:[8,4,10],col:1,t:"WALL"},{id:0,p:[157,70,68],s:[10,4,2],col:1,t:"WALL"},{id:0,p:[135,70,68],s:[22,2,2],col:1,t:"WALL"},{id:0,p:[112,70,68],s:[8,4,2],col:1,t:"WALL"},{id:0,p:[167,70,90],s:[6,4,10],col:1,t:"WALL"},{id:0,p:[80,70,-17],s:[4,4,10],col:1,t:"WALL"},{id:0,p:[80,70,12],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[80,70,52],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[98,70,38],s:[4,4,26],col:1,t:"WALL"},{id:0,p:[98,70,4],s:[4,4,8],col:1,t:"WALL"},{id:0,p:[50,40,-71],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[49,36,-71],s:[4,4,12],da:.59,t:"WALL"},{id:0,p:[-322,104,-31],s:[20,6,4],col:1,da:1.48,t:"WALL"},{id:0,p:[-295,104,-24],s:[20,6,18],col:1,da:1.48,t:"WALL"},{id:0,p:[-295,104,28],s:[20,6,10],col:1,da:1.48,t:"WALL"},{id:0,p:[-336,104,31],s:[26,8,4],col:1,da:1.48,t:"WALL"},{id:0,p:[-287,104,5],s:[4,4,20],col:1,da:1.48,t:"WALL"},{id:0,p:[-174,57,70],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[-175,53,70],s:[4,4,12],col:1,da:.79,t:"WALL"},{id:0,p:[-115,88,70],s:[124,6,46],da:1.1,t:"ROOF"},{id:0,p:[-80,96,-13],s:[4,4,22],col:1,da:.84,t:"WALL"},{id:0,p:[-80,96,-43],s:[4,4,16],col:1,da:.84,t:"WALL"},{id:0,p:[-80,96,-71],s:[4,4,18],col:1,da:.84,t:"WALL"},{id:0,p:[-84,96,-97],s:[12,6,12],col:1,da:.84,t:"WALL"},{id:0,p:[-98,96,-73],s:[4,4,24],col:1,da:.84,t:"WALL"},{id:0,p:[-95,96,1],s:[10,4,24],col:1,da:.84,t:"WALL"},{id:0,p:[-98,96,-36],s:[4,6,14],col:1,da:.84,t:"WALL"},{id:0,p:[-161,94,-93],s:[14,4,8],col:1,da:.84,t:"WALL"},{id:0,p:[-116,94,-95],s:[14,6,4],col:1,da:.84,t:"WALL"},{id:0,p:[-139,94,-95],s:[14,4,4],col:1,da:.84,t:"WALL"},{id:0,p:[-153,94,-75],s:[14,4,4],col:1,da:.84,t:"WALL"},{id:0,p:[-127,94,-75],s:[12,6,4],col:1,da:.84,t:"WALL"},{id:0,p:[240,60,205],s:[112,54,86],da:.88,t:"WALL"},{id:0,p:[295,67,172],s:[106,72,172],da:.88,t:"WALL"},{id:0,p:[294,135,172],s:[112,8,180],da:.95,t:"ROOF"},{id:0,p:[236,114,203],s:[112,8,90],da:.95,t:"ROOF"},{id:0,p:[242,100,120],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[212,77,162],s:[12,4,6],col:1,da:.95,t:"WALL"},{id:0,p:[241,96,120],s:[6,4,12],col:1,da:.95,t:"WALL"},{id:0,p:[212,81,162],s:[8,24,2],col:1,da:.13,t:"WALL"},{id:0,p:[-318,90,-111],s:[72,6,86],da:.88,t:"ROOF"},{id:0,p:[-270,90,-232],s:[198,6,172],da:.86,t:"ROOF"},{id:0,p:[-277,54,-75],s:[18,6,6],col:1,da:1.1,t:"WALL"},{id:0,p:[-255,54,-75],s:[12,4,6],col:1,da:1.08,t:"WALL"},{id:0,p:[-236,54,-78],s:[12,6,12],col:1,da:1.01,t:"WALL"},{id:0,p:[-232,54,-121],s:[4,6,22],col:1,da:1.1,t:"WALL"},{id:0,p:[-232,54,-98],s:[4,4,10],col:1,da:1.08,t:"WALL"},{id:0,p:[-232,54,-146],s:[4,4,8],col:1,da:1.06,t:"WALL"},{id:0,p:[-230,45,113],s:[2,24,8],col:1,da:.13,t:"WALL"},{id:0,p:[-229,41,113],s:[4,4,16],col:1,da:.86,t:"WALL"},{id:0,p:[-166,70,42],s:[4,6,16],col:1,da:1.32,t:"WALL"},{id:0,p:[-166,70,15],s:[4,4,12],col:1,da:1.32,t:"WALL"},{id:0,p:[-179,62,-18],s:[22,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-161,70,-31],s:[14,6,10],col:1,da:1.32,t:"WALL"},{id:0,p:[-138,70,-22],s:[8,6,28],col:1,da:1.32,t:"WALL"},{id:0,p:[-136,70,41],s:[4,4,18],col:1,da:1.32,t:"WALL"},{id:0,p:[-136,70,13],s:[4,6,16],col:1,da:1.32,t:"WALL"},{id:0,p:[-317,66,0],s:[10,24,68],col:1,da:.13,t:"WALL"},{id:0,p:[-317,62,0],s:[16,4,74],col:1,da:1.06,t:"WALL"},{id:0,p:[-237,84,84],s:[14,6,24],col:1,da:1.37,t:"WALL"},{id:0,p:[-184,84,162],s:[20,6,24],col:1,da:1.37,t:"WALL"},{id:0,p:[-213,84,153],s:[16,8,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-234,84,123],s:[8,4,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-178,84,194],s:[8,4,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-178,84,234],s:[8,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-269,84,75],s:[20,8,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-314,84,75],s:[36,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[234,70,82],s:[8,6,20],col:1,da:.88,t:"WALL"},{id:0,p:[232,70,137],s:[4,4,20],col:1,da:.88,t:"WALL"},{id:0,p:[176,70,231],s:[4,4,18],col:1,da:.88,t:"WALL"},{id:0,p:[176,70,189],s:[4,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[181,70,153],s:[14,4,6],col:1,da:.88,t:"WALL"},{id:0,p:[261,70,75],s:[14,4,6],col:1,da:.88,t:"WALL"},{id:0,p:[302,70,74],s:[30,4,4],col:1,da:.88,t:"WALL"},{id:0,p:[221,70,153],s:[10,4,6],col:1,da:.88,t:"WALL"},{id:1,p:[-326,0,121],s:[12,12,12]},{id:0,p:[-295,0,79],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[269,0,205],s:[8,2,8],col:1,t:"WALL"},{id:1,p:[210,0,228],s:[12,12,12]},{id:0,p:[-333,0,-39],s:[12,2,8],col:1,t:"WALL"},{id:1,p:[202,0,-202],s:[12,12,12]},{id:0,p:[-46,-11,384],s:[70,198,72],da:1.57,t:"WALL"},{id:0,p:[-22,187,352],s:[22,6,8],col:1,da:1.57,t:"WALL"},{id:0,p:[-46,118,346],s:[18,6,4],col:1,da:1.01,t:"WALL"},{id:0,p:[-73,187,356],s:[16,8,16],col:1,da:1.57,t:"WALL"},{id:0,p:[-77,187,390],s:[8,6,16],col:1,da:1.57,t:"WALL"},{id:0,p:[-15,187,388],s:[8,4,24],col:1,da:1.57,t:"WALL"},{id:0,p:[-46,124,348],s:[8,36,2],col:1,da:.13,t:"WALL"},{id:0,p:[-50,187,352],s:[16,4,8],col:1,da:1.57,t:"WALL"},{id:0,p:[-142,76,250],s:[32,6,4],col:1,da:1.04,t:"WALL"},{id:0,p:[-88,76,250],s:[24,4,4],col:1,da:1.04,t:"WALL"},{id:0,p:[-26,76,250],s:[20,8,4],col:1,da:1.04,t:"WALL"},{id:0,p:[142,76,250],s:[24,4,4],col:1,da:1.04,t:"WALL"},{id:0,p:[101,76,-252],s:[14,6,8],col:1,da:1.04,t:"WALL"},{id:0,p:[350,76,48],s:[4,4,20],col:1,da:1.04,t:"WALL"},{id:0,p:[350,76,-60],s:[4,4,12],col:1,da:1.04,t:"WALL"},{id:0,p:[350,76,-23],s:[4,2,22],col:1,da:1.04,t:"WALL"},{id:0,p:[-350,76,-60],s:[4,4,12],col:1,da:1.04,t:"WALL"},{id:0,p:[-350,76,37],s:[4,4,30],col:1,da:1.04,t:"WALL"},{id:0,p:[85,0,-292],s:[46,76,88],t:"WALL"},{id:0,p:[172,0,-314],s:[42,76,132],t:"WALL"},{id:0,p:[96,0,-384],s:[202,88,8],da:1.52,t:"WALL"},{id:0,p:[-64,0,-341],s:[164,88,92],da:1.48,t:"WALL"},{id:0,p:[158,76,-252],s:[14,6,8],col:1,da:1.04,t:"WALL"},{id:0,p:[105,76,-277],s:[6,6,20],col:1,da:1.04,t:"WALL"},{id:0,p:[99,76,-330],s:[18,6,12],col:1,da:1.04,t:"WALL"},{id:0,p:[154,76,-284],s:[6,4,28],col:1,da:1.04,t:"WALL"},{id:0,p:[154,76,-334],s:[6,8,18],col:1,da:1.04,t:"WALL"},{id:0,p:[76,43,-380],s:[6,20,2],col:1,da:.13,t:"WALL"},{id:0,p:[76,38,-380],s:[12,6,6],col:1,da:1.04,t:"WALL"},{id:0,p:[142,88,-382],s:[18,6,4],col:1,da:1.52,t:"WALL"},{id:0,p:[186,88,-382],s:[22,4,4],col:1,da:1.52,t:"WALL"},{id:0,p:[103,88,-382],s:[28,2,4],col:1,da:1.52,t:"WALL"},{id:0,p:[16,88,-376],s:[4,6,16],col:1,da:1.52,t:"WALL"},{id:0,p:[-2,88,-307],s:[40,6,24],col:1,da:1.52,t:"WALL"},{id:0,p:[16,88,-345],s:[4,4,24],col:1,da:1.52,t:"WALL"},{id:0,p:[-137,88,-307],s:[18,4,24],col:1,da:1.52,t:"WALL"},{id:0,p:[-49,88,-297],s:[12,6,4],col:1,da:1.52,t:"WALL"},{id:0,p:[-96,88,-297],s:[30,4,4],col:1,da:1.52,t:"WALL"},{id:1,p:[114,0,-327],s:[12,12,12]},{id:0,p:[142,0,-320],s:[8,2,6],col:1,da:.84,t:"WALL"},{id:2,p:[130,0,-95],s:[7,8,7]},{id:0,p:[49,88,-382],s:[36,4,4],col:1,da:1.52,t:"WALL"},{id:2,p:[58,0,-291],s:[7,8,7]},{id:0,p:[65,76,-302],s:[6,4,28],col:1,da:1.04,t:"WALL"},{id:0,p:[65,76,-262],s:[6,6,20],col:1,da:1.04,t:"WALL"},{id:0,p:[-160,0,-309],s:[28,76,10],da:1.01,t:"WALL"},{id:0,p:[-157,76,-306],s:[12,4,4],da:1.01,t:"WALL"},{id:1,p:[-2,0,-289],s:[12,12,12]},{id:0,p:[-86,0,-256],s:[10,2,10],col:1,t:"WALL"},{id:2,p:[-170,0,-300],s:[7,8,7]},{id:0,p:[24,0,-329],s:[10,2,10],col:1,t:"WALL"},{id:0,p:[21,79,-303],s:[8,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[21,79,-342],s:[8,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-174,46,-269],s:[2,20,8],col:1,da:.13,t:"WALL"},{id:0,p:[-172,43,-269],s:[6,4,14],col:1,da:.84,t:"WALL"},{id:0,p:[5,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-31,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-64,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-97,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-133,79,-292],s:[4,4,8],col:1,da:.86,t:"FLOOR"},{id:0,p:[-256,0,0],s:[60,62,40],da:1.32,t:"WALL"},{id:0,p:[-176,0,0],s:[16,62,40],da:1.32,t:"WALL"},{id:0,p:[-205,40,0],s:[42,22,40],da:1.32,t:"WALL"},{id:0,p:[-221,62,-18],s:[28,4,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-259,62,-18],s:[14,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-278,62,18],s:[14,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-244,62,18],s:[24,4,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-198,62,18],s:[24,6,4],col:1,da:1.32,t:"WALL"},{id:0,p:[-181,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-211,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-242,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-275,56,0],s:[4,4,50],col:1,da:.86,t:"FLOOR"},{id:0,p:[-216,0,0],s:[20,40,2],da:1.04,t:"FLOOR"},{id:0,p:[-185,0,-6],s:[2,40,18],da:1.01,t:"FLOOR"},{id:0,p:[-188,0,-233],s:[20,40,2],da:1.04,t:"FLOOR"},{id:0,p:[-179,0,-205],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[172,0,-205],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[180,0,-233],s:[18,40,2],da:1.04,t:"FLOOR"},{id:0,p:[287,0,-84],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[323,0,-76],s:[18,40,2],da:1.04,t:"FLOOR"},{id:0,p:[-287,0,-68],s:[2,40,18],da:1.04,t:"FLOOR"},{id:0,p:[-321,0,-77],s:[22,40,2],da:1.04,t:"FLOOR"},{id:1,p:[287,0,66],s:[12,12,12]},{id:0,p:[338,70,74],s:[10,4,4],col:1,da:.88,t:"WALL"},{id:0,p:[168,70,72],s:[4,4,10],col:1,t:"WALL"},{id:0,p:[80,70,75],s:[4,2,10],col:1,t:"WALL"},{id:1,p:[30,0,-12],s:[12,12,12]},{id:1,p:[-168,0,-265],s:[12,12,12]},{id:0,p:[89,42,-15],s:[22,28,44],t:"WALL"},{id:0,p:[98,70,-36],s:[4,4,26],col:1,t:"WALL"},{id:0,p:[80,70,-47],s:[4,6,16],col:1,t:"WALL"},{id:0,p:[89,0,-46],s:[22,70,18],t:"WALL"},{id:0,p:[82,0,-3],s:[2,42,22],da:1.01,t:"FLOOR"},{id:0,p:[70,0,-36],s:[20,42,2],da:1.01,t:"FLOOR"},{id:0,p:[-15,77,194],s:[16,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-15,77,100],s:[16,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-131,77,188],s:[16,6,32],col:1,da:1.37,t:"WALL"},{id:0,p:[-10,77,129],s:[6,4,12],col:1,da:1.37,t:"WALL"},{id:0,p:[-10,77,156],s:[6,8,12],col:1,da:1.37,t:"WALL"},{id:0,p:[-42,77,93],s:[12,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-39,77,201],s:[12,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-100,77,201],s:[26,4,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-65,77,201],s:[22,6,6],col:1,da:1.37,t:"WALL"},{id:0,p:[-136,77,141],s:[6,4,16],col:1,da:1.37,t:"WALL"},{id:0,p:[-136,77,98],s:[6,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[-19,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,101],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,132],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,165],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-73,66,196],s:[146,4,4],col:1,da:.86,t:"FLOOR"},{id:0,p:[-44,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-71,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-98,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:0,p:[-126,66,147],s:[4,4,128],col:1,da:.86,t:"FLOOR"},{id:1,p:[-263,0,-202],s:[12,12,12]},{id:1,p:[30,0,0],s:[12,12,12]},{id:1,p:[30,12,-7],s:[12,12,12]},{id:1,p:[-1,0,174],s:[12,12,12]},{id:1,p:[231,0,-228],s:[12,12,12]},{id:1,p:[231,12,-228],s:[12,12,12]},{id:1,p:[56,0,-301],s:[12,12,12]},{id:2,p:[55,50,133],s:[7,8,7]},{id:2,p:[-30,0,-19],s:[7,8,7]},{id:1,p:[292,0,-147],s:[12,12,12]},{id:2,p:[-161,0,-101],s:[7,8,7]},{id:0,p:[-11,0,63],s:[2,24,2],t:"FLOOR"},{id:0,p:[-118,0,-106],s:[2,80,2],t:"FLOOR"},{id:0,p:[-154,0,-106],s:[2,84,2],da:.95,t:"FLOOR"},{id:0,p:[-136,36,-102],s:[34,2,10],da:.95,t:"FLOOR"},{id:0,p:[-11,0,89],s:[2,24,2],da:.88,t:"FLOOR"},{id:0,p:[235,56,87],s:[26,2,44],da:.71,t:"FLOOR"},{id:0,p:[-136,74,-102],s:[34,2,10],da:.95,t:"FLOOR"},{id:0,p:[-170,79,-164],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:1,p:[-1,0,-136],s:[12,12,12]},{id:1,p:[3,12,-136],s:[12,12,12]},{id:0,p:[-95,0,-131],s:[2,48,2],da:.86,t:"FLOOR"},{id:0,p:[-95,0,-217],s:[2,48,2],da:.86,t:"FLOOR"},{id:0,p:[31,0,-131],s:[2,48,2],da:.86,t:"FLOOR"},{id:0,p:[53,0,131],s:[2,48,2],t:"FLOOR"},{id:0,p:[127,0,131],s:[2,48,2],t:"FLOOR"},{id:0,p:[127,0,187],s:[2,48,2],t:"FLOOR"},{id:0,p:[246,0,67],s:[2,74,2],da:.84,t:"FLOOR"},{id:0,p:[224,0,67],s:[2,64,2],da:.84,t:"FLOOR"},{id:0,p:[224,0,107],s:[2,68,2],da:.84,t:"FLOOR"},{id:0,p:[235,28,87],s:[26,2,44],da:.57,t:"FLOOR"},{id:0,p:[223,0,74],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-71,82,-1],s:[14,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[-170,79,-195],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[-170,79,-231],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[-170,79,-267],s:[8,4,4],col:1,da:.88,t:"FLOOR"},{id:0,p:[156,98,-74],s:[4,4,64],col:1,da:.88,t:"FLOOR"},{id:0,p:[156,98,-74],s:[58,4,4],col:1,da:.88,t:"FLOOR"},{id:1,p:[162,0,-163],s:[12,12,12]},{id:0,p:[-9,7,75],s:[2,6,30],da:.86,t:"FLOOR"},{id:0,p:[-9,15,75],s:[2,6,32],da:.77,t:"FLOOR"},{id:0,p:[-102,26,32],s:[64,2,38],da:.71,t:"FLOOR"},{id:1,p:[-81,28,19],s:[12,12,12]},{id:0,p:[-72,0,8],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[-60,0,44],s:[6,2,8],col:1,t:"WALL"},{id:2,p:[-130,28,46],s:[7,8,7]},{id:0,p:[-74,0,15],s:[2,30,2],da:.84,t:"FLOOR"},{id:1,p:[-93,0,19],s:[12,12,12]},{id:1,p:[-93,12,19],s:[12,12,12]},{id:0,p:[-72,0,49],s:[2,34,2],da:.84,t:"FLOOR"},{id:0,p:[-75,0,212],s:[8,2,8],col:1,da:1.04,t:"WALL"},{id:0,p:[-223,0,-230],s:[8,2,4],col:1,t:"WALL"},{id:0,p:[-133,0,15],s:[2,26,2],da:.84,t:"FLOOR"},{id:0,p:[-133,0,49],s:[2,30,2],da:.84,t:"FLOOR"},{id:3,p:[-134,0,7],s:[2,44,8],d:0},{id:1,p:[118,0,61],s:[12,12,12]},{id:1,p:[142,0,-43],s:[12,12,12]},{id:1,p:[154,0,-43],s:[12,12,12]},{id:1,p:[149,12,-43],s:[12,12,12]},{id:1,p:[147,0,8],s:[12,12,12]},{id:2,p:[156,0,9],s:[7,8,7]},{id:0,p:[320,0,-43],s:[8,2,8],col:1,t:"WALL"},{id:0,p:[177,53,79],s:[14,4,4],da:.88,t:"FLOOR"},{id:1,p:[147,12,8],s:[12,12,12]},{id:0,p:[174,0,-41],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[173,26,-63],s:[26,2,44],da:.57,t:"FLOOR"},{id:0,p:[184,0,-43],s:[2,72,2],da:.84,t:"FLOOR"},{id:0,p:[184,0,-83],s:[2,70,2],da:.84,t:"FLOOR"},{id:0,p:[162,0,-43],s:[2,70,2],da:.84,t:"FLOOR"},{id:0,p:[173,64,-63],s:[26,2,44],da:.82,t:"FLOOR"},{id:2,p:[128,0,63],s:[7,8,7]},{id:2,p:[214,0,17],s:[7,8,7]},{id:0,p:[223,0,-78],s:[8,2,8],col:1,t:"WALL"},{id:1,p:[-239,0,66],s:[12,12,12]},{id:0,p:[213,0,0],s:[4,2,8],col:1,t:"WALL"},{id:0,p:[224,100,-27],s:[14,4,18],col:1,t:"WALL"},{id:0,p:[220,100,-1],s:[6,6,16],col:1,t:"WALL"},{id:0,p:[225,100,26],s:[16,4,16],col:1,t:"WALL"},{id:0,p:[266,100,31],s:[22,4,6],col:1,t:"WALL"},{id:0,p:[308,100,31],s:[28,6,6],col:1,t:"WALL"},{id:0,p:[257,100,-33],s:[22,4,6],col:1,t:"WALL"},{id:0,p:[311,100,-33],s:[36,6,6],col:1,t:"WALL"},{id:0,p:[217,54,0],s:[2,24,6],col:1,da:.13,t:"WALL"},{id:0,p:[217,50,0],s:[6,4,12],col:1,da:.95,t:"WALL"},{id:0,p:[-292,0,-160],s:[8,2,10],col:1,t:"WALL"},{id:2,p:[-281,0,24],s:[7,8,7]},{id:1,p:[-224,0,-107],s:[12,12,12]},{id:0,p:[51,0,-92],s:[2,24,2],t:"FLOOR"},{id:0,p:[51,0,-104],s:[2,22,2],t:"FLOOR"},{id:0,p:[49,5,-98],s:[2,6,18],da:.86,t:"FLOOR"},{id:0,p:[49,13,-98],s:[2,6,16],da:.86,t:"FLOOR"},{id:0,p:[-182,4,89],s:[16,6,2],da:.77,t:"FLOOR"},{id:0,p:[-182,12,89],s:[16,4,2],da:.77,t:"FLOOR"},{id:0,p:[-178,0,87],s:[2,20,2],da:.77,t:"FLOOR"},{id:0,p:[-186,0,87],s:[2,18,2],da:.77,t:"FLOOR"},{id:2,p:[-179,0,82],s:[7,8,7]},{id:0,p:[259,0,-198],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[331,0,-169],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[215,0,196],s:[4,42,4],t:"FLOOR"},{id:0,p:[249,0,234],s:[4,42,4],t:"FLOOR"},{id:0,p:[-253,0,-198],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[-287,0,-149],s:[4,40,4],da:.86,t:"FLOOR"},{id:0,p:[-324,0,-105],s:[8,2,10],col:1,t:"WALL"},{id:7,p:[68,0,65],s:[20,15,51],col:1,r:[0,1.57,0]},{id:7,p:[-250,0,-31],s:[51,15,20],col:1,r:[3.14,0,3.14]},{id:7,p:[161,0,-110],s:[51,15,20],col:1,r:[3.14,0,3.14]},{id:7,p:[-117,0,-285],s:[51,15,20],col:1},{id:0,p:[67,0,65],s:[16,8,48],v:1,t:"WALL"},{id:0,p:[161,0,-110],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-117,0,-286],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-250,0,-30],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-256,7,-30],s:[24,8,16],v:1,t:"WALL"},{id:0,p:[-112,7,-286],s:[24,8,16],v:1,t:"WALL"},{id:0,p:[156,7,-110],s:[24,8,16],v:1,t:"WALL"},{id:0,p:[67,7,60],s:[16,8,24],v:1,t:"WALL"},{id:7,p:[0,0,-34],s:[51,15,20],col:1,r:[3.14,0,3.14]},{id:0,p:[0,0,-33],s:[48,8,18],v:1,t:"WALL"},{id:0,p:[-6,7,-33],s:[24,8,16],v:1,t:"WALL"},{id:8,p:[-72,0,-33],s:[12,12,12]},{id:8,p:[45,0,136],s:[12,12,12]},{id:8,p:[225,0,-42],s:[12,12,12]},{id:8,p:[168,0,174],s:[12,12,12]},{id:8,p:[-168,0,-161],s:[12,12,12]},{id:8,p:[147,0,20],s:[12,12,12]},{id:8,p:[-292,0,-180],s:[12,12,12]},{id:8,p:[104,0,-211],s:[12,12,12]},{id:8,p:[-35,0,210],s:[12,12,12]},{id:0,p:[158,53,101],s:[4,4,12],da:.88,t:"FLOOR"},{id:0,p:[135,0,81],s:[70,82,28],v:1,t:"WALL"},{id:0,p:[357,0,45],s:[18,110,108],v:1,t:"WALL"},{id:0,p:[154,0,256],s:[148,114,16],v:1,t:"WALL"}]},{name:"Throwback",modes:[0,1],biomes:[0,1],shadScale:270,camPos:[0,59,0],spawns:[[-237,0,-124],[-81,0,223],[241,0,124],[75,0,-228]],objects:[{id:4,p:[0,0,0],s:[573,0,531],v:1,ter:1,t:"DEFAULT"},{id:0,p:[-74,0,-201],s:[404,76,10],da:1.32,t:"WALL"},{id:0,p:[-186,0,0],s:[22,22,250],da:1.01,t:"WALL"},{id:1,p:[-130,0,-34],s:[12,12,12]},{id:0,p:[0,0,173],s:[4,26,46],da:1.3,t:"WALL"},{id:0,p:[0,0,-173],s:[4,26,46],da:1.04,t:"WALL"},{id:0,p:[65,0,65],s:[70,92,70],da:1.37,t:"WALL"},{id:0,p:[65,0,-65],s:[70,80,70],da:1.32,t:"WALL"},{id:0,p:[-65,0,65],s:[70,58,70],da:1.34,t:"WALL"},{id:0,p:[-65,0,-65],s:[70,118,70],da:1.3,t:"WALL"},{id:0,p:[87,0,115],s:[4,26,30],da:1.06,t:"WALL"},{id:0,p:[-89,0,-115],s:[4,26,30],da:1.12,t:"WALL"},{id:1,p:[-81,0,-106],s:[12,12,12]},{id:1,p:[-8,0,175],s:[12,12,12]},{id:1,p:[-8,0,163],s:[12,12,12]},{id:1,p:[-8,12,166],s:[12,12,12]},{id:1,p:[39,0,-106],s:[12,12,12]},{id:1,p:[-24,0,39],s:[12,12,12]},{id:1,p:[40,0,-24],s:[12,12,12]},{id:1,p:[-141,0,-190],s:[12,12,12]},{id:7,p:[-28,0,-178],s:[51,15,20],col:1},{id:7,p:[60,0,110],s:[51,15,20],col:1},{id:1,p:[-97,0,-106],s:[12,12,12]},{id:2,p:[-96,0,-26],s:[7,8,7]},{id:2,p:[-95,0,-116],s:[7,8,7]},{id:2,p:[-171,0,-98],s:[7,8,7]},{id:2,p:[170,0,-121],s:[7,8,7]},{id:2,p:[104,0,36],s:[7,8,7]},{id:1,p:[146,0,190],s:[12,12,12]},{id:1,p:[134,0,190],s:[12,12,12]},{id:1,p:[137,12,190],s:[12,12,12]},{id:7,p:[152,0,-1],s:[20,15,51],col:1,r:[0,-1.57,0]},{id:8,p:[84,0,-106],s:[12,12,12]},{id:8,p:[168,0,101],s:[12,12,12]},{id:8,p:[-94,0,126],s:[12,12,12]},{id:8,p:[-169,0,-88],s:[12,12,12]},{id:1,p:[-130,0,-22],s:[12,12,12]},{id:1,p:[-130,12,-22],s:[12,12,12]},{id:1,p:[-142,0,-22],s:[12,12,12]},{id:3,p:[187,0,126],s:[8,24,2],d:1},{id:3,p:[-187,0,-126],s:[8,24,2],d:3},{id:8,p:[-190,0,131],s:[12,12,12]},{id:0,p:[90,81,65],s:[4,4,88],t:"FLOOR"},{id:0,p:[65,81,65],s:[4,4,88],t:"FLOOR"},{id:0,p:[40,81,65],s:[4,4,88],t:"FLOOR"},{id:0,p:[65,81,65],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,81,88],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,81,40],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,69,-64],s:[4,4,88],t:"FLOOR"},{id:0,p:[89,69,-64],s:[4,4,88],t:"FLOOR"},{id:0,p:[40,69,-64],s:[4,4,88],t:"FLOOR"},{id:0,p:[65,69,-43],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,69,-91],s:[88,4,4],t:"FLOOR"},{id:0,p:[65,69,-66],s:[88,4,4],t:"FLOOR"},{id:0,p:[94,92,35],s:[12,6,10],col:1,da:1.37,t:"WALL"},{id:0,p:[94,92,90],s:[12,4,20],col:1,da:1.37,t:"WALL"},{id:0,p:[36,92,37],s:[12,4,14],col:1,da:1.37,t:"WALL"},{id:0,p:[37,92,93],s:[14,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[37,80,-37],s:[14,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[37,80,-90],s:[14,6,20],col:1,da:1.37,t:"WALL"},{id:0,p:[95,80,-90],s:[10,8,20],col:1,da:1.37,t:"WALL"},{id:0,p:[92,80,-38],s:[16,6,16],col:1,da:1.37,t:"WALL"},{id:0,p:[98,92,58],s:[4,6,10],col:1,da:1.37,t:"WALL"},{id:0,p:[32,92,66],s:[4,4,18],col:1,da:1.37,t:"WALL"},{id:0,p:[64,92,32],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[61,92,98],s:[22,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[98,80,-66],s:[4,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[32,80,-59],s:[4,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[71,80,-98],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[64,80,-32],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[65,51,65],s:[72,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[65,42,-65],s:[72,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[65,42,-65],s:[6,20,72],col:1,da:.13,t:"WALL"},{id:0,p:[65,51,65],s:[6,20,72],col:1,da:.13,t:"WALL"},{id:0,p:[65,47,65],s:[76,4,10],da:.68,t:"WALL"},{id:0,p:[65,38,-65],s:[76,4,10],da:.68,t:"WALL"},{id:0,p:[65,47,65],s:[10,4,76],da:.68,t:"WALL"},{id:0,p:[65,38,-65],s:[10,4,76],da:.68,t:"WALL"},{id:0,p:[98,0,-137],s:[4,20,4],da:.71,t:"FLOOR"},{id:0,p:[96,4,-121],s:[2,6,40],da:.71,t:"FLOOR"},{id:0,p:[98,0,-102],s:[4,22,4],da:.71,t:"FLOOR"},{id:0,p:[96,12,-121],s:[2,6,40],da:.86,t:"FLOOR"},{id:0,p:[-65,96,-65],s:[92,2,92],da:1.06,t:"FLOOR"},{id:0,p:[-65,92,-66],s:[94,4,4],t:"FLOOR"},{id:0,p:[-65,92,-37],s:[94,4,4],t:"FLOOR"},{id:0,p:[-65,92,-94],s:[94,4,4],t:"FLOOR"},{id:0,p:[-66,92,-65],s:[4,4,94],t:"FLOOR"},{id:0,p:[-39,92,-65],s:[4,4,94],t:"FLOOR"},{id:0,p:[-94,92,-65],s:[4,4,94],t:"FLOOR"},{id:0,p:[-66,72,-65],s:[4,4,110],t:"FLOOR"},{id:0,p:[-66,68,-104],s:[2,2,12],col:1,r:[.7,0,0],t:"FLOOR"},{id:0,p:[-66,68,-27],s:[2,2,12],col:1,r:[-.7,0,0],t:"FLOOR"},{id:0,p:[-89,26,-107],s:[4,4,14],da:1.12,t:"WALL"},{id:0,p:[0,26,-191],s:[4,6,10],da:1.04,t:"WALL"},{id:0,p:[0,26,-179],s:[4,2,14],da:1.01,t:"WALL"},{id:0,p:[87,26,105],s:[4,4,10],da:1.06,t:"WALL"},{id:0,p:[0,26,187],s:[4,4,18],da:1.3,t:"WALL"},{id:0,p:[0,26,159],s:[4,2,18],da:1.3,t:"WALL"},{id:0,p:[-87,0,102],s:[4,20,4],da:.71,t:"FLOOR"},{id:0,p:[-87,0,135],s:[4,18,4],da:.75,t:"FLOOR"},{id:0,p:[-85,3,120],s:[2,6,38],da:.75,t:"FLOOR"},{id:0,p:[-85,11,120],s:[2,6,36],da:.84,t:"FLOOR"},{id:0,p:[-37,118,-37],s:[14,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[-89,118,-37],s:[22,6,14],col:1,da:1.37,t:"WALL"},{id:0,p:[-93,118,-91],s:[14,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-36,118,-93],s:[12,4,14],col:1,da:1.37,t:"WALL"},{id:0,p:[-69,118,-98],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[-61,118,-32],s:[18,4,4],col:1,da:1.37,t:"WALL"},{id:0,p:[-97,118,-62],s:[6,4,16],col:1,da:1.37,t:"WALL"},{id:0,p:[-33,118,-72],s:[6,4,16],col:1,da:1.37,t:"WALL"},{id:0,p:[-101,0,106],s:[8,2,8],col:1,da:.77,t:"WALL"},{id:0,p:[-105,0,95],s:[8,2,4],col:1,da:.97,t:"WALL"},{id:0,p:[-67,0,105],s:[4,2,6],col:1,da:1.12,t:"WALL"},{id:0,p:[-30,0,106],s:[8,4,6],da:1.34,t:"WALL"},{id:0,p:[-93,0,23],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:0,p:[-45,0,20],s:[4,2,4],col:1,da:1.34,t:"WALL"},{id:0,p:[-82,0,22],s:[4,2,4],col:1,da:1.04,t:"WALL"},{id:0,p:[-92,0,115],s:[4,2,4],col:1,da:.99,t:"WALL"},{id:0,p:[-103,0,86],s:[4,2,4],col:1,da:.84,t:"WALL"},{id:0,p:[-26,0,98],s:[4,2,4],col:1,da:1.34,t:"WALL"},{id:0,p:[-26,0,29],s:[4,2,4],col:1,da:1.34,t:"WALL"},{id:0,p:[-34,0,24],s:[8,2,8],col:1,da:1.34,t:"WALL"},{id:0,p:[-95,58,36],s:[8,26,8],a:1,da:1.04,t:"FLOOR"},{id:0,p:[-32,58,85],s:[4,12,30],da:1.43,t:"WALL"},{id:0,p:[-55,58,98],s:[42,12,4],da:1.41,t:"WALL"},{id:0,p:[-98,58,73],s:[4,4,24],da:1.34,t:"WALL"},{id:0,p:[-39,58,32],s:[18,6,4],da:1.34,t:"WALL"},{id:0,p:[-32,58,41],s:[4,10,14],da:1.34,t:"WALL"},{id:0,p:[-38,58,92],s:[8,34,8],a:1,da:.97,t:"FLOOR"},{id:0,p:[-44,0,107],s:[12,10,12],da:1.34,t:"WALL"},{id:0,p:[-106,0,50],s:[8,2,8],col:1,da:1.04,t:"WALL"},{id:0,p:[-21,0,51],s:[12,2,4],col:1,da:.71,t:"FLOOR"},{id:0,p:[-77,0,113],s:[4,2,20],col:1,da:.71,t:"FLOOR"},{id:0,p:[-116,76,201],s:[38,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-49,76,201],s:[48,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[38,76,201],s:[28,4,10],col:1,da:1.28,t:"WALL"},{id:0,p:[141,76,201],s:[42,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[48,76,-201],s:[58,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-56,76,-201],s:[42,4,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-162,76,-201],s:[38,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,-135],s:[12,8,44],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,-44],s:[12,6,36],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,62],s:[12,8,42],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,76,142],s:[12,6,36],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,-123],s:[12,8,40],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,-43],s:[12,8,34],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,48],s:[12,6,26],col:1,da:1.28,t:"WALL"},{id:0,p:[202,76,134],s:[12,8,52],col:1,da:1.28,t:"WALL"},{id:0,p:[-92,58,92],s:[8,10,8],a:1,da:.97,t:"FLOOR"},{id:0,p:[185,0,0],s:[22,22,250],da:1.01,t:"WALL"},{id:0,p:[-177,22,0],s:[4,8,250],da:1.21,t:"WALL"},{id:0,p:[-177,30,115],s:[4,4,20],da:1.21,t:"WALL"},{id:0,p:[-177,30,63],s:[4,2,22],da:1.12,t:"WALL"},{id:0,p:[-177,30,28],s:[4,4,18],da:1.19,t:"WALL"},{id:0,p:[-177,30,-35],s:[4,2,18],da:1.21,t:"WALL"},{id:0,p:[-177,30,-84],s:[4,2,12],da:1.15,t:"WALL"},{id:0,p:[-177,30,-119],s:[4,4,12],da:1.17,t:"WALL"},{id:0,p:[176,22,0],s:[4,8,250],da:1.17,t:"WALL"},{id:0,p:[86,0,186],s:[2,56,2],da:.71,t:"FLOOR"},{id:0,p:[48,0,186],s:[2,52,2],da:.71,t:"FLOOR"},{id:0,p:[67,24,190],s:[42,2,12],da:.71,t:"FLOOR"},{id:0,p:[67,44,190],s:[42,2,12],da:.71,t:"FLOOR"},{id:0,p:[86,0,195],s:[2,50,2],da:.71,t:"FLOOR"},{id:0,p:[48,0,195],s:[2,50,2],da:.71,t:"FLOOR"},{id:0,p:[176,30,-116],s:[4,4,18],da:1.15,t:"WALL"},{id:0,p:[176,30,-72],s:[4,2,18],da:1.15,t:"WALL"},{id:0,p:[176,30,-23],s:[4,4,14],da:1.1,t:"WALL"},{id:0,p:[176,30,22],s:[4,2,14],da:1.12,t:"WALL"},{id:0,p:[176,30,75],s:[4,4,12],da:1.15,t:"WALL"},{id:0,p:[176,30,116],s:[4,4,18],da:1.12,t:"WALL"},{id:0,p:[60,0,109],s:[48,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[-28,0,-179],s:[48,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[153,0,-1],s:[16,8,48],v:1,da:1.06,t:"WALL"},{id:0,p:[153,7,4],s:[16,8,24],v:1,da:1.06,t:"WALL"},{id:0,p:[65,7,109],s:[24,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[-23,7,-179],s:[24,8,16],v:1,da:1.06,t:"WALL"},{id:0,p:[-65,62,-65],s:[72,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[-65,58,-65],s:[76,4,10],da:.68,t:"WALL"},{id:2,p:[-7,0,-165],s:[7,8,7]},{id:2,p:[6,0,-192],s:[7,8,7]},{id:2,p:[-26,0,-92],s:[7,8,7]},{id:2,p:[53,0,192],s:[7,8,7]},{id:8,p:[-125,0,190],s:[12,12,12]},{id:0,p:[-188,22,0],s:[18,2,252],da:1.01,t:"FLOOR"},{id:0,p:[187,22,0],s:[18,2,252],da:1.01,t:"FLOOR"},{id:0,p:[326,0,-34],s:[46,166,50],da:1.3,t:"WALL"},{id:0,p:[-74,0,18],s:[4,2,20],col:1,r:[0,.87,0],da:.71,t:"FLOOR"},{id:0,p:[312,166,-52],s:[18,4,14],da:1.3,t:"WALL"},{id:0,p:[312,166,-16],s:[18,6,14],da:1.3,t:"WALL"},{id:0,p:[343,166,-52],s:[12,4,14],da:1.3,t:"WALL"},{id:0,p:[341,166,-16],s:[16,4,14],da:1.3,t:"WALL"},{id:0,p:[303,127,-33],s:[2,20,6],col:1,da:.13,t:"WALL"},{id:0,p:[-95,0,192],s:[8,72,8],da:.95,t:"FLOOR"},{id:0,p:[-95,64,172],s:[6,6,40],da:.95,t:"FLOOR"},{id:0,p:[-95,58,182],s:[4,4,20],col:1,r:[.7,0,0],da:.95,t:"FLOOR"},{id:0,p:[79,0,-23],s:[2,56,2],da:.71,t:"FLOOR"},{id:0,p:[93,25,-36],s:[32,2,30],da:.71,t:"FLOOR"},{id:0,p:[107,0,-23],s:[2,52,2],da:.71,t:"FLOOR"},{id:0,p:[107,0,-49],s:[2,52,2],da:.71,t:"FLOOR"},{id:0,p:[93,45,-36],s:[32,2,30],da:.71,t:"FLOOR"},{id:0,p:[202,0,-56],s:[12,76,396],da:1.3,t:"WALL"},{id:0,p:[-203,0,52],s:[12,76,388],da:1.3,t:"WALL"},{id:0,p:[68,0,201],s:[420,76,10],da:1.32,t:"WALL"},{id:0,p:[233,76,201],s:[34,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-203,0,-184],s:[12,76,24],da:1.3,t:"WALL"},{id:0,p:[202,30,157],s:[12,46,30],da:1.3,t:"WALL"},{id:0,p:[-203,30,-157],s:[12,46,30],da:1.3,t:"WALL"},{id:0,p:[202,0,184],s:[12,76,24],da:1.3,t:"WALL"},{id:0,p:[-203,0,-149],s:[2,30,14],da:.84,t:"FLOOR"},{id:0,p:[-197,0,-171],s:[14,30,2],da:.84,t:"FLOOR"},{id:0,p:[202,0,149],s:[2,30,14],da:.84,t:"FLOOR"},{id:0,p:[196,0,171],s:[14,30,2],da:.84,t:"FLOOR"},{id:0,p:[-231,76,-201],s:[20,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-193,64,28],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,81],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,131],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,-22],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,-72],s:[8,4,4],t:"FLOOR"},{id:0,p:[-193,64,-115],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,-115],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,-73],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,-32],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,11],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,54],s:[8,4,4],t:"FLOOR"},{id:0,p:[192,64,96],s:[8,4,4],t:"FLOOR"},{id:0,p:[-187,0,-125],s:[12,22,2],v:1,da:1.01,t:"WALL"},{id:0,p:[187,0,125],s:[12,22,2],v:1,da:1.01,t:"WALL"},{id:0,p:[-170,34,217],s:[56,2,58],da:1.01,t:"FLOOR"},{id:0,p:[-184,0,198],s:[26,22,6],da:.97,t:"WALL"},{id:0,p:[-203,76,216],s:[12,6,28],col:1,da:1.28,t:"WALL"},{id:0,p:[-131,0,251],s:[156,76,10],da:1.32,t:"WALL"},{id:0,p:[-46,0,231],s:[14,76,50],da:1.32,t:"WALL"},{id:0,p:[-194,0,191],s:[4,40,4],da:.84,t:"FLOOR"},{id:0,p:[-145,0,191],s:[4,38,4],da:.88,t:"FLOOR"},{id:0,p:[-145,0,243],s:[4,40,4],da:.88,t:"FLOOR"},{id:0,p:[-194,0,243],s:[4,40,4],da:.88,t:"FLOOR"},{id:0,p:[-191,22,198],s:[12,4,6],da:1.01,t:"WALL"},{id:0,p:[-145,0,201],s:[6,18,6],da:.99,t:"WALL"},{id:0,p:[-171,76,251],s:[38,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[-46,76,230],s:[14,6,28],col:1,da:1.28,t:"WALL"},{id:0,p:[-95,76,251],s:[24,6,10],col:1,da:1.28,t:"WALL"},{id:0,p:[162,34,-191],s:[68,2,68],da:.73,t:"FLOOR"},{id:0,p:[131,0,-160],s:[4,48,4],da:.71,t:"FLOOR"},{id:0,p:[193,0,-160],s:[4,48,4],da:.82,t:"FLOOR"},{id:0,p:[193,0,-222],s:[4,34,4],da:.71,t:"FLOOR"},{id:0,p:[131,0,-222],s:[4,38,4],da:.71,t:"FLOOR"},{id:0,p:[138,0,-201],s:[20,20,6],da:.97,t:"WALL"},{id:0,p:[135,20,-201],s:[14,6,6],da:1.04,t:"WALL"},{id:0,p:[193,0,-201],s:[6,24,6],da:.97,t:"WALL"},{id:0,p:[187,0,-201],s:[6,2,6],col:1,da:.99,t:"WALL"},{id:3,p:[196,0,-233],s:[2,50,10],d:2},{id:0,p:[125,0,-254],s:[142,76,10],da:1.32,t:"WALL"},{id:0,p:[49,0,-233],s:[10,76,54],da:1.32,t:"WALL"},{id:0,p:[202,76,-217],s:[12,8,40],col:1,da:1.28,t:"WALL"},{id:0,p:[166,76,-254],s:[26,8,10],col:1,da:1.28,t:"WALL"},{id:0,p:[93,76,-254],s:[44,8,10],col:1,da:1.28,t:"WALL"},{id:2,p:[192,36,-166],s:[7,8,7]},{id:2,p:[-194,36,197],s:[7,8,7]},{id:8,p:[-111,0,212],s:[12,12,12]},{id:1,p:[137,0,-192],s:[12,12,12]},{id:1,p:[140,0,-210],s:[12,12,12]},{id:0,p:[-270,0,-146],s:[12,76,104],da:1.3,t:"WALL"},{id:0,p:[-243,0,-90],s:[68,76,12],da:1.3,t:"WALL"},{id:0,p:[243,0,88],s:[70,76,12],da:1.3,t:"WALL"},{id:0,p:[271,0,145],s:[14,76,112],da:1.3,t:"WALL"},{id:1,p:[214,0,134],s:[12,12,12]},{id:1,p:[214,12,134],s:[12,12,12]},{id:1,p:[214,0,180],s:[12,12,12]},{id:1,p:[258,0,100],s:[12,12,12]},{id:1,p:[258,0,190],s:[12,12,12]},{id:1,p:[246,0,190],s:[12,12,12]},{id:1,p:[258,0,178],s:[12,12,12]},{id:1,p:[258,12,190],s:[12,12,12]},{id:2,p:[260,0,168],s:[7,8,7]},{id:2,p:[248,0,98],s:[7,8,7]},{id:2,p:[224,0,135],s:[7,8,7]},{id:0,p:[-212,0,-178],s:[4,40,4],da:.71,t:"FLOOR"},{id:0,p:[-261,0,-178],s:[4,40,4],da:.71,t:"FLOOR"},{id:0,p:[-237,35,-186],s:[56,2,22],da:.86,t:"FLOOR"},{id:1,p:[-258,0,-190],s:[12,12,12]},{id:1,p:[-215,0,-102],s:[12,12,12]},{id:2,p:[-261,0,-144],s:[7,8,7]},{id:0,p:[152,0,-188],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:0,p:[189,0,-214],s:[8,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[-152,0,193],s:[8,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[-178,0,207],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:0,p:[-216,0,-138],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:1,p:[190,36,-176],s:[12,12,12]},{id:1,p:[134,36,-196],s:[12,12,12]},{id:0,p:[162,39,-157],s:[68,6,2],da:.62,t:"FLOOR"},{id:3,p:[-133,0,206],s:[12,58,2],d:1},{id:0,p:[-23,0,-253],s:[72,124,66],da:.88,t:"WALL"},{id:0,p:[-88,0,-269],s:[72,104,62],da:.95,t:"WALL"},{id:0,p:[29,0,252],s:[72,124,66],da:.9,t:"WALL"},{id:0,p:[-301,0,14],s:[72,118,120],da:.86,t:"WALL"},{id:0,p:[57,124,229],s:[16,4,20],col:1,da:.9,t:"WALL"},{id:0,p:[1,124,229],s:[16,6,20],col:1,da:.9,t:"WALL"},{id:0,p:[29,124,222],s:[20,2,6],col:1,da:.9,t:"WALL"},{id:0,p:[-4,124,260],s:[6,2,20],col:1,da:.9,t:"WALL"},{id:0,p:[62,124,257],s:[6,2,12],col:1,da:.9,t:"WALL"},{id:0,p:[-269,118,3],s:[8,4,18],col:1,da:.86,t:"WALL"},{id:0,p:[-274,118,-32],s:[18,6,28],col:1,da:.86,t:"WALL"},{id:0,p:[-269,118,34],s:[8,6,22],col:1,da:.86,t:"WALL"},{id:0,p:[-274,118,66],s:[18,6,16],col:1,da:.86,t:"WALL"},{id:0,p:[-304,118,-43],s:[16,6,6],col:1,da:.86,t:"WALL"},{id:0,p:[-301,118,71],s:[16,6,6],col:1,da:.86,t:"WALL"},{id:0,p:[-332,118,-32],s:[10,6,28],col:1,da:.86,t:"WALL"},{id:0,p:[-332,118,60],s:[10,6,28],col:1,da:.86,t:"WALL"},{id:0,p:[-23,124,-222],s:[20,2,4],col:1,da:.88,t:"WALL"},{id:0,p:[6,124,-227],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-52,124,-227],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[10,124,-251],s:[6,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[6,124,-279],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-52,124,-279],s:[14,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-56,124,-251],s:[6,4,14],col:1,da:.88,t:"WALL"},{id:0,p:[-73,104,-240],s:[18,6,4],col:1,da:.95,t:"WALL"},{id:0,p:[-97,104,-240],s:[10,4,4],col:1,da:.95,t:"WALL"},{id:0,p:[-117,104,-245],s:[14,4,14],col:1,da:.95,t:"WALL"},{id:0,p:[-122,104,-267],s:[4,2,14],col:1,da:.95,t:"WALL"},{id:0,p:[-117,104,-293],s:[14,4,14],col:1,da:.95,t:"WALL"},{id:1,p:[190,0,-131],s:[12,12,12]}]},{name:"Stockade",modes:[0],biomes:[0],shadScale:350,camPos:[172,21,93],spawns:[[-54,1,0],[291,0,77],[205,0,-199],[-166,0,-233],[-14,38,-232],[-57,1,108],[-214,0,257]],objects:[{id:4,p:[0,0,0],s:[780,0,692],ter:1,t:"DIRT"},{id:0,p:[35,0,215],s:[480,56,38],t:"WALL"},{id:0,p:[100,0,50],s:[10,60,10],t:"FLOOR"},{id:0,p:[100,0,-50],s:[10,58,10],t:"FLOOR"},{id:0,p:[-100,0,-50],s:[10,58,10],t:"FLOOR"},{id:0,p:[-100,0,50],s:[10,58,10],t:"FLOOR"},{id:0,p:[-46,0,50],s:[102,58,4],da:1.06,t:"WALL"},{id:0,p:[0,0,-50],s:[202,58,4],da:1.06,t:"WALL"},{id:0,p:[100,0,0],s:[4,58,92],da:1.06,t:"WALL"},{id:0,p:[-100,0,-34],s:[4,58,24],da:1.08,t:"WALL"},{id:0,p:[-65,58,0],s:[88,4,116],t:"FLOOR"},{id:0,p:[-40,0,-50],s:[6,58,6],t:"FLOOR"},{id:0,p:[34,0,-50],s:[6,58,6],t:"FLOOR"},{id:0,p:[34,0,50],s:[6,58,6],t:"FLOOR"},{id:0,p:[-40,0,50],s:[6,58,6],t:"FLOOR"},{id:0,p:[0,62,-53],s:[214,42,2],da:1.15,t:"WALL"},{id:0,p:[-103,62,-52],s:[10,54,10],a:1,da:.97,t:"FLOOR"},{id:0,p:[103,62,52],s:[10,60,10],a:1,da:1.01,t:"FLOOR"},{id:0,p:[103,62,-52],s:[10,64,10],a:1,da:.97,t:"FLOOR"},{id:1,p:[23,1,42],s:[12,12,12]},{id:1,p:[11,1,42],s:[12,12,12]},{id:1,p:[16,13,42],s:[12,12,12]},{id:1,p:[-29,1,42],s:[12,12,12]},{id:1,p:[-29,1,-42],s:[12,12,12]},{id:1,p:[-17,1,-42],s:[12,12,12]},{id:1,p:[-23,13,-42],s:[12,12,12]},{id:1,p:[63,1,-42],s:[12,12,12]},{id:1,p:[63,1,-30],s:[12,12,12]},{id:1,p:[59,1,19],s:[12,12,12]},{id:1,p:[59,1,7],s:[12,12,12]},{id:1,p:[71,1,19],s:[12,12,12]},{id:1,p:[71,1,7],s:[12,12,12]},{id:1,p:[59,13,19],s:[12,12,12]},{id:1,p:[63,13,-42],s:[12,12,12]},{id:2,p:[-7,1,-43],s:[7,8,7]},{id:2,p:[53,1,-44],s:[7,8,7]},{id:2,p:[58,1,29],s:[7,8,7]},{id:2,p:[-30,1,-32],s:[7,8,7]},{id:1,p:[-74,1,-27],s:[12,12,12]},{id:1,p:[-62,1,-27],s:[12,12,12]},{id:3,p:[-11,1,46],s:[10,68,2],d:3},{id:1,p:[-29,13,42],s:[12,12,12]},{id:1,p:[-29,1,30],s:[12,12,12]},{id:1,p:[-92,1,39],s:[12,12,12]},{id:0,p:[0,-1,0],s:[202,2,96],da:.86,t:"FLOOR"},{id:0,p:[0,62,53],s:[214,40,4],da:1.12,t:"WALL"},{id:0,p:[104,62,0],s:[2,40,96],a:1,da:1.15,t:"WALL"},{id:0,p:[-104,62,31],s:[2,28,32],a:1,da:1.15,t:"WALL"},{id:0,p:[24,58,52],s:[90,4,12],t:"FLOOR"},{id:0,p:[89,58,0],s:[40,4,116],t:"FLOOR"},{id:0,p:[-104,62,-31],s:[2,34,32],a:1,da:1.15,t:"WALL"},{id:1,p:[78,62,-1],s:[12,12,12]},{id:1,p:[78,62,11],s:[12,12,12]},{id:1,p:[-29,62,-46],s:[12,12,12]},{id:1,p:[-50,62,45],s:[12,12,12]},{id:2,p:[-30,62,-37],s:[7,8,7]},{id:2,p:[-100,62,40],s:[7,8,7]},{id:2,p:[-100,62,32],s:[7,8,7]},{id:0,p:[-104,90,28],s:[2,4,12],col:1,da:1.1,t:"WALL"},{id:0,p:[-104,90,43],s:[2,2,6],col:1,da:1.1,t:"WALL"},{id:0,p:[104,102,-32],s:[2,4,20],col:1,da:1.08,t:"WALL"},{id:0,p:[104,102,25],s:[2,2,30],col:1,da:1.08,t:"WALL"},{id:0,p:[104,102,-5],s:[2,2,10],col:1,da:1.15,t:"WALL"},{id:0,p:[-104,96,-38],s:[2,4,12],col:1,da:1.15,t:"WALL"},{id:0,p:[-67,104,-53],s:[38,6,2],col:1,da:1.15,t:"WALL"},{id:0,p:[-14,104,-53],s:[24,2,2],col:1,da:1.12,t:"WALL"},{id:0,p:[43,104,-53],s:[24,4,2],col:1,da:1.1,t:"WALL"},{id:0,p:[76,102,53],s:[24,6,4],col:1,da:1.1,t:"WALL"},{id:0,p:[-71,102,53],s:[24,2,4],col:1,da:1.12,t:"WALL"},{id:0,p:[22,102,53],s:[16,4,4],col:1,da:1.12,t:"WALL"},{id:0,p:[-100,38,0],s:[4,20,44],da:1.08,t:"WALL"},{id:0,p:[-103,62,52],s:[10,54,10],a:1,da:1.04,t:"FLOOR"},{id:0,p:[-111,0,-11],s:[4,2,10],col:1,da:1.01,t:"WALL"},{id:0,p:[-110,0,-32],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-81,0,-72],s:[6,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[113,0,-52],s:[12,2,6],col:1,da:1.01,t:"WALL"},{id:1,p:[-108,0,37],s:[12,12,12]},{id:1,p:[-69,0,-58],s:[12,12,12]},{id:0,p:[-140,0,-103],s:[4,16,82],da:1.08,t:"WALL"},{id:0,p:[-140,16,-71],s:[4,4,14],da:1.08,t:"WALL"},{id:0,p:[-140,16,-134],s:[4,2,14],da:1.08,t:"WALL"},{id:0,p:[-167,0,-128],s:[4,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-18,-1,123],s:[568,2,58],da:.42,t:"WALL"},{id:7,p:[-152,1,135],s:[51,15,20],col:1},{id:0,p:[-251,0,-84],s:[42,104,356],da:1.54,t:"WALL"},{id:0,p:[-251,0,213],s:[42,104,122],da:1.54,t:"WALL"},{id:0,p:[-270,0,124],s:[6,50,86],da:.02,t:"WALL"},{id:0,p:[-251,44,123],s:[42,60,58],da:1.54,t:"WALL"},{id:0,p:[246,0,187],s:[42,78,70],da:1.21,t:"WALL"},{id:0,p:[246,44,123],s:[42,34,58],da:1.21,t:"WALL"},{id:0,p:[-100,1,-11],s:[2,38,22],da:1.01,t:"FLOOR"},{id:0,p:[-110,0,21],s:[22,38,2],da:1.1,t:"FLOOR"},{id:0,p:[-240,0,-3],s:[106,72,130],da:.97,t:"WALL"},{id:1,p:[-199,0,-153],s:[12,12,12]},{id:0,p:[24,58,-52],s:[90,4,12],t:"FLOOR"},{id:0,p:[-11,0,48],s:[12,62,4],v:1,t:"WALL"},{id:0,p:[-191,0,-74],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[0,0,198],s:[162,82,92],da:1.06,t:"WALL"},{id:0,p:[0,48,123],s:[162,34,58],da:1.06,t:"WALL"},{id:1,p:[-87,0,163],s:[12,12,12]},{id:1,p:[-87,12,163],s:[12,12,12]},{id:1,p:[-99,0,163],s:[12,12,12]},{id:8,p:[-206,0,168],s:[12,12,12]},{id:8,p:[-194,0,168],s:[12,12,12],r:[0,1.57,0]},{id:1,p:[-87,0,175],s:[12,12,12]},{id:0,p:[-14,0,-235],s:[60,38,70],t:"WALL"},{id:0,p:[-73,0,-202],s:[58,78,136],da:1.39,t:"WALL"},{id:0,p:[45,0,-216],s:[58,82,108],t:"WALL"},{id:3,p:[-28,0,-200],s:[10,38,2],d:1},{id:8,p:[10,0,-176],s:[12,12,12]},{id:8,p:[44,0,-156],s:[12,12,12],r:[0,-1.57,0]},{id:8,p:[10,38,-211],s:[12,12,12]},{id:0,p:[162,0,-173],s:[126,36,6],da:.81,t:"WALL"},{id:0,p:[166,0,-112],s:[46,122,50],da:1.72,t:"WALL"},{id:0,p:[212,0,84],s:[26,10,4],t:"WALL"},{id:0,p:[203,10,84],s:[8,2,4],t:"WALL"},{id:0,p:[217,10,84],s:[10,4,4],t:"WALL"},{id:0,p:[-142,0,-179],s:[102,54,72],da:1.59,t:"WALL"},{id:7,p:[-71,0,-124],s:[51,15,20],col:1},{id:8,p:[137,0,-97],s:[12,12,12],r:[0,-1.57,0]},{id:8,p:[137,0,-109],s:[12,12,12]},{id:0,p:[-141,0,-267],s:[78,102,26],t:"WALL"},{id:0,p:[-140,16,-104],s:[4,2,20],da:1.08,t:"WALL"},{id:0,p:[-190,0,-65],s:[8,72,8],t:"FLOOR"},{id:0,p:[-190,0,59],s:[8,72,8],t:"FLOOR"},{id:0,p:[-240,71,-3],s:[122,6,142],da:1.01,t:"ROOF"},{id:0,p:[55,0,-158],s:[8,76,8],t:"FLOOR"},{id:0,p:[55,65,-141],s:[6,6,26],t:"FLOOR"},{id:0,p:[55,59,-146],s:[4,4,20],col:1,r:[-.7,0,0],t:"FLOOR"},{id:0,p:[-76,82,76],s:[10,6,44],col:1,da:1.06,t:"WALL"},{id:0,p:[-76,82,137],s:[10,4,24],col:1,da:1.06,t:"WALL"},{id:0,p:[-76,82,197],s:[10,6,24],col:1,da:1.06,t:"WALL"},{id:0,p:[76,82,66],s:[10,6,26],col:1,da:1.06,t:"WALL"},{id:0,p:[76,82,115],s:[10,4,32],col:1,da:1.06,t:"WALL"},{id:0,p:[76,82,155],s:[10,6,22],col:1,da:1.06,t:"WALL"},{id:0,p:[-97,0,-139],s:[6,88,6],t:"FLOOR"},{id:0,p:[-49,0,-139],s:[6,96,6],t:"FLOOR"},{id:0,p:[-182,54,-147],s:[22,4,8],col:1,da:1.54,t:"WALL"},{id:0,p:[-111,54,-145],s:[18,6,4],da:1.57,t:"WALL"},{id:0,p:[-127,54,-213],s:[18,6,4],col:1,da:1.54,t:"WALL"},{id:0,p:[-166,54,-213],s:[26,4,4],col:1,da:1.54,t:"WALL"},{id:0,p:[-191,54,-196],s:[4,4,18],col:1,da:1.57,t:"WALL"},{id:0,p:[-191,54,-167],s:[4,2,16],col:1,da:1.54,t:"WALL"},{id:0,p:[-189,0,-4],s:[6,72,6],t:"FLOOR"},{id:1,p:[120,0,-164],s:[12,12,12]},{id:1,p:[108,0,-164],s:[12,12,12]},{id:0,p:[20,0,-166],s:[6,116,6],t:"FLOOR"},{id:0,p:[70,0,-166],s:[6,116,6],t:"FLOOR"},{id:0,p:[70,0,-265],s:[6,116,6],t:"FLOOR"},{id:0,p:[20,0,-239],s:[6,116,6],t:"FLOOR"},{id:0,p:[45,105,-216],s:[58,2,110],t:"FLOOR"},{id:8,p:[80,0,-58],s:[12,12,12],r:[0,-1.57,0]},{id:2,p:[-177,0,-139],s:[7,8,7]},{id:1,p:[219,0,-108],s:[12,12,12]},{id:0,p:[180,113,-112],s:[4,4,66],t:"FLOOR"},{id:0,p:[152,113,-112],s:[4,4,64],t:"FLOOR"},{id:0,p:[166,113,-126],s:[60,4,4],t:"FLOOR"},{id:0,p:[166,113,-97],s:[60,4,4],t:"FLOOR"},{id:0,p:[149,122,-128],s:[12,4,18],col:1,da:1.65,t:"WALL"},{id:0,p:[149,122,-93],s:[12,4,12],col:1,da:1.68,t:"WALL"},{id:0,p:[183,122,-98],s:[12,4,22],col:1,da:1.65,t:"WALL"},{id:0,p:[181,122,-131],s:[16,6,12],col:1,da:1.65,t:"WALL"},{id:0,p:[145,122,-109],s:[4,4,8],col:1,da:1.65,t:"WALL"},{id:0,p:[166,81,-112],s:[48,22,6],col:1,da:.09,t:"WALL"},{id:0,p:[166,78,-112],s:[50,4,10],da:.68,t:"WALL"},{id:0,p:[166,81,-112],s:[6,22,52],col:1,da:.04,t:"WALL"},{id:0,p:[166,79,-112],s:[10,4,54],da:.71,t:"WALL"},{id:2,p:[-238,1,98],s:[7,8,7]},{id:0,p:[-191,56,202],s:[28,8,12],col:1,da:1.06,t:"WALL"},{id:0,p:[-135,56,198],s:[22,4,4],col:1,da:1.06,t:"WALL"},{id:0,p:[-85,56,198],s:[38,6,4],col:1,da:1.06,t:"WALL"},{id:0,p:[-235,104,243],s:[10,4,28],col:1,da:1.5,t:"WALL"},{id:0,p:[-235,104,111],s:[10,4,54],col:1,da:1.46,t:"WALL"},{id:0,p:[-235,104,-100],s:[10,8,30],col:1,da:1.5,t:"WALL"},{id:0,p:[-235,104,-152],s:[10,4,42],col:1,da:1.52,t:"WALL"},{id:0,p:[-100,0,34],s:[4,58,24],da:1.08,t:"WALL"},{id:0,p:[-251,77,-3],s:[142,42,140],da:.97,t:"WALL"},{id:0,p:[-192,119,52],s:[24,8,30],col:1,da:1.06,t:"WALL"},{id:0,p:[-191,119,-55],s:[22,8,36],col:1,da:1.06,t:"WALL"},{id:0,p:[-184,119,1],s:[8,4,36],col:1,da:1.06,t:"WALL"},{id:0,p:[-230,42,123],s:[6,6,66],t:"FLOOR"},{id:0,p:[-230,0,153],s:[6,42,6],t:"FLOOR"},{id:0,p:[-230,0,93],s:[6,42,6],t:"FLOOR"},{id:0,p:[-230,32,152],s:[4,20,4],col:1,r:[-.7,0,0],da:.97,t:"FLOOR"},{id:0,p:[-230,32,94],s:[4,20,4],col:1,r:[.7,0,0],da:1.06,t:"FLOOR"},{id:0,p:[127,36,-173],s:[30,6,6],da:.83,t:"WALL"},{id:0,p:[188,36,-173],s:[28,4,6],da:.83,t:"WALL"},{id:0,p:[218,36,-173],s:[12,2,6],da:.76,t:"WALL"},{id:0,p:[227,78,167],s:[4,6,30],col:1,t:"WALL"},{id:0,p:[200,56,198],s:[26,6,4],col:1,t:"WALL"},{id:0,p:[146,56,198],s:[34,4,4],col:1,t:"WALL"},{id:1,p:[219,0,56],s:[12,12,12]},{id:8,p:[-2,38,-211],s:[12,12,12],r:[0,1.57,0]},{id:7,p:[10,1,104],s:[51,15,20],col:1},{id:1,p:[59,1,146],s:[12,12,12]},{id:1,p:[47,1,146],s:[12,12,12]},{id:0,p:[88,0,81],s:[6,2,12],col:1,da:1.01,t:"WALL"},{id:8,p:[148,0,167],s:[12,12,12],r:[0,1.57,0]},{id:8,p:[219,0,174],s:[12,12,12],r:[-3.14,0,-3.14]},{id:0,p:[292,0,51],s:[50,78,12],da:1.19,t:"WALL"},{id:0,p:[222,0,248],s:[88,134,58],da:1.12,t:"WALL"},{id:0,p:[140,0,252],s:[84,104,40],da:.95,t:"WALL"},{id:2,p:[106,0,36],s:[7,8,7]},{id:0,p:[188,0,-145],s:[12,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[131,0,-122],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[198,0,-82],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[140,0,166],s:[4,50,4],t:"FLOOR"},{id:0,p:[196,0,166],s:[4,50,4],t:"FLOOR"},{id:0,p:[168,42,179],s:[64,2,34],t:"FLOOR"},{id:0,p:[-160,0,254],s:[78,104,40],da:.84,t:"WALL"},{id:0,p:[-94,0,252],s:[54,140,86],da:1.37,t:"WALL"},{id:0,p:[82,0,205],s:[50,130,54],da:1.48,t:"WALL"},{id:0,p:[167,0,-252],s:[92,106,48],da:1.7,t:"WALL"},{id:0,p:[242,0,-248],s:[58,180,62],da:1.76,t:"WALL"},{id:0,p:[60,0,50],s:[70,58,4],da:1.06,t:"WALL"},{id:0,p:[15,0,71],s:[20,26,46],da:.57,t:"WALL"},{id:0,p:[-38,0,73],s:[86,82,42],da:1.06,t:"WALL"},{id:0,p:[53,0,73],s:[56,82,42],da:1.06,t:"WALL"},{id:0,p:[15,48,71],s:[20,10,46],da:1.06,t:"WALL"},{id:0,p:[319,0,210],s:[130,118,92],da:1.1,t:"WALL"},{id:0,p:[321,0,105],s:[8,78,120],da:1.19,t:"WALL"},{id:0,p:[88,82,-245],s:[14,2,6],col:1,t:"WALL"},{id:0,p:[111,82,-245],s:[12,4,6],col:1,t:"WALL"},{id:1,p:[143,0,-222],s:[12,12,12]},{id:1,p:[155,0,-222],s:[12,12,12]},{id:0,p:[103,0,-61],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[136,0,-80],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[54,0,-68],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[13,0,-156],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[-125,0,-98],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-178,0,-28],s:[8,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[-147,0,-57],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-195,0,69],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-112,0,161],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-184,0,160],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[102,0,-183],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[197,0,-216],s:[8,2,4],col:1,da:1.01,t:"WALL"},{id:0,p:[123,0,-215],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[78,0,-213],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[220,0,10],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[201,0,74],s:[8,2,8],col:1,da:1.01,t:"WALL"},{id:8,p:[311,0,158],s:[12,12,12],r:[-3.14,0,-3.14]},{id:1,p:[252,1,100],s:[12,12,12]},{id:2,p:[271,1,160],s:[7,8,7]},{id:0,p:[271,-1,101],s:[10,2,14],da:.48,t:"WALL"},{id:0,p:[269,-1,143],s:[6,2,18],da:.48,t:"WALL"},{id:0,p:[200,1,115],s:[2,12,4],t:"FLOOR"},{id:0,p:[198,6,124],s:[2,6,28],da:.84,t:"FLOOR"},{id:0,p:[200,1,133],s:[2,12,4],t:"FLOOR"},{id:0,p:[282,-1,138],s:[6,2,8],col:1,da:.48,t:"WALL"},{id:0,p:[273,-1,117],s:[6,2,8],col:1,da:.48,t:"WALL"},{id:0,p:[246,0,-79],s:[42,78,346],da:1.21,t:"WALL"},{id:0,p:[227,78,113],s:[4,4,28],col:1,t:"WALL"},{id:0,p:[265,78,134],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[265,78,81],s:[4,4,18],col:1,t:"WALL"},{id:0,p:[227,78,8],s:[4,4,16],col:1,t:"WALL"},{id:0,p:[227,78,55],s:[4,6,28],col:1,t:"WALL"},{id:0,p:[227,78,-154],s:[4,2,22],col:1,t:"WALL"},{id:0,p:[227,78,-108],s:[4,4,22],col:1,t:"WALL"},{id:0,p:[227,78,-46],s:[4,2,42],col:1,t:"WALL"},{id:0,p:[227,78,-203],s:[4,4,22],col:1,t:"WALL"},{id:0,p:[304,78,55],s:[16,4,4],col:1,t:"WALL"},{id:0,p:[277,78,55],s:[10,2,4],col:1,t:"WALL"},{id:0,p:[321,78,77],s:[8,4,22],col:1,t:"WALL"},{id:0,p:[321,78,129],s:[8,2,30],col:1,t:"WALL"},{id:0,p:[-3,38,-202],s:[38,6,4],t:"WALL"},{id:0,p:[5,44,-202],s:[22,2,4],t:"WALL"},{id:0,p:[-18,44,-202],s:[8,2,4],t:"WALL"},{id:1,p:[10,38,-238],s:[12,12,12]},{id:1,p:[-181,0,14],s:[12,12,12]},{id:1,p:[-117,0,-221],s:[12,12,12]},{id:0,p:[-1,0,-94],s:[34,58,84],da:1.08,t:"WALL"},{id:0,p:[225,0,93],s:[6,42,6],t:"FLOOR"},{id:0,p:[225,0,153],s:[6,42,6],t:"FLOOR"},{id:0,p:[266,0,93],s:[6,42,6],t:"FLOOR"},{id:0,p:[266,0,153],s:[6,42,6],t:"FLOOR"},{id:0,p:[225,42,123],s:[6,6,66],t:"FLOOR"},{id:0,p:[266,42,123],s:[6,6,66],t:"FLOOR"},{id:0,p:[225,31,152],s:[4,20,4],col:1,r:[-.7,0,0],da:1.01,t:"FLOOR"},{id:0,p:[266,31,152],s:[4,20,4],col:1,r:[-.7,0,0],da:1.04,t:"FLOOR"},{id:0,p:[225,31,94],s:[4,20,4],col:1,r:[.7,0,0],da:.97,t:"FLOOR"},{id:0,p:[266,31,94],s:[4,20,4],col:1,r:[.7,0,0],da:.93,t:"FLOOR"},{id:1,p:[166,0,-81],s:[12,12,12]},{id:8,p:[22,0,-58],s:[12,12,12],r:[-3.14,0,-3.14]},{id:0,p:[-17,0,-135],s:[6,60,6],t:"FLOOR"},{id:0,p:[-1,58,-99],s:[44,4,82],t:"FLOOR"},{id:0,p:[15,0,-135],s:[6,58,6],t:"FLOOR"},{id:0,p:[83,104,-53],s:[22,2,2],col:1,da:1.1,t:"WALL"},{id:2,p:[85,0,174],s:[7,8,7]},{id:8,p:[-206,0,68],s:[12,12,12],r:[0,1.57,0]},{id:0,p:[140,0,-6],s:[76,58,54],da:1.08,t:"WALL"},{id:0,p:[146,58,-7],s:[74,4,62],t:"FLOOR"},{id:0,p:[177,0,-32],s:[6,58,6],t:"FLOOR"},{id:0,p:[177,0,20],s:[6,58,6],t:"FLOOR"},{id:1,p:[184,0,-5],s:[12,12,12]},{id:0,p:[183,0,30],s:[4,2,6],col:1,da:1.01,t:"WALL"},{id:0,p:[103,130,228],s:[6,22,6],col:1,t:"FLOOR"},{id:0,p:[103,130,182],s:[6,32,6],col:1,t:"FLOOR"},{id:0,p:[61,130,228],s:[6,34,6],col:1,t:"FLOOR"},{id:0,p:[61,130,182],s:[6,16,6],col:1,t:"FLOOR"},{id:0,p:[102,130,222],s:[10,4,20],da:1.48,t:"WALL"},{id:0,p:[67,130,188],s:[20,6,20],da:1.48,t:"WALL"},{id:0,p:[170,104,234],s:[16,4,4],col:1,t:"WALL"},{id:0,p:[143,104,234],s:[16,2,4],col:1,t:"WALL"},{id:0,p:[111,104,234],s:[22,4,4],col:1,t:"WALL"},{id:0,p:[206,89,219],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[206,85,217],s:[12,4,4],col:1,da:.75,t:"WALL"},{id:0,p:[107,90,205],s:[2,20,6],col:1,da:.04,t:"WALL"},{id:0,p:[109,88,205],s:[4,4,12],col:1,da:.75,t:"WALL"},{id:0,p:[187,134,225],s:[18,4,12],col:1,da:1.12,t:"WALL"},{id:0,p:[257,134,225],s:[18,6,12],col:1,da:1.12,t:"WALL"},{id:0,p:[218,134,222],s:[18,4,6],col:1,da:1.12,t:"WALL"},{id:1,p:[113,56,226],s:[12,12,12]},{id:1,p:[125,56,226],s:[12,12,12]},{id:1,p:[118,68,226],s:[12,12,12]},{id:0,p:[313,118,167],s:[38,6,6],col:1,t:"WALL"},{id:0,p:[263,118,179],s:[18,6,30],col:1,t:"WALL"},{id:0,p:[374,118,175],s:[20,8,22],col:1,t:"WALL"},{id:0,p:[291,68,162],s:[12,4,4],col:1,da:.75,t:"WALL"},{id:0,p:[291,73,164],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[-136,104,238],s:[30,8,8],col:1,da:.84,t:"WALL"},{id:0,p:[-175,104,238],s:[20,4,8],col:1,da:.84,t:"WALL"},{id:0,p:[-196,104,256],s:[6,6,18],col:1,da:.84,t:"WALL"},{id:0,p:[-103,62,52],s:[14,58,14],v:1,da:1.23,t:"FLOOR"},{id:0,p:[-103,62,-52],s:[14,58,14],v:1,da:1.23,t:"FLOOR"},{id:0,p:[-114,140,218],s:[14,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-77,140,218],s:[20,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-118,140,245],s:[6,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-113,140,286],s:[16,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[-116,132,214],s:[6,22,6],col:1,t:"FLOOR"},{id:0,p:[-72,132,214],s:[6,34,6],col:1,t:"FLOOR"},{id:0,p:[-116,132,290],s:[6,28,6],col:1,t:"FLOOR"},{id:0,p:[-202,103,-243],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[-94,102,207],s:[12,4,4],col:1,da:.75,t:"WALL"},{id:1,p:[-152,56,228],s:[12,12,12]},{id:1,p:[-164,56,228],s:[12,12,12]},{id:0,p:[-77,1,108],s:[2,48,28],da:1.01,t:"FLOOR"},{id:0,p:[77,1,138],s:[2,48,28],da:1.01,t:"FLOOR"},{id:0,p:[-65,1,151],s:[26,48,2],da:1.01,t:"FLOOR"},{id:0,p:[65,1,95],s:[26,48,2],da:1.01,t:"FLOOR"},{id:0,p:[-79,78,-136],s:[20,4,4],col:1,da:1.39,t:"WALL"},{id:0,p:[-50,78,-147],s:[12,6,26],col:1,da:1.37,t:"WALL"},{id:0,p:[-47,78,-196],s:[6,4,30],col:1,da:1.39,t:"WALL"},{id:0,p:[-47,78,-235],s:[6,6,18],col:1,da:1.39,t:"WALL"},{id:0,p:[-99,78,-210],s:[6,6,18],col:1,da:1.37,t:"WALL"},{id:0,p:[19,82,-188],s:[6,6,26],col:1,t:"WALL"},{id:0,p:[71,82,-184],s:[6,4,18],col:1,t:"WALL"},{id:0,p:[19,82,-233],s:[6,4,26],col:1,t:"WALL"},{id:0,p:[71,82,-222],s:[6,6,32],col:1,t:"WALL"},{id:0,p:[71,82,-259],s:[6,4,22],col:1,t:"WALL"},{id:0,p:[184,41,-7],s:[12,4,4],t:"FLOOR"},{id:0,p:[-41,38,-202],s:[6,6,4],t:"WALL"},{id:0,p:[8,44,93],s:[6,4,2],da:.82,t:"WALL"},{id:0,p:[22,45,92],s:[6,4,4],da:.79,t:"WALL"},{id:0,p:[22,44,49],s:[6,4,2],da:.97,t:"WALL"},{id:0,p:[6,42,49],s:[2,6,2],da:1.06,t:"WALL"},{id:0,p:[9,26,50],s:[8,2,4],col:1,da:.97,t:"WALL"},{id:0,p:[21,26,92],s:[8,2,4],col:1,da:.68,t:"WALL"},{id:0,p:[10,16,101],s:[6,2,4],col:1,da:.95,t:"WALL"},{id:0,p:[18,24,44],s:[2,2,4],col:1,da:1.06,t:"WALL"},{id:0,p:[24,26,50],s:[2,4,4],col:1,da:.97,t:"WALL"},{id:0,p:[126,106,-234],s:[10,4,12],col:1,da:1.7,t:"WALL"},{id:0,p:[123,106,-254],s:[4,2,12],col:1,da:1.7,t:"WALL"},{id:0,p:[129,106,-272],s:[16,4,8],col:1,da:1.7,t:"WALL"},{id:0,p:[149,106,-230],s:[24,2,4],col:1,da:1.7,t:"WALL"},{id:0,p:[180,106,-230],s:[18,4,4],col:1,da:1.7,t:"WALL"},{id:0,p:[205,106,-230],s:[16,2,4],col:1,da:1.7,t:"WALL"},{id:0,p:[243,133,-215],s:[10,4,4],da:1.26,t:"WALL"},{id:0,p:[243,137,-217],s:[6,18,2],col:1,da:.13,t:"WALL"},{id:0,p:[213,137,-247],s:[2,18,6],col:1,da:.13,t:"WALL"},{id:0,p:[211,133,-247],s:[4,4,10],da:1.26,t:"WALL"},{id:0,p:[221,180,-226],s:[16,4,18],col:1,da:1.7,t:"WALL"},{id:0,p:[246,180,-220],s:[16,2,6],col:1,da:1.7,t:"WALL"},{id:0,p:[267,180,-226],s:[8,4,18],col:1,da:1.7,t:"WALL"},{id:0,p:[216,180,-254],s:[6,2,18],col:1,da:1.7,t:"WALL"},{id:0,p:[-152,1,134],s:[48,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[10,1,103],s:[48,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-71,0,-125],s:[48,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-66,7,-125],s:[24,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-147,8,134],s:[24,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[15,8,103],s:[24,8,16],v:1,da:.95,t:"WALL"},{id:0,p:[-201,56,228],s:[8,6,12],col:1,da:1.06,t:"WALL"},{id:0,p:[-214,0,278],s:[52,104,8],da:.84,t:"WALL"},{id:0,p:[-214,104,278],s:[20,4,8],col:1,da:.84,t:"WALL"},{id:0,p:[208,165,-247],s:[10,4,4],t:"FLOOR"},{id:0,p:[208,165,-227],s:[10,4,4],t:"FLOOR"},{id:0,p:[208,165,-268],s:[10,4,4],t:"FLOOR"},{id:0,p:[222,165,-212],s:[4,4,10],t:"FLOOR"},{id:0,p:[243,165,-212],s:[4,4,10],t:"FLOOR"},{id:0,p:[262,165,-212],s:[4,4,10],t:"FLOOR"},{id:0,p:[-29,102,53],s:[24,4,4],col:1,da:1.12,t:"WALL"},{id:0,p:[-151,54,-145],s:[14,4,4],col:1,da:1.54,t:"WALL"},{id:0,p:[-104,62,12],s:[2,6,6],a:1,da:1.15,t:"WALL"},{id:0,p:[-104,62,-14],s:[2,10,2],a:1,da:1.15,t:"WALL"},{id:0,p:[-245,0,-289],s:[130,146,92],da:.97,t:"WALL"},{id:0,p:[-154,102,-258],s:[22,6,8],col:1,t:"WALL"},{id:0,p:[-191,146,-255],s:[22,8,24],col:1,da:1.04,t:"WALL"},{id:0,p:[-288,146,-203],s:[42,8,8],col:1,da:.97,t:"WALL"},{id:0,p:[-235,146,-207],s:[28,8,16],col:1,da:.95,t:"WALL"},{id:0,p:[-185,146,-294],s:[10,6,24],col:1,da:.95,t:"WALL"},{id:0,p:[-194,146,-326],s:[28,10,18],col:1,da:.9,t:"WALL"},{id:0,p:[-94,106,209],s:[6,20,2],col:1,da:.04,t:"WALL"},{id:0,p:[-202,98,-241],s:[14,6,4],da:.53,t:"WALL"},{id:0,p:[-44,0,-282],s:[164,126,76],da:1.46,t:"WALL"},{id:0,p:[-115,126,-256],s:[22,8,24],col:1,da:1.48,t:"WALL"},{id:0,p:[-67,126,-248],s:[22,6,8],col:1,da:1.48,t:"WALL"},{id:0,p:[-25,126,-248],s:[32,2,8],col:1,da:1.52,t:"WALL"},{id:0,p:[22,126,-254],s:[32,4,20],col:1,da:1.52,t:"WALL"},{id:0,p:[34,126,-292],s:[8,6,26],col:1,da:1.5,t:"WALL"},{id:0,p:[-122,126,-306],s:[8,6,26],col:1,da:1.52,t:"WALL"},{id:0,p:[-238,119,64],s:[32,4,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-287,119,64],s:[20,6,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-233,119,-70],s:[36,6,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-285,119,-70],s:[28,4,6],col:1,da:1.06,t:"WALL"},{id:0,p:[-235,104,186],s:[10,6,44],col:1,da:1.48,t:"WALL"},{id:0,p:[-101,96,-244],s:[6,14,2],col:1,da:.04,t:"WALL"},{id:0,p:[-101,92,-243],s:[12,4,4],da:.75,t:"WALL"},{id:1,p:[-162,54,-178],s:[12,12,12]},{id:0,p:[-1,0,-93],s:[36,60,6],t:"FLOOR"},{id:1,p:[-117,0,-137],s:[12,12,12]},{id:2,p:[-127,0,-139],s:[7,8,7]},{id:0,p:[-147,0,-126],s:[4,48,4],t:"FLOOR"},{id:0,p:[-166,42,-133],s:[44,2,20],t:"FLOOR"},{id:0,p:[-185,0,-126],s:[4,46,4],t:"FLOOR"},{id:0,p:[-265,0,-221],s:[88,146,44],da:.97,t:"WALL"},{id:0,p:[-226,146,-237],s:[10,6,12],col:1,da:.95,t:"WALL"},{id:0,p:[-223,146,-249],s:[16,6,12],col:1,da:.95,t:"WALL"},{id:0,p:[96,0,-254],s:[52,82,24],t:"WALL"},{id:1,p:[-181,0,26],s:[12,12,12]},{id:1,p:[-181,12,18],s:[12,12,12]},{id:0,p:[-222,0,-123],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-173,0,-240],s:[4,2,8],col:1,da:.95,t:"WALL"},{id:0,p:[-203,0,-166],s:[10,2,6],col:1,da:.95,t:"WALL"}]}],o=0;o<a.length;++o)for(var s=0;s<a[o].objects.length;++s)a[o].objects[s].id=n.prefabIDS[a[o].objects[s].id];t.exports.maps=a,t.exports.manager=function(t,e,n,r){var o,s;this.manager=new(i(26).manager)(t,n,r),this.maps=a,this.spawns=[],this.lastGen=null,this.getRandomMap=function(){return n.randInt(0,this.maps.length-1)},this.getRandomMode=function(t){return this.maps[t].modes[n.randInt(0,this.maps[t].modes.length-1)]},this.getRandomBiome=function(t){return this.maps[t].biomes[n.randInt(0,this.maps[t].biomes.length-1)]},this.generate=function(i,a,c,h){var l=this.maps[i];t&&(mapInfo.innerHTML=a.alias+"_"+l.name,curGameInfo.innerHTML=a.name+"<div style='color:rgba(255,255,255,0.6)'>on "+l.name+"</div>");var u=i+" - "+c;if(h||this.lastGen!==u){var d=null;this.lastGen=u,this.manager.removeAll(),e&&e.reset(),t&&t.init(l,c);for(var p=0;p<l.objects.length;++p){var f=(o=l.objects[p]).p[0],m=o.p[1],g=o.p[2];if("CUBE"==o.id){for(var v=1,y=0,x=0;x<l.objects.length;++x)if(("CUBE"==(s=l.objects[x]).id||"PLANE"==s.id)&&o!=s&&m<=s.p[1]+s.s[1]&&m>=s.p[1]&&f+o.s[0]/2<s.p[0]+s.s[0]/2&&f-o.s[0]/2>s.p[0]-s.s[0]/2&&g+o.s[2]/2<s.p[2]+s.s[2]/2&&g-o.s[2]/2>s.p[2]-s.s[2]/2){v=0;break}v&&(y=Math.abs(m/(m+o.s[1]))),this.manager.addBlock(f,m,g,o.s[0],o.s[2],o.s[1],[1,1,1,v,1,1],{src:o.t.toLowerCase()+"_0",darken:o.da,amb:y,noAmb:o.a,yR:o.r?o.r[0]:0,xR:o.r?o.r[1]:0,noCol:o.col,noVis:o.v})}else"PLANE"==o.id?o.ter?d=o:this.manager.addPlane(f,m,g,o.s[2]/2,o.s[0]/2,{src:o.t.toLowerCase()+"_0",scale:1,col:!o.col,noVis:o.v},0,Math.PI/2):"RAMP"==o.id?this.manager.addRamp(f,m,g,o.s[0],o.s[1],o.s[2],o.d*Math.PI/2):"LADDER"==o.id?this.manager.addLadder(f,m,g,o.s[1],o.d*Math.PI/2):this.manager.addMesh(f,m,g,o.r?o.r[1]?o.r[1]:Math.PI:0,o.s[0]/2,o.s[1]/2,o.s[2]/2,o.id.toLowerCase(),o.col)}if(t){var w,b=r.ambScale,L=[];for(p=0;p<this.manager.objects.length;++p)if(!(o=this.manager.objects[p]).noVis&&!o.complexMesh)for(x=0;x<this.manager.objects.length;++x)if(!(s=this.manager.objects[x]).noVis&&!s.complexMesh&&this.manager.collision(o,s,0)){if(x>p){if(w=n.boxIntersection(o,s,"x","z",[Math.PI,0,Math.PI/2,-Math.PI/2]))for(var M=0;M<w.length;++M)for(var _=n.getIntersection(o,s,"y"),A=0;A<2;A++){var E=(w[M].d+Math.PI/2*A)%(2*Math.PI);b=this.manager.limitAmb(r.ambScale,w[M],E,"x","z",o,s),this.manager.addAmbient(w[M].x+b*Math.cos(E),_.y,w[M].z+b*Math.sin(E),-E+Math.PI,0,0,_.height,b,1)}if(w=n.boxIntersection(o,s,"z","y",[Math.PI,0,-Math.PI/2,Math.PI/2]))for(M=0;M<w.length;++M)for(_=n.getIntersection(o,s,"x"),A=0;A<2;A++)E=w[M].d+Math.PI/2*(A?0:1),b=this.manager.limitAmb(r.ambScale,w[M],-E+Math.PI/2,"z","y",o,s),this.manager.addAmbient(_.x,w[M].y+b*Math.cos(E),w[M].z+b*Math.sin(E),0,E,-Math.PI/2,_.width,b,1);if(w=n.boxIntersection(o,s,"x","y",[Math.PI,0,-Math.PI/2,Math.PI/2]))for(M=0;M<w.length;++M)for(_=n.getIntersection(o,s,"z"),A=0;A<2;A++)E=w[M].d+Math.PI/2*(A?0:1),b=this.manager.limitAmb(r.ambScale,w[M],-E+Math.PI/2,"x","y",o,s),this.manager.addAmbient(w[M].x+b*Math.sin(E),w[M].y+b*Math.cos(E),_.z,Math.PI/2,E,-Math.PI/2,_.length,b,1)}var S=o.y+o.height>s.y+s.height,T=o.y-o.height<s.y-s.height;if((S||T)&&(w=n.boxCornerIntersection(o,s,"x","z")))for(M=0;M<w.length;++M)for(b=Math.sqrt(2)*r.ambScale,E=w[M].d-Math.PI/4,A=0;A<2;++A)if((A||S)&&(!A||T)){var R=n.limitRect(w[M].x-b*Math.sin(E),w[M].z-b*Math.cos(E),r.ambScale,r.ambScale,w[M].d,s,"x","z");L.push(this.manager.addAmbient(R.x,s.y+(s.height+.025)*(A?-1:1),R.z,w[M].d,Math.PI/2,0,R.width,R.length,0,!0)),L[L.length-1].org={x:w[M].x,y:L[L.length-1].y,z:w[M].z}}var O=o.x+o.width>s.x+s.width,P=o.x-o.width<s.x-s.width;if(O||P){var C=[Math.PI/2,0,Math.PI,-Math.PI/2];if(w=n.boxCornerIntersection(o,s,"z","y"))for(M=0;M<w.length;++M)for(b=Math.sqrt(2)*r.ambScale,E=w[M].d-Math.PI/4,A=0;A<2;++A)!A&&!O||A&&!P||(R=n.limitRect(w[M].z-b*Math.sin(E),w[M].y-b*Math.cos(E),r.ambScale,r.ambScale,w[M].d,s,"z","y"),L.push(this.manager.addAmbient(s.x+(s.width+.025)*(A?-1:1),R.y,R.z,Math.PI/2,Math.PI,C[w[M].i],R.length,R.height,0,!0)),L[L.length-1].org={x:L[L.length-1].x,y:w[M].y,z:w[M].z})}var I=o.z+o.length>s.z+s.length,D=o.z-o.length<s.z-s.length;if((I||D)&&(C=[-Math.PI/2,Math.PI,0,Math.PI/2],w=n.boxCornerIntersection(o,s,"x","y")))for(M=0;M<w.length;++M)for(b=Math.sqrt(2)*r.ambScale,E=w[M].d-Math.PI/4,A=0;A<2;++A)!A&&!I||A&&!D||(R=n.limitRect(w[M].x-b*Math.sin(E),w[M].y-b*Math.cos(E),r.ambScale,r.ambScale,w[M].d,s,"x","y"),L.push(this.manager.addAmbient(R.x,R.y,s.z+(s.length+.025)*(A?-1:1),0,0,C[w[M].i],R.width,R.height,0,!0)),L[L.length-1].org={x:w[M].x,y:w[M].y,z:L[L.length-1].z})}for(p=0;p<L.length;++p){var F=!0;for(o=L[p],x=0;x<L.length;++x)if(p!=x&&n.sharePos(o.org,L[x].org)){F=!1;break}F&&this.manager.addAmbient(o.x,o.y,o.z,o.xD,o.yD,o.zD,o.w,o.h,o.i)}L.length=0}if(d){var U=d.s[2]/2;b=d.s[0]/2,this.manager.addPlane(0,0,0,U,b,{yOff:-U,col:!0,scale:1,src:c.terrain},0,-Math.PI/2),this.manager.addPlane(0,-.1,0,U,b,{yOff:-U,tilesX:Math.round(b/r.terrainGrid),tilesZ:Math.round(U/r.terrainGrid),noise:4,margin:3,objects:this.manager.objects,scale:1,src:c.terrain},0,-Math.PI/2),e&&c.particles&&c.particles(e,Math.max(U,b))}for(this.spawns.length=0,p=0;p<l.spawns.length;++p)this.spawns.push({x:l.spawns[p][0],y:l.spawns[p][1],z:l.spawns[p][2]});t&&t.addMeshGroups()}}}},function(t,e,i){var n=i(2);const r=i(1);i(23);var a,o={};t.exports.getColor=function(t,e){var i=t+"-"+(e||""),r=o[i];return r||(r=new n.Color(t),e&&r.multiplyScalar(e),o[i]=r),r},t.exports.colorize=function(e,i,n){i=n||t.exports.getColor(i);for(var r=0;r<e.faces.length;++r)e.faces[r].vertexColors[0]=i,e.faces[r].vertexColors[1]=i,e.faces[r].vertexColors[2]=i};var s=function(t,e,i,r){for(var a=new n.Vector2(e,i).multiplyScalar(r||1),o=0;o<t.faceVertexUvs.length;o++)for(var s=t.faceVertexUvs[o],c=0;c<s.length;c++)for(var h=0;h<3;h++){var l=s[c][h].multiply(a);l.x=.5+l.x-a.x/2}},c=function(t,e,i,n,r,a){return t>=i-r&&t<=i+r&&e>=n-a&&e<=n+a},h=[],l=["a","b","c","d"];t.exports.generatePlane=function(e,i,o){e*=o.ratio||1;var u=(o.scale?e+"_"+i+"_":"")+(o.scale||"")+(o.tilesX||"")+(o.tilesZ||"")+(o.color||"")+(o.darken||"");if(!(a=h[u])){if(a=new n.PlaneGeometry(1,1,o.tilesX||1,o.tilesZ||1),o.noise){for(var d={},p=o.margin||0,f=0;f<a.vertices.length;++f){var m=a.vertices[f].x,g=a.vertices[f].y;if(!o.pinEdges||-.5!=m&&.5!=m&&-.5!=g&&.5!=g)if(o.objects){for(var v=0;v<o.objects.length;++v)if(o.objects[v].y-o.objects[v].height<=.1&&2*o.objects[v].height>o.noise&&c(-g*e*2,m*i*2,o.objects[v].z,o.objects[v].x,o.objects[v].length+p,o.objects[v].width+p)){a.vertices[f].z=Math.random()*o.noise+1,d[f]=t.exports.getColor(o.color,.65);break}}else a.vertices[f].z=Math.random()*o.noise;d[f]||(d[f]=t.exports.getColor(o.color))}for(f=0;f<a.faces.length;f++){for(var y=a.faces[f],x=0,w=0;w<3;w++)y.vertexColors[w]=d[y[l[w]]],a.vertices[y[l[w]]].z<=0&&x++;x>=3&&delete a.faces[f]}a.faces=a.faces.filter(function(t){return t}),a.elementsNeedUpdate=!0}else o.color?t.exports.colorize(a,o.color):o.darken&&t.exports.colorize(a,null,t.exports.getColor(16777215,o.darken));o.scale&&s(a,i/r.worldUV,e/r.worldUV,o.scale),h[u]=a}return a};var u=[];t.exports.generateCube=function(e,i,o,c,h){e=e||[1,1,1,1,1,1];for(var l=(h.scale?i+"_"+o+"_"+c+"_":"")+(h.darken||"")+(h.scale||"")+(h.amb||"")+(h.noAmb||""),d=0;d<e.length;++d)l+="_"+e[d];if(!(a=u[l])){h.darken=h.darken||1;var p=t.exports.getColor(16777215,h.darken),f=h.noAmb?p:h.amb?t.exports.getColor(16777215,(r.ambientVal+h.amb*(1-r.ambientVal))*h.darken):t.exports.getColor(16777215,r.ambientVal*h.darken),m=h.noAmb||!h.amb&&e[3]?p:f;a=new n.Geometry;var g,v=[];for(e[0]&&((g=new n.PlaneGeometry(1,1)).rotateY(Math.PI/2),g.translate(.5,.5,0),g.faces[0].vertexColors=[p,m,p],g.faces[1].vertexColors=[m,m,p],h.scale&&s(g,c/r.worldUV,o/r.worldUV,h.scale),v.push(g)),e[1]&&((g=new n.PlaneGeometry(1,1)).rotateY(-Math.PI/2),g.translate(-.5,.5,0),g.faces[0].vertexColors=[p,m,p],g.faces[1].vertexColors=[m,m,p],h.scale&&s(g,c/r.worldUV,o/r.worldUV,h.scale),v.push(g)),e[2]&&((g=new n.PlaneGeometry(1,1)).rotateX(-Math.PI/2),g.translate(0,1,0),g.faces[0].vertexColors=[p,p,p],g.faces[1].vertexColors=[p,p,p],h.scale&&s(g,i/r.worldUV,c/r.worldUV,h.scale),v.push(g)),e[3]&&((g=new n.PlaneGeometry(1,1)).rotateX(Math.PI/2),g.translate(0,0,0),g.faces[0].vertexColors=[m,m,m],g.faces[1].vertexColors=[m,m,m],h.scale&&s(g,i/r.worldUV,c/r.worldUV,h.scale),v.push(g)),e[4]&&((g=new n.PlaneGeometry(1,1)).translate(0,.5,.5),g.faces[0].vertexColors=[p,m,p],g.faces[1].vertexColors=[m,m,p],h.scale&&s(g,i/r.worldUV,o/r.worldUV,h.scale),v.push(g)),e[5]&&((g=new n.PlaneGeometry(1,1)).rotateY(Math.PI),g.translate(0,.5,-.5),g.faces[0].vertexColors=[p,m,p],g.faces[1].vertexColors=[m,m,p],h.scale&&s(g,i/r.worldUV,o/r.worldUV,h.scale),v.push(g)),d=0;d<v.length;d++)a.merge(v[d],new n.Matrix4);u[l]=a}return a}},function(t,e,i){!function(e){t.exports=e;var i="listeners",n={on:function(t,e){return o(this,t).push(e),this},once:function(t,e){var i=this;return n.originalListener=e,o(i,t).push(n),i;function n(){a.call(i,t,n),e.apply(this,arguments)}},off:a,emit:function(t,e){var i=this,n=o(i,t,!0);if(!n)return!1;var r=arguments.length;if(1===r)n.forEach(function(t){t.call(i)});else if(2===r)n.forEach(function(t){t.call(i,e)});else{var a=Array.prototype.slice.call(arguments,1);n.forEach(function(t){t.apply(i,a)})}return!!n.length}};function r(t){for(var e in n)t[e]=n[e];return t}function a(t,e){var n;if(arguments.length){if(e){if(n=o(this,t,!0)){if(!(n=n.filter(function(t){return t!==e&&t.originalListener!==e})).length)return a.call(this,t);this[i][t]=n}}else if((n=this[i])&&(delete n[t],!Object.keys(n).length))return a.call(this)}else delete this[i];return this}function o(t,e,n){if(!n||t[i]){var r=t[i]||(t[i]={});return r[e]||(r[e]=[])}}r(e.prototype),e.mixin=r}(
/**
 * event-lite.js - Light-weight EventEmitter (less than 1KB when gzipped)
 *
 * @copyright Yusuke Kawasaki
 * @license MIT
 * @constructor
 * @see https://github.com/kawanet/event-lite
 * @see http://kawanet.github.io/event-lite/EventLite.html
 * @example
 * var EventLite = require("event-lite");
 *
 * function MyClass() {...}             // your class
 *
 * EventLite.mixin(MyClass.prototype);  // import event methods
 *
 * var obj = new MyClass();
 * obj.on("foo", function() {...});     // add event listener
 * obj.once("bar", function() {...});   // add one-time event listener
 * obj.emit("foo");                     // dispatch event
 * obj.emit("bar");                     // dispatch another event
 * obj.off("foo");                      // remove event listener
 */
function t(){if(!(this instanceof t))return new t})},function(t,e,i){var n=i(8),r=i(6),a=r.Uint64BE,o=r.Int64BE;e.getReadFormat=function(t){var e=s.hasArrayBuffer&&t&&t.binarraybuffer,i=t&&t.int64;return{map:h&&t&&t.usemap?d:u,array:p,str:f,bin:e?g:m,ext:v,uint8:y,uint16:w,uint32:L,uint64:_(8,i?S:A),int8:x,int16:b,int32:M,int64:_(8,i?T:E),float32:_(4,R),float64:_(8,O)}},e.readUint8=y;var s=i(0),c=i(7),h="undefined"!=typeof Map,l=!0;function u(t,e){var i,n={},r=new Array(e),a=new Array(e),o=t.codec.decode;for(i=0;i<e;i++)r[i]=o(t),a[i]=o(t);for(i=0;i<e;i++)n[r[i]]=a[i];return n}function d(t,e){var i,n=new Map,r=new Array(e),a=new Array(e),o=t.codec.decode;for(i=0;i<e;i++)r[i]=o(t),a[i]=o(t);for(i=0;i<e;i++)n.set(r[i],a[i]);return n}function p(t,e){for(var i=new Array(e),n=t.codec.decode,r=0;r<e;r++)i[r]=n(t);return i}function f(t,e){var i=t.reserve(e),n=i+e;return c.toString.call(t.buffer,"utf-8",i,n)}function m(t,e){var i=t.reserve(e),n=i+e,r=c.slice.call(t.buffer,i,n);return s.from(r)}function g(t,e){var i=t.reserve(e),n=i+e,r=c.slice.call(t.buffer,i,n);return s.Uint8Array.from(r).buffer}function v(t,e){var i=t.reserve(e+1),n=t.buffer[i++],r=i+e,a=t.codec.getExtUnpacker(n);if(!a)throw new Error("Invalid ext type: "+(n?"0x"+n.toString(16):n));return a(c.slice.call(t.buffer,i,r))}function y(t){var e=t.reserve(1);return t.buffer[e]}function x(t){var e=t.reserve(1),i=t.buffer[e];return 128&i?i-256:i}function w(t){var e=t.reserve(2),i=t.buffer;return i[e++]<<8|i[e]}function b(t){var e=t.reserve(2),i=t.buffer,n=i[e++]<<8|i[e];return 32768&n?n-65536:n}function L(t){var e=t.reserve(4),i=t.buffer;return 16777216*i[e++]+(i[e++]<<16)+(i[e++]<<8)+i[e]}function M(t){var e=t.reserve(4),i=t.buffer;return i[e++]<<24|i[e++]<<16|i[e++]<<8|i[e]}function _(t,e){return function(i){var n=i.reserve(t);return e.call(i.buffer,n,l)}}function A(t){return new a(this,t).toNumber()}function E(t){return new o(this,t).toNumber()}function S(t){return new a(this,t)}function T(t){return new o(this,t)}function R(t){return n.read(this,t,!1,23,4)}function O(t){return n.read(this,t,!1,52,8)}},function(t,e,i){e.DecodeBuffer=r;var n=i(5).preset;function r(t){if(!(this instanceof r))return new r(t);if(t&&(this.options=t,t.codec)){var e=this.codec=t.codec;e.bufferish&&(this.bufferish=e.bufferish)}}i(18).FlexDecoder.mixin(r.prototype),r.prototype.codec=n,r.prototype.fetch=function(){return this.codec.decode(this)}},function(t,e,i){e.decode=function(t,e){var i=new n(e);return i.write(t),i.read()};var n=i(16).DecodeBuffer},function(t,e,i){e.FlexDecoder=a,e.FlexEncoder=o;var n=i(0),r="BUFFER_SHORTAGE";function a(){if(!(this instanceof a))return new a}function o(){if(!(this instanceof o))return new o}function s(){throw new Error("method not implemented: write()")}function c(){throw new Error("method not implemented: fetch()")}function h(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function l(t){(this.buffers||(this.buffers=[])).push(t)}function u(){return(this.buffers||(this.buffers=[])).shift()}function d(t){return function(e){for(var i in t)e[i]=t[i];return e}}a.mixin=d({bufferish:n,write:function(t){var e=this.offset?n.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=e?t?this.bufferish.concat([e,t]):e:t,this.offset=0},fetch:c,flush:function(){for(;this.offset<this.buffer.length;){var t,e=this.offset;try{t=this.fetch()}catch(t){if(t&&t.message!=r)throw t;this.offset=e;break}this.push(t)}},push:l,pull:u,read:h,reserve:function(t){var e=this.offset,i=e+t;if(i>this.buffer.length)throw new Error(r);return this.offset=i,e},offset:0}),a.mixin(a.prototype),o.mixin=d({bufferish:n,write:s,fetch:function(){var t=this.start;if(t<this.offset){var e=this.start=this.offset;return n.prototype.slice.call(this.buffer,t,e)}},flush:function(){for(;this.start<this.offset;){var t=this.fetch();t&&this.push(t)}},push:l,pull:function(){var t=this.buffers||(this.buffers=[]),e=t.length>1?this.bufferish.concat(t):t[0];return t.length=0,e},read:h,reserve:function(t){var e=0|t;if(this.buffer){var i=this.buffer.length,n=0|this.offset,r=n+e;if(r<i)return this.offset=r,n;this.flush(),t=Math.max(t,Math.min(2*i,this.maxBufferSize))}return t=Math.max(t,this.minBufferSize),this.buffer=this.bufferish.alloc(t),this.start=0,this.offset=e,0},send:function(t){var e=t.length;if(e>this.minBufferSize)this.flush(),this.push(t);else{var i=this.reserve(e);n.prototype.copy.call(t,this.buffer,i)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}),o.mixin(o.prototype)},function(t,e){for(var i=e.uint8=new Array(256),n=0;n<=255;n++)i[n]=r(n);function r(t){return function(e){var i=e.reserve(1);e.buffer[i]=t}}},function(t,e,i){"use strict";(function(t){
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */
var n=i(40),r=i(8),a=i(4);function o(){return c.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(t,e){if(o()<e)throw new RangeError("Invalid typed array length");return c.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=c.prototype:(null===t&&(t=new c(e)),t.length=e),t}function c(t,e,i){if(!(c.TYPED_ARRAY_SUPPORT||this instanceof c))return new c(t,e,i);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return u(this,t)}return h(this,t,e,i)}function h(t,e,i,n){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,i,n){if(e.byteLength,i<0||e.byteLength<i)throw new RangeError("'offset' is out of bounds");if(e.byteLength<i+(n||0))throw new RangeError("'length' is out of bounds");return e=void 0===i&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,i):new Uint8Array(e,i,n),c.TYPED_ARRAY_SUPPORT?(t=e).__proto__=c.prototype:t=d(t,e),t}(t,e,i,n):"string"==typeof e?function(t,e,i){if("string"==typeof i&&""!==i||(i="utf8"),!c.isEncoding(i))throw new TypeError('"encoding" must be a valid string encoding');var n=0|f(e,i),r=(t=s(t,n)).write(e,i);return r!==n&&(t=t.slice(0,r)),t}(t,e,i):function(t,e){if(c.isBuffer(e)){var i=0|p(e.length);return 0===(t=s(t,i)).length?t:(e.copy(t,0,0,i),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||function(t){return t!=t}(e.length)?s(t,0):d(t,e);if("Buffer"===e.type&&a(e.data))return d(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function l(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function u(t,e){if(l(e),t=s(t,e<0?0:0|p(e)),!c.TYPED_ARRAY_SUPPORT)for(var i=0;i<e;++i)t[i]=0;return t}function d(t,e){var i=e.length<0?0:0|p(e.length);t=s(t,i);for(var n=0;n<i;n+=1)t[n]=255&e[n];return t}function p(t){if(t>=o())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o().toString(16)+" bytes");return 0|t}function f(t,e){if(c.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var i=t.length;if(0===i)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":case void 0:return z(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*i;case"hex":return i>>>1;case"base64":return k(t).length;default:if(n)return z(t).length;e=(""+e).toLowerCase(),n=!0}}function m(t,e,i){var n=t[e];t[e]=t[i],t[i]=n}function g(t,e,i,n,r){if(0===t.length)return-1;if("string"==typeof i?(n=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,isNaN(i)&&(i=r?0:t.length-1),i<0&&(i=t.length+i),i>=t.length){if(r)return-1;i=t.length-1}else if(i<0){if(!r)return-1;i=0}if("string"==typeof e&&(e=c.from(e,n)),c.isBuffer(e))return 0===e.length?-1:v(t,e,i,n,r);if("number"==typeof e)return e&=255,c.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?r?Uint8Array.prototype.indexOf.call(t,e,i):Uint8Array.prototype.lastIndexOf.call(t,e,i):v(t,[e],i,n,r);throw new TypeError("val must be string, number or Buffer")}function v(t,e,i,n,r){var a,o=1,s=t.length,c=e.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(t.length<2||e.length<2)return-1;o=2,s/=2,c/=2,i/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(r){var l=-1;for(a=i;a<s;a++)if(h(t,a)===h(e,-1===l?0:a-l)){if(-1===l&&(l=a),a-l+1===c)return l*o}else-1!==l&&(a-=a-l),l=-1}else for(i+c>s&&(i=s-c),a=i;a>=0;a--){for(var u=!0,d=0;d<c;d++)if(h(t,a+d)!==h(e,d)){u=!1;break}if(u)return a}return-1}function y(t,e,i,n){i=Number(i)||0;var r=t.length-i;n?(n=Number(n))>r&&(n=r):n=r;var a=e.length;if(a%2!=0)throw new TypeError("Invalid hex string");n>a/2&&(n=a/2);for(var o=0;o<n;++o){var s=parseInt(e.substr(2*o,2),16);if(isNaN(s))return o;t[i+o]=s}return o}function x(t,e,i,n){return H(z(e,t.length-i),t,i,n)}function w(t,e,i,n){return H(function(t){for(var e=[],i=0;i<t.length;++i)e.push(255&t.charCodeAt(i));return e}(e),t,i,n)}function b(t,e,i,n){return w(t,e,i,n)}function L(t,e,i,n){return H(k(e),t,i,n)}function M(t,e,i,n){return H(function(t,e){for(var i,n,r,a=[],o=0;o<t.length&&!((e-=2)<0);++o)n=(i=t.charCodeAt(o))>>8,r=i%256,a.push(r),a.push(n);return a}(e,t.length-i),t,i,n)}function _(t,e,i){return 0===e&&i===t.length?n.fromByteArray(t):n.fromByteArray(t.slice(e,i))}function A(t,e,i){i=Math.min(t.length,i);for(var n=[],r=e;r<i;){var a,o,s,c,h=t[r],l=null,u=h>239?4:h>223?3:h>191?2:1;if(r+u<=i)switch(u){case 1:h<128&&(l=h);break;case 2:128==(192&(a=t[r+1]))&&(c=(31&h)<<6|63&a)>127&&(l=c);break;case 3:a=t[r+1],o=t[r+2],128==(192&a)&&128==(192&o)&&(c=(15&h)<<12|(63&a)<<6|63&o)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:a=t[r+1],o=t[r+2],s=t[r+3],128==(192&a)&&128==(192&o)&&128==(192&s)&&(c=(15&h)<<18|(63&a)<<12|(63&o)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,u=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),r+=u}return function(t){var e=t.length;if(e<=E)return String.fromCharCode.apply(String,t);for(var i="",n=0;n<e;)i+=String.fromCharCode.apply(String,t.slice(n,n+=E));return i}(n)}e.Buffer=c,e.SlowBuffer=function(t){return+t!=t&&(t=0),c.alloc(+t)},e.INSPECT_MAX_BYTES=50,c.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=o(),c.poolSize=8192,c._augment=function(t){return t.__proto__=c.prototype,t},c.from=function(t,e,i){return h(null,t,e,i)},c.TYPED_ARRAY_SUPPORT&&(c.prototype.__proto__=Uint8Array.prototype,c.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&c[Symbol.species]===c&&Object.defineProperty(c,Symbol.species,{value:null,configurable:!0})),c.alloc=function(t,e,i){return function(t,e,i,n){return l(e),e<=0?s(t,e):void 0!==i?"string"==typeof n?s(t,e).fill(i,n):s(t,e).fill(i):s(t,e)}(null,t,e,i)},c.allocUnsafe=function(t){return u(null,t)},c.allocUnsafeSlow=function(t){return u(null,t)},c.isBuffer=function(t){return!(null==t||!t._isBuffer)},c.compare=function(t,e){if(!c.isBuffer(t)||!c.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var i=t.length,n=e.length,r=0,a=Math.min(i,n);r<a;++r)if(t[r]!==e[r]){i=t[r],n=e[r];break}return i<n?-1:n<i?1:0},c.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return c.alloc(0);var i;if(void 0===e)for(e=0,i=0;i<t.length;++i)e+=t[i].length;var n=c.allocUnsafe(e),r=0;for(i=0;i<t.length;++i){var o=t[i];if(!c.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(n,r),r+=o.length}return n},c.byteLength=f,c.prototype._isBuffer=!0,c.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)m(this,e,e+1);return this},c.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)m(this,e,e+3),m(this,e+1,e+2);return this},c.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)m(this,e,e+7),m(this,e+1,e+6),m(this,e+2,e+5),m(this,e+3,e+4);return this},c.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?A(this,0,t):function(t,e,i){var n=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===i||i>this.length)&&(i=this.length),i<=0)return"";if((i>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return R(this,e,i);case"utf8":case"utf-8":return A(this,e,i);case"ascii":return S(this,e,i);case"latin1":case"binary":return T(this,e,i);case"base64":return _(this,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,i);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}.apply(this,arguments)},c.prototype.equals=function(t){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===c.compare(this,t)},c.prototype.inspect=function(){var t="",i=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,i).match(/.{2}/g).join(" "),this.length>i&&(t+=" ... ")),"<Buffer "+t+">"},c.prototype.compare=function(t,e,i,n,r){if(!c.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===i&&(i=t?t.length:0),void 0===n&&(n=0),void 0===r&&(r=this.length),e<0||i>t.length||n<0||r>this.length)throw new RangeError("out of range index");if(n>=r&&e>=i)return 0;if(n>=r)return-1;if(e>=i)return 1;if(e>>>=0,i>>>=0,n>>>=0,r>>>=0,this===t)return 0;for(var a=r-n,o=i-e,s=Math.min(a,o),h=this.slice(n,r),l=t.slice(e,i),u=0;u<s;++u)if(h[u]!==l[u]){a=h[u],o=l[u];break}return a<o?-1:o<a?1:0},c.prototype.includes=function(t,e,i){return-1!==this.indexOf(t,e,i)},c.prototype.indexOf=function(t,e,i){return g(this,t,e,i,!0)},c.prototype.lastIndexOf=function(t,e,i){return g(this,t,e,i,!1)},c.prototype.write=function(t,e,i,n){if(void 0===e)n="utf8",i=this.length,e=0;else if(void 0===i&&"string"==typeof e)n=e,i=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(i)?(i|=0,void 0===n&&(n="utf8")):(n=i,i=void 0)}var r=this.length-e;if((void 0===i||i>r)&&(i=r),t.length>0&&(i<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var a=!1;;)switch(n){case"hex":return y(this,t,e,i);case"utf8":case"utf-8":return x(this,t,e,i);case"ascii":return w(this,t,e,i);case"latin1":case"binary":return b(this,t,e,i);case"base64":return L(this,t,e,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,t,e,i);default:if(a)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),a=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var E=4096;function S(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(127&t[r]);return n}function T(t,e,i){var n="";i=Math.min(t.length,i);for(var r=e;r<i;++r)n+=String.fromCharCode(t[r]);return n}function R(t,e,i){var n=t.length;(!e||e<0)&&(e=0),(!i||i<0||i>n)&&(i=n);for(var r="",a=e;a<i;++a)r+=W(t[a]);return r}function O(t,e,i){for(var n=t.slice(e,i),r="",a=0;a<n.length;a+=2)r+=String.fromCharCode(n[a]+256*n[a+1]);return r}function P(t,e,i){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>i)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,i,n,r,a){if(!c.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>r||e<a)throw new RangeError('"value" argument is out of bounds');if(i+n>t.length)throw new RangeError("Index out of range")}function I(t,e,i,n){e<0&&(e=65535+e+1);for(var r=0,a=Math.min(t.length-i,2);r<a;++r)t[i+r]=(e&255<<8*(n?r:1-r))>>>8*(n?r:1-r)}function D(t,e,i,n){e<0&&(e=4294967295+e+1);for(var r=0,a=Math.min(t.length-i,4);r<a;++r)t[i+r]=e>>>8*(n?r:3-r)&255}function F(t,e,i,n,r,a){if(i+n>t.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function U(t,e,i,n,a){return a||F(t,0,i,4),r.write(t,e,i,n,23,4),i+4}function N(t,e,i,n,a){return a||F(t,0,i,8),r.write(t,e,i,n,52,8),i+8}c.prototype.slice=function(t,e){var i,n=this.length;if(t=~~t,e=void 0===e?n:~~e,t<0?(t+=n)<0&&(t=0):t>n&&(t=n),e<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t),c.TYPED_ARRAY_SUPPORT)(i=this.subarray(t,e)).__proto__=c.prototype;else{var r=e-t;i=new c(r,void 0);for(var a=0;a<r;++a)i[a]=this[a+t]}return i},c.prototype.readUIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],r=1,a=0;++a<e&&(r*=256);)n+=this[t+a]*r;return n},c.prototype.readUIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t+--e],r=1;e>0&&(r*=256);)n+=this[t+--e]*r;return n},c.prototype.readUInt8=function(t,e){return e||P(t,1,this.length),this[t]},c.prototype.readUInt16LE=function(t,e){return e||P(t,2,this.length),this[t]|this[t+1]<<8},c.prototype.readUInt16BE=function(t,e){return e||P(t,2,this.length),this[t]<<8|this[t+1]},c.prototype.readUInt32LE=function(t,e){return e||P(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},c.prototype.readUInt32BE=function(t,e){return e||P(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},c.prototype.readIntLE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=this[t],r=1,a=0;++a<e&&(r*=256);)n+=this[t+a]*r;return n>=(r*=128)&&(n-=Math.pow(2,8*e)),n},c.prototype.readIntBE=function(t,e,i){t|=0,e|=0,i||P(t,e,this.length);for(var n=e,r=1,a=this[t+--n];n>0&&(r*=256);)a+=this[t+--n]*r;return a>=(r*=128)&&(a-=Math.pow(2,8*e)),a},c.prototype.readInt8=function(t,e){return e||P(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},c.prototype.readInt16LE=function(t,e){e||P(t,2,this.length);var i=this[t]|this[t+1]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt16BE=function(t,e){e||P(t,2,this.length);var i=this[t+1]|this[t]<<8;return 32768&i?4294901760|i:i},c.prototype.readInt32LE=function(t,e){return e||P(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},c.prototype.readInt32BE=function(t,e){return e||P(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},c.prototype.readFloatLE=function(t,e){return e||P(t,4,this.length),r.read(this,t,!0,23,4)},c.prototype.readFloatBE=function(t,e){return e||P(t,4,this.length),r.read(this,t,!1,23,4)},c.prototype.readDoubleLE=function(t,e){return e||P(t,8,this.length),r.read(this,t,!0,52,8)},c.prototype.readDoubleBE=function(t,e){return e||P(t,8,this.length),r.read(this,t,!1,52,8)},c.prototype.writeUIntLE=function(t,e,i,n){t=+t,e|=0,i|=0,n||C(this,t,e,i,Math.pow(2,8*i)-1,0);var r=1,a=0;for(this[e]=255&t;++a<i&&(r*=256);)this[e+a]=t/r&255;return e+i},c.prototype.writeUIntBE=function(t,e,i,n){t=+t,e|=0,i|=0,n||C(this,t,e,i,Math.pow(2,8*i)-1,0);var r=i-1,a=1;for(this[e+r]=255&t;--r>=0&&(a*=256);)this[e+r]=t/a&255;return e+i},c.prototype.writeUInt8=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,1,255,0),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},c.prototype.writeUInt16LE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeUInt16BE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,2,65535,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeUInt32LE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):D(this,t,e,!0),e+4},c.prototype.writeUInt32BE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,4,4294967295,0),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},c.prototype.writeIntLE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);C(this,t,e,i,r-1,-r)}var a=0,o=1,s=0;for(this[e]=255&t;++a<i&&(o*=256);)t<0&&0===s&&0!==this[e+a-1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+i},c.prototype.writeIntBE=function(t,e,i,n){if(t=+t,e|=0,!n){var r=Math.pow(2,8*i-1);C(this,t,e,i,r-1,-r)}var a=i-1,o=1,s=0;for(this[e+a]=255&t;--a>=0&&(o*=256);)t<0&&0===s&&0!==this[e+a+1]&&(s=1),this[e+a]=(t/o>>0)-s&255;return e+i},c.prototype.writeInt8=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,1,127,-128),c.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},c.prototype.writeInt16LE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):I(this,t,e,!0),e+2},c.prototype.writeInt16BE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,2,32767,-32768),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):I(this,t,e,!1),e+2},c.prototype.writeInt32LE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,4,2147483647,-2147483648),c.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):D(this,t,e,!0),e+4},c.prototype.writeInt32BE=function(t,e,i){return t=+t,e|=0,i||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),c.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):D(this,t,e,!1),e+4},c.prototype.writeFloatLE=function(t,e,i){return U(this,t,e,!0,i)},c.prototype.writeFloatBE=function(t,e,i){return U(this,t,e,!1,i)},c.prototype.writeDoubleLE=function(t,e,i){return N(this,t,e,!0,i)},c.prototype.writeDoubleBE=function(t,e,i){return N(this,t,e,!1,i)},c.prototype.copy=function(t,e,i,n){if(i||(i=0),n||0===n||(n=this.length),e>=t.length&&(e=t.length),e||(e=0),n>0&&n<i&&(n=i),n===i)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(i<0||i>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),t.length-e<n-i&&(n=t.length-e+i);var r,a=n-i;if(this===t&&i<e&&e<n)for(r=a-1;r>=0;--r)t[r+e]=this[r+i];else if(a<1e3||!c.TYPED_ARRAY_SUPPORT)for(r=0;r<a;++r)t[r+e]=this[r+i];else Uint8Array.prototype.set.call(t,this.subarray(i,i+a),e);return a},c.prototype.fill=function(t,e,i,n){if("string"==typeof t){if("string"==typeof e?(n=e,e=0,i=this.length):"string"==typeof i&&(n=i,i=this.length),1===t.length){var r=t.charCodeAt(0);r<256&&(t=r)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!c.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<i)throw new RangeError("Out of range index");if(i<=e)return this;var a;if(e>>>=0,i=void 0===i?this.length:i>>>0,t||(t=0),"number"==typeof t)for(a=e;a<i;++a)this[a]=t;else{var o=c.isBuffer(t)?t:z(new c(t,n).toString()),s=o.length;for(a=0;a<i-e;++a)this[a+e]=o[a%s]}return this};var B=/[^+\/0-9A-Za-z-_]/g;function W(t){return t<16?"0"+t.toString(16):t.toString(16)}function z(t,e){var i;e=e||1/0;for(var n=t.length,r=null,a=[],o=0;o<n;++o){if((i=t.charCodeAt(o))>55295&&i<57344){if(!r){if(i>56319){(e-=3)>-1&&a.push(239,191,189);continue}if(o+1===n){(e-=3)>-1&&a.push(239,191,189);continue}r=i;continue}if(i<56320){(e-=3)>-1&&a.push(239,191,189),r=i;continue}i=65536+(r-55296<<10|i-56320)}else r&&(e-=3)>-1&&a.push(239,191,189);if(r=null,i<128){if((e-=1)<0)break;a.push(i)}else if(i<2048){if((e-=2)<0)break;a.push(i>>6|192,63&i|128)}else if(i<65536){if((e-=3)<0)break;a.push(i>>12|224,i>>6&63|128,63&i|128)}else{if(!(i<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;a.push(i>>18|240,i>>12&63|128,i>>6&63|128,63&i|128)}}return a}function k(t){return n.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(B,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function H(t,e,i,n){for(var r=0;r<n&&!(r+i>=e.length||r>=t.length);++r)e[r+i]=t[r];return r}}).call(this,i(25))},function(t,e,i){e.EncodeBuffer=r;var n=i(10).preset;function r(t){if(!(this instanceof r))return new r(t);if(t&&(this.options=t,t.codec)){var e=this.codec=t.codec;e.bufferish&&(this.bufferish=e.bufferish)}}i(18).FlexEncoder.mixin(r.prototype),r.prototype.codec=n,r.prototype.write=function(t){this.codec.encode(this,t)}},function(t,e,i){e.encode=function(t,e){var i=new n(e);return i.write(t),i.read()};var n=i(21).EncodeBuffer},function(t,e){t.exports.keyboardMap="   CANCEL   HELP  BACK_SPACE TAB   CLEAR ENTER ENTER_SPECIAL  SHIFT CONTROL ALT PAUSE CAPS_LOCK KANA EISU JUNJA FINAL HANJA  ESCAPE CONVERT NONCONVERT ACCEPT MODECHANGE SPACE PAGE_UP PAGE_DOWN END HOME LEFT UP RIGHT DOWN SELECT PRINT EXECUTE PRINTSCREEN INSERT DELETE  0 1 2 3 4 5 6 7 8 9 COLON SEMICOLON LESS_THAN EQUALS GREATER_THAN QUESTION_MARK AT A B C D E F G H I J K L M N O P Q R S T U V W X Y Z OS_KEY  CONTEXT_MENU  SLEEP NUMPAD0 NUMPAD1 NUMPAD2 NUMPAD3 NUMPAD4 NUMPAD5 NUMPAD6 NUMPAD7 NUMPAD8 NUMPAD9 MULTIPLY ADD SEPARATOR SUBTRACT DECIMAL DIVIDE F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 F11 F12 F13 F14 F15 F16 F17 F18 F19 F20 F21 F22 F23 F24         NUM_LOCK SCROLL_LOCK WIN_OEM_FJ_JISHO WIN_OEM_FJ_MASSHOU WIN_OEM_FJ_TOUROKU WIN_OEM_FJ_LOYA WIN_OEM_FJ_ROYA          CIRCUMFLEX EXCLAMATION DOUBLE_QUOTE HASH DOLLAR PERCENT AMPERSAND UNDERSCORE OPEN_PAREN CLOSE_PAREN ASTERISK PLUS PIPE HYPHEN_MINUS OPEN_CURLY_BRACKET CLOSE_CURLY_BRACKET TILDE     VOLUME_MUTE VOLUME_DOWN VOLUME_UP   SEMICOLON EQUALS COMMA MINUS PERIOD SLASH BACK_QUOTE                           OPEN_BRACKET BACK_SLASH CLOSE_BRACKET QUOTE  META ALTGR  WIN_ICO_HELP WIN_ICO_00  WIN_ICO_CLEAR   WIN_OEM_RESET WIN_OEM_JUMP WIN_OEM_PA1 WIN_OEM_PA2 WIN_OEM_PA3 WIN_OEM_WSCTRL WIN_OEM_CUSEL WIN_OEM_ATTN WIN_OEM_FINISH WIN_OEM_COPY WIN_OEM_AUTO WIN_OEM_ENLW WIN_OEM_BACKTAB ATTN CRSEL EXSEL EREOF PLAY ZOOM  PA1 WIN_OEM_CLEAR ".split(" "),Number.prototype.round=function(t){return+this.toFixed(t)},Number.prototype.roundToNearest=function(t){return this>0?Math.ceil(this/t)*t:this<0?Math.floor(this/t)*t:this},t.exports.formatNum=function(t){var e=Math.floor(Math.log(Math.abs(t))/Math.log(1e3)),i="kmb"[e-1];return i?(t/Math.pow(1e3,e)).toFixed(1)+i:""+t},t.exports.randInt=function(t,e){return Math.floor(Math.random()*(e-t+1))+t},t.exports.randFloat=function(t,e){return Math.random()*(e-t)+t},t.exports.getRandom=function(e){return e[t.exports.randInt(0,e.length-1)]},t.exports.getDistance=function(t,e,i,n){return Math.sqrt((i-=t)*i+(n-=e)*n)},t.exports.getDistance3D=function(t,e,i,n,r,a){var o=t-n,s=e-r,c=i-a;return Math.sqrt(o*o+s*s+c*c)},t.exports.getAnglesSSS=function(t,e,i){var n=Math.acos((e*e+i*i-t*t)/(2*e*i)),r=Math.acos((i*i+t*t-e*e)/(2*i*t)),a=Math.PI-n-r;return[-n-Math.PI/2,r,a]},t.exports.getXDir=function(e,i,n,r,a,o){var s=Math.abs(i-a),c=t.exports.getDistance3D(e,i,n,r,a,o);return Math.asin(s/c)*(i>a?-1:1)},t.exports.getAngleDist=function(t,e){return Math.atan2(Math.sin(e-t),Math.cos(t-e))},t.exports.toRad=function(t){return t*(Math.PI/180)},t.exports.getDirection=function(t,e,i,n){return Math.atan2(e-n,t-i)},t.exports.lerp=function(t,e,i){return t+(e-t)*i},t.exports.orderByScore=function(t,e){return e.score-t.score},t.exports.orderByDst=function(t,e){return t.dst-e.dst},t.exports.capFirst=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},t.exports.truncateText=function(t,e){return t.length>e?t.substring(0,e)+"...":t},t.exports.randomString=function(t){for(var e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;n<t;n++)e+=i.charAt(Math.floor(Math.random()*i.length));return e},t.exports.formatNumCash=function(t){return parseFloat(Math.round(100*t)/100).toFixed(2)},t.exports.getKeyName=function(e){return t.exports.keyboardMap[e]},t.exports.getTime=function(t){var e=Math.floor(t/6e4),i=(t%6e4/1e3).toFixed(0);return e+":"+(i<10?"0":"")+i},t.exports.getReadableTime=function(t){var e=t/1e3/60,i=parseInt(e%60);e/=60;var n=parseInt(e%24);e/=24;var r=parseInt(e);return(r?r+"d ":"")+(n?n+"h ":"")+(i||0)+"m "},t.exports.fixTo=function(t,e){return parseFloat(t.toFixed(e))},t.exports.limit=function(t,e){return t<-e?-e:t>e?e:t},t.exports.cropVal=function(t,e){return t<=e&&t>=-e?0:t},t.exports.isNumber=function(t){return"number"==typeof t&&!isNaN(t)&&isFinite(t)},t.exports.isString=function(t){return t&&"string"==typeof t},t.exports.lineInRect=function(t,e,i,n,r,a,o,s,c,h,l,u){var d=(o-t)*n,p=(h-t)*n,f=(c-i)*a,m=(u-i)*a,g=(s-e)*r,v=(l-e)*r,y=Math.max(Math.max(Math.min(d,p),Math.min(f,m)),Math.min(g,v)),x=Math.min(Math.min(Math.max(d,p),Math.max(f,m)),Math.max(g,v));return!(x<0)&&!(y>x)&&y},t.exports.pointInBox=function(t,e,i,n,r,a,o){return o?t>=i&&t<=r&&e>=n&&e<=a:t>i&&t<r&&e>n&&e<a},t.exports.sharePos=function(t,e,i){return i=i||0,Math.abs(t.x-e.x)<=i&&Math.abs(t.y-e.y)<=i&&Math.abs(t.z-e.z)<=i},t.exports.cdv={x:"width",y:"height",z:"length"},t.exports.boxIntersection=function(e,i,n,r,a){var o=t.exports.cdv[n],s=t.exports.cdv[r],c=e[n]-e[o]-.025,h=i[n]-i[o]-.025,l=e[n]+e[o]+.025,u=i[n]+i[o]+.025,d=e[r]-e[s]-.025,p=i[r]-i[s]-.025,f=e[r]+e[s]+.025,m=i[r]+i[s]+.025,g=Math.max(c,h),v=Math.min(l,u);if(v>=g){var y=Math.max(d,p),x=Math.min(f,m);if(x>=y){for(var w=[{[n]:g,[r]:y,d:a[0]},{[n]:v,[r]:x,d:a[1]},{[n]:g,[r]:x,d:a[2]},{[n]:v,[r]:y,d:a[3]}],b=w.length-1;b>=0;--b)(w[b][n]==l&&w[b][n]==u||w[b][n]==c&&w[b][n]==h||w[b][r]==f&&w[b][r]==m||w[b][r]==d&&w[b][r]==p||t.exports.pointInBox(w[b][n],w[b][r],c,d,l,f)||t.exports.pointInBox(w[b][n],w[b][r],h,p,u,m))&&w.splice(b,1);return w.length?w:null}}return null},t.exports.boxCornerIntersection=function(e,i,n,r){for(var a=t.exports.cdv[n],o=t.exports.cdv[r],s=e[n]-e[a],c=i[n]-i[a],h=e[n]+e[a],l=i[n]+i[a],u=e[r]-e[o],d=i[r]-i[o],p=e[r]+e[o],f=i[r]+i[o],m=[{[n]:s,[r]:u,d:Math.PI/2},{[n]:s,[r]:p,d:Math.PI},{[n]:h,[r]:u,d:0},{[n]:h,[r]:p,d:-Math.PI/2}],g=m.length-1;g>=0;--g)m[g].i=g,t.exports.pointInBox(m[g][n],m[g][r],c,d,l,f,!0)||m.splice(g,1);return m.length?m:null},t.exports.getIntersection=function(e,i,n){var r=t.exports.cdv[n],a=e[n]-e[r],o=i[n]-i[r],s=e[n]+e[r],c=i[n]+i[r],h=Math.max(a,o),l=Math.min(s,c);if(l>=h){var u=(l-h)/2;return{[n]:h+u,[r]:u}}return null},t.exports.limitRectVal=function(e,i,n){var r=t.exports.cdv[n];if(e[n]-e[r]<i[n]-i[r]){var a=(i[n]-i[r]-(e[n]-e[r]))/2;e[r]-=a,e[n]+=a}e[n]+e[r]>i[n]+i[r]&&(a=(e[n]+e[r]-(i[n]+i[r]))/2,e[r]-=a,e[n]-=a)},t.exports.limitRect=function(e,i,n,r,a,o,s,c){var h=t.exports.cdv[s],l=t.exports.cdv[c],u={};if(u[s]=e,u[c]=i,u[h]=n,u[l]=r,t.exports.limitRectVal(u,o,s),t.exports.limitRectVal(u,o,c),0==a||a==Math.PI){var d=u[h];u[h]=u[l],u[l]=d}return u},t.exports.progressOnLine=function(t,e,i,n,r,a){var o=i-t,s=n-e,c=Math.sqrt(o*o+s*s);return((o/=c)*(r-t)+(s/=c)*(a-e))/Math.sqrt(Math.pow(i-t,2)+Math.pow(n-e,2))},t.exports.generateSID=function(t){for(var e=0,i=!0;i;){i=!1,e++;for(var n=0;n<t.length;++n)if(t[n].sid==e){i=!0;break}}return e};var i=function(t,e){return t.concat(e)};Array.prototype.flatMap=function(t){return function(t,e){return e.map(t).reduce(i,[])}(t,this)}},function(t,e){var i,n,r=t.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(i===setTimeout)return setTimeout(t,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(t,0);try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(t){i=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}}();var c,h=[],l=!1,u=-1;function d(){l&&c&&(l=!1,c.length?h=c.concat(h):u=-1,h.length&&p())}function p(){if(!l){var t=s(d);l=!0;for(var e=h.length;e;){for(c=h,h=[];++u<e;)c&&c[u].run();u=-1,e=h.length}c=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];h.push(new f(t,e)),1!==h.length||l||s(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e){var i;i=function(){return this}();try{i=i||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(i=window)}t.exports=i},function(t,e,i){var n,r,a=function(t){this.width=t.w,this.length=t.l,this.height=t.h,this.x=t.x,this.y=t.y,this.z=t.z,this.dir=t.d,this.src=t.src,this.ramp=t.ramp,this.ladder=t.ladder,this.stepSrc=t.s,this.dummy=t.dummy,this.terrain=t.ter,this.noVis=t.noVis,this.complexMesh=t.complexMesh};t.exports.manager=function(t,e,o){var s;t&&(n=i(11).prefabs,r=i(2)),this.objects=[],this.collision=function(t,e,i){return t.x-t.width-i<=e.x+e.width&&t.x+t.width+i>=e.x-e.width&&t.z-t.length-i<=e.z+e.length&&t.z+t.length+i>=e.z-e.length&&t.y-t.height-i<=e.y+e.height&&t.y+t.height+i>=e.y-e.height},this.addCylinder=function(e,i,n,r,a,o){t&&(o.shadows=!0,t.addCylinder(e,i,n,r,a,o))},this.addLadder=function(i,n,c,h,l){var u=o.ladderScale,d=o.ladderScale;if(0==l||l==Math.PI?d=o.ladderWidth:u=o.ladderWidth,s=new a({ladder:!0,complexMesh:!0,d:l,x:i+o.ladderScale*Math.cos(l),z:c+o.ladderScale*Math.sin(l),y:n,w:u,l:d,h:h}),this.objects.push(s),t){var p={src:"floor_0",vertexColors:r.VertexColors,scale:.02,shadows:!0};t.addCube(s.x+o.ladderWidth*Math.sin(l),s.y,s.z+o.ladderWidth*Math.cos(l),2*o.ladderScale,h+2,2*o.ladderScale,[1,1,1,0,1,1],p),t.addCube(s.x-o.ladderWidth*Math.sin(l),s.y,s.z-o.ladderWidth*Math.cos(l),2*o.ladderScale,h+2,2*o.ladderScale,[1,1,1,0,1,1],p);for(var f=Math.floor(h/6),m=0;m<f;++m)p.darken=o.ambientVal+(1-o.ambientVal)*(m/f),t.addPlane(s.x,n+6*(m+1)+e.randFloat(-1,1),s.z,o.ladderWidth,o.ladderScale,p,-l+Math.PI/2,Math.PI/2,e.randFloat(-.1,.1))}},this.addRamp=function(e,i,n,r,o,s,c){var h=r,l=s;0!=c&&c!=Math.PI&&(h=s,l=r),this.objects.push(new a({x:e,z:n,y:i+o/2,w:h/2,l:l/2,h:o/2,d:c,complexMesh:!0,ramp:{sX:e-r/2*Math.cos(c),sZ:n-r/2*Math.sin(c),eX:e+r/2*Math.cos(c),eZ:n+r/2*Math.sin(c)}})),t&&t.addRamp(e,i,n,s,o,r/2,c,{src:"default",scale:1.3,shadowsR:!0})},this.addBlock=function(e,i,n,o,s,c,h,l){(l=l||{}).src=l.src||"wall_0",l.noCol||this.objects.push(new a({x:e,z:n,y:i+c/2,w:o/2,l:s/2,h:c/2,s:l.sound,src:l.src,noVis:l.noVis,ter:!0})),t&&!l.noVis&&(l.vertexColors=r.VertexColors,l.scale=void 0==l.scale?1:l.scale,l.shadows=!l.shadowsR,t.addCube(e,i,n,o,c,s,h,l))},this.addMesh=function(e,i,r,s,c,h,l,u,d){i+=h,d||this.objects.push(new a({complexMesh:!!n&&n[u.toUpperCase()].complex,x:e,z:r,y:i,w:c,l:l,h:h,ter:!0})),t&&t.loadMesh({src:u+"_0",shadows:!0},e,i,r,s,o[u+"Scale"],t.scene,!0)},this.addPlane=function(e,i,n,o,s,c,h,l,u){if((c=c||{}).col&&this.objects.push(new a({x:e,z:n,y:i,w:s,l:o,h:0,s:c.sound,noVis:c.noVis})),t&&!c.noVis)return c.transparent=!0,c.vertexColors=r.VertexColors,c.side=r.DoubleSide,c.shadowsR=!0,t.addPlane(e,i,n,s,o,c,h,(l||0)+Math.PI/2,u)},this.addAmbient=function(t,e,i,n,r,a,o,s,c,h){if(h)return{x:t,y:e,z:i,xD:n,yD:r,zD:a,w:o,h:s,i:c};this.addPlane(t,e,i,o,s,{src:"ambient_"+(c||0),euler:"ZYX",depthWrite:!1},n,r,a)},this.limitAmb=function(t,i,n,r,a,o,s){var c=[e.cdv[r]],h=[e.cdv[a]];return n==-Math.PI/2||n==Math.PI+Math.PI/2?Math.min(t,(i[a]-Math.min(o[a]-o[h],s[a]-s[h]))/2):n==Math.PI/2?Math.min(t,(Math.max(o[a]+o[h],s[a]+s[h])-i[a])/2):0==n?Math.min(t,(Math.max(o[r]+o[c],s[r]+s[c])-i[r])/2):Math.min(t,(i[r]-Math.min(o[r]-o[c],s[r]-s[c]))/2)},this.removeAll=function(){this.objects.length=0}}},function(t,e,i){i(5),i(10),e.codec={preset:i(3).preset}},function(t,e,i){i(5),i(10),e.createCodec=i(3).createCodec},function(t,e,i){e.Decoder=a;var n=i(14),r=i(16).DecodeBuffer;function a(t){if(!(this instanceof a))return new a(t);r.call(this,t)}a.prototype=new r,n.mixin(a.prototype),a.prototype.decode=function(t){arguments.length&&this.write(t),this.flush()},a.prototype.push=function(t){this.emit("data",t)},a.prototype.end=function(t){this.decode(t),this.emit("end")}},function(t,e,i){e.Encoder=a;var n=i(14),r=i(21).EncodeBuffer;function a(t){if(!(this instanceof a))return new a(t);r.call(this,t)}a.prototype=new r,n.mixin(a.prototype),a.prototype.encode=function(t){this.write(t),this.emit("data",this.read())},a.prototype.end=function(t){arguments.length&&this.encode(t),this.flush(),this.emit("end")}},function(t,e,i){var n=i(15);function r(t){var e,i=new Array(256);for(e=0;e<=127;e++)i[e]=a(e);for(e=128;e<=143;e++)i[e]=s(e-128,t.map);for(e=144;e<=159;e++)i[e]=s(e-144,t.array);for(e=160;e<=191;e++)i[e]=s(e-160,t.str);for(i[192]=a(null),i[193]=null,i[194]=a(!1),i[195]=a(!0),i[196]=o(t.uint8,t.bin),i[197]=o(t.uint16,t.bin),i[198]=o(t.uint32,t.bin),i[199]=o(t.uint8,t.ext),i[200]=o(t.uint16,t.ext),i[201]=o(t.uint32,t.ext),i[202]=t.float32,i[203]=t.float64,i[204]=t.uint8,i[205]=t.uint16,i[206]=t.uint32,i[207]=t.uint64,i[208]=t.int8,i[209]=t.int16,i[210]=t.int32,i[211]=t.int64,i[212]=s(1,t.ext),i[213]=s(2,t.ext),i[214]=s(4,t.ext),i[215]=s(8,t.ext),i[216]=s(16,t.ext),i[217]=o(t.uint8,t.str),i[218]=o(t.uint16,t.str),i[219]=o(t.uint32,t.str),i[220]=o(t.uint16,t.array),i[221]=o(t.uint32,t.array),i[222]=o(t.uint16,t.map),i[223]=o(t.uint32,t.map),e=224;e<=255;e++)i[e]=a(e-256);return i}function a(t){return function(){return t}}function o(t,e){return function(i){var n=t(i);return e(i,n)}}function s(t,e){return function(i){return e(i,t)}}e.getReadToken=function(t){var e=n.getReadFormat(t);return t&&t.useraw?function(t){var e,i=r(t).slice();for(i[217]=i[196],i[218]=i[197],i[219]=i[198],e=160;e<=191;e++)i[e]=s(e-160,t.bin);return i}(e):r(e)}},function(t,e,i){e.setExtUnpackers=function(t){t.addExtUnpacker(14,[s,h(Error)]),t.addExtUnpacker(1,[s,h(EvalError)]),t.addExtUnpacker(2,[s,h(RangeError)]),t.addExtUnpacker(3,[s,h(ReferenceError)]),t.addExtUnpacker(4,[s,h(SyntaxError)]),t.addExtUnpacker(5,[s,h(TypeError)]),t.addExtUnpacker(6,[s,h(URIError)]),t.addExtUnpacker(10,[s,c]),t.addExtUnpacker(11,[s,l(Boolean)]),t.addExtUnpacker(12,[s,l(String)]),t.addExtUnpacker(13,[s,l(Date)]),t.addExtUnpacker(15,[s,l(Number)]),"undefined"!=typeof Uint8Array&&(t.addExtUnpacker(17,l(Int8Array)),t.addExtUnpacker(18,l(Uint8Array)),t.addExtUnpacker(19,[u,l(Int16Array)]),t.addExtUnpacker(20,[u,l(Uint16Array)]),t.addExtUnpacker(21,[u,l(Int32Array)]),t.addExtUnpacker(22,[u,l(Uint32Array)]),t.addExtUnpacker(23,[u,l(Float32Array)]),"undefined"!=typeof Float64Array&&t.addExtUnpacker(24,[u,l(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&t.addExtUnpacker(25,l(Uint8ClampedArray)),t.addExtUnpacker(26,u),t.addExtUnpacker(29,[u,l(DataView)])),r.hasBuffer&&t.addExtUnpacker(27,l(a))};var n,r=i(0),a=r.global,o={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function s(t){return n||(n=i(17).decode),n(t)}function c(t){return RegExp.apply(null,t)}function h(t){return function(e){var i=new t;for(var n in o)i[n]=e[n];return i}}function l(t){return function(e){return new t(e)}}function u(t){return new Uint8Array(t).buffer}},function(t,e,i){var n=i(8),r=i(6),a=r.Uint64BE,o=r.Int64BE,s=i(19).uint8,c=i(0),h=c.global,l=c.hasBuffer&&"TYPED_ARRAY_SUPPORT"in h&&!h.TYPED_ARRAY_SUPPORT,u=c.hasBuffer&&h.prototype||{};function d(){var t=s.slice();return t[196]=p(196),t[197]=f(197),t[198]=m(198),t[199]=p(199),t[200]=f(200),t[201]=m(201),t[202]=g(202,4,u.writeFloatBE||x,!0),t[203]=g(203,8,u.writeDoubleBE||w,!0),t[204]=p(204),t[205]=f(205),t[206]=m(206),t[207]=g(207,8,v),t[208]=p(208),t[209]=f(209),t[210]=m(210),t[211]=g(211,8,y),t[217]=p(217),t[218]=f(218),t[219]=m(219),t[220]=f(220),t[221]=m(221),t[222]=f(222),t[223]=m(223),t}function p(t){return function(e,i){var n=e.reserve(2),r=e.buffer;r[n++]=t,r[n]=i}}function f(t){return function(e,i){var n=e.reserve(3),r=e.buffer;r[n++]=t,r[n++]=i>>>8,r[n]=i}}function m(t){return function(e,i){var n=e.reserve(5),r=e.buffer;r[n++]=t,r[n++]=i>>>24,r[n++]=i>>>16,r[n++]=i>>>8,r[n]=i}}function g(t,e,i,n){return function(r,a){var o=r.reserve(e+1);r.buffer[o++]=t,i.call(r.buffer,a,o,n)}}function v(t,e){new a(this,e,t)}function y(t,e){new o(this,e,t)}function x(t,e){n.write(this,t,e,!1,23,4)}function w(t,e){n.write(this,t,e,!1,52,8)}e.getWriteToken=function(t){return t&&t.uint8array?function(){var t=d();return t[202]=g(202,4,x),t[203]=g(203,8,w),t}():l||c.hasBuffer&&t&&t.safe?function(){var t=s.slice();return t[196]=g(196,1,h.prototype.writeUInt8),t[197]=g(197,2,h.prototype.writeUInt16BE),t[198]=g(198,4,h.prototype.writeUInt32BE),t[199]=g(199,1,h.prototype.writeUInt8),t[200]=g(200,2,h.prototype.writeUInt16BE),t[201]=g(201,4,h.prototype.writeUInt32BE),t[202]=g(202,4,h.prototype.writeFloatBE),t[203]=g(203,8,h.prototype.writeDoubleBE),t[204]=g(204,1,h.prototype.writeUInt8),t[205]=g(205,2,h.prototype.writeUInt16BE),t[206]=g(206,4,h.prototype.writeUInt32BE),t[207]=g(207,8,v),t[208]=g(208,1,h.prototype.writeInt8),t[209]=g(209,2,h.prototype.writeInt16BE),t[210]=g(210,4,h.prototype.writeInt32BE),t[211]=g(211,8,y),t[217]=g(217,1,h.prototype.writeUInt8),t[218]=g(218,2,h.prototype.writeUInt16BE),t[219]=g(219,4,h.prototype.writeUInt32BE),t[220]=g(220,2,h.prototype.writeUInt16BE),t[221]=g(221,4,h.prototype.writeUInt32BE),t[222]=g(222,2,h.prototype.writeUInt16BE),t[223]=g(223,4,h.prototype.writeUInt32BE),t}():d()}},function(t,e,i){var n=i(4),r=i(6),a=r.Uint64BE,o=r.Int64BE,s=i(0),c=i(7),h=i(33),l=i(19).uint8,u=i(9).ExtBuffer,d="undefined"!=typeof Uint8Array,p="undefined"!=typeof Map,f=[];f[1]=212,f[2]=213,f[4]=214,f[8]=215,f[16]=216,e.getWriteType=function(t){var e=h.getWriteToken(t),i=t&&t.useraw,r=d&&t&&t.binarraybuffer,m=r?s.isArrayBuffer:s.isBuffer,g=r?function(t,e){w(t,new Uint8Array(e))}:w,v=p&&t&&t.usemap?function(t,i){if(!(i instanceof Map))return b(t,i);var n=i.size;e[n<16?128+n:n<=65535?222:223](t,n);var r=t.codec.encode;i.forEach(function(e,i,n){r(t,i),r(t,e)})}:b;return{boolean:function(t,i){e[i?195:194](t,i)},function:x,number:function(t,i){var n=0|i;i===n?e[-32<=n&&n<=127?255&n:0<=n?n<=255?204:n<=65535?205:206:-128<=n?208:-32768<=n?209:210](t,n):e[203](t,i)},object:i?function(t,i){if(m(i))return function(t,i){var n=i.length;e[n<32?160+n:n<=65535?218:219](t,n),t.send(i)}(t,i);y(t,i)}:y,string:function(t){return function(i,n){var r=n.length,a=5+3*r;i.offset=i.reserve(a);var o=i.buffer,s=t(r),h=i.offset+s;r=c.write.call(o,n,h);var l=t(r);if(s!==l){var u=h+l-s,d=h+r;c.copy.call(o,o,u,h,d)}e[1===l?160+r:l<=3?215+l:219](i,r),i.offset+=r}}(i?function(t){return t<32?1:t<=65535?3:5}:function(t){return t<32?1:t<=255?2:t<=65535?3:5}),symbol:x,undefined:x};function y(t,i){if(null===i)return x(t,i);if(m(i))return g(t,i);if(n(i))return function(t,i){var n=i.length;e[n<16?144+n:n<=65535?220:221](t,n);for(var r=t.codec.encode,a=0;a<n;a++)r(t,i[a])}(t,i);if(a.isUint64BE(i))return function(t,i){e[207](t,i.toArray())}(t,i);if(o.isInt64BE(i))return function(t,i){e[211](t,i.toArray())}(t,i);var r=t.codec.getExtPacker(i);if(r&&(i=r(i)),i instanceof u)return function(t,i){var n=i.buffer,r=n.length,a=f[r]||(r<255?199:r<=65535?200:201);e[a](t,r),l[i.type](t),t.send(n)}(t,i);v(t,i)}function x(t,i){e[192](t,i)}function w(t,i){var n=i.length;e[n<255?196:n<=65535?197:198](t,n),t.send(i)}function b(t,i){var n=Object.keys(i),r=n.length;e[r<16?128+r:r<=65535?222:223](t,r);var a=t.codec.encode;n.forEach(function(e){a(t,e),a(t,i[e])})}}},function(t,e,i){e.setExtPackers=function(t){t.addExtPacker(14,Error,[u,c]),t.addExtPacker(1,EvalError,[u,c]),t.addExtPacker(2,RangeError,[u,c]),t.addExtPacker(3,ReferenceError,[u,c]),t.addExtPacker(4,SyntaxError,[u,c]),t.addExtPacker(5,TypeError,[u,c]),t.addExtPacker(6,URIError,[u,c]),t.addExtPacker(10,RegExp,[l,c]),t.addExtPacker(11,Boolean,[h,c]),t.addExtPacker(12,String,[h,c]),t.addExtPacker(13,Date,[Number,c]),t.addExtPacker(15,Number,[h,c]),"undefined"!=typeof Uint8Array&&(t.addExtPacker(17,Int8Array,o),t.addExtPacker(18,Uint8Array,o),t.addExtPacker(19,Int16Array,o),t.addExtPacker(20,Uint16Array,o),t.addExtPacker(21,Int32Array,o),t.addExtPacker(22,Uint32Array,o),t.addExtPacker(23,Float32Array,o),"undefined"!=typeof Float64Array&&t.addExtPacker(24,Float64Array,o),"undefined"!=typeof Uint8ClampedArray&&t.addExtPacker(25,Uint8ClampedArray,o),t.addExtPacker(26,ArrayBuffer,o),t.addExtPacker(29,DataView,o)),r.hasBuffer&&t.addExtPacker(27,a,r.from)};var n,r=i(0),a=r.global,o=r.Uint8Array.from,s={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function c(t){return n||(n=i(22).encode),n(t)}function h(t){return t.valueOf()}function l(t){(t=RegExp.prototype.toString.call(t).split("/")).shift();var e=[t.pop()];return e.unshift(t.join("/")),e}function u(t){var e={};for(var i in s)e[i]=t[i];return e}},function(t,e){e.copy=function(t,e,i,n){var r;i||(i=0),n||0===n||(n=this.length),e||(e=0);var a=n-i;if(t===this&&i<e&&e<n)for(r=a-1;r>=0;r--)t[r+e]=this[r+i];else for(r=0;r<a;r++)t[r+e]=this[r+i];return a},e.toString=function(t,e,i){var n=0|e;i||(i=this.length);for(var r="",a=0;n<i;)(a=this[n++])<128?r+=String.fromCharCode(a):(192==(224&a)?a=(31&a)<<6|63&this[n++]:224==(240&a)?a=(15&a)<<12|(63&this[n++])<<6|63&this[n++]:240==(248&a)&&(a=(7&a)<<18|(63&this[n++])<<12|(63&this[n++])<<6|63&this[n++]),a>=65536?(a-=65536,r+=String.fromCharCode(55296+(a>>>10),56320+(1023&a))):r+=String.fromCharCode(a));return r},e.write=function(t,e){for(var i=e||(e|=0),n=t.length,r=0,a=0;a<n;)(r=t.charCodeAt(a++))<128?this[i++]=r:r<2048?(this[i++]=192|r>>>6,this[i++]=128|63&r):r<55296||r>57343?(this[i++]=224|r>>>12,this[i++]=128|r>>>6&63,this[i++]=128|63&r):(r=65536+(r-55296<<10|t.charCodeAt(a++)-56320),this[i++]=240|r>>>18,this[i++]=128|r>>>12&63,this[i++]=128|r>>>6&63,this[i++]=128|63&r);return i-e}},function(t,e,i){var n=i(0);function r(t){return new Uint8Array(t)}(e=t.exports=n.hasArrayBuffer?r(0):[]).alloc=r,e.concat=n.concat,e.from=function(t){if(n.isView(t)){var i=t.byteOffset,r=t.byteLength;(t=t.buffer).byteLength!==r&&(t.slice?t=t.slice(i,i+r):(t=new Uint8Array(t)).byteLength!==r&&(t=Array.prototype.slice.call(t,i,i+r)))}else{if("string"==typeof t)return n.from.call(e,t);if("number"==typeof t)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(t)}},function(t,e,i){var n=i(0),r=n.global;function a(t){return new r(t)}(e=t.exports=n.hasBuffer?a(0):[]).alloc=n.hasBuffer&&r.alloc||a,e.concat=n.concat,e.from=function(t){if(!n.isBuffer(t)&&n.isView(t))t=n.Uint8Array.from(t);else if(n.isArrayBuffer(t))t=new Uint8Array(t);else{if("string"==typeof t)return n.from.call(e,t);if("number"==typeof t)throw new TypeError('"value" argument must not be a number')}return r.from&&1!==r.from.length?r.from(t):new r(t)}},function(t,e,i){var n=i(0);function r(t){return new Array(t)}(e=t.exports=r(0)).alloc=r,e.concat=n.concat,e.from=function(t){if(!n.isBuffer(t)&&n.isView(t))t=n.Uint8Array.from(t);else if(n.isArrayBuffer(t))t=new Uint8Array(t);else{if("string"==typeof t)return n.from.call(e,t);if("number"==typeof t)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(t)}},function(t,e,i){"use strict";e.byteLength=function(t){var e=h(t),i=e[0],n=e[1];return 3*(i+n)/4-n},e.toByteArray=function(t){for(var e,i=h(t),n=i[0],o=i[1],s=new a(3*(n+o)/4-o),c=0,l=o>0?n-4:n,u=0;u<l;u+=4)e=r[t.charCodeAt(u)]<<18|r[t.charCodeAt(u+1)]<<12|r[t.charCodeAt(u+2)]<<6|r[t.charCodeAt(u+3)],s[c++]=e>>16&255,s[c++]=e>>8&255,s[c++]=255&e;return 2===o&&(e=r[t.charCodeAt(u)]<<2|r[t.charCodeAt(u+1)]>>4,s[c++]=255&e),1===o&&(e=r[t.charCodeAt(u)]<<10|r[t.charCodeAt(u+1)]<<4|r[t.charCodeAt(u+2)]>>2,s[c++]=e>>8&255,s[c++]=255&e),s},e.fromByteArray=function(t){for(var e,i=t.length,r=i%3,a=[],o=0,s=i-r;o<s;o+=16383)a.push(u(t,o,o+16383>s?s:o+16383));return 1===r?(e=t[i-1],a.push(n[e>>2]+n[e<<4&63]+"==")):2===r&&(e=(t[i-2]<<8)+t[i-1],a.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),a.join("")};for(var n=[],r=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=o.length;s<c;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var i=t.indexOf("=");return-1===i&&(i=e),[i,i===e?0:4-i%4]}function l(t){return n[t>>18&63]+n[t>>12&63]+n[t>>6&63]+n[63&t]}function u(t,e,i){for(var n,r=[],a=e;a<i;a+=3)n=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),r.push(l(n));return r.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},function(t,e,i){(function(e){function i(t){return t&&t.isBuffer&&t}t.exports=i(void 0!==e&&e)||i(this.Buffer)||i("undefined"!=typeof window&&window.Buffer)||this.Buffer}).call(this,i(20).Buffer)},function(t,e,i){e.encode=i(22).encode,e.decode=i(17).decode,e.Encoder=i(30).Encoder,e.Decoder=i(29).Decoder,e.createCodec=i(28).createCodec,e.codec=i(27).codec},function(t,e,i){var n=i(42),r=i(1);t.exports={socket:null,connected:!1,socketId:-1,connect:function(t,e,i){if(!this.socket){var a=r.enableHttps?"wss:":"ws:",o=this;try{var s=!1,c=a+t;this.socket=new WebSocket(c),this.socket.binaryType="arraybuffer",this.socket.onmessage=function(t){var e=new Uint8Array(t.data),r=n.decode(e),a=r[0];e=r[1],"io-init"==a?o.socketId=e[0]:i[a].apply(void 0,e)},this.socket.onopen=function(){o.connected=!0,e()},this.socket.onclose=function(){o.connected=!1,s||e("Disconnected. Try connecting to another server.")},this.socket.onerror=function(t){this.socket.readyState!=WebSocket.OPEN&&(s=!0,console.error("Socket error",arguments),e("Socket error"))}}catch(t){console.error("Socket connection error:",t),e(t)}}},send:function(t){var e=Array.prototype.slice.call(arguments,1),i=n.encode([t,e]);this.socket.send(i)},socketReady:function(){return this.socket&&this.connected}}},function(t,e,i){var n=i(1),r=i(2);t.exports=function(e,n,r){var a=i(13),o=new e.LoadingManager,s=new e.OBJLoader(o);this.cubeGeo=new e.BoxGeometry(1,1,1);var c=new e.PlaneGeometry(1,1),h=new e.CylinderGeometry(.1,1,1,4,1,!1,Math.PI/4);h.computeFlatVertexNormals();var l=new e.TextureLoader,u={},d={},p={},f=this,m={};this.frustum=new e.Frustum;var g=new e.Matrix4;this.camera=new e.PerspectiveCamera(0,window.innerWidth/window.innerHeight,.2,8e3),this.weaponLean=1,this.init=function(i,r){this.scene=new e.Scene,t.exports.initScene.call(this,i,r),this.addPlane(0,5e3,-4500,750,750,{src:"sun_0",noFog:!0,transparent:!0,mat:e.MeshBasicMaterial,noGroup:!0},0,n.getDirection(-4500,5e3,0,0))},this.renderer=new e.WebGLRenderer,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=e.BasicShadowMap,this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),document.body.appendChild(this.renderer.domElement),this.zoom=function(t){this.camera.fov=this.fov/t,this.camera.updateProjectionMatrix()},this.setFov=function(t){this.fov=t,this.camera.fov=t},this.setFov(r.fov),this.resize=function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)},this.setResMlt=function(t){this.renderer.setPixelRatio(window.devicePixelRatio*t),this.renderer.setSize(window.innerWidth,window.innerHeight)},this.updateFrustum=function(){this.frustum.setFromMatrix(g.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse))},this.render=function(t){this.scene&&this.renderer.render(this.scene,this.camera)},this.updateTexture=function(t,i){var n=p[t];n?n.image=i:(n=new e.Texture(i),p[t]=n),n.needsUpdate=!0},this.loadTexture=function(t,i,n,r){return p[i]?p[i].mats?p[i].mats.push(t):(t[r||"map"]=p[i],t.needsUpdate=!0):(p[i]={mats:[t]},n=n||{},l.load("/textures/"+i+".png",function(t){t.wrapS=e.RepeatWrapping,t.wrapT=e.RepeatWrapping,t.repeat.set(n.repeatX||1,n.repeatY||1),t.minFilter=e.NearestFilter,t.magFilter=e.NearestFilter,t.needsUpdate=!0;for(var a=0;a<p[i].mats.length;++a)p[i].mats[a][r||"map"]=t,p[i].mats[a].needsUpdate=!0;p[i]=t})),t},this.getMat=function(t,i){var n=t+(i?(i.rotation||"")+(i.noFog||"")+(i.opacity||"")+(i.color||"")+(i.ao||""):""),r=d[n];return r||(r=new(i&&i.mat?i.mat:e.MeshLambertMaterial)(i),t&&"default"!=t&&this.loadTexture(r,t,i),i&&i.emissive&&this.loadTexture(r,t+"_e",i,"emissiveMap"),i&&i.ao&&this.loadTexture(r,t+"_ao",i,"aoMap"),"default"==t&&(r.vertexColors=e.VertexColors),i&&i.noFog&&(r.fog=!1),d[n]=r),r},this.offsetMesh=function(t,e){t.translateZ(e)},this.genColorCube=function(t,i,n,r,o){for(var s="",c=0;c<r.length;++c)s+=r[c]+"_";var h=u[s];if(!h){h=new e.Geometry;var l=.5+(o||0);for(c=0;c<r.length;){var d=r[c+1],p=new e.BoxGeometry(1*(4==c?.9:1),d,1*(4==c?.9:1));a.colorize(p,r[c]);var f=new e.Mesh(p);this.moveMesh(f,0,l-d/2,0),this.merge(h,f),l-=d,c+=2}u[s]=h}return f=new e.Mesh(h,this.getMat("default")),this.scaleMesh(f,t,i,n),f};var v={};this.genBody=function(t,i,n,a){var o=v[t];if(!o){o=new e.Geometry;var s=r.playerHeight-r.headScale-r.legHeight,c=this.genColorCube(r.chestWidth,s,r.chestScale,[t,.8,i,.2]);this.moveMesh(c,0,s/2,0),this.merge(o,c);var h=this.genColorCube(r.headScale,r.headScale,r.headScale,[n,.2,a,.8]);this.moveMesh(h,0,r.playerHeight-r.headScale/2-r.legHeight,0),this.merge(o,h),v[t]=o}var l=new e.Mesh(o,this.getMat("default"));return l.castShadow=!0,l.receiveShadow=!0,l};var y={};this.genLeg=function(t,i,n,a){var o=r.legScale,s=null;if(a){var c=i+"-"+(a||"");if(!(s=y[c])){var h=r.legHeight/2,l=o/2,u=[.5,2],d=this.genColorCube(o,h,o,[i,1]);this.moveMesh(d,0,-h/2*Math.cos(u[1]),-h/2*Math.sin(u[1])),this.rotateMesh(d,0,u[1],0);var p=Math.sqrt(l*l+l*l-2*l*l*Math.cos(u[0]-u[1])),f=2*Math.sqrt(l*l-p/2*(p/2)),m=this.genColorCube(o,p,f,[i,1]);this.moveMesh(m,0,-h*Math.cos(u[1]),-h*Math.sin(u[1])),this.rotateMesh(m,0,(u[1]+u[0])/2,0);var g=this.genColorCube(o,h,o,[i,.5,n,.5]);this.moveMesh(g,0,-h*Math.cos(u[1])-h/2*Math.cos(u[0]),-h*Math.sin(u[1])-h/2*Math.sin(u[0])),this.rotateMesh(g,0,u[0],0),s=new e.Geometry,this.merge(s,d),this.merge(s,m),this.merge(s,g),y[c]=s}s=new e.Mesh(s,this.getMat("default")),this.moveMesh(s,r.legScale/2*(t?-1:1),r.legHeight-r.crouchDst+.5,0)}else s=this.genColorCube(o,r.legHeight,o,[i,.75,n,.25],-.5),this.moveMesh(s,r.legScale/2*(t?-1:1),r.legHeight,0);return s.castShadow=!0,s.receiveShadow=!0,s};var x={};this.genArms=function(t,i,n,a,o){var s=x[t.name+"-"+n+"-"+o];if(!s){s=new e.Geometry;var c=(-r.chestWidth+r.armScale/2-r.armInset)*(o?.4:1);this.merge(s,this.genArm(c,r.armOff,t,!0,i,n,a,o)),this.merge(s,this.genArm(-c,r.armOff,t,!1,i,n,a,o)),x[t.name+"-"+n+"-"+o]=s}return(s=new e.Mesh(s,this.getMat("default"))).receiveShadow=!0,s},this.genArm=function(t,i,a,o,s,c,h,l){var u=o?a.leftHoldY:a.rightHoldY,d=o?a.leftHoldZ:a.rightHoldZ,p=o?0:a.rightHoldX||0,f=r.armScale*(l?.75:1),m=Math.min(r.uArmLength+r.lArmLength-.01,n.getDistance3D(t,i,0,a.xOff-p,a.yOff+u,a.zOff-d)),g=n.getAnglesSSS(m,r.uArmLength,r.lArmLength),v=Math.PI/2;if(!l){var y=this.genColorCube(f,r.uArmLength,f,[s,1]);this.moveMesh(y,0,-r.uArmLength/2*Math.cos(v),-r.uArmLength/2*Math.sin(v)),this.rotateMesh(y,0,v,0);var x=f/2,w=Math.sqrt(x*x+x*x-2*x*x*Math.cos(Math.PI+g[0]+Math.PI/2)),b=2*Math.sqrt(x*x-w/2*(w/2)),L=this.genColorCube(f,w,b,[s,1]);this.moveMesh(L,0,-r.uArmLength*Math.cos(v),-r.uArmLength*Math.sin(v)),this.rotateMesh(L,0,(v+g[0])/2,0)}var M=this.genColorCube(f,r.lArmLength,f,[s,.65,c,.15,h,.2]),_=r.lArmLength/2;this.moveMesh(M,0,-r.uArmLength*Math.cos(v)-_*Math.cos(g[0]),-r.uArmLength*Math.sin(v)-_*Math.sin(g[0])),this.rotateMesh(M,0,g[0],0);var A=new e.Geometry;if(l){if(o){var E=this.genColorCube(f,20,f,[s,1]);this.moveMesh(E,0,-r.uArmLength*Math.cos(v)- -10*Math.cos(g[0]),-r.uArmLength*Math.sin(v)- -10*Math.sin(g[0])),this.rotateMesh(E,0,g[0],0),this.merge(A,E)}}else this.merge(A,y),this.merge(A,L);return this.merge(A,M),A=new e.Mesh(A),this.moveMesh(A,t-a.xOff,i-a.yOff,-a.zOff),A.rotation.order="YXZ",A.rotation.x=-g[1]-n.getDirection(0,i,a.zOff-d,a.yOff+u),A.rotation.y=n.getDirection(-t,0,-a.xOff-p,a.zOff-d)-Math.PI/2,A},this.addCube=function(t,i,n,r,o,s,c,h){h=h||{};var l=new e.Mesh(a.generateCube(c,r,o,s,h));return this.moveMesh(l,t,i,n),l.rotateY(h.xR||0),l.rotateX(h.yR||0),l.scale.set(r,o,s),h.src?this.meshGroup(l,h):this.add(l,h),l};var w=[];this.addSpray=function(t,i,a,o,s,h,l,u){tmpObj=null;for(var d=0;d<w.length;++d)if(w[d].sid==t){tmpObj=w[d];break}tmpObj||(tmpObj=new e.Mesh(c),tmpObj.sid=t,tmpObj.scale.set(r.sprayScale,r.sprayScale,1),tmpObj.receiveShadow=!0,w.push(tmpObj),this.add(tmpObj)),this.moveMesh(tmpObj,a,o,s),tmpObj.rotation.y=n.toRad(h),tmpObj.rotation.x=n.toRad(l),tmpObj.material=this.getMat("sprays/"+i,{opacity:u,transparent:!0})},this.clearSprays=function(){for(var t=0;t<w.length;++t)w[t].material.map.dispose(),this.scene.remove(w[t]);w.length=0},this.addPlane=function(t,i,n,r,o,s,c,h,l){s=s||{};var u=new e.Mesh(a.generatePlane(o,r,s));return s.euler&&(u.eulerOrder=s.euler),this.moveMesh(u,t,i,n),u.rotateY(c||0),u.rotateX((h||0)-Math.PI/2),u.rotateZ(l||0),u.scale.set(2*r,2*o,1),s.dontAdd?s.src&&(u.material=this.getMat(s.src,s)):s.src&&!s.noGroup?this.meshGroup(u,s):this.add(u,s),u},this.addRamp=function(t,i,n,r,o,s,c,h){h=h||{};var l=new e.Mesh(a.generatePlane(s,r,h));this.moveMesh(l,t,i+o/2,n),s*=2;var u=Math.sqrt(o*o+s*s);return l.scale.set(r,u,2),l.rotateY(-Math.PI/2-c),l.rotateX(Math.asin(o/u)-Math.PI/2),h.src?this.meshGroup(l,h):this.add(l,h),l},this.addCylinder=function(t,i,n,r,a,o){o=o||{};var s=new e.Mesh(h);return this.moveMesh(s,t,i+a/2,n),s.scale.set(2*r,a,2*r),o.src?this.meshGroup(s,o):this.add(s,o),s};var b=[],L=[];this.loadMesh=function(t,i,n,r,a,o,c,h){var l=this.getMat(t.src,t),u=b[t.src];u||(u=h?new e.Geometry:new e.BufferGeometry,b[t.src]=u,s.load("/models/"+t.src+".obj",function(i){if(i.children[0].geometry.computeVertexNormals(),u.copy(h?(new e.Geometry).fromBufferGeometry(i.children[0].geometry):i.children[0].geometry),t.uv2&&u.addAttribute("uv2",new e.BufferAttribute(u.attributes.uv.array,2)),h){for(var n=new e.Geometry,r=0;r<L[t.src].length;++r)f.merge(n,L[t.src][r]);f.add(new e.Mesh(n,l),t),L[t.src].loaded=!0}}));var d=new e.Mesh(u,l);d.receiveShadow=!0,d.castShadow=t.shadows,d.rotation.y=a||0,f.moveMesh(d,i,n,r),f.scaleMesh(d,o||1,o||1,o||1),h?L[t.src]?L[t.src].loaded?this.meshGroup(d,t):L[t.src].push(d):L[t.src]=[d]:c.add(d)},this.genObj3D=function(t,i,n){var r=new e.Object3D;return this.moveMesh(r,t||0,i||0,n||0),r},this.merge=function(t,e,i){e.updateMatrix(),t.merge(e.geometry,e.matrix,i)},this.meshGroup=function(t,i){var n=i.src+"-"+i.shadowsR;m[n]||(m[n]=new e.Geometry,m[n].data=i),t.updateMatrix(),m[n].merge(t.geometry,t.matrix)},this.addMeshGroups=function(){for(var t in m)if(m.hasOwnProperty(t)){var i=new e.Mesh(m[t]);this.add(i,m[t].data)}m={}},this.add=function(t,e){e&&(t.castShadow=e.shadows,t.receiveShadow=e.shadows||e.shadowsR,t.material=this.getMat(e.src,e)),this.scene.add(t)},this.remove=function(t){this.scene.remove(t)},this.moveMesh=function(t,e,i,n){void 0!=e&&(t.position.x=e),void 0!=i&&(t.position.y=i),void 0!=n&&(t.position.z=n)},this.scaleMesh=function(t,e,i,n){t.scale.set(e,i,n)},this.rotateMesh=function(t,e,i,n){(e||0==e)&&(t.rotation.y=e),(i||0==i)&&(t.rotation.x=i),(n||0==n)&&(t.rotation.z=n)}},t.exports.initScene=function(t,e){this.ambientLight=new r.AmbientLight(e.ambient),this.scene.add(this.ambientLight),this.skyLight=new r.DirectionalLight(e.light,1),this.scene.fog=new r.Fog(e.fog,1,e.fogD),this.renderer.setClearColor(e.sky),this.scene.add(this.skyLight);var i=-.3*Math.PI,a=2*Math.PI*-.25;this.skyLight.position.x=n.lightDistance*Math.cos(a),this.skyLight.position.y=n.lightDistance*Math.sin(a)*Math.sin(i),this.skyLight.position.z=n.lightDistance*Math.sin(a)*Math.cos(i),this.skyLight.castShadow=!0,this.skyLight.shadow.bias=.001,this.skyLight.shadow.mapSize.width=n.shadowRes,this.skyLight.shadow.mapSize.height=n.shadowRes,this.skyLight.shadow.camera.far=n.shadowDst,this.skyLight.shadow.camera.right=t.shadScale,this.skyLight.shadow.camera.left=-t.shadScale,this.skyLight.shadow.camera.top=t.shadScale,this.skyLight.shadow.camera.bottom=-t.shadScale}},function(t,e){t.exports=function(t){return function(){var e=/^[og]\s*(.+)?/,i=/^mtllib /,n=/^usemtl /;function r(e){this.manager=void 0!==e?e:t.DefaultLoadingManager,this.materials=null}return r.prototype={constructor:r,load:function(e,i,n,r){var a=this,o=new t.FileLoader(a.manager);o.setPath(this.path),o.load(e,function(t){i(a.parse(t))},n,r)},setPath:function(t){return this.path=t,this},setMaterials:function(t){return this.materials=t,this},parse:function(r){console.time("OBJLoader");var a=new function(){var t={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materialLibraries:[],startObject:function(t,e){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=t,void(this.object.fromDeclaration=!1!==e);var i=this.object&&"function"==typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0),this.object={name:t||"",fromDeclaration:!1!==e,geometry:{vertices:[],normals:[],colors:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(t,e){var i=this._finalize(!1);i&&(i.inherited||i.groupCount<=0)&&this.materials.splice(i.index,1);var n={index:this.materials.length,name:t||"",mtllib:Array.isArray(e)&&e.length>0?e[e.length-1]:"",smooth:void 0!==i?i.smooth:this.smooth,groupStart:void 0!==i?i.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(t){var e={index:"number"==typeof t?t:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return e.clone=this.clone.bind(e),e}};return this.materials.push(n),n},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(t){var e=this.currentMaterial();if(e&&-1===e.groupEnd&&(e.groupEnd=this.geometry.vertices.length/3,e.groupCount=e.groupEnd-e.groupStart,e.inherited=!1),t&&this.materials.length>1)for(var i=this.materials.length-1;i>=0;i--)this.materials[i].groupCount<=0&&this.materials.splice(i,1);return t&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),e}},i&&i.name&&"function"==typeof i.clone){var n=i.clone(0);n.inherited=!0,this.object.materials.push(n)}this.objects.push(this.object)},finalize:function(){this.object&&"function"==typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(t,e){var i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},parseNormalIndex:function(t,e){var i=parseInt(t,10);return 3*(i>=0?i-1:i+e/3)},parseUVIndex:function(t,e){var i=parseInt(t,10);return 2*(i>=0?i-1:i+e/2)},addVertex:function(t,e,i){var n=this.vertices,r=this.object.geometry.vertices;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},addVertexPoint:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addVertexLine:function(t){var e=this.vertices;this.object.geometry.vertices.push(e[t+0],e[t+1],e[t+2])},addNormal:function(t,e,i){var n=this.normals,r=this.object.geometry.normals;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},addColor:function(t,e,i){var n=this.colors,r=this.object.geometry.colors;r.push(n[t+0],n[t+1],n[t+2]),r.push(n[e+0],n[e+1],n[e+2]),r.push(n[i+0],n[i+1],n[i+2])},addUV:function(t,e,i){var n=this.uvs,r=this.object.geometry.uvs;r.push(n[t+0],n[t+1]),r.push(n[e+0],n[e+1]),r.push(n[i+0],n[i+1])},addUVLine:function(t){var e=this.uvs;this.object.geometry.uvs.push(e[t+0],e[t+1])},addFace:function(t,e,i,n,r,a,o,s,c){var h=this.vertices.length,l=this.parseVertexIndex(t,h),u=this.parseVertexIndex(e,h),d=this.parseVertexIndex(i,h);if(this.addVertex(l,u,d),void 0!==n&&""!==n){var p=this.uvs.length;l=this.parseUVIndex(n,p),u=this.parseUVIndex(r,p),d=this.parseUVIndex(a,p),this.addUV(l,u,d)}if(void 0!==o&&""!==o){var f=this.normals.length;l=this.parseNormalIndex(o,f),u=o===s?l:this.parseNormalIndex(s,f),d=o===c?l:this.parseNormalIndex(c,f),this.addNormal(l,u,d)}this.colors.length>0&&this.addColor(l,u,d)},addPointGeometry:function(t){this.object.geometry.type="Points";for(var e=this.vertices.length,i=0,n=t.length;i<n;i++)this.addVertexPoint(this.parseVertexIndex(t[i],e))},addLineGeometry:function(t,e){this.object.geometry.type="Line";for(var i=this.vertices.length,n=this.uvs.length,r=0,a=t.length;r<a;r++)this.addVertexLine(this.parseVertexIndex(t[r],i));var o=0;for(a=e.length;o<a;o++)this.addUVLine(this.parseUVIndex(e[o],n))}};return t.startObject("",!1),t};-1!==r.indexOf("\r\n")&&(r=r.replace(/\r\n/g,"\n")),-1!==r.indexOf("\\\n")&&(r=r.replace(/\\\n/g,""));for(var o=r.split("\n"),s="",c="",h=[],l="function"==typeof"".trimLeft,u=0,d=o.length;u<d;u++)if(s=o[u],0!==(s=l?s.trimLeft():s.trim()).length&&"#"!==(c=s.charAt(0)))if("v"===c){var p=s.split(/\s+/);switch(p[0]){case"v":a.vertices.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3])),8===p.length&&a.colors.push(parseFloat(p[4]),parseFloat(p[5]),parseFloat(p[6]));break;case"vn":a.normals.push(parseFloat(p[1]),parseFloat(p[2]),parseFloat(p[3]));break;case"vt":a.uvs.push(parseFloat(p[1]),parseFloat(p[2]))}}else if("f"===c){for(var f=s.substr(1).trim().split(/\s+/),m=[],g=0,v=f.length;g<v;g++){var y=f[g];if(y.length>0){var x=y.split("/");m.push(x)}}var w=m[0];for(g=1,v=m.length-1;g<v;g++){var b=m[g],L=m[g+1];a.addFace(w[0],b[0],L[0],w[1],b[1],L[1],w[2],b[2],L[2])}}else if("l"===c){var M=s.substring(1).trim().split(" "),_=[],A=[];if(-1===s.indexOf("/"))_=M;else for(var E=0,S=M.length;E<S;E++){var T=M[E].split("/");""!==T[0]&&_.push(T[0]),""!==T[1]&&A.push(T[1])}a.addLineGeometry(_,A)}else if("p"===c){var R=s.substr(1).trim().split(" ");a.addPointGeometry(R)}else if(null!==(h=e.exec(s))){var O=(" "+h[0].substr(1).trim()).substr(1);a.startObject(O)}else if(n.test(s))a.object.startMaterial(s.substring(7).trim(),a.materialLibraries);else if(i.test(s))a.materialLibraries.push(s.substring(7).trim());else{if("s"!==c){if("\0"===s)continue;throw new Error('THREE.OBJLoader: Unexpected line: "'+s+'"')}if((h=s.split(" ")).length>1){var P=h[1].trim().toLowerCase();a.object.smooth="0"!==P&&"off"!==P}else a.object.smooth=!0;(j=a.object.currentMaterial())&&(j.smooth=a.object.smooth)}a.finalize();var C=new t.Group;for(C.materialLibraries=[].concat(a.materialLibraries),u=0,d=a.objects.length;u<d;u++){var I=a.objects[u],D=I.geometry,F=I.materials,U="Line"===D.type,N="Points"===D.type,B=!1;if(0!==D.vertices.length){var W=new t.BufferGeometry;W.addAttribute("position",new t.Float32BufferAttribute(D.vertices,3)),D.normals.length>0?W.addAttribute("normal",new t.Float32BufferAttribute(D.normals,3)):W.computeVertexNormals(),D.colors.length>0&&(B=!0,W.addAttribute("color",new t.Float32BufferAttribute(D.colors,3))),D.uvs.length>0&&W.addAttribute("uv",new t.Float32BufferAttribute(D.uvs,2));for(var z,k=[],H=0,G=F.length;H<G;H++){var V=F[H],j=void 0;if(null!==this.materials)if(j=this.materials.create(V.name),!U||!j||j instanceof t.LineBasicMaterial){if(N&&j&&!(j instanceof t.PointsMaterial)){var Y=new t.PointsMaterial({size:10,sizeAttenuation:!1});X.copy(j),j=Y}}else{var X=new t.LineBasicMaterial;X.copy(j),X.lights=!1,j=X}j||((j=U?new t.LineBasicMaterial:N?new t.PointsMaterial({size:1,sizeAttenuation:!1}):new t.MeshPhongMaterial).name=V.name),j.flatShading=!V.smooth,j.vertexColors=B?t.VertexColors:t.NoColors,k.push(j)}if(k.length>1){for(H=0,G=F.length;H<G;H++)V=F[H],W.addGroup(V.groupStart,V.groupCount,H);z=U?new t.LineSegments(W,k):N?new t.Points(W,k):new t.Mesh(W,k)}else z=U?new t.LineSegments(W,k[0]):N?new t.Points(W,k[0]):new t.Mesh(W,k[0]);z.name=I.name,C.add(z)}}return console.timeEnd("OBJLoader"),C}},r}()}},function(t,e){var i={utf8:{stringToBytes:function(t){return i.bin.stringToBytes(unescape(encodeURIComponent(t)))},bytesToString:function(t){return decodeURIComponent(escape(i.bin.bytesToString(t)))}},bin:{stringToBytes:function(t){for(var e=[],i=0;i<t.length;i++)e.push(255&t.charCodeAt(i));return e},bytesToString:function(t){for(var e=[],i=0;i<t.length;i++)e.push(String.fromCharCode(t[i]));return e.join("")}}};t.exports=i},,,,,function(t,e){t.exports=function(t,e,i,n){i=i||{},this.id=t,this.name=e,this.score=i.player_score||0,this.kills=i.player_kills||0,this.deaths=i.player_deaths||0,this.wins=i.player_wins||0,this.games=i.player_games_played||0,this.clan=i.player_clanid,this.funds=i.player_funds||0,this.timePlayed=i.player_timeplayed||0,this.setData=function(t){this.kills=t[1],this.wins=t[2],this.games=t[3],this.deaths=t[4],this.funds=t[5],this.score=t[6],this.updateLevel(),this.clan=t[7],this.timePlayed=t[8]},this.updateLevel=function(){this.level=Math.max(1,Math.floor(n.rankVar*Math.sqrt(this.score)))},this.updateLevel(),this.getData=function(){return[this.id,this.kills,this.wins,this.games,this.deaths,this.funds,this.score,this.clan,this.timePlayed]}}},function(t,e){var i=["Double Kill","Triple Kill","Quad Kill","Multi Kill","Mega Kill","Ultra Kill","Super Kill"],n=[];t.exports.reward=function(t,e,r,a){if(n.length=0,e.weapon.melee)n.push("Execution",300);else{e.weapon.kill?n.push(e.weapon.kill[0],e.weapon.kill[1]):e.weapon.scope&&1==e.aimVal?n.push("No Scope",100):!e.weapon.scope||0==e.aimVal&&e.aimTime>180||1==e.aimDir?n.push("",50):n.push("Quick Scope",75);var o=t.getSpin(e);o>=720?n.push("720!",200):o>=360&&n.push("360!",150),a.headShot&&n.push("Headshot",50),!e.weapon.scope&&a.dst*e.weapon.range>200&&n.push("Longshot",25)}e.airTime>=400&&n.push("Mid Air",25);for(var s=i.length-1;s>=0;--s)if(e.streak>s){n.push(i[s],50*(s+1));break}return n.length?n:null},t.exports.getScore=function(t){var e=0;if(t)for(var i=1;i<t.length;i+=2)e+=t[i];return e}},function(t,e,i){var n=i(2);t.exports.manager=function(t,e,r,a,o,s,c){var h,l,u;this.list=[];var d=i(52);this.setTeam=function(t,e){if(e.teams&&!t.team){for(var i=0,n=0,r=0;r<this.list.length;++r)1==this.list[r].team&&i++,2==this.list[r].team&&n++;t.team=i>=n?2:1}},this.update=function(i){e&&(l=e.camera.getWorldPosition());for(var n=0;n<this.list.length;++n)if((h=this.list[n]).active&&(h.update(t.map,i),c&&(this.tickPlayer(h,i),this.storeState(h),h.y<=s.deathY&&this.kill(h)),e&&(this.updateMesh(h),h.isYou||this.updateHeight(h)),!h.isYou&&h.objInstances)){var r=document.getElementById("pInfo"+h.sid);if(r)if(h.isVisible&&h.objInstances.visible){var a=h.objInstances.position.clone();a.y+=s.playerHeight+s.nameOffset-h.crouchVal*s.crouchDst;var u=1-o.getDistance3D(l.x,l.y,l.z,a.x,a.y,a.z)/600,d=22*u,p=d>=.1&&e.frustum.containsPoint(a);if(r.style.display=p?"block":"none",p){a.project(e.camera),a.x=(a.x+1)/2,a.y=(a.y+1)/2;var f=14*u,m=22*u;r.style.left=100*a.x+"%",r.style.marginLeft=-r.offsetWidth/2+"px",r.style.top=100*(1-a.y)+"%",r.style.marginTop=-(f+m)+"px",(r=document.getElementById("pInfoH"+h.sid))&&(r.style.fontSize=d+"px",r.children[1].style.width=120*u+"px",r.children[1].style.height=f+"px",r.children[1].style.marginTop=m+"px"),h.level&&(r=document.getElementById("pInfoR"+h.sid))&&(r.style.fontSize=32*u+"px",r.style.marginRight=10*u+"px")}}else r.style.display="none"}},this.forcePos=function(){for(var t=0;t<this.list.length;++t)this.list[t].forcePos=!0,this.list[t].objInstances&&(this.list[t].objInstances.visible=!1,this.list[t].isVisible=!1)},this.saveSpin=function(t,e){c&&(t.spins.unshift(e),t.spins.length>s.spinTimer/s.serverTickRate&&(t.spins.length=Math.round(s.spinTimer/s.serverTickRate)))},this.getSpin=function(t){for(var e=0,i=0;i<t.spins.length;++i)e+=t.spins[i];return Math.abs(e*(180/Math.PI))},this.storeState=function(e){e.stateHistory.unshift({time:t.now,x:e.x,y:e.y,z:e.z});for(var i=e.stateHistory.length-1;i>=0;--i)t.now-e.stateHistory[i].time>=s.stateHistory&&e.stateHistory.splice(i,1)},this.fetchState=function(e,i){for(var n=t.now-(i+s.serverSendRate*s.interpolation),r=0;r<e.stateHistory.length;++r)if(e.stateHistory[r].time<=n)return e.stateHistory[r];return e.stateHistory[e.stateHistory.length-1]},this.updateMesh=function(t){if(t.objInstances){var i=(1-(1-s.aimAnimMlt)*(1-t.aimVal))*s.animMult*e.weaponLean,n=1-.55*(1-t.aimVal),r=Math.sin(t.stepVal)*s.stepAnim,a=Math.cos(2*t.stepVal)/2*s.stepAnim,o=1-t.aimVal,c=.35*(o<=.5?o:.5-(o-.5)),h=t.swapTime/t.weapon.swapTime,l=t.weapon.xOff,u=0;t.reloadTimer>0&&(u=(u=1-t.reloadTimer/t.weapon.reload)>.5?.5-(u-.5):u),e.moveMesh(t.objInstances,t.x,t.y+(t.isYou?0:Math.abs(3.5*r)),t.z),e.rotateMesh(t.objInstances,t.xDir+(t.isYou?0:2*-r)),a-=a*(t.crouchVal*s.crouchAnimMlt),r-=r*(t.crouchVal*s.crouchAnimMlt);for(var d=0;d<t.legMeshes.length;++d)t.legMeshes[d].rotation.x=r*(1==d||3==d?1:-1)*7+(d>1?-.6:0);e.rotateMesh(t.upperBody,-1*u,-2.8*u+t.yDir*(t.isYou?1:.5)+(-Math.PI/4*h+t.recoilAnimY*s.recoilMlt*(t.weapon.recoilY||1)-t.bobAnimY*i)),e.moveMesh(t.upperBody,5*t.leanAnimX*i,t.height-s.cameraHeight-s.legHeight,Math.abs(1.8*t.leanAnimX)*i),e.rotateMesh(t.weaponMeshes[t.weaponIndex],(.3*r+t.leanAnimX*(t.weapon.leanMlt||0))*i,(t.recoilAnimY*(t.weapon.recoilY||0)+1.8*t.leanAnimY-.15*a-.2*t.bobAnimY)*i,c+(t.leanAnimZ+.3*r)*i),e.moveMesh(t.weaponMeshes[t.weaponIndex],(1.2*t.leanAnimZ+r)*t.aimVal*i+l-(l-t.weapon.xOrg)*o,(a+5*t.leanAnimY)*i+t.weapon.yOff-(t.weapon.yOff-t.weapon.yOrg)*o,t.weapon.zOff-(t.weapon.zOff-t.weapon.zOrg)*o+(t.recoilAnim*(t.weapon.recoilZ||0)+t.bobAnimZ)*n)}},this.updateHeight=function(t){var i=s.crouchDst*t.crouchVal;if(e&&!t.isYou){var n=s.crouchLean*t.crouchVal;e.rotateMesh(t.lowerBody,0,n+.5*t.yDir,0),t.upperBody.rotation.x-=n,e.moveMesh(t.lowerBody,0,s.legHeight-i,0);for(var r=0;r<4;++r)t.legMeshes[r].visible=r<=1?!t.crouchVal:!!t.crouchVal}else t.height=s.playerHeight-i},this.generateMeshes=function(i,r){var o=t.classes[i.classIndex].colors;if(i.objInstances=e.genObj3D(i.x,i.y,i.z),i.lowerBody=e.genObj3D(0,s.legHeight,0),r||i.lowerBody.add(e.genBody(o[1],o[2],o[4],o[0])),i.upperBody=e.genObj3D(0,0,0),i.lowerBody.add(i.upperBody),!r)for(var c=0;c<4;++c)i.legMeshes.push(e.genLeg(1==c||3==c,o[2],o[3],c>1)),c>=2&&e.rotateMesh(i.legMeshes[c],2==c?-Math.PI/6:Math.PI/8,0,0),i.legMeshes[c].visible=c<=1,i.objInstances.add(i.legMeshes[c]);for(c=0;c<i.ammos.length;++c){var h=e.genObj3D(0,0,0),l=t.weapons[i.loadout[c]];r&&(h.muzzle=new n.Sprite,h.muzzle.visible=!1,h.muzzle.static=!0,a.particles.push(h.muzzle),h.add(h.muzzle)),h.add(e.genArms(l,o[1],o[5],o[0],r)),i.weaponMeshes.push(h),i.weaponMeshes[c].visible=!1,i.upperBody.add(i.weaponMeshes[c]),e.loadMesh({src:"weapons/"+l.src,uv2:!0,ao:r,emissive:l.transp?16777215:null},0,0,0,Math.PI/2,l.scale,i.weaponMeshes[c])}i.objInstances.add(i.lowerBody),e.add(i.objInstances)},this.hideAll=function(){for(var t=0;t<this.list.length;++t)this.list[t].active&&this.list[t].objInstances&&(this.list[t].forcePos=!this.list[t].objInstances.visible,this.list[t].isYou||(this.list[t].objInstances.visible=!1))},this.clear=function(){if(e)for(var t=0;t<this.list.length;++t)this.disposeMesh(this.list[t]);this.list.length=0},this.disposeMesh=function(t){e.remove(t.objInstances),t.objInstances=null,t.weaponMeshes.length=0,t.legMeshes.length=0;var i=document.getElementById("pInfo"+t.sid);i&&i.parentNode.removeChild(i)},this.add=function(i,n,r,a,c,h,l,u){for(var d,p=0;p<this.list.length;++p)if(this.list[p].id==i){d=this.list[p];break}return d||((d=new function(t,e,i,n){var r;this.id=t,this.sentTo=[],this.inputs=[],this.spins=[],this.stateHistory=[],this.weaponMeshes=[],this.legMeshes=[],this.lastInput=[],this.reloads=[],this.ammos=[],this.ping=0,this.pings=[],this.score=0,this.kills=0,this.deaths=0,this.level=0,this.highest=0,this.deltaAdd=0,this.deltaDiv=1,this.sprayIndex=0,this.lastSpray=0,this.playTime=0,this.init=function(t,e,i,r,a){this.x=t,this.y=e,this.z=i,this.stepSrc=null,this.name=r||"unknown",this.xVel=0,this.yVel=0,this.zVel=0,this.spins.length=0,this.xDir=0,this.yDir=0,this.hitTimer=0,this.ticker=0,this.spread=0,this.spreadPlus=0,this.aimVal=1,this.aimDir=0,this.aimTime=0,this.streak=0,this.lastKill=0,this.stateHistory.length=0,this.lastInput.length=0,this.leanAnimX=0,this.leanAnimY=0,this.leanAnimZ=0,this.bobAnimZ=0,this.bobAnimY=0,this.stepVal=0,this.stepDir=1,this.recoilAnim=0,this.recoilAnimY=0,this.recoilForce=0,this.crouchVal=0,this.onGround=!0,this.onLadder=!1,this.rampFix=null,this.fixRamp=!1,this.didJump=!1,this.didShoot=!1,this.airTime=0,this.height=n.playerHeight,this.headScale=n.cameraHeight,this.scale=n.playerScale,this.active=!0,this.interpolate=!1,this.isYou=a,this.sentTo.length=0,this.inputSN=0,this.weaponIndex=0,this.swapTime=0,this.recon=!1,this.isVisible=!1},this.setClass=function(t,e){this.classIndex=e,this.reloads.length=0,this.ammos.length=0,this.loadout=t.classes[e].loadout,this.speed=t.classes[e].speed||1;for(var i=0;i<this.loadout.length;++i)this.reloads.push(0),this.ammos.push(t.weapons[this.loadout[i]].ammo);this.reloadTimer=0,this.maxHealth=t.classes[e].health,this.health=this.maxHealth},this.resetInputs=function(){this.inputs.length=0},this.processInput=function(t,a,o){this.recon=o;var s=Math.min(t[1],n.maxDelta)/this.deltaDiv;this.inputSN=t[0];var c=i.getAngleDist(t[2],this.xDir);e.saveSpin(this,c);var h=!o&&this.isYou;if(h&&(this.leanAnimX-=c*n.leanSens,this.leanAnimX=i.limit(this.leanAnimX,n.leanMax),this.leanAnimY-=i.getAngleDist(t[3],this.yDir)*n.leanSens,this.leanAnimY=i.limit(this.leanAnimY,n.leanMax),this.leanAnimX&&(this.leanAnimX*=Math.pow(n.leanPull,s)),this.leanAnimY&&(this.leanAnimY*=Math.pow(n.leanPull,s)),this.leanAnimZ&&(this.leanAnimZ*=Math.pow(n.leanPullZ,s)),this.bobAnimZ&&(this.bobAnimZ*=Math.pow(n.bobPullZ,s)),this.bobAnimY&&(this.bobAnimY*=Math.pow(n.bobPullY,s))),t[10]&&e.swapWeapon(this,t[10]),o||(this.recoilForce&&(this.recoilAnim+=this.recoilForce*s,this.recoilAnimY+=this.recoilForce*s,this.recoilForce*=Math.pow(this.weapon.recoverF,s)),this.recoilAnim&&(this.recoilAnim*=Math.pow(this.weapon.recover,s)),this.recoilAnimY&&(this.recoilAnimY*=Math.pow(this.weapon.recoverY||this.weapon.recover,s))),this.xDir=t[2].round(3),this.yDir=t[3].round(3),this.oldX=this.x,this.oldY=this.y,this.oldZ=this.z,this.weapon.zoom){var l=this.reloadTimer<=0&&this.swapTime<=0;t[6]&&this.aimVal>0&&l?(this.aimDir=0,this.aimVal-=1/(this.weapon.aimSpeed/s),this.aimVal<=0&&(this.aimVal=0,this.isYou&&!o&&e.toggleAim(this,1)),!this.isYou||o||this.weapon.scope||e.updateAim(this,1-this.aimVal)):(!l||!t[6]&&this.aimVal<1)&&(this.aimDir=1,this.aimVal||!this.isYou||o||e.toggleAim(this,0),this.aimVal+=1/(this.weapon.aimSpeed/s),this.aimVal>=1&&(this.aimVal=1),!this.isYou||o||this.weapon.scope||e.updateAim(this,1-this.aimVal)),0==this.aimVal?this.aimTime+=s:this.aimTime=0}t[8]&&this.crouchVal<1&&!this.onLadder?(this.crouchVal+=n.crouchSpeed*s,this.crouchVal>=1&&(this.crouchVal=1),this.onGround?h&&(this.bobAnimY-=n.crouchAnim*s):this.y+=n.crouchSpeed*s):!t[8]&&this.crouchVal>0&&(this.crouchVal-=n.crouchSpeed*s,this.crouchVal<=0&&(this.crouchVal=0),this.onGround?h&&(this.bobAnimY+=n.crouchAnim*s):this.y-=n.crouchSpeed*s),this.crouchVal&&(this.crouchVal=this.crouchVal.round(3)),e.updateHeight(this);var u=this.onGround||this.onLadder,d=s*(u?n.playerSpeed*this.speed:n.airSpeed)*(this.aimVal?1:n.aimSlow)*(this.crouchVal?n.crouchSlow:1)*this.weapon.spdMlt,p=this.onLadder?n.ladderDecel:this.onGround?n.groundDecel:n.airDecel;this.onGround&&(this.didJump&&!t[7]&&(this.didJump=!1),!this.didJump&&t[7]&&e.jump(this)),u||(this.yVel-=s*n.gravity);var f=n.movDirs[t[4]];void 0!==f&&(this.xVel+=d*Math.cos(f-this.xDir),this.zVel+=d*Math.sin(f-this.xDir)),this.xVel&&(this.x+=this.xVel*s,this.xVel*=Math.pow(p,s),this.xVel=i.cropVal(this.xVel,n.decelMin)),this.yVel&&(this.y+=this.yVel*s,this.yVel*=Math.pow(p,s),this.yVel=i.cropVal(this.yVel,n.decelMin)),this.zVel&&(this.z+=this.zVel*s,this.zVel*=Math.pow(p,s),this.zVel=i.cropVal(this.zVel,n.decelMin));var m=this.onGround&&!this.didJump,g=!1;this.onGround=!1,this.onLadder=!1;for(var v=0;v<a.manager.objects.length;++v)if(r=a.manager.objects[v],this.collides(r))if(r.ladder){if(this.y<r.y+r.height&&0==this.crouchVal&&(this.yVel=0,this.onLadder=!0,this.stepSrc=null,void 0!==f)){var y=(Math.abs(i.getAngleDist(r.dir,f-this.xDir))-Math.PI/2)/(Math.PI/2);y>0&&(this.y+=n.ladderSpeed*this.weapon.spdMlt*s*y,this.y<=r.y-r.height?this.y=r.y-r.height:this.y>=r.y+r.height&&(this.y=r.y+r.height))}}else if(r.ramp){if(this.y<r.y+r.height){var x=Math.max(0,Math.min(1,i.progressOnLine(r.ramp.sX,r.ramp.sZ,r.ramp.eX,r.ramp.eZ,this.x-this.scale*Math.cos(r.dir),this.z-this.scale*Math.sin(r.dir)))),w=r.y-r.height+2*r.height*x;(this.y<=w||m)&&(!o&&this.oldY>this.y&&e.resetStep(this),this.y=w,this.yVel=0,this.onGround=!0,g=!0,this.rampFix=r.y-r.height+2*r.height*Math.round(x))}}else this.y<r.y+r.height&&r.y+r.height-this.y<=n.climbHeight&&this.oldY<r.y+r.height&&m?(this.y=r.y+r.height,this.onGround=!0):this.oldY>=r.y+r.height?(this.stepSrc=r.stepSrc,!o&&this.oldY>this.y&&e.resetStep(this),this.y=r.y+r.height,this.yVel=0,this.onGround=!0):this.oldX-this.scale>=r.x+r.width?(this.x=r.x+r.width+this.scale,this.xVel=0):this.oldX+this.scale<=r.x-r.width?(this.x=r.x-r.width-this.scale,this.xVel=0):this.oldZ-this.scale>=r.z+r.length?(this.z=r.z+r.length+this.scale,this.zVel=0):this.oldZ+this.scale<=r.z-r.length?(this.z=r.z-r.length-this.scale,this.zVel=0):this.oldY+this.height<=r.y-r.height&&(this.y=r.y-r.height-this.height,this.yVel=0);if(!g&&!this.didJump&&null!=this.rampFix&&Math.abs(this.y-this.rampFix)<=n.climbHeight&&(this.y=this.rampFix,this.onGround=!0,this.yVel=0,this.rampFix=null),this.onGround?this.airTime=0:this.airTime+=s,!o){var b=i.getDistance3D(this.oldX,this.oldY,this.oldZ,this.x,this.y,this.z);if(this.isYou&&(this.onLadder&&(b*=1.4),i.getDirection(this.oldX,this.oldZ,this.x,this.z),this.bobAnimZ+=b*n.bobMltZ,this.bobAnimZ=i.limit(this.bobAnimZ,n.bobAnimZMax),this.bobAnimY+=(this.oldY-this.y)*n.bobMltY,u&&void 0!==f?(e.playerStep(this,b),this.leanAnimZ-=b*n.leanMltZ*Math.cos(f)):this.stepVal*=Math.pow(n.stepPull,s)),this.spreadPlus+=b*n.spreadMove+Math.abs(this.oldY-this.y)*n.spreadFall,this.spreadPlus*=Math.pow(n.spreadRecover,s),this.spread=Math.max(this.weapon.minSpread||0,(this.weapon.spread-this.weapon.spread*n.crouchSpread*this.crouchVal+this.recoilAnim*n.spreadMlt+this.spreadPlus)*this.aimVal),t[9]&&e.reload(this),this.reloadTimer>0){var L=this.reloadTimer;this.reloadTimer-=s,this.isYou&&L>=this.weapon.reload/2&&this.reloadTimer<this.weapon.reload/2&&e.endReload(),this.reloadTimer<=0&&(this.reloadTimer=0,this.didShoot=!1,this.ammos[this.weaponIndex]=this.weapon.ammo,e.updatePlayerAmmo(this))}for(this.swapTime>0&&(this.swapTime-=s,this.swapTime<0&&(this.swapTime=0)),v=0;v<this.reloads.length;++v)this.reloads[v]>0&&(this.reloads[v]-=s,this.reloads[v]<0&&(this.reloads[v]=0));var M=!this.weapon.nAuto&&t[5];this.didShoot&&!t[5]&&(this.didShoot=!1),!this.didShoot&&t[5]&&(M=!0),M&&this.reloads[this.weaponIndex]<=0&&this.swapTime<=0&&this.reloadTimer<=0&&(this.ammos[this.weaponIndex]>0?e.shoot(this):e.reload(this))}},this.collides=function(t){return this.x-this.scale<t.x+t.width&&this.x+this.scale>t.x-t.width&&this.z-this.scale<t.z+t.length&&this.z+this.scale>t.z-t.length&&this.y<=t.y+t.height&&this.y+this.height>=t.y-t.height},this.update=function(t,r){if(this.active){if(this.inputs.length){for(var a=0;a<this.inputs.length;++a)this.processInput(this.inputs[a],t);this.resetInputs()}if(this.interpolate){this.dt+=r;var o=Math.min(1.6,this.dt/(n.serverSendRate*n.interpolation));this.oldX=this.x,this.oldY=this.y,this.oldZ=this.z,this.x=this.x1+(this.x2-this.x1)*o,this.y=this.y1+(this.y2-this.y1)*o,this.z=this.z1+(this.z2-this.z1)*o,this.onGround&&e.playerStep(this,i.getDistance(this.oldX,this.oldZ,this.x,this.z)),this.xDir=Math.lerpAngle(this.xDir2,this.xDir1,Math.min(1,o)),this.yDir=Math.lerpAngle(this.yDir2,this.yDir1,Math.min(1,o))}}}}(i,this,o,s)).sid=n||o.generateSID(this.list),this.list.push(d)),h||(h="Guest_"+d.sid),d.init(r,a,c,h,u),d.setClass(t,l),this.setTeam(d,t.mode),e&&this.generateMeshes(d,u),this.swapWeapon(d,0,!0),d},this.remove=function(e){var i=this.indexBySid(e);if(i>=0){this.list[i].room;var n=this.list[i].id;if(this.list[i].objInstances&&this.disposeMesh(this.list[i]),this.list.splice(i,1),c){for(var r=this.list.length-1;r>=0;--r)(i=this.list[r].sentTo.indexOf(n))>=0&&this.list[r].sentTo.splice(i,1);c.broadcast("game"+t.sid,"2",e),this.syncLeaders()}}};var p=[0,1,2];this.getStepSound=function(){var t=o.randInt(0,p.length-1),e=p[t];return p.splice(t,1),p.length<=0&&p.push(0,1,2),e},this.playerStep=function(e,i){if(i&&(!e.isYou&&e.crouchVal&&(i*=1.6),e.stepVal+=i*s.stepMlt*e.stepDir,e.stepVal>=Math.PI/2&&1==e.stepDir||e.stepVal<=-Math.PI/2&&-1==e.stepDir)){if(r){var n=.65*(e.crouchVal<1?1:e.isYou?.5:0),a=e.crouchVal<1?1:.8,c=e.stepSrc?"_"+e.stepSrc:"";e.isYou?r.play("step_"+this.getStepSound()+c,n,!1,a):n&&t.playerSound("step_"+o.randInt(0,2)+c,0,n,e,a,10)}e.stepDir*=-1}},this.resetStep=function(t){if(r){var e=t.stepSrc?"_"+t.stepSrc:"";r.play("step_0"+e)}},this.jump=function(t){t.didJump=!0,t.yVel+=(s.jumpVel-s.jumpVel*(s.crouchJump*t.crouchVal))*t.weapon.spdMlt*(t.aimVal?1:s.aimJumpSlow);var e=o.getDistance(0,0,t.xVel,t.zVel);t.xVel-=s.jumpPush*e*Math.sin(t.xDir),t.zVel-=s.jumpPush*e*Math.cos(t.xDir),r&&!t.recon&&r.play("jump_0",.1)},this.updateAim=function(t,i){e.zoom(1+(t.weapon.zoom-1)*i)},this.toggleAim=function(t,i){r&&!t.recon&&r.play("aim_"+i,.1),i||(e.zoom(1),aimRecticle.style.display="none"),t.weapon.scope&&(e.zoom(i?t.weapon.zoom:1),t.weaponMeshes[t.weaponIndex].visible=!i,aimRecticle.style.display=i?"block":"none")},this.reload=function(t){!t.reloadTimer&&t.ammos[t.weaponIndex]<t.weapon.ammo&&(r&&r.play("reload_1",.25),t.reloadTimer=t.weapon.reload)},this.endReload=function(){r&&r.play("reload_2",.25)},this.updatePlayerAmmo=function(t){t.isYou&&(ammoVal.innerHTML=t.ammos[t.weaponIndex]+" <span id='ammoMax'> | "+t.weapon.ammo+"</span>",t.ammos[t.weaponIndex]<=0?(reloadMsg.innerHTML="[R] Reload",reloadMsg.style.display="block"):reloadMsg.style.display="none")};var f=[];this.shoot=function(e){if(e.reloads[e.weaponIndex]=e.weapon.rate,e.ammos[e.weaponIndex]--,e.didShoot=!0,this.updatePlayerAmmo(e),t.playSound(e.weapon.sound,.85,e),e.recoilForce+=e.weapon.recoil*(1-.3*e.crouchVal),e.isYou&&(e.leanAnimX+=o.randInt(0,1)?-e.weapon.recoilR:e.weapon.recoilR),e.isYou){var i=e.weaponMeshes[e.weaponIndex];i.muzzle.visible=!0,a.setMaterial(i.muzzle,2,1,!0),e.weapon.nCase||r.play("case_"+o.randInt(0,1),.2),i.muzzle.init(0,e.weapon.muzOffY||0,-e.weapon.muzOff,0,0,0,3*(e.weapon.muzMlt||1),50)}for(var n=0;n<(e.weapon.shots||1);++n){var h=(e.spread+(e.weapon.innac||0))*s.spreadAdj,u=e.xDir+o.randFloat(-h,h),d=e.yDir+e.recoilAnimY*s.recoilMlt+o.randFloat(-h,h);f.length=0;for(var p=0,m=1/(e.weapon.range*Math.sin(u+Math.PI)*Math.cos(d)),g=1/(e.weapon.range*Math.cos(u+Math.PI)*Math.cos(d)),v=1/(e.weapon.range*Math.sin(d)),y=0;y<t.map.manager.objects.length;++y)l=t.map.manager.objects[y],(p=o.lineInRect(e.x,e.z,e.y+e.height-s.cameraHeight,m,g,v,l.x-l.width,l.z-l.length,l.y-l.height,l.x+l.width,l.z+l.length,l.y+l.height))&&p<=1&&f.push({obj:l,dst:p});if(c)for(y=0;y<this.list.length;++y)!this.list[y].active||e==this.list[y]||e.team&&e.team==this.list[y].team||(l=this.fetchState(this.list[y],e.ping))&&(p=o.lineInRect(e.x,e.z,e.y+e.height-s.cameraHeight,m,g,v,l.x-this.list[y].scale-s.hitBoxPad,l.z-this.list[y].scale-s.hitBoxPad,l.y,l.x+this.list[y].scale+s.hitBoxPad,l.z+this.list[y].scale+s.hitBoxPad,l.y+this.list[y].height+s.hitBoxPad))&&p<=1&&f.push({player:!0,obj:this.list[y],dst:p});var x=e.weapon.range;if(f.length){f.sort(o.orderByDst);var w=e.weapon.dmg;for(y=0;y<f.length&&(l=f[y],x=e.weapon.range*l.dst,c);++y){var b=w-e.weapon.dmgDrop*l.dst,L=!1,M=!1;if(l.player){var _=e.y+e.height-s.cameraHeight+x*Math.sin(d);L=l.obj.y+l.obj.height-_<s.headScale,M=l.obj.y+s.legHeight>_,b*=L&&!e.weapon.noHeadShot?1.5:1,b*=M?.5:1}if(l.player||l.obj.dummy){if(this.changeHealth(l.obj,e,b)){var A={dst:l.dst,headShot:L};this.kill(l.obj,e,A)}w-=void 0!=e.weapon.pierce?e.weapon.dmg*s.materialDens.flesh*e.weapon.pierce:w}else{if(!s.materialDens[l.obj.src])break;w-=void 0!=e.weapon.pierce?e.weapon.dmg*s.materialDens[l.obj.src]*e.weapon.pierce:w}if(w<=0)break}}x-=.12;var E=e.x+x*Math.sin(u+Math.PI)*Math.cos(d),S=(_=e.y+e.height-s.cameraHeight+x*Math.sin(d),e.z+x*Math.cos(u+Math.PI)*Math.cos(d)),T=0,R=0;if(f.length&&(_>=l.obj.y+l.obj.height?R=Math.PI/2:_<=l.obj.y-l.obj.height?R=-Math.PI/2:E<=l.obj.x-l.obj.width?T=-Math.PI/2:E>=l.obj.x+l.obj.width?T=Math.PI/2:S<=l.obj.z-l.obj.length&&(T=Math.PI),c||a.effect(E,_,S,T,R,0)),c&&(!f.length||!l.player))for(y=0;y<this.list.length;++y)this.list[y].active&&this.list[y]!=e&&(f.length?c.send(this.list[y].id,"9",e.sid,Math.round(E),Math.round(_),Math.round(S),T.round(1),R.round(1)):c.send(this.list[y].id,"9",e.sid,Math.round(E),Math.round(_),Math.round(S)));if(e.isYou&&x>=s.tracerMinDst){var O=e.weaponMeshes[e.weaponIndex].muzzle.getWorldPosition(),P=O.x,C=O.y,I=O.z;o.getDistance3D(P,C,I,E,_,S),T=o.getDirection(I,P,S,E),R=o.getDirection(o.getDistance(P,I,E,S),_,0,C),a.tracer(P,C,I,T,R,Math.min(x,s.tracerMaxDst))}}},this.spray=function(e){if(t.now-e.lastSpray>=s.sprayTimer){f.length=0;for(var i=0,n=1/(s.sprayRange*Math.sin(e.xDir+Math.PI)*Math.cos(e.yDir)),r=1/(s.sprayRange*Math.cos(e.xDir+Math.PI)*Math.cos(e.yDir)),a=1/(s.sprayRange*Math.sin(e.yDir)),h=0;h<t.map.manager.objects.length;++h)l=t.map.manager.objects[h],(i=o.lineInRect(e.x,e.z,e.y+e.height-s.cameraHeight,n,r,a,l.x-l.width,l.z-l.length,l.y-l.height,l.x+l.width,l.z+l.length,l.y+l.height))&&i<=1&&f.push({obj:l,dst:i});if(f.length&&(f.sort(o.orderByDst),l=f[0].obj)){var u=s.sprayRange*f[0].dst-.1,d=e.y+e.height-s.cameraHeight+u*Math.sin(e.yDir),p=e.x+u*Math.sin(e.xDir+Math.PI)*Math.cos(e.yDir),m=e.z+u*Math.cos(e.xDir+Math.PI)*Math.cos(e.yDir),g=0,v=0;d>=l.y+l.height?v=-90:d<=l.y-l.height?v=90:p<=l.x-l.width?g=-90:p>=l.x+l.width?g=90:m<=l.z-l.length&&(g=180);var y=s.sprayScale/2;if(v){if(l.width<y||l.length<y)return;m-y<l.z-l.length?m=l.z-l.length+y:m+y>l.z+l.length&&(m=l.z+l.length-y),p-y<l.x-l.width?p=l.x-l.width+y:p+y>l.x+l.width&&(p=l.x+l.width-y)}else{if(l.height<y)return;if(90==g||-90==g){if(l.length<y)return;m-y<l.z-l.length?m=l.z-l.length+y:m+y>l.z+l.length&&(m=l.z+l.length-y)}else{if(l.width<y)return;p-y<l.x-l.width?p=l.x-l.width+y:p+y>l.x+l.width&&(p=l.x+l.width-y)}d+y>l.y+l.height&&(d=l.y+l.height-y)}e.lastSpray=t.now,t.playSound("spray",.4,e,!0),c.broadcast("game"+t.sid,"sp",e.sid,e.sprayIndex,p.round(2),d.round(2),m.round(2),g,v)}}};var m=[];this.syncLeaders=function(){u=this.list.slice().sort(o.orderByScore),m.length=0;for(var e=0;e<u.length;++e)m.push(u[e].sid,u[e].name,u[e].team,u[e].score);c.broadcast("game"+t.sid,"7",m)},this.score=function(t,e){t.score+=e,e>t.highest&&(t.highest=e),c.send(t.id,"5",e),this.syncLeaders()},this.tickPlayer=function(t,e){t.playTime+=e,t.hitTimer>0&&(t.hitTimer-=e),t.ticker-=e,t.ticker<=0&&(t.ticker=500,t.hitTimer<=0&&this.changeHealth(t,null,-s.regenVal))},this.changeHealth=function(t,e,i){if(!(i<0&&t.health==t.maxHealth||t.team&&e&&t.team==e.team&&i>0)){if(e&&c.send(e.id,"4",t.sid,Math.round(i)),t.dummy)return!0;i>0&&(t.hitTimer=s.regenDelay),t.health-=i,t.health=Math.max(Math.min(t.maxHealth,t.health),0),e?c.send(t.id,"h",Math.ceil(t.health),null,Math.round(e.x),Math.round(e.z)):c.send(t.id,"h",Math.ceil(t.health));for(var n=0;n<this.list.length;++n)this.list[n]!=t&&c.send(this.list[n].id,"h",Math.ceil(t.health),t.sid);return t.health<=0}},this.swapWeapon=function(i,n,r,a){if(!(i.ammos.length<=1&&n)){var o=i.weaponIndex;if(n&&(i.reloadTimer=0,i.weaponIndex+=n,i.didShoot=!1,i.weaponIndex<0&&(i.weaponIndex=i.ammos.length-1),i.weaponIndex>i.ammos.length-1&&(i.weaponIndex=0)),void 0!=a&&(i.weaponIndex=a),i.weapon=t.weapons[i.loadout[i.weaponIndex]],e&&(o!=i.weaponIndex||r)&&(i.weaponMeshes[o]&&(i.weaponMeshes[o].visible=!1),i.weaponMeshes[i.weaponIndex]&&(i.weaponMeshes[i.weaponIndex].visible=!0)),void 0==a&&(!e||i.isYou)&&(i.swapTime=i.weapon.swapTime,i.isYou&&(o!=i.weaponIndex||r))){for(var s="",c=i.ammos.length-1;c>=0;--c)s+="<div class='weaponItem'><img style='opacity:"+(c==i.weaponIndex?1:.7)+"' class='weaponIcon' src='./textures/weapons/"+t.weapons[i.loadout[c]].icon+".png' /></div>";weaponDisplay.innerHTML=s,this.updatePlayerAmmo(i)}}},this.kill=function(e,i,n){var r;if(e.dummy||(e.active=!1,e.isYou&&this.toggleAim(e,0),e.objInstances&&this.disposeMesh(e)),c&&(e.deaths++,i&&(e.dummy||i.kills++,i.streak++,t.now-i.lastKill>=s.feedTimer&&(i.streak=0),i.lastKill=t.now,(r=d.reward(this,i,e,n))&&c.send(i.id,"6",r,n.headShot?1:0,i.kills),this.score(i,d.getScore(r))),!e.dummy))for(var a=0;a<this.list.length;++a)this.list[a]==e?c.send(e.id,"3",e.sid,i?i.sid:0,[i?i.loadout[i.weaponIndex]:-1,r?d.getScore(r):0]):c.send(this.list[a].id,"3",e.sid,i?i.sid:0)},this.indexBySid=function(t){for(var e=0;e<this.list.length;++e)if(this.list[e].sid==t)return e;return-1},this.findBySid=function(t){for(var e=0;e<this.list.length;++e)if(this.list[e].sid===t)return this.list[e];return null}}},function(t,e){t.exports=[{name:"Dummy",opacity:1},{name:"Target",opacity:.7},{name:"Vertix",opacity:.7}]},function(t,e){t.exports=[{name:"Triggerman",loadout:[2,1],colors:[10975328,4013373,2302755,2631720,7098434,12566463],health:100,speed:1.05},{name:"Hunter",loadout:[0,1],colors:[10975328,8083261,6506290,2631720,6506290,6506290],health:60,speed:1},{name:"Run N Gun",loadout:[3],colors:[10975328,4088706,3099491,2631720,6506290,3099491],health:80,speed:1.1},{name:"Spray N Pray",loadout:[4],colors:[10975328,5793865,4806204,2631720,2631720,4806204],health:150,speed:1},{name:"Vince",loadout:[5,1],colors:[8412234,5526119,4144461,2631720,2631720,4144461],health:100,speed:1},{name:"Detective",loadout:[6],colors:[10975328,7360054,6308654,2631720,6506290,6308654],health:100,speed:1},{name:"Marksman",loadout:[7],colors:[10975328,5793865,4806204,2631720,2631720,4806204],health:100,speed:1}]},function(t,e){t.exports=[{name:"Sniper Rifle",src:"weapon_1",icon:"icon_1",sound:"weapon_1",nAuto:!0,type:0,scope:!0,swapTime:400,aimSpeed:120,spdMlt:.85,ammo:3,reload:1500,dmg:100,pierce:.2,range:800,dmgDrop:0,scale:1.3,leftHoldY:-.8,rightHoldY:-.8,leftHoldZ:2.1,rightHoldZ:0,xOff:.7,yOff:-.6,zOff:-2.4,xOrg:0,yOrg:-.33,zOrg:-1.2,muzOff:5.5,muzMlt:1.4,rate:900,spread:260,zoom:2.7,leanMlt:1,recoil:.005,recoilR:.02,recover:.993,recoverF:.975,recoilY:1.5,recoilZ:3},{name:"Pistol",src:"weapon_3",icon:"icon_3",sound:"weapon_3",transp:!0,nAuto:!0,kill:["",75],type:1,swapTime:200,aimSpeed:120,spdMlt:1.05,ammo:10,reload:700,dmg:20,range:500,dmgDrop:10,scale:1.2,leftHoldY:-.1,rightHoldY:.21,leftHoldZ:-.5,rightHoldZ:-.5,xOff:.7,yOff:-2.1,zOff:-4.5,xOrg:0,yOrg:-1.09,zOrg:-4.25,muzOff:1.5,muzOffY:.6,muzMlt:.95,rate:150,spread:90,zoom:1.4,leanMlt:.3,recoil:.006,recoilR:.01,recover:.992,recoverF:.94,recoilY:2.5,recoilZ:6},{name:"Assault Rifle",src:"weapon_2",icon:"icon_2",sound:"weapon_2_t",transp:!0,type:0,swapTime:300,aimSpeed:140,spdMlt:1,ammo:30,reload:1200,dmg:22,pierce:1,range:700,dmgDrop:10,scale:1,leftHoldY:.07,rightHoldY:0,rightHoldX:.2,leftHoldZ:1,rightHoldZ:-.7,xOff:.95,yOff:-1.4,zOff:-3.5,xOrg:0,yOrg:-.94,zOrg:-2.1,muzOff:4.5,muzOffY:.5,rate:110,spread:120,minSpread:5,zoom:1.5,leanMlt:.3,recoil:.002,recoilR:.01,recover:.99,recoverY:.9975,recoverF:.975,recoilZ:5},{name:"Submachine Gun",src:"weapon_4",icon:"icon_4",sound:"weapon_4",transp:!0,type:0,swapTime:300,aimSpeed:120,spdMlt:1.04,ammo:24,reload:1200,dmg:18,pierce:1,range:500,dmgDrop:12,scale:1.6,leftHoldY:-.35,rightHoldY:-.45,leftHoldZ:1.2,rightHoldZ:-.2,xOff:.95,yOff:-.95,zOff:-3,xOrg:0,yOrg:-.62,zOrg:-2.2,muzOff:2.4,muzOffY:.1,rate:80,spread:200,minSpread:10,zoom:1.4,recoil:.0019,recoilR:.008,recover:.99,recoverY:.997,recoverF:.975,recoilZ:4},{name:"Light Machine Gun",src:"weapon_7",icon:"icon_7",sound:"weapon_7",transp:!0,type:0,swapTime:800,aimSpeed:200,spdMlt:.79,ammo:100,reload:2500,dmg:22,pierce:1,range:700,dmgDrop:10,scale:1.9,leftHoldY:-.5,rightHoldY:-.55,rightHoldX:.1,leftHoldZ:1.2,rightHoldZ:-.2,xOff:.95,yOff:-.95,zOff:-3,xOrg:0,yOrg:-.3,zOrg:-2,muzOff:3.9,rate:120,spread:300,minSpread:15,zoom:1.2,recoil:.0025,recoilR:.015,recover:.994,recoverY:.998,recoverF:.975,recoilZ:3.5},{name:"Shotgun",src:"weapon_6",icon:"icon_6",sound:"weapon_6",nAuto:!0,nCase:!0,type:0,swapTime:300,aimSpeed:180,spdMlt:1,ammo:2,shots:5,reload:900,dmg:50,dmgDrop:25,scale:2,leftHoldY:-.4,rightHoldY:-.5,rightHoldX:0,leftHoldZ:2.2,rightHoldZ:.3,xOff:.95,yOff:-.95,zOff:-2,xOrg:0,yOrg:-.4,zOrg:-1.5,muzOff:5,muzMlt:1.2,range:240,rate:400,innac:110,spread:120,minSpread:20,zoom:1.25,recoil:.008,recoilR:.015,recover:.994,recoverF:.975,recoilY:.5,recoilZ:4},{name:"Revolver",src:"weapon_5",icon:"icon_5",sound:"weapon_5",nAuto:!0,transp:!0,kill:["",50],type:1,swapTime:200,aimSpeed:120,spdMlt:1.04,ammo:6,reload:900,dmg:61,pierce:.85,dmgDrop:10,scale:1.7,leftHoldY:-.05,rightHoldY:.05,leftHoldZ:-.75,rightHoldZ:-.75,xOff:.7,yOff:-2.1,zOff:-4.1,xOrg:0,yOrg:-1.26,zOrg:-4.25,muzOff:2.3,muzOffY:.6,muzMlt:.95,range:700,rate:300,spread:100,zoom:1.4,recoil:.009,recoilR:.02,recover:.992,recoverF:.94,recoilY:2.5,recoilZ:6},{name:"Semi Auto",src:"weapon_8",icon:"icon_8",sound:"weapon_8",nAuto:!0,type:0,scope:!0,swapTime:400,aimSpeed:160,spdMlt:1,ammo:6,reload:1300,dmg:50,pierce:.2,range:800,dmgDrop:0,scale:1.3,leftHoldY:-.8,rightHoldY:-.8,leftHoldZ:2.1,rightHoldZ:0,xOff:.7,yOff:-.6,zOff:-2.4,xOrg:0,yOrg:-.33,zOrg:-1.2,muzOff:5.5,muzOffY:-.2,muzMlt:1.4,rate:300,spread:300,zoom:2.2,leanMlt:1,recoil:.007,recoilR:.02,recover:.993,recoverY:.998,recoverF:.975,recoilZ:2.4}]},function(t,e,i){var n=i(12);t.exports.obj=function(t,e,r,a,o,s,c,h,l){function u(){return{name:"KRUNKER",availableMaps:function(){for(var t=[],e=0;e<n.maps.length;e++)t.push(e);return t}()}}var d,p;this.index=t,this.connectedClients=0,this.password=void 0,this.config=u(),this.isPrivate=function(){return void 0!=this.password},this.makePublic=function(){this.password=void 0,this.config=u(),l.setPrivateGame(this.index,!1)},this.setPrivate=function(t,e){this.password=t,this.config=e,l.setPrivateGame(this.index,!0)},this.map=new n.manager(o,c,a,e),this.weapons=i(56),this.classes=i(55),this.sprays=i(54),this.players=new(i(53).manager)(this,o,s,c,a,e,h),this.endData=[],this.playSound=function(t,e,i,n){if(s)s.play(t,e);else for(var r=0;r<this.players.list.length;++r)(d=this.players.list[r]).active&&(i!=d||n)&&h.send(d.id,"s",t,i.sid)},this.playerSound=function(t,e,i,n,r){(d=n||this.players.findBySid(e))&&s.play3D(t,d.x,d.y,d.z,i||1,r)},this.getSpawnPoint=function(t){for(var e=0;e<this.map.spawns.length;++e){this.map.spawns[e].dst=0;for(var i=0;i<this.players.list.length;++i)!(d=this.players.list[i]).active||t&&d.team==t||(this.map.spawns[e].dst+=a.getDistance3D(this.map.spawns[e].x,this.map.spawns[e].y,this.map.spawns[e].z,d.x,d.y,d.z))}return this.map.spawns.sort(a.orderByDst),this.map.spawns.reverse(),this.map.spawns[0]},this.savePlayerData=function(){if(r)for(var t=0;t<this.players.list.length;++t)if((d=this.players.list[t]).account){d.account.kills+=d.kills,d.account.deaths+=d.deaths,d.account.games++,d.account.timePlayed+=d.playTime||0,d.account.score+=d.score,d.didWin&&d.account.wins++;var e=d.account.getData();h.send(d.id,"ua",e),r.call(2,e)}},this.init=function(t,i,r,a){this.players.clear(),this.gameTimer=e.gameTime,this.lastTimer=0,this.mapIndex=void 0!=t?t:this.config.availableMaps[Math.floor(Math.random()*this.config.availableMaps.length)],this.modeIndex=void 0!=i?i:this.map.getRandomMode(this.mapIndex),this.biomeIndex=void 0!=r?r:this.map.getRandomBiome(this.mapIndex),this.mode=n.modes[this.modeIndex],this.biome=n.biomes[this.biomeIndex],this.map.generate(this.mapIndex,this.mode,this.biome,a),s&&s.play("ambient_1",.12,!0)},this.endGame=function(){this.endTimer=e.endTimer,this.players.list.sort(a.orderByScore),this.endData.length=0;for(var t=0;t<this.players.list.length;++t)for(var i=0;i<e.endStats.length;++i)this.endData.push(this.players.list[t][e.endStats[i]]);if(this.mode.teams){var n=0,r=0;for(t=0;t<this.players.list.length;++t)1==(d=this.players.list[t]).team?n+=d.score:2==d.team&&(r+=d.score);this.winner=n>=r?1:2}else this.winner=this.players.list[0];for(t=0;t<this.players.list.length;++t)(d=this.players.list[t]).didWin=this.mode.teams?d.team&&d.team==this.winner:d==this.winner,h.send(d.id,"end",!1,d.didWin,this.endData);this.savePlayerData(),this.init()},this.forceNewGame=function(){this.gameTimer=0,this.endGame(),h.broadcast("game"+this.sid,"init",this.mapIndex,this.modeIndex,this.biomeIndex),this.endTimer=0},this.update=function(t,e,i){this.now=e,h&&(this.endTimer>0?(this.endTimer-=t,this.endTimer<=0?(this.endTimer=0,h.broadcast("game"+this.sid,"init",this.mapIndex,this.modeIndex,this.biomeIndex)):(p=a.getTime(this.endTimer))!=this.lastTimer&&(this.lastTimer=p,h.broadcast("game"+this.sid,"t",p,1))):this.gameTimer>0&&(this.gameTimer-=t,this.gameTimer<=0?(this.gameTimer=0,this.endGame()):(p=a.getTime(this.gameTimer))!=this.lastTimer&&(this.lastTimer=p,h.broadcast("game"+this.sid,"t",p)))),this.players.update(t),c&&c.update(t,i),o&&o.render(t)}}},function(t,e,i){i(2),t.exports=function(t,e,i,n,r,a){var o=this,s=t.renderer.domElement;if(this.hasPointerlock="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document,this.hasPointerlock){s.requestPointerLock=s.requestPointerLock||s.mozRequestPointerLock||s.webkitRequestPointerLock;var c=function(t){o.enabled=document.pointerLockElement===s||document.mozPointerLockElement===s||document.webkitPointerLockElement===s,a.connected&&(o.enabled&&enterGame(),i.toggleControlUI(o.enabled))};document.addEventListener("pointerlockchange",c,!1),document.addEventListener("mozpointerlockchange",c,!1),document.addEventListener("webkitpointerlockchange",c,!1)}this.isn=0,this.tmpInputs=[],this.getISN=function(){return this.isn++},this.sensMlt=1,this.locked=!1,this.enabled=!1,t.camera.rotation.set(0,0,0),this.pitchObject=new e.Object3D,this.pitchObject.add(t.camera),this.object=new e.Object3D,this.object.add(this.pitchObject);var h=Math.PI/2;s.addEventListener("mousemove",function(e){if(o.enabled){e.preventDefault();var i=e.movementX||e.mozMovementX||e.webkitMovementX||0,n=e.movementY||e.mozMovementY||e.webkitMovementY||0,a=r.mouseSens*o.sensMlt*(o.target?r.camChaseSen:1)*(t.camera.fov/t.fov);o.object.rotation.y-=i*a,o.pitchObject.rotation.x-=n*a*(o.invertY?-1:1),o.pitchObject.rotation.x=Math.max(-h,Math.min(h,o.pitchObject.rotation.x)),o.yDir=(o.pitchObject.rotation.x%Math.PI2).round(3),o.xDir=(o.object.rotation.y%Math.PI2).round(3)}},!1),s.addEventListener("mousedown",function(t){if(!o.locked)switch(o.enabled||o.toggle(!0),document.activeElement==chatInput&&chatInput.blur(),t.which){case 3:o.mouseDownR=1;break;default:o.mouseDownL=1}},!1),s.addEventListener("mouseup",function(t){if(!o.locked)switch(t.which){case 3:o.mouseDownR=0;break;default:o.mouseDownL=0}},!1);var l=function(t){return t=window.event||t,o.skipScroll?o.skipScroll=!1:o.scrollDelta=-Math.max(-1,Math.min(1,t.wheelDelta||-t.detail)),!1};function u(t,e){if(window.idleTimer=0,o.keys){if(e&&o.keys[t]!==e&&null!=o.inputChanger)o.moveKeys[o.inputChanger]?o.moveKeys[o.inputChanger]=t:o[o.inputChanger]=t,saveVal("cont_"+o.inputChanger,t),o.inputChanger=null,showWindow(7,!0);else if(!o.enabled)return;o.keys[t]!==e&&(o.keys[t]=e,o.moveKeys.indexOf(t)>=0&&o.updateMoveDir(),e&&(t==o.swapKeyU?o.scrollDelta=1:t==o.swapKeyD?o.scrollDelta=-1:window.pressButton(t)))}}s.addEventListener?(s.addEventListener("mousewheel",l,!1),s.addEventListener("DOMMouseScroll",l,!1)):myitem.attachEvent("onmousewheel",l),this.update=function(e){if(this.target){var i=n.getAngleDist(this.object.rotation.y,this.target.yD);this.object.rotation.y+=i*e*r.camChaseTrn,i=n.getAngleDist(o.pitchObject.rotation.x,this.target.xD),this.pitchObject.rotation.x+=i*e*r.camChaseTrn,i=n.getDistance3D(this.object.position.x,this.object.position.y,this.object.position.z,this.target.x,this.target.y,this.target.z)*e*r.camChaseSpd;var a=n.getDirection(this.object.position.z,this.object.position.x,this.target.z,this.target.x),s=n.getXDir(this.object.position.x,this.object.position.y,this.object.position.z,this.target.x,this.target.y,this.target.z);this.object.position.x-=i*Math.sin(a)*Math.cos(s),this.object.position.y+=i*Math.sin(s),this.object.position.z-=i*Math.cos(a)*Math.cos(s),t.updateFrustum()}},this.camLookAt=function(t,e,i){var a=n.getXDir(this.object.position.x,this.object.position.y,this.object.position.z,t,e,i),o=n.getDirection(this.object.position.z,this.object.position.x,i,t);this.target={xD:a,yD:o,x:t+r.camChaseDst*Math.sin(o)*Math.cos(a),y:e-r.camChaseDst*Math.sin(a),z:i+r.camChaseDst*Math.cos(o)*Math.cos(a)}},this.moveCam=function(e,i,n){o.object.position.set(e,i,n),t.camera.updateProjectionMatrix(),t.updateFrustum()},this.rotateCam=function(e,i,n){t.camera.rotation.y=e,t.camera.rotation.x=i,t.camera.rotation.z=n},this.jumpKey=parseInt(getSavedVal("cont_4")||32),this.crouchKey=parseInt(getSavedVal("cont_5")||16),this.swapKeyD=parseInt(getSavedVal("cont_6")||81),this.swapKeyU=parseInt(getSavedVal("cont_7")||69),this.reloadKey=parseInt(getSavedVal("cont_8")||82),this.sprayKey=parseInt(getSavedVal("cont_9")||70),this.aimKey=parseInt(getSavedVal("cont_10")||67),this.chatKey=parseInt(getSavedVal("cont_11")||13),this.moveKeys=[parseInt(getSavedVal("cont_0")||87),parseInt(getSavedVal("cont_1")||83),parseInt(getSavedVal("cont_2")||65),parseInt(getSavedVal("cont_3")||68)],this.moveDirs=[[0,-1],[0,1],[-1,0],[1,0]],this.updateMoveDir=function(){for(var t=0,e=0,i=0;i<o.moveKeys.length;++i)o.keys[o.moveKeys[i]]&&(t+=o.moveDirs[i][0],e+=o.moveDirs[i][1]);this.moveDir=0==t&&0==e?null:Math.atan2(e,t)},window.addEventListener("keydown",function(t){(t.which||t.keyCode)==o.chatKey?window.pressButton(t.which||t.keyCode):document.activeElement!=chatInput&&(o.enabled&&t.preventDefault(),u(t.which||t.keyCode||0,1))},!1),window.addEventListener("keyup",function(t){o.enabled&&t.preventDefault(),u(t.which||t.keyCode||0,0)},!1),this.toggle=function(t){this.locked||("block"==windowHolder.style.display?t&&i.toggleWindow(!1):(t?s.requestPointerLock():document.exitPointerLock(),this.enabled=t))},this.disable=function(){o.toggle(!1),o.locked=!0},this.reset=function(){this.mouseDownL=0,this.mouseDownR=0,this.keys={},this.tmpInputs.length=0,this.scrollDelta=0,this.xDir=0,this.yDir=0,this.isn=0,this.moveDir=null,this.skipScroll=!1,this.inputChanger=null,this.target=null,this.locked=!1,o.pitchObject.rotation.x=0,o.object.rotation.y=0,t.camera.rotation.set(0,0,0)}}},function(t,e){t.exports=function(t,e){var i;this.divs=[],this.update=function(t){for(var e=this.divs.length-1;e>=0;--e)if((i=this.divs[e]).delay>0)i.delay-=t,i.delay<=0&&(i.style.display="inline-block");else{if(i.scale>i.minScale&&(i.scale-=i.scaleSpeed*t,i.scale<=i.minScale&&(i.scale=i.minScale),i.style.fontSize=i.scale+"px"),i.scaleSpd&&(i.startS+=i.scaleSpd*t,i.style.width=i.startS+"vh",i.style.height=i.startS+"vh"),i.life-=t,i.life<=0){i.style.display="none";var n=i.callback;this.divs.splice(e,1),n&&n()}i.fade&&i.life<=i.fade&&(i.style.opacity=i.life/i.fade)}},this.animateText=function(t,e,i,n,r,a,o,s){this.divs.indexOf(t)<0&&this.divs.push(t),t.delay=o,o||(t.style.display="inline-block"),t.style.fontSize=i+"px",t.scale=i,t.minScale=n?.4*i:i,t.innerHTML=e,t.scaleSpeed=n,t.life=r,t.fade=a,t.style.opacity=1,t.callback=s},this.animateDiv=function(t,e,i,n,r){this.divs.indexOf(t)<0&&this.divs.push(t),t.style.display="block",t.life=e,t.maxLife=e,t.style.opacity=1,t.fade=i,n&&(t.style.width=n+"vh",t.style.height=n+"vh",t.startS=n,t.scaleSpd=r)},this.reset=function(){for(var t=0;t<this.divs.length;++t)this.divs[t].style.display="none";this.divs.length=0}}},function(t,e){var i=t.exports;i.active=!0,i.toggleMenu=function(t){menuHolder.style.display=t?"block":"none",chatHolder.style.bottom=(t?20:88)+"px",t&&(endUI.style.display="none",instructionHolder.style.display="block"),i.active=!0},i.hideUI=function(){i.toggleMenu(!1),inGameUI.style.display="none",instructionHolder.style.display="none",chatHolder.style.bottom="20px",i.active=!1},i.showEndScreen=function(){endTable.style.display="none",endUI.style.display="block",i.hideUI()},i.toggleWindow=function(t){windowHolder.style.display=t?"block":"none",instructions.innerHTML=t?"":"CLICK TO PLAY"},i.showError=function(t){i.toggleMenu(!0),instructions.innerHTML=t},i.toggleGameUI=function(t){topRight.style.display=t?"block":"none",crosshair.style.display=t?"block":"none",reloadMsg.style.display=t?"block":"none",healthHolder.style.display=t?"block":"none",weaponDisplay.style.display=t?"block":"none",ammoDisplay.style.display=t?"block":"none",killCardHolder.style.display=t?"none":"block",chatHolder.style.bottom=(t?88:20)+"px"},i.toggleControlUI=function(t){window.loading&&(t=!1),inGameUI.style.display=t&&i.active?"block":"none",instructionHolder.style.display=!t&&i.active?"block":"none",aHolder.style.display=t?"none":"block",chatHolder.style.bottom=(t?88:20)+"px","block"!=endUI.style.display&&(menuHolder.style.display=t?"none":"block")};var n=0,r=0;i.updateCrosshair=function(t,e){n==Math.round(t)&&r==e.round(1)||(r=e.round(1),n=Math.round(t),crosshair.style.width=n+"px",crosshair.style.height=n+"px",crosshair.style.opacity=r)}},function(t,e,i){var n=i(2);n.Sprite.prototype.init=function(t,e,i,n,r,a,o,s,c){this.position.x=t,this.position.y=e,this.position.z=i,this.xVel=n,this.yVel=r,this.zVel=a,this.scale.x=this.scale.y=o,this.life=s,this.area=c},n.Sprite.prototype.update=function(t){if(this.visible){if(this.position.x+=this.xVel*t,this.position.y+=this.yVel*t,this.position.z+=this.zVel*t,this.area){var e=this.scale.x/2;this.position.x-e>=this.area.x+this.area.s?this.position.x=this.area.x-this.area.s-e:this.position.x+e<=this.area.x-this.area.s&&(this.position.x=this.area.x+this.area.s+e),this.position.z-e>=this.area.z+this.area.s?this.position.z=this.area.z-this.area.s-e:this.position.z+e<=this.area.z-this.area.s&&(this.position.z=this.area.z+this.area.s+e),this.position.y-e>=this.area.y+this.area.h?this.position.y=this.area.y-e:this.position.y+e<=this.area.y&&(this.position.y=this.area.y+this.area.h+e)}this.life>0&&(this.life-=t,this.life<=0&&(this.visible=!1))}};var r=[Math.PI/3,-Math.PI/3],a=[{hole:!0,count:10,scale:[1,4],speed:[0,.025],spread:[-.4,.4],life:[300,500]},{},{count:1,blending:2,scale:[5,7],speed:[0,0],spread:[0,0],life:[30,35]},{count:1,blending:2,scale:[2e3,2e3],speed:[0,0],spread:[0,0]}];t.exports=function(t,e,i){var o,s;this.particles=[],this.tracers=[],this.areas=[],this.active=!0,this.area=function(t,i,n,r,a,o,s){this.areas.push({f:s,x:t,y:i,z:n,s:r,h:a});for(var c=t-r,h=n-r,l=2*r/Math.sqrt(o.count),u=.9*l,d=0;d<o.count;++d)this.add(o.src,c+e.randInt(-u,u),i+e.randInt(0,a),h+e.randInt(-u,u),o.spd*Math.sin(o.dir),o.grav?e.randFloat(o.grav[0],o.grav[1]):0,o.spd*Math.cos(o.dir),e.randFloat(o.scl[0],o.scl[1]),0,o.blending,this.areas[this.areas.length-1]),(c+=l)>=r&&(c=t-r,h+=l)},this.effect=function(t,i,r,s,c,h){if(this.active){o=a[h];for(var l=0;l<o.count;++l){var u=e.randFloat(o.speed[0],o.speed[1]),d=s+e.randFloat(o.spread[0],o.spread[1]),p=c+e.randFloat(o.spread[0],o.spread[1]);this.add(h,t,i,r,u*Math.sin(d)*Math.cos(p),u*Math.sin(p),u*Math.cos(d)*Math.cos(p),e.randFloat(o.scale[0],o.scale[1]),o.life?e.randInt(o.life[0],o.life[1]):0,o.blending)}o.hole&&this.add(1,t,i,r,0,0,0,e.randFloat(.4,1),5e3,n.SubtractiveBlending)}},this.add=function(e,i,r,a,o,c,h,l,u,d,p){s=null;for(var f=0;f<this.particles.length;++f)if(!this.particles[f].visible&&!this.particles[f].static){s=this.particles[f];break}s||(s=new n.Sprite,this.particles.push(s),t.scene.add(s)),this.setMaterial(s,e,d),s.visible=!0,s.init(i,r,a,o,c,h,l,u,p)},this.setMaterial=function(i,a,o,s){i.material=t.getMat("particles/"+a,{mat:n.SpriteMaterial,blending:o||n.NormalBlending,rotation:s?r[e.randInt(0,1)]:0})},this.tracer=function(e,r,a,o,c,h){s=null;for(var l=0;l<this.tracers.length;++l)if(!this.tracers[l].mesh.visible){s=this.tracers[l];break}s||(s=new function(t){this.mesh=new n.Mesh(t.cubeGeo,t.getMat("default",{fog:!1,mat:n.MeshBasicMaterial,color:16777179})),this.init=function(e,i,n,r,a,o,s){this.dst=s,this.spd=o,r-=Math.PI,this.xS=o*Math.sin(r)*Math.cos(a),this.zS=o*Math.cos(r)*Math.cos(a),this.yS=o*Math.sin(a),t.moveMesh(this.mesh,e,i,n),this.mesh.lookAt(e+this.xS,i+this.yS,n+this.zS),t.scaleMesh(this.mesh,1.4,1.4,10)},this.update=function(t){this.mesh.visible&&(this.mesh.position.x+=this.xS*t,this.mesh.position.z+=this.zS*t,this.mesh.position.y+=this.yS*t,this.dst-=this.spd*t,this.dst<=0&&(this.mesh.visible=!1))}}(t),this.tracers.push(s),t.scene.add(s.mesh)),s.mesh.visible=!0,s.init(e,r,a,o,c,i.tracerSpeed,h)},this.update=function(t,e){if(e&&e.active)for(var i=0;i<this.areas.length;++i)this.areas[i].f&&(this.areas[i].x=e.x,this.areas[i].y=e.y,this.areas[i].z=e.z);for(i=0;i<this.particles.length;++i)this.particles[i].update(t);for(i=0;i<this.tracers.length;++i)this.tracers[i].update(t)},this.reset=function(){this.particles.length=0,this.tracers.length=0,this.areas.length=0}}},function(t,e){t.exports=function(t,e){var i;this.sounds=[],this.listener={},this.setVolume=function(t){Howler.volume(t)},this.getSound=function(t,e){var n=t+(e||"");(i=this.sounds[n])||(i=new Howl({src:".././sound/"+t+".mp3"}),this.sounds[n]=i)},this.play=function(t,e,n,r){if(this.getSound(t),!n||!i.isPlaying){i.isPlaying=!0;var a=i.play();i.volume(e||1,a),i.loop(n,a),i.rate(r||1,a)}},this.play3D=function(t,n,r,a,o,s,c){this.getSound(t,"3d");var h=i.play();o=(o||1)*e.otherSoundMlt,i.volume(o,h),i.rate(s||1,h),i.pos(n,r,a,h),i.pannerAttr({refDistance:c||25,rolloffFactor:1},h)}}},function(t,e){function i(t){return!!t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t)}
/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */t.exports=function(t){return null!=t&&(i(t)||function(t){return"function"==typeof t.readFloatLE&&"function"==typeof t.slice&&i(t.slice(0,0))}(t)||!!t._isBuffer)}},function(t,e){!function(){var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i={rotl:function(t,e){return t<<e|t>>>32-e},rotr:function(t,e){return t<<32-e|t>>>e},endian:function(t){if(t.constructor==Number)return 16711935&i.rotl(t,8)|4278255360&i.rotl(t,24);for(var e=0;e<t.length;e++)t[e]=i.endian(t[e]);return t},randomBytes:function(t){for(var e=[];t>0;t--)e.push(Math.floor(256*Math.random()));return e},bytesToWords:function(t){for(var e=[],i=0,n=0;i<t.length;i++,n+=8)e[n>>>5]|=t[i]<<24-n%32;return e},wordsToBytes:function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>>5]>>>24-i%32&255);return e},bytesToHex:function(t){for(var e=[],i=0;i<t.length;i++)e.push((t[i]>>>4).toString(16)),e.push((15&t[i]).toString(16));return e.join("")},hexToBytes:function(t){for(var e=[],i=0;i<t.length;i+=2)e.push(parseInt(t.substr(i,2),16));return e},bytesToBase64:function(t){for(var i=[],n=0;n<t.length;n+=3)for(var r=t[n]<<16|t[n+1]<<8|t[n+2],a=0;a<4;a++)8*n+6*a<=8*t.length?i.push(e.charAt(r>>>6*(3-a)&63)):i.push("=");return i.join("")},base64ToBytes:function(t){t=t.replace(/[^A-Z0-9+\/]/gi,"");for(var i=[],n=0,r=0;n<t.length;r=++n%4)0!=r&&i.push((e.indexOf(t.charAt(n-1))&Math.pow(2,-2*r+8)-1)<<2*r|e.indexOf(t.charAt(n))>>>6-2*r);return i}};t.exports=i}()},function(t,e,i){!function(){var e=i(64),n=i(46).utf8,r=i(63),a=i(46).bin,o=function(t,i){t.constructor==String?t=i&&"binary"===i.encoding?a.stringToBytes(t):n.stringToBytes(t):r(t)?t=Array.prototype.slice.call(t,0):Array.isArray(t)||(t=t.toString());for(var s=e.bytesToWords(t),c=8*t.length,h=1732584193,l=-271733879,u=-1732584194,d=271733878,p=0;p<s.length;p++)s[p]=16711935&(s[p]<<8|s[p]>>>24)|4278255360&(s[p]<<24|s[p]>>>8);s[c>>>5]|=128<<c%32,s[14+(c+64>>>9<<4)]=c;var f=o._ff,m=o._gg,g=o._hh,v=o._ii;for(p=0;p<s.length;p+=16){var y=h,x=l,w=u,b=d;l=v(l=v(l=v(l=v(l=g(l=g(l=g(l=g(l=m(l=m(l=m(l=m(l=f(l=f(l=f(l=f(l,u=f(u,d=f(d,h=f(h,l,u,d,s[p+0],7,-680876936),l,u,s[p+1],12,-389564586),h,l,s[p+2],17,606105819),d,h,s[p+3],22,-1044525330),u=f(u,d=f(d,h=f(h,l,u,d,s[p+4],7,-176418897),l,u,s[p+5],12,1200080426),h,l,s[p+6],17,-1473231341),d,h,s[p+7],22,-45705983),u=f(u,d=f(d,h=f(h,l,u,d,s[p+8],7,1770035416),l,u,s[p+9],12,-1958414417),h,l,s[p+10],17,-42063),d,h,s[p+11],22,-1990404162),u=f(u,d=f(d,h=f(h,l,u,d,s[p+12],7,1804603682),l,u,s[p+13],12,-40341101),h,l,s[p+14],17,-1502002290),d,h,s[p+15],22,1236535329),u=m(u,d=m(d,h=m(h,l,u,d,s[p+1],5,-165796510),l,u,s[p+6],9,-1069501632),h,l,s[p+11],14,643717713),d,h,s[p+0],20,-373897302),u=m(u,d=m(d,h=m(h,l,u,d,s[p+5],5,-701558691),l,u,s[p+10],9,38016083),h,l,s[p+15],14,-660478335),d,h,s[p+4],20,-405537848),u=m(u,d=m(d,h=m(h,l,u,d,s[p+9],5,568446438),l,u,s[p+14],9,-1019803690),h,l,s[p+3],14,-187363961),d,h,s[p+8],20,1163531501),u=m(u,d=m(d,h=m(h,l,u,d,s[p+13],5,-1444681467),l,u,s[p+2],9,-51403784),h,l,s[p+7],14,1735328473),d,h,s[p+12],20,-1926607734),u=g(u,d=g(d,h=g(h,l,u,d,s[p+5],4,-378558),l,u,s[p+8],11,-2022574463),h,l,s[p+11],16,1839030562),d,h,s[p+14],23,-35309556),u=g(u,d=g(d,h=g(h,l,u,d,s[p+1],4,-1530992060),l,u,s[p+4],11,1272893353),h,l,s[p+7],16,-155497632),d,h,s[p+10],23,-1094730640),u=g(u,d=g(d,h=g(h,l,u,d,s[p+13],4,681279174),l,u,s[p+0],11,-358537222),h,l,s[p+3],16,-722521979),d,h,s[p+6],23,76029189),u=g(u,d=g(d,h=g(h,l,u,d,s[p+9],4,-640364487),l,u,s[p+12],11,-421815835),h,l,s[p+15],16,530742520),d,h,s[p+2],23,-995338651),u=v(u,d=v(d,h=v(h,l,u,d,s[p+0],6,-198630844),l,u,s[p+7],10,1126891415),h,l,s[p+14],15,-1416354905),d,h,s[p+5],21,-57434055),u=v(u,d=v(d,h=v(h,l,u,d,s[p+12],6,1700485571),l,u,s[p+3],10,-1894986606),h,l,s[p+10],15,-1051523),d,h,s[p+1],21,-2054922799),u=v(u,d=v(d,h=v(h,l,u,d,s[p+8],6,1873313359),l,u,s[p+15],10,-30611744),h,l,s[p+6],15,-1560198380),d,h,s[p+13],21,1309151649),u=v(u,d=v(d,h=v(h,l,u,d,s[p+4],6,-145523070),l,u,s[p+11],10,-1120210379),h,l,s[p+2],15,718787259),d,h,s[p+9],21,-343485551),h=h+y>>>0,l=l+x>>>0,u=u+w>>>0,d=d+b>>>0}return e.endian([h,l,u,d])};o._ff=function(t,e,i,n,r,a,o){var s=t+(e&i|~e&n)+(r>>>0)+o;return(s<<a|s>>>32-a)+e},o._gg=function(t,e,i,n,r,a,o){var s=t+(e&n|i&~n)+(r>>>0)+o;return(s<<a|s>>>32-a)+e},o._hh=function(t,e,i,n,r,a,o){var s=t+(e^i^n)+(r>>>0)+o;return(s<<a|s>>>32-a)+e},o._ii=function(t,e,i,n,r,a,o){var s=t+(i^(e|~n))+(r>>>0)+o;return(s<<a|s>>>32-a)+e},o._blocksize=16,o._digestsize=16,t.exports=function(t,i){if(void 0===t||null===t)throw new Error("Illegal argument "+t);var n=e.wordsToBytes(o(t,i));return i&&i.asBytes?n:i&&i.asString?a.bytesToString(n):e.bytesToHex(n)}}()},function(t,e,i){"use strict";var n=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,e,i,s){return e=e||"&",i=i||"=",null===t&&(t=void 0),"object"==typeof t?a(o(t),function(o){var s=encodeURIComponent(n(o))+i;return r(t[o])?a(t[o],function(t){return s+encodeURIComponent(n(t))}).join(e):s+encodeURIComponent(n(t[o]))}).join(e):s?encodeURIComponent(n(s))+i+encodeURIComponent(n(t)):""};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function a(t,e){if(t.map)return t.map(e);for(var i=[],n=0;n<t.length;n++)i.push(e(t[n],n));return i}var o=Object.keys||function(t){var e=[];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.push(i);return e}},function(t,e,i){"use strict";function n(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,e,i,a){e=e||"&",i=i||"=";var o={};if("string"!=typeof t||0===t.length)return o;var s=/\+/g;t=t.split(e);var c=1e3;a&&"number"==typeof a.maxKeys&&(c=a.maxKeys);var h=t.length;c>0&&h>c&&(h=c);for(var l=0;l<h;++l){var u,d,p,f,m=t[l].replace(s,"%20"),g=m.indexOf(i);g>=0?(u=m.substr(0,g),d=m.substr(g+1)):(u=m,d=""),p=decodeURIComponent(u),f=decodeURIComponent(d),n(o,p)?r(o[p])?o[p].push(f):o[p]=[o[p],f]:o[p]=f}return o};var r=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},function(t,e,i){"use strict";e.decode=e.parse=i(67),e.encode=e.stringify=i(66)},function(t,e,i){"use strict";t.exports={isString:function(t){return"string"==typeof t},isObject:function(t){return"object"==typeof t&&null!==t},isNull:function(t){return null===t},isNullOrUndefined:function(t){return null==t}}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,i){(function(t,n){var r;/*! https://mths.be/punycode v1.3.2 by @mathias */!function(a){"object"==typeof e&&e&&e.nodeType,"object"==typeof t&&t&&t.nodeType;var o="object"==typeof n&&n;o.global!==o&&o.window!==o&&o.self;var s,c=2147483647,h=36,l=1,u=26,d=38,p=700,f=72,m=128,g="-",v=/^xn--/,y=/[^\x20-\x7E]/,x=/[\x2E\u3002\uFF0E\uFF61]/g,w={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},b=h-l,L=Math.floor,M=String.fromCharCode;function _(t){throw RangeError(w[t])}function A(t,e){for(var i=t.length,n=[];i--;)n[i]=e(t[i]);return n}function E(t,e){var i=t.split("@"),n="";return i.length>1&&(n=i[0]+"@",t=i[1]),n+A((t=t.replace(x,".")).split("."),e).join(".")}function S(t){for(var e,i,n=[],r=0,a=t.length;r<a;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<a?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function T(t){return A(t,function(t){var e="";return t>65535&&(e+=M((t-=65536)>>>10&1023|55296),t=56320|1023&t),e+M(t)}).join("")}function R(t){return t-48<10?t-22:t-65<26?t-65:t-97<26?t-97:h}function O(t,e){return t+22+75*(t<26)-((0!=e)<<5)}function P(t,e,i){var n=0;for(t=i?L(t/p):t>>1,t+=L(t/e);t>b*u>>1;n+=h)t=L(t/b);return L(n+(b+1)*t/(t+d))}function C(t){var e,i,n,r,a,o,s,d,p,v,y=[],x=t.length,w=0,b=m,M=f;for((i=t.lastIndexOf(g))<0&&(i=0),n=0;n<i;++n)t.charCodeAt(n)>=128&&_("not-basic"),y.push(t.charCodeAt(n));for(r=i>0?i+1:0;r<x;){for(a=w,o=1,s=h;r>=x&&_("invalid-input"),((d=R(t.charCodeAt(r++)))>=h||d>L((c-w)/o))&&_("overflow"),w+=d*o,!(d<(p=s<=M?l:s>=M+u?u:s-M));s+=h)o>L(c/(v=h-p))&&_("overflow"),o*=v;M=P(w-a,e=y.length+1,0==a),L(w/e)>c-b&&_("overflow"),b+=L(w/e),w%=e,y.splice(w++,0,b)}return T(y)}function I(t){var e,i,n,r,a,o,s,d,p,v,y,x,w,b,A,E=[];for(x=(t=S(t)).length,e=m,i=0,a=f,o=0;o<x;++o)(y=t[o])<128&&E.push(M(y));for(n=r=E.length,r&&E.push(g);n<x;){for(s=c,o=0;o<x;++o)(y=t[o])>=e&&y<s&&(s=y);for(s-e>L((c-i)/(w=n+1))&&_("overflow"),i+=(s-e)*w,e=s,o=0;o<x;++o)if((y=t[o])<e&&++i>c&&_("overflow"),y==e){for(d=i,p=h;!(d<(v=p<=a?l:p>=a+u?u:p-a));p+=h)A=d-v,b=h-v,E.push(M(O(v+A%b,0))),d=L(A/b);E.push(M(O(d,0))),a=P(i,w,n==r),i=0,++n}++i,++e}return E.join("")}s={version:"1.3.2",ucs2:{decode:S,encode:T},decode:C,encode:I,toASCII:function(t){return E(t,function(t){return y.test(t)?"xn--"+I(t):t})},toUnicode:function(t){return E(t,function(t){return v.test(t)?C(t.slice(4).toLowerCase()):t})}},void 0===(r=function(){return s}.call(e,i,e,t))||(t.exports=r)}()}).call(this,i(70)(t),i(25))},function(t,e,i){"use strict";var n=i(71),r=i(69);function a(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}e.parse=x,e.resolve=function(t,e){return x(t,!1,!0).resolve(e)},e.resolveObject=function(t,e){return t?x(t,!1,!0).resolveObject(e):e},e.format=function(t){return r.isString(t)&&(t=x(t)),t instanceof a?t.format():a.prototype.format.call(t)},e.Url=a;var o=/^([a-z0-9.+-]+:)/i,s=/:[0-9]*$/,c=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,h=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(h),u=["%","/","?",";","#"].concat(l),d=["/","?","#"],p=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},g={javascript:!0,"javascript:":!0},v={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},y=i(68);function x(t,e,i){if(t&&r.isObject(t)&&t instanceof a)return t;var n=new a;return n.parse(t,e,i),n}a.prototype.parse=function(t,e,i){if(!r.isString(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var a=t.indexOf("?"),s=-1!==a&&a<t.indexOf("#")?"?":"#",h=t.split(s);h[0]=h[0].replace(/\\/g,"/");var x=t=h.join(s);if(x=x.trim(),!i&&1===t.split("#").length){var w=c.exec(x);if(w)return this.path=x,this.href=x,this.pathname=w[1],w[2]?(this.search=w[2],this.query=e?y.parse(this.search.substr(1)):this.search.substr(1)):e&&(this.search="",this.query={}),this}var b=o.exec(x);if(b){var L=(b=b[0]).toLowerCase();this.protocol=L,x=x.substr(b.length)}if(i||b||x.match(/^\/\/[^@\/]+@[^@\/]+/)){var M="//"===x.substr(0,2);!M||b&&g[b]||(x=x.substr(2),this.slashes=!0)}if(!g[b]&&(M||b&&!v[b])){for(var _,A,E=-1,S=0;S<d.length;S++)-1!==(T=x.indexOf(d[S]))&&(-1===E||T<E)&&(E=T);for(-1!==(A=-1===E?x.lastIndexOf("@"):x.lastIndexOf("@",E))&&(_=x.slice(0,A),x=x.slice(A+1),this.auth=decodeURIComponent(_)),E=-1,S=0;S<u.length;S++){var T;-1!==(T=x.indexOf(u[S]))&&(-1===E||T<E)&&(E=T)}-1===E&&(E=x.length),this.host=x.slice(0,E),x=x.slice(E),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var O=this.hostname.split(/\./),P=(S=0,O.length);S<P;S++){var C=O[S];if(C&&!C.match(p)){for(var I="",D=0,F=C.length;D<F;D++)C.charCodeAt(D)>127?I+="x":I+=C[D];if(!I.match(p)){var U=O.slice(0,S),N=O.slice(S+1),B=C.match(f);B&&(U.push(B[1]),N.unshift(B[2])),N.length&&(x="/"+N.join(".")+x),this.hostname=U.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=n.toASCII(this.hostname));var W=this.port?":"+this.port:"",z=this.hostname||"";this.host=z+W,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==x[0]&&(x="/"+x))}if(!m[L])for(S=0,P=l.length;S<P;S++){var k=l[S];if(-1!==x.indexOf(k)){var H=encodeURIComponent(k);H===k&&(H=escape(k)),x=x.split(k).join(H)}}var G=x.indexOf("#");-1!==G&&(this.hash=x.substr(G),x=x.slice(0,G));var V=x.indexOf("?");if(-1!==V?(this.search=x.substr(V),this.query=x.substr(V+1),e&&(this.query=y.parse(this.query)),x=x.slice(0,V)):e&&(this.search="",this.query={}),x&&(this.pathname=x),v[L]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){W=this.pathname||"";var j=this.search||"";this.path=W+j}return this.href=this.format(),this},a.prototype.format=function(){var t=this.auth||"";t&&(t=(t=encodeURIComponent(t)).replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",n=this.hash||"",a=!1,o="";this.host?a=t+this.host:this.hostname&&(a=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(a+=":"+this.port)),this.query&&r.isObject(this.query)&&Object.keys(this.query).length&&(o=y.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||v[e])&&!1!==a?(a="//"+(a||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):a||(a=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),e+a+(i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}))+(s=s.replace("#","%23"))+n},a.prototype.resolve=function(t){return this.resolveObject(x(t,!1,!0)).format()},a.prototype.resolveObject=function(t){if(r.isString(t)){var e=new a;e.parse(t,!1,!0),t=e}for(var i=new a,n=Object.keys(this),o=0;o<n.length;o++){var s=n[o];i[s]=this[s]}if(i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol){for(var c=Object.keys(t),h=0;h<c.length;h++){var l=c[h];"protocol"!==l&&(i[l]=t[l])}return v[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i}if(t.protocol&&t.protocol!==i.protocol){if(!v[t.protocol]){for(var u=Object.keys(t),d=0;d<u.length;d++){var p=u[d];i[p]=t[p]}return i.href=i.format(),i}if(i.protocol=t.protocol,t.host||g[t.protocol])i.pathname=t.pathname;else{for(var f=(t.pathname||"").split("/");f.length&&!(t.host=f.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),i.pathname=f.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var m=i.pathname||"",y=i.search||"";i.path=m+y}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var x=i.pathname&&"/"===i.pathname.charAt(0),w=t.host||t.pathname&&"/"===t.pathname.charAt(0),b=w||x||i.host&&t.pathname,L=b,M=i.pathname&&i.pathname.split("/")||[],_=(f=t.pathname&&t.pathname.split("/")||[],i.protocol&&!v[i.protocol]);if(_&&(i.hostname="",i.port=null,i.host&&(""===M[0]?M[0]=i.host:M.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===f[0]?f[0]=t.host:f.unshift(t.host)),t.host=null),b=b&&(""===f[0]||""===M[0])),w)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,M=f;else if(f.length)M||(M=[]),M.pop(),M=M.concat(f),i.search=t.search,i.query=t.query;else if(!r.isNullOrUndefined(t.search))return _&&(i.hostname=i.host=M.shift(),(R=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=R.shift(),i.host=i.hostname=R.shift())),i.search=t.search,i.query=t.query,r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i;if(!M.length)return i.pathname=null,i.search?i.path="/"+i.search:i.path=null,i.href=i.format(),i;for(var A=M.slice(-1)[0],E=(i.host||t.host||M.length>1)&&("."===A||".."===A)||""===A,S=0,T=M.length;T>=0;T--)"."===(A=M[T])?M.splice(T,1):".."===A?(M.splice(T,1),S++):S&&(M.splice(T,1),S--);if(!b&&!L)for(;S--;S)M.unshift("..");!b||""===M[0]||M[0]&&"/"===M[0].charAt(0)||M.unshift(""),E&&"/"!==M.join("/").substr(-1)&&M.push("");var R,O=""===M[0]||M[0]&&"/"===M[0].charAt(0);return _&&(i.hostname=i.host=O?"":M.length?M.shift():"",(R=!!(i.host&&i.host.indexOf("@")>0)&&i.host.split("@"))&&(i.auth=R.shift(),i.host=i.hostname=R.shift())),(b=b||i.host&&M.length)&&!O&&M.unshift(""),M.length?i.pathname=M.join("/"):(i.pathname=null,i.path=null),r.isNull(i.pathname)&&r.isNull(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},a.prototype.parseHost=function(){var t=this.host,e=s.exec(t);e&&(":"!==(e=e[0])&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,i){var n=i(72),r=i(65);function a(t,e,i,n,r){"localhost"==location.hostname&&(window.location.hostname="127.0.0.1"),this.debugLog=!1,this.baseUrl=t,this.lobbySize=i,this.devPort=e,this.lobbySpread=n,this.rawIPs=!!r,this.server=void 0,this.gameIndex=void 0,this.callback=void 0,this.errorCallback=void 0,this.processServers(vultr.servers)}a.prototype.regionInfo={0:{name:"Local",latitude:0,longitude:0},1:{name:"New Jersey",latitude:40.1393329,longitude:-75.8521818},2:{name:"Chicago",latitude:41.8339037,longitude:-87.872238},3:{name:"Dallas",latitude:32.8208751,longitude:-96.8714229},4:{name:"Seattle",latitude:47.6149942,longitude:-122.4759879},5:{name:"Los Angeles",latitude:34.0207504,longitude:-118.691914},6:{name:"Atlanta",latitude:33.7676334,longitude:-84.5610332},7:{name:"Amsterdam",latitude:52.3745287,longitude:4.7581878},8:{name:"London",latitude:51.5283063,longitude:-.382486},9:{name:"Frankfurt",latitude:50.1211273,longitude:8.496137},12:{name:"Silicon Valley",latitude:37.4024714,longitude:-122.3219752},19:{name:"Sydney",latitude:-33.8479715,longitude:150.651084},24:{name:"Paris",latitude:48.8588376,longitude:2.2773454},25:{name:"Tokyo",latitude:35.6732615,longitude:139.569959},39:{name:"Miami",latitude:25.7823071,longitude:-80.3012156},40:{name:"Singapore",latitude:1.3147268,longitude:103.7065876}},a.prototype.start=function(t,e){this.callback=t,this.errorCallback=e;var i=this.parseServerQuery();i?(this.log("Found server in query."),this.password=i[3],this.connect(i[0],i[1],i[2])):(this.log("Pinging servers..."),this.pingServers())},a.prototype.parseServerQuery=function(){var t=n.parse(location.href,!0),e=t.query.server;if("string"==typeof e){var i=e.split(":");if(3==i.length)return[parseInt(i[0]),parseInt(i[1]),parseInt(i[2]),t.query.password];this.errorCallback("Invalid number of server parameters in "+e)}},a.prototype.findServer=function(t,e){var i=this.servers[t];if(Array.isArray(i)){for(var n=0;n<i.length;n++){var r=i[n];if(r.index==e)return r}console.warn("Could not find server in region "+t+" with index "+e+".")}else this.errorCallback("No server list for region "+t)},a.prototype.pingServers=function(){var t=this,e=[];for(var i in this.servers)if(this.servers.hasOwnProperty(i)){var n=this.servers[i],r=n[Math.floor(Math.random()*n.length)];void 0!=r?function(n,r){var a=new XMLHttpRequest;a.onreadystatechange=function(n){var a=n.target;if(4==a.readyState)if(200==a.status){for(var o=0;o<e.length;o++)e[o].abort();t.log("Connecting to region",r.region);var s=t.seekServer(r.region);t.connect(s[0],s[1],s[2])}else console.warn("Error pinging "+r.ip+" in region "+i)};var o="//"+t.serverAddress(r.ip,!0)+":"+t.serverPort(r)+"/ping";a.open("GET",o,!0),a.send(null),t.log("Pinging",o),e.push(a)}(0,r):console.log("No target server for region "+i)}},a.prototype.seekServer=function(t,e,i){void 0==i&&(i="random"),void 0==e&&(e=!1);const n=["random"];var r=this.lobbySize,a=this.lobbySpread,o=this.servers[t].flatMap(function(t){var e=0;return t.games.map(function(i){var n=e++;return{region:t.region,index:t.index*t.games.length+n,gameIndex:n,gameCount:t.games.length,playerCount:i.playerCount,isPrivate:i.isPrivate}})}).filter(function(t){return!t.isPrivate}).filter(function(t){return!e||0==t.playerCount&&t.gameIndex>=t.gameCount/2}).filter(function(t){return"random"==i||n[t.index%n.length].key==i}).sort(function(t,e){return e.playerCount-t.playerCount}).filter(function(t){return t.playerCount<r});if(e&&o.reverse(),0!=o.length){var s=Math.min(a,o.length),c=Math.floor(Math.random()*s),h=o[c=Math.min(c,o.length-1)],l=h.region,u=(c=Math.floor(h.index/h.gameCount),h.index%h.gameCount);return this.log("Found server."),[l,c,u]}this.errorCallback("No open servers.")},a.prototype.connect=function(t,e,i){if(!this.connected){var n=this.findServer(t,e);void 0!=n?(this.log("Connecting to server",n,"with game index",i),n.games[i].playerCount>=this.lobbySize?this.errorCallback("Server is already full."):(window.history.replaceState(document.title,document.title,this.generateHref(t,e,i,this.password)),this.server=n,this.gameIndex=i,this.log("Calling callback with address",this.serverAddress(n.ip),"on port",this.serverPort(n),"with game index",i),this.callback(this.serverAddress(n.ip),this.serverPort(n),i))):this.errorCallback("Failed to find server for region "+t+" and index "+e)}},a.prototype.switchServer=function(t,e,i,n){this.switchingServers=!0,window.location.href=this.generateHref(t,e,i,n)},a.prototype.generateHref=function(t,e,i,n){var r="/?server="+t+":"+e+":"+i;return n&&(r+="&password="+encodeURIComponent(n)),r},a.prototype.serverAddress=function(t,e){return"127.0.0.1"==t||"7f000001"==t||"903d62ef5d1c2fecdcaeb5e7dd485eff"==t?window.location.hostname:this.rawIPs?e?"ip_"+this.hashIP(t)+"."+this.baseUrl:t:"ip_"+t+"."+this.baseUrl},a.prototype.serverPort=function(t){return 0==t.region?this.devPort:location.protocol.startsWith("https")?443:80},a.prototype.processServers=function(t){for(var e={},i=0;i<t.length;i++){var n=t[i],r=e[n.region];void 0==r&&(r=[],e[n.region]=r),r.push(n)}for(var a in e)e[a]=e[a].sort(function(t,e){return t.index-e.index});this.servers=e},a.prototype.ipToHex=function(t){return t.split(".").map(t=>("00"+parseInt(t).toString(16)).substr(-2)).join("").toLowerCase()},a.prototype.hashIP=function(t){return r(this.ipToHex(t))},a.prototype.log=function(){return this.debugLog?console.log.apply(void 0,arguments):console.verbose?console.verbose.apply(void 0,arguments):void 0},window.testVultrClient=function(){var t=1;function e(e,i){(e=`${e}`)==(i=`${i}`)?console.log(`Assert ${t} passed.`):console.warn(`Assert ${t} failed. Expected ${i}, got ${e}.`),t++}var i=new a("test.io",-1,5,1,!1);i.errorCallback=function(t){},i.processServers(function(t){var e=[];for(var i in t)for(var n=t[i],r=0;r<n.length;r++)e.push({ip:i+":"+r,scheme:"testing",region:i,index:r,games:n[r].map(t=>({playerCount:t,isPrivate:!1}))});return e}({1:[[0,0,0,0],[0,0,0,0]],2:[[5,1,0,0],[0,0,0,0]],3:[[5,0,1,5],[0,0,0,0]],4:[[5,1,1,5],[1,0,0,0]],5:[[5,1,1,5],[1,0,4,0]],6:[[5,5,5,5],[2,3,1,4]],7:[[5,5,5,5],[5,5,5,5]]})),e(i.seekServer(1,!1),[1,0,0]),e(i.seekServer(1,!0),[1,1,3]),e(i.seekServer(2,!1),[2,0,1]),e(i.seekServer(2,!0),[2,1,3]),e(i.seekServer(3,!1),[3,0,2]),e(i.seekServer(3,!0),[3,1,3]),e(i.seekServer(4,!1),[4,0,1]),e(i.seekServer(4,!0),[4,1,3]),e(i.seekServer(5,!1),[5,1,2]),e(i.seekServer(5,!0),[5,1,3]),e(i.seekServer(6,!1),[6,1,3]),e(i.seekServer(6,!0),void 0),e(i.seekServer(7,!1),void 0),e(i.seekServer(7,!0),void 0),console.log("Tests passed.")};var o=function(t,e){return t.concat(e)};Array.prototype.flatMap=function(t){return function(t,e){return e.map(t).reduce(o,[])}(t,this)},t.exports=a},function(t,e,i){var n=i(1),r="undefined"!=typeof Storage;window.saveVal=function(t,e){r&&localStorage.setItem(t,e)},window.getSavedVal=function(t){return r?localStorage.getItem(t):null};var a=new(i(73))("krunker.io",3e3,n.maxPlayers,n.playerSpread,!1);window.switchServer=function(t,e,i){a.switchServer(t,e,i)},window.createPrivateRoom=function(){for(var t=[],e=0;e<b.length;e++)document.getElementById("gameMap"+e).checked&&t.push(e);0==t.length&&(t=[0]),saveVal("private-game-config",JSON.stringify({name:"KRUNKER",availableMaps:t}));var i=a.seekServer(a.server.region,!0);void 0==i?alert("No private servers available at this time"):a.switchServer(i[0],i[1],i[2],p.randomString(10))},Object.defineProperty(console,"_commandLineAPI",{get:function(){throw""}});var o=i(2);o.OBJLoader=i(45)(o);var s,c,h,l,u,d,p=i(23),f=new(i(44))(o,p,n),m=new(i(62))(p,n),g=new(i(61))(f,p,n),v=i(60),y=new(i(59))(f,n),x=i(43),w=new(i(58))(f,o,v,p,n,x),b=i(12).maps,L=(i(12).modes,i(57).obj),M=i(51);L=new L(0,n,null,p,f,m,g);var _,A,E,S,T=[],R=0,O=0,P=0;window.idleTimer=0,Math.PI2=2*Math.PI,Math.lerpAngle=function(t,e,i){Math.abs(e-t)>Math.PI&&(t>e?e+=Math.PI2:t+=Math.PI2);var n=e+(t-e)*i;return n>=0&&n<=Math.PI2?n:n%Math.PI2},console.warn=(t=>{}),console.info=(t=>{});var C,I,D=!1;function F(){window.innerWidth,C=window.innerHeight,I=C/693,f.resize()}function U(){D=!1,window.idleTimer=0,v.toggleMenu(!0),w.toggle(!1)}window.loading=!1,window.enterGame=function(){if(L.singlePlayer&&!D){K("0:00");var t=L.getSpawnPoint();ot([x.socketId,1,t.x,t.y,t.z,"TEST",V,null]),D=!0,ut([1,"TEST",0,0]),v.toggleMenu(!1)}else x.connected&&!D&&(D=!0,window.idleTimer=0,v.toggleMenu(!1),instructions.innerHTML="LOADING...",window.loading=!0,x.send("enter",[V,nt]))},window.addEventListener("resize",F),F(),window.setSetting=function(t,e){document.getElementById("slid"+t)&&(document.getElementById("slid"+t).innerHTML=e),N[t].set(e),N[t].val=e,saveVal("sett_"+t,e)};for(var N=[{name:"<div style='width:100%'><a href='javascript:;' onclick='showWindow(7);' class='menuLink'>Change Controls</a></div>",html:function(){return""}},{name:"Resolution",val:.7,html:function(){return"<span class='sliderVal' id='slid1'>"+N[1].val+"</span><div class='slidecontainer'><input type='range' min='0.1' max='2' step='0.1' value='"+N[1].val+"' class='sliderM' oninput='setSetting(1, this.value)'></div>"},set:function(t){f.setResMlt(t)}},{name:"Sensitivity",val:1,html:function(){return"<span class='sliderVal' id='slid2'>"+N[2].val+"</span><div class='slidecontainer'><input type='range' min='0.1' max='10' step='0.1' value='"+N[2].val+"' class='sliderM' oninput='setSetting(2, this.value)'></div>"},set:function(t){w.sensMlt=t}},{name:"Field of View",val:n.fov,html:function(){return"<span class='sliderVal' id='slid3'>"+N[3].val+"</span><div class='slidecontainer'><input type='range' min='60' max='100' step='5' value='"+N[3].val+"' class='sliderM' oninput='setSetting(3, this.value)'></div>"},set:function(t){f.setFov(t)}},{name:"Sound",val:1,html:function(){return"<span class='sliderVal' id='slid4'>"+N[4].val+"</span><div class='slidecontainer'><input type='range' min='0' max='1' step='0.1' value='"+N[4].val+"' class='sliderM' oninput='setSetting(4, this.value)'></div>"},set:function(t){m.setVolume(t)}},{name:"Particles",val:!0,html:function(){return"<label class='switch'><input type='checkbox' onclick='setSetting(5, this.checked)' "+(N[5].val?"checked":"")+"><span class='slider'></span></label>"},set:function(t){g.active=t}},{name:"Invert Y-Axis",val:!1,html:function(){return"<label class='switch'><input type='checkbox' onclick='setSetting(6, this.checked)' "+(N[6].val?"checked":"")+"><span class='slider'></span></label>"},set:function(t){w.invertY=t}},{name:"Show Chat",val:!0,html:function(){return"<label class='switch'><input type='checkbox' onclick='setSetting(7, this.checked)' "+(N[7].val?"checked":"")+"><span class='slider'></span></label>"},set:function(t){chatHolder.style.display=t?"block":"none"}},{name:"Crosshair Color",val:"#ffffff",html:function(){return"<input type='color' id='head' name='color' value='"+N[8].val+"' oninput='setSetting(8, this.value)' style='float:right;margin-top:5px'/>"},set:function(t){crosshairT.style.backgroundColor=t,crosshairB.style.backgroundColor=t,crosshairLL.style.backgroundColor=t,crosshairRL.style.backgroundColor=t}},{name:"Weapon Bobbing",val:1,html:function(){return"<span class='sliderVal' id='slid9'>"+N[9].val+"</span><div class='slidecontainer'><input type='range' min='0' max='2' step='0.1' value='"+N[9].val+"' class='sliderM' oninput='setSetting(9, this.value)'></div>"},set:function(t){f.weaponLean=t}}],B=0;B<N.length;++B)if(N[B].set){var W=getSavedVal("sett_"+B);N[B].val=null!==W?W:N[B].val,"false"==N[B].val&&(N[B].val=!1),N[B].set(N[B].val)}function z(t){c&&c.setData(t),"block"==windowHolder.style.display&&5==Y&&showWindow(5,!0)}function k(t){try{accResp.innerHTML=t||"",accResp.style.display=t?"block":"none"}catch(t){}}function H(t,e){t>=0&&k("Please Wait..."),x.send("a",t,e)}function G(t,e,i,r,a){t?k(t):(c=new M(e,i,null,n),saveVal("krunker_username",i),z(r),a&&saveVal("krunker_token",a))}window.changeCont=function(t){showWindow(7,!0),t<=3?w.inputChanger=t:4==t?w.inputChanger="jumpKey":5==t?w.inputChanger="crouchKey":6==t?w.inputChanger="swapKeyD":7==t?w.inputChanger="swapKeyU":8==t?w.inputChanger="reloadKey":9==t?w.inputChanger="sprayKey":10==t?w.inputChanger="aimKey":11==t&&(w.inputChanger="chatKey"),document.getElementById("cont"+t).innerHTML="Press any Key"},window.registerAcc=function(){H(0,[accName.value,accPass.value])},window.loginAcc=function(){H(1,[accName.value,accPass.value,null])},window.logoutAcc=function(){H(-1),k(),r&&localStorage.removeItem("krunker_token"),c=null,z()};var V=getSavedVal("classindex")||0;window.selectClass=function(t){saveVal("classindex",t),V=t,showWindow(3)};var j=[{header:"Game Settings",gen:function(){for(var t="",e=0;e<N.length;++e)t+="<div class='settName'>"+N[e].name+" "+N[e].html()+"</div>";return t}},{header:"Server Browser",lastLoadTime:0,gen:function(){return Date.now()-this.lastLoadTime<1e4?this.genList():this.loadData()},loadData:function(){var t=new XMLHttpRequest,e=this;return t.onreadystatechange=function(){4==this.readyState&&(200==this.status?(window.vultr=JSON.parse(this.responseText),a.processServers(vultr.servers),e.lastLoadTime=Date.now(),window.showWindow(2,!0)):console.error("Failed to load server data with status code:",this.status))},t.open("GET","/serverData",!0),t.send(),"Loading..."},expandedRegion:-1,genList:function(){var t=this;window.setExpandedRegion=function(e){t.expandedRegion=e,t.lastLoadTime=Date.now(),showWindow(2,!0)};var e="<div style='font-size:20px'>";e+="<a id='createPrivateRoom' class='menuLink' onclick='showWindow(8)'>+ Private Game</a><br/>";var i=0,r=0;for(var o in a.servers){for(var s=a.servers[o],c=0,h=0;h<s.length;h++)for(var l=0;l<s[h].games.length;l++)c+=s[h].games[l].playerCount;i+=c;var u=a.regionInfo[o].name,d=u+" - "+c+" online",p=this.expandedRegion==r;if(e+="<div class='menuSelectorHeader' onclick='setExpandedRegion("+(p?-1:r)+")' style='cursor: pointer;'>"+(p?"&#x25BC;":"&#x25B6;")+" "+d+"</div>",p){e+="<div class='menuSelectorHolder'>";for(var f=0;f<s.length;f++)for(var m=s[f],g=0;g<m.games.length;g++){var v=m.games[g],y=m.index*n.gamesPerServer+g+1,x=a.server&&a.server.region==m.region&&a.server.index==m.index&&a.gameIndex==g,w=u+" "+y+" - "+v.playerCount+"/"+n.maxPlayers+" online";e+="<div class='menuSelector"+(x?" selectedMenuSelector":"")+(v.isPrivate?" privateMenuSelector":"")+"' onclick='"+(v.isPrivate?"":"switchServer("+o+","+f+","+g+")")+"'>"+w+"</div>"}e+="</div>"}e+="<br/>",r++}return(e+="<b>"+i+" total online</b>")+"</div>"}},{header:"Change Loadout",gen:function(){var t=L.classes[V];return"<div class='settName'>Class<span class='settText floatR' onclick='showWindow(6)'>"+t.name+"</span></div><div class='settName'>Primary<span class='settLabel'>"+L.weapons[t.loadout[0]].name+"</span></div><div class='settName'>Secondary<span class='settLabel'>"+(t.loadout[1]?L.weapons[t.loadout[1]].name:"None")+"</span></div><div class='settName'>Spray<span onclick='showWindow(9)' class='settText floatR'>"+L.sprays[nt].name+"</span></div>"}},{header:"Mod Manager",gen:function(){return"<div id='modLinks'><a href='./docs/mods.txt' class='menuLink'>Mod Guide</a> | <a href='' class='menuLink'>Find Mods</a></div><form id='modDropper'><input onchange='loadMod()' id='modInput'type='file'><p id='modLInfo'>drop mod file here or click</p></form>"}},{header:"Account",gen:function(){return c?"<div class='settName'>Name<span class='floatR'>"+c.name+"</span></div><div class='settName'>Level<span class='floatR'><img src='./img/levels/"+Math.max(Math.min(n.maxLevel,c.level.roundToNearest(3)-2),0)+".png' class='rnkIcon'>"+c.level+"</span></div><div class='settName'>Score<span class='floatR'>"+c.score+"</span></div><div class='settName'>Kills<span class='floatR'>"+c.kills+"</span></div><div class='settName'>Deaths<span class='floatR'>"+c.deaths+"</span></div><div class='settName'>KDR<span class='floatR'>"+(c.kills/Math.max(c.deaths,1)).toFixed(2)+"</span></div><div class='settName'>Games Played<span class='floatR'>"+c.games+"</span></div><div class='settName'>Games Won<span class='floatR'>"+c.wins+"</span></div><div class='settName'>W/L<span class='floatR'>"+(c.wins/Math.max(c.games-c.wins,1)).toFixed(2)+"</span></div><div class='settName'>Time Played<span class='floatR'>"+p.getReadableTime(c.timePlayed)+"</span></div><div style='height:10px'></div><a class='menuLink' onclick='logoutAcc()'>Logout</a>":"<input id='accName' type='text' placeholder='Username' class='accountInput' style='margin-top:0' value='"+(getSavedVal("krunker_username")||"")+"'></input><input id='accPass' type='password' placeholder='Password' class='accountInput'></input><div id='accResp' style='margin-top:15px;color:rgba(0,0,0,0.7);display:none'></div><div class='accountButton' onclick='registerAcc()'>Register</div><div class='accountButton' onclick='loginAcc()' style='margin-left: 20px'>Login</div>"}},{header:"Select Class",gen:function(){for(var t="",e=0;e<L.classes.length;++e)t+="<div class='selItem' style='margin-top:"+(e>0?"10px":"")+"'><div class='equipBtn' onclick='selectClass("+e+")'><i class='material-icons'>&#xE037</i></div><div class='itemIcon'><img class='itemIconImg' src='./textures/classes/icon_"+e+".png'/></div><div class='itemInfo'><div class='itemName'>"+L.classes[e].name+"</div><div class='itemCat'>"+L.weapons[L.classes[e].loadout[0]].name+"</div></div></div>";return t}},{header:"Change Controls",gen:function(){var t="";return t+="<div class='settName'>Forward<span class='settText floatR' id='cont0' onclick='changeCont(0)'>"+p.getKeyName(w.moveKeys[0])+"</span></div>",t+="<div class='settName'>Backward<span class='settText floatR' id='cont1' onclick='changeCont(1)'>"+p.getKeyName(w.moveKeys[1])+"</span></div>",t+="<div class='settName'>Left<span class='settText floatR' id='cont2' onclick='changeCont(2)'>"+p.getKeyName(w.moveKeys[2])+"</span></div>",t+="<div class='settName'>Right<span class='settText floatR' id='cont3' onclick='changeCont(3)'>"+p.getKeyName(w.moveKeys[3])+"</span></div>",t+="<div class='settName'>Reload<span class='settText floatR' id='cont8' onclick='changeCont(8)'>"+p.getKeyName(w.reloadKey)+"</span></div>",t+="<div class='settName'>Aim<span class='settText floatR' id='cont10' onclick='changeCont(10)'>"+p.getKeyName(w.aimKey)+"</span></div>",t+="<div class='settName'>Spray<span class='settText floatR' id='cont9' onclick='changeCont(9)'>"+p.getKeyName(w.sprayKey)+"</span></div>",t+="<div class='settName'>Jump<span class='settText floatR' id='cont4' onclick='changeCont(4)'>"+p.getKeyName(w.jumpKey)+"</span></div>",t+="<div class='settName'>Crouch<span class='settText floatR' id='cont5' onclick='changeCont(5)'>"+p.getKeyName(w.crouchKey)+"</span></div>",t+="<div class='settName'>Next Weapon<span class='settText floatR' id='cont6' onclick='changeCont(6)'>"+p.getKeyName(w.swapKeyD)+"</span></div>",(t+="<div class='settName'>Previous Weapon<span class='settText floatR' id='cont7' onclick='changeCont(7)'>"+p.getKeyName(w.swapKeyU)+"</span></div>")+"<div class='settName'>Chat<span class='settText floatR' id='cont11' onclick='changeCont(11)'>"+p.getKeyName(w.chatKey)+"</span></div>"}},{header:"Create Private Game",gen:function(){var t="";t+="<div class='settName'>Select Maps</div>",t+="<div style='margin-top:5px'>";for(var e=0;e<b.length;e++){var i="<label class='switch'><input id='gameMap"+e+"' type='checkbox' checked=''><span class='slider'></span></label>";t+="<div class='settNameSmall' style='margin:0'>"+b[e].name+i+"</div>"}return t+="</div><br />",t+="<div style='text-align: left'>",t+="<a class='menuLink' onclick='createPrivateRoom()'>Create Game</a><br/>",(t+="<span style='opacity: 0.5'>Share the URL with your friends</span>")+"</div>"}},{header:"Select Spray",gen:function(){for(var t="",e=0;e<L.sprays.length;++e)t+="<div class='selItem' style='margin-top:"+(e>0?"10px":"")+"'><div class='equipBtn' onclick='selectSpray("+e+")'><i class='material-icons'>&#xE037</i></div><div class='itemIcon'><img class='itemIconImg' src='./textures/sprays/"+e+".png'/></div><div class='itemInfo'><div class='itemName'>"+L.sprays[e].name+"</div><div class='itemCat'>Default Spray</div></div></div>";return t}},{header:"Custom Maps",gen:function(){return"<a href='./editor.html' class='menuLink'>Map Editor</a><br/><input id='mapData' type='text' placeholder='Copy Map Data' class='mapInput' /><div class='mapLoadButton' onclick='loadCustomMap()'>Load</div>"}}];for(B=0;B<j.length;++B)j[B].html="";var Y=0;window.showWindow=function(t,e){window.idleTimer=0,e||t&&("block"!=windowHolder.style.display||t!=Y)?(j[t-1].gen?menuWindow.innerHTML=j[t-1].gen():menuWindow.innerHTML=j[t-1].html,Y=t,windowHeader.innerHTML=j[t-1].header,v.toggleWindow(!0)):(v.toggleWindow(!1),w.inputChanger=null)},window.loadCustomMap=function(){Mt(null,!0),L.singlePlayer=!0;try{var t=JSON.parse(mapData.value);L.map.maps=[t];for(var e=0;e<L.map.maps.length;++e)for(var i=0;i<L.map.maps[e].objects.length;++i)L.map.maps[e].objects[i].id=n.prefabIDS[L.map.maps[e].objects[i].id];$(0,null,null,!0)}catch(t){}},zip.workerScriptsPath="./libs/";var X=new FileReader;function q(t){this.imgAsDataURL="",this.process=function(e){if(this.imgAsDataURL=URL.createObjectURL(e),this.imgAsDataURL&&t){try{var i=new Image;i.onload=function(){f.updateTexture(t.replace("textures/","").replace(".png",""),this)},i.src=this.imgAsDataURL}catch(t){}J.close()}}}function Z(t){this.filename=t;var e=this;this.process=function(t){var i=URL.createObjectURL(t);if(i){try{var n=e.filename.split("/")[1];m.sounds[n]=new Howl({src:[i],format:"mp3"}),"ambient_1"==n&&m.play("ambient_1",.12,!0)}catch(t){}J.close()}}}X.onload=function(t){!function(t){try{var e="";zip.createReader(new zip.Data64URIReader(t),function(t){t.getEntries(function(i){if(i.length){J.init(t,i.length);for(var n=0;n<i.length;n++){var r=i[n];r.directory?J.close():"textures"==(e=r.filename.split("/")[0])?r.getData(new zip.BlobWriter("image/png"),new q(r.filename).process,function(t,e){}):"sound"==e&&r.getData(new zip.BlobWriter("audio/mp3"),new Z(r.filename.replace(".mp3","")).process,function(t,e){})}}})},function(t){modLInfo.innerHTML="mod error!"})}catch(t){modLInfo.innerHTML="mod error!"}}(t.target.result)};var J=new function(){this.init=function(t,e){this.numFiles=e,this.progress=0,this.reader=t},this.close=function(){this.reader&&(this.progress++,modLInfo.innerHTML="extracting "+this.progress+"/"+this.numFiles,this.numFiles===this.progress&&(spriteIndex=0,modLInfo.innerHTML="success!",this.reader.close(),this.reader=void 0))}};function K(t,e){P=e,at(t),v.toggleMenu(!1),function(){ft.length=0,yt.length=0,v.toggleGameUI(!0),y.reset(),w.reset(),L.players.forcePos(),T.length=0,window.loading=!1,window.idleTimer=0,instructions.innerHTML="CLICK TO PLAY",d=null;for(var t=0;t<playerInfos.children.length;t++)playerInfos.children[t].style.display="none"}(),v.toggleControlUI(w.enabled)}function Q(t){gameName.innerText=t.name}function $(t,e,i,n){L.init(t,e,i,n),S=null,w.reset();var r=L.map.maps[t];w.moveCam(r.camPos[0],r.camPos[1],r.camPos[2]),w.rotateCam(0,0,0),f.clearSprays(),f.scene.add(w.object),s=null,playerInfos.innerHTML="",killsVal.innerHTML=0,O=0,U()}function tt(t,e,i){instructions.innerHTML="CLICK TO PLAY",victoryText.innerHTML=e?"VICTORY":"DEFEAT",victorySub.src="./img/"+(e?"sub":"defeat")+".png",s&&s.active?(v.showEndScreen(),S=n.endAnim,setTimeout(function(){w.disable(),et(i)},n.endAnim)):t&&(w.disable(),v.showEndScreen(),et(i))}function et(t){if(t&&t.length){endTable.style.display="inline-block";for(var e="<tr><th>Rank</th>",i=n.endStats.length,r=1;r<i;++r)e+="<th>"+p.capFirst(n.endStats[r])+"</th>";e+="</tr>";var a=1;for(r=0;r<t.length;){if(h=L.players.findBySid(t[r])){e+="<tr style='"+(r+i>=t.length?"border-bottom:none":"")+"'><td style='color:#fff'>"+a+".</td>";for(var o=1;o<i;++o)e+="<td "+(1!=o?"":"style='color:"+(s&&s.sid==h.sid?"#fff'":s&&s.team&&s.team==h.team?"rgba(255,255,255,0.6)'":"#eb5656'"))+">"+t[r+o]+"</td>"}e+="</tr>",a++,r+=i}endTable.innerHTML=e}}function it(t,e,i){L.playerSound(t,e,i)}window.loadMod=function(){if(modInput.files&&modInput.files[0]){var t=modInput.files[0];"zip"==t.name.split(".").pop().toLowerCase()?(modLInfo.innerHTML="loading mod...",X.readAsDataURL(t)):modLInfo.innerHTML="invalid mod file!"}};var nt=getSavedVal("sprayindex")||0;function rt(t,e,i,n,r,a,o){f.addSpray(t,e,i,n,r,a,o,L.sprays[e].opacity)}function at(t,e){e?endTimer.innerHTML="Next Round in "+t:timerVal.innerHTML=t}function ot(t){for(var e=0;e<t.length;){var i=t[e]==x.socketId;if((h=L.players.add(t[e],t[e+1],t[e+2],t[e+3],t[e+4],t[e+5],t[e+6],i)).health=null==t[e+7]?h.maxHealth:t[e+7],h.team=t[e+8],h.level=t[e+9],i)s=h;else{playerInfos.innerHTML+="<div id='pInfo"+h.sid+"' class='playerInfo'>"+(h.level?"<div class='playerRank' id='pInfoR"+h.sid+"'>"+h.level+"</div>":"")+"<div class='pInfoH' id='pInfoH"+h.sid+"'>"+h.name+"<div></div><div class='playerHealth'><div class='healthBar"+(P&&P==h.team?"":"E")+"' id='healthBarE"+h.sid+"'></div></div></div></div>";var n=document.getElementById("pInfoH"+h.sid);n&&(n.style.textAlign=h.level?"left":"center")}vt(h.health,h.sid,null,null),e+=10}}function st(t){if(x.send("p"),s){s.x=t[1],s.y=t[2],s.z=t[3],s.xVel=t[4],s.yVel=t[5],s.zVel=t[6],s.onGround=t[7],s.didJump=t[8],s.onLadder=t[9],s.aimVal=t[10],s.crouchVal=t[11],L.players.swapWeapon(s,0,!1,t[12]);for(var e=0;e<w.tmpInputs.length;)w.tmpInputs[e][0]<=t[0]?w.tmpInputs.splice(e,1):(s.processInput(w.tmpInputs[e],L.map,!0),e++)}}function ct(t){L.players.hideAll();for(var e=0;e<t.length;)(h=L.players.findBySid(t[e]))&&(h.objInstances.visible=!0,h.forcePos?(h.x=t[e+1],h.y=t[e+2],h.z=t[e+3],h.xDir=t[e+4],h.yDir=t[e+5],h.interpolate=!1,h.forcePos=!1):(h.dt=0,h.x1=h.x,h.x2=t[e+1],h.y1=h.y,h.y2=t[e+2],h.z1=h.z,h.z2=t[e+3],h.xDir1=h.xDir,h.xDir2=t[e+4],h.yDir1=h.yDir,h.yDir2=t[e+5],h.interpolate=!0),h.onGround=t[e+6],h.crouchVal=t[e+7],L.players.swapWeapon(h,0,!1,t[e+8])),e+=9}function ht(t){L.players.remove(t)}function lt(t,e,i){if(h=L.players.findBySid(t),l=L.players.findBySid(e),h){if(L.players.kill(h),h.isYou){var r="";l&&(w.camLookAt(l.x,l.y+l.height-n.cameraHeight,l.z),l.interpolate=!1,l.isVisible=!0,r="<img id='kCProfile' src='./textures/classes/icon_"+l.classIndex+".png' />",r+="<div id='kCName'>"+(l?l.name:"You")+"</div>",r+="<br/><div id='kCInfo'>["+L.weapons[i[0]].name+"] <span id='kCInfoS'>+"+i[1]+"</span></div>"),killCard.innerHTML=r,v.toggleGameUI(!1),setTimeout(function(){U()},n.deathDelay)}var a=h==s?"<span style='color:#fff'>You</span>":"<span style='color:"+(P&&P==h.team?"#9eeb56":"#eb5656")+"'>"+h.name+"</span>",o=l==s?"<span style='color:#fff'>You</span>":l?"<span style='color:"+(P&&P==l.team?"#9eeb56":"#eb5656")+"'>"+l.name+"</span>":"";wt(null,l?o+" killed "+a:a+" committed suicide",!0)}}function ut(t){if(s){for(var e="",i=1,n=0;n<t.length;n+=4)e+="<div class='leaderItem'>",e+="<div class='leaderCounter'>"+i+".</div>",e+="<div class='leaderName"+(t[n]==s.sid?"M":P&&P==t[n+2]?"F":"")+"'>"+t[n+1]+"</div>",e+="<div class='leaderScore'>"+p.formatNum(t[n+3])+"</div>",e+="</div>",i++;leaderContainer.innerHTML=e}}function dt(t,e,i,r,a,o){if(s&&s.active){if(h=L.players.findBySid(t)){var c=h.y+h.height-n.cameraHeight-h.crouchVal*n.crouchDst,l=p.getDistance3D(h.x,c,h.z,e,i,r),u=p.getDirection(h.z,h.x,r,e),d=p.getDirection(p.getDistance(h.x,h.z,e,r),i,0,c);g.tracer(h.x,c,h.z,u,d,l)}void 0!=a&&g.effect(e,i,r,a,o,0)}}function pt(t){O+=t,y.animateText(scoreText,"+"+O,100,.38,1100,100,0,function(){O=0}),s.score+=t}window.selectSpray=function(t){saveVal("sprayindex",t),nt=t,showWindow(3)};var ft=[];function mt(t,e,i){if(t){for(var r=0==ft.length,a=0;a<t.length;++a)""==t[a]?a++:ft.push(t[a]);r&&function t(e){ft.length>0&&y.animateText(chalName,"<span class='cTxt'>"+ft[0]+"</span><div id='chalScore'>+"+ft[1]+"</div>",130,.4,n.medalAnim,100,e,function(){ft.splice(0,2),t(0)})}(n.medalDelay)}e&&m.play("headshot"),killsVal.innerHTML=i}var gt=0;function vt(t,e,i,r){if(s&&(h=void 0==e||null==e?s:L.players.findBySid(e))){h.health=t;var a=t/h.maxHealth*100;h==s?(healthValue.innerHTML=t+" <span id='maxHP'>|"+h.maxHealth+"</span>",healthBarH.style.width=a+"%",healthBarH.style.backgroundColor=a<=35?"#eb5656":"#9eeb56",bloodDisplay.style.display=a<=35?"block":"none",bloodDisplay.style.opacity=1-a/35,t<gt&&(void 0!=i&&null!=i&&function(t,e){for(var i=null,r=0;r<yt.length;++r)if(!yt[r].life){i=yt[r];break}i||(i={},yt.push(i)),i.life=n.hitLife,i.x=t,i.z=e}(i,r),m.play("impact_0",.6)),gt=t):document.getElementById("healthBarE"+e).style.width=a+"%"}}var yt=[];function xt(t,e){m.play("hit_0",3),y.animateDiv(hitmarker,400,100,14)}function wt(t,e,i){for(chatList.innerHTML+=i?"<div class='chatItem'><span class='chatMsg'>"+e+"</span></div><br/>":"<div class='chatItem'>"+(t||"unknown")+": <span class='chatMsg'>"+e+"</span></div><br/>";chatList.scrollHeight>=250;)chatList.removeChild(chatList.childNodes[0])}window.pressButton=function(t){t==w.chatKey&&(document.activeElement!=chatInput?chatInput.focus():(""!=chatInput.value&&(x.send("c",chatInput.value),chatInput.value=""),chatInput.blur())),s&&s.active&&t==w.sprayKey&&x.send("s")};var bt=void 0;function Lt(t){bt=t,showWindow(0),w.disable(),v.hideUI(),instructionHolder.style.display="block",instructions.innerHTML="<span style='color: rgba(255, 255, 255, 0.6)'>"+t+"</span><br/><span style='color: rgba(255, 255, 255, 0.6)'>Try seeking a new server by clicking <a href='https://krunker.io/'>here</a>.</span>",instructionHolder.style.pointerEvents="all"}function Mt(t,e){x.socket.onclose=function(){},x.socket.close(),e||(showWindow(0),w.disable(),v.hideUI(),instructionHolder.style.display="block",instructions.innerText=t||"DISCONNECTED")}a.start(function(t,e,i){var n="//"+t+":8008/?gameIndex="+i;if(void 0!=a.password&&(n+="&password="+encodeURIComponent(a.password),void 0!=a.password&&!a.server.games[a.gameIndex].isPrivate)){var r=getSavedVal("private-game-config");n+="&serverConfig="+encodeURIComponent(r)}x.connect(n,function(t){if(t){if(void 0!=bt)return;Mt()}else U(),function(){var t=getSavedVal("krunker_token"),e=getSavedVal("krunker_username");t&&e&&H(1,[e,null,t])}()},{config:Q,init:$,start:K,end:tt,error:Lt,t:at,0:ot,1:ct,8:st,2:ht,3:lt,4:xt,5:pt,6:mt,7:ut,9:dt,h:vt,s:it,sp:rt,ch:wt,a:G,ua:z})},function(t){Lt(t)}),window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},setInterval(function(){!L.singlePlayer&&s&&s.active&&(x.send("0",T),T.length=0)},n.clientSendRate),setInterval(function(){if(!L.singlePlayer&&s&&s.active)for(var t=0;t<L.players.list.length;++t)if((h=L.players.list[t]).active&&h.objInstances&&h!=s&&(h.isVisible=!0,!P||P!=h.team))for(var e=p.getDistance3D(s.x,s.y,s.z,h.x,h.y,h.z),i=p.getDirection(s.z,s.x,h.z,h.x),r=p.getDirection(p.getDistance(s.x,s.z,h.x,h.z),h.y,0,s.y),a=1/(e*Math.sin(i-Math.PI)*Math.cos(r)),o=1/(e*Math.cos(i-Math.PI)*Math.cos(r)),c=1/(e*Math.sin(r)),u=0;u<L.map.manager.objects.length;++u)if(l=L.map.manager.objects[u],tmpDst=p.lineInRect(s.x,s.z,s.y+s.height-n.cameraHeight,a,o,c,l.x-l.width,l.z-l.length,l.y-l.height,l.x+l.width,l.z+l.length,l.y+l.height),tmpDst&&tmpDst<1){h.isVisible=!1;break}},n.nameVisRate),E=Date.now(),function t(){_=Date.now(),A=_-E,A=Math.min(A,n.maxDelta),E=_,S>0&&(S-=A)<=0&&(S=0),null!=S&&(A*=S/n.endAnim),s||(R+=1e-4*A,R%=2*Math.PI,w.rotateCam(R,0,0)),w.update(A),s&&s.active&&(w.skipScroll=!1,u=[w.getISN(),A,w.xDir,w.yDir,n.movDirs.indexOf(w.moveDir),w.mouseDownL,w.mouseDownR||w.keys[w.aimKey]?1:0,w.keys[w.jumpKey]?1:0,w.keys[w.crouchKey]?1:0,w.keys[w.reloadKey]?1:0,w.scrollDelta],w.scrollDelta&&(w.skipScroll=!0),w.scrollDelta=0,w.tmpInputs.push(u),s.processInput(u,L.map),w.moveCam(s.x,s.y+s.height-n.cameraHeight,s.z),w.rotateCam(0,s.recoilAnimY*n.recoilMlt,0),v.updateCrosshair(Math.max(.05*window.innerHeight,s.spread*I),s.aimVal*(s.weapon.melee||s.reloadTimer>0?0:1)),L.singlePlayer||function(t){for(var e=T.length?1:0;e<t.length;)if(2==e&&d&&d[2]==t[2]&&d[3]==t[3])T.push("x"),e+=2;else{if(5==e&&d&&d[5]==t[5]&&d[6]==t[6]&&d[7]==t[7]&&d[8]==t[8]&&d[9]==t[9]&&d[10]==t[10]){T.push("x");break}T.push(t[e]),e++}d=t}(u),Howler.pos(s.x,s.y+s.height-n.cameraHeight,s.z),Howler.orientation(Math.sin(w.xDir+Math.PI),w.yDir,Math.cos(w.xDir+Math.PI)),s.y<=n.deathY&&lt(s.sid)),L.update(A,_,s),function(t){var e="";if(s&&s.active)for(var i=0;i<yt.length;++i)yt[i].life&&(yt[i].life-=t,yt[i].life<=0&&(yt[i].life=0),e+="<div class='hitInd' style='transform: translate(0, -50%) rotate("+(w.xDir+p.getDirection(yt[i].x,yt[i].z,s.x,s.z))+"rad);opacity:"+yt[i].life/n.hitLife+"'></div>");hitHolder.innerHTML=e}(A),y.update(A),"block"==menuHolder.style.display&&(window.idleTimer+=A,window.idleTimer>=n.kickTimer&&Mt("Kicked for inactivity")),requestAnimFrame(t)}()}]);
//# sourceMappingURL=game.js.map
